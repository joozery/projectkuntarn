function BC(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function _2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var S2={exports:{}},H0={},E2={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nu=Symbol.for("react.element"),UC=Symbol.for("react.portal"),VC=Symbol.for("react.fragment"),$C=Symbol.for("react.strict_mode"),zC=Symbol.for("react.profiler"),HC=Symbol.for("react.provider"),WC=Symbol.for("react.context"),GC=Symbol.for("react.forward_ref"),XC=Symbol.for("react.suspense"),KC=Symbol.for("react.memo"),YC=Symbol.for("react.lazy"),f1=Symbol.iterator;function qC(e){return e===null||typeof e!="object"?null:(e=f1&&e[f1]||e["@@iterator"],typeof e=="function"?e:null)}var C2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j2=Object.assign,T2={};function cl(e,t,r){this.props=e,this.context=t,this.refs=T2,this.updater=r||C2}cl.prototype.isReactComponent={};cl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};cl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function A2(){}A2.prototype=cl.prototype;function Ip(e,t,r){this.props=e,this.context=t,this.refs=T2,this.updater=r||C2}var Rp=Ip.prototype=new A2;Rp.constructor=Ip;j2(Rp,cl.prototype);Rp.isPureReactComponent=!0;var h1=Array.isArray,F2=Object.prototype.hasOwnProperty,Lp={current:null},P2={key:!0,ref:!0,__self:!0,__source:!0};function D2(e,t,r){var n,s={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)F2.call(t,n)&&!P2.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:nu,type:e,key:a,ref:o,props:s,_owner:Lp.current}}function ZC(e,t){return{$$typeof:nu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Op(e){return typeof e=="object"&&e!==null&&e.$$typeof===nu}function JC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var m1=/\/+/g;function Vf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?JC(""+e.key):t.toString(36)}function vd(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case nu:case UC:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+Vf(o,0):n,h1(s)?(r="",e!=null&&(r=e.replace(m1,"$&/")+"/"),vd(s,t,r,"",function(u){return u})):s!=null&&(Op(s)&&(s=ZC(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(m1,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",h1(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+Vf(a,l);o+=vd(a,t,r,c,s)}else if(c=qC(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+Vf(a,l++),o+=vd(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Iu(e,t,r){if(e==null)return e;var n=[],s=0;return vd(e,n,"","",function(a){return t.call(r,a,s++)}),n}function QC(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var rn={current:null},yd={transition:null},ej={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:yd,ReactCurrentOwner:Lp};function I2(){throw Error("act(...) is not supported in production builds of React.")}rt.Children={map:Iu,forEach:function(e,t,r){Iu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Iu(e,function(){t++}),t},toArray:function(e){return Iu(e,function(t){return t})||[]},only:function(e){if(!Op(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};rt.Component=cl;rt.Fragment=VC;rt.Profiler=zC;rt.PureComponent=Ip;rt.StrictMode=$C;rt.Suspense=XC;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ej;rt.act=I2;rt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=j2({},e.props),s=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=Lp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)F2.call(t,c)&&!P2.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:nu,type:e.type,key:s,ref:a,props:n,_owner:o}};rt.createContext=function(e){return e={$$typeof:WC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:HC,_context:e},e.Consumer=e};rt.createElement=D2;rt.createFactory=function(e){var t=D2.bind(null,e);return t.type=e,t};rt.createRef=function(){return{current:null}};rt.forwardRef=function(e){return{$$typeof:GC,render:e}};rt.isValidElement=Op;rt.lazy=function(e){return{$$typeof:YC,_payload:{_status:-1,_result:e},_init:QC}};rt.memo=function(e,t){return{$$typeof:KC,type:e,compare:t===void 0?null:t}};rt.startTransition=function(e){var t=yd.transition;yd.transition={};try{e()}finally{yd.transition=t}};rt.unstable_act=I2;rt.useCallback=function(e,t){return rn.current.useCallback(e,t)};rt.useContext=function(e){return rn.current.useContext(e)};rt.useDebugValue=function(){};rt.useDeferredValue=function(e){return rn.current.useDeferredValue(e)};rt.useEffect=function(e,t){return rn.current.useEffect(e,t)};rt.useId=function(){return rn.current.useId()};rt.useImperativeHandle=function(e,t,r){return rn.current.useImperativeHandle(e,t,r)};rt.useInsertionEffect=function(e,t){return rn.current.useInsertionEffect(e,t)};rt.useLayoutEffect=function(e,t){return rn.current.useLayoutEffect(e,t)};rt.useMemo=function(e,t){return rn.current.useMemo(e,t)};rt.useReducer=function(e,t,r){return rn.current.useReducer(e,t,r)};rt.useRef=function(e){return rn.current.useRef(e)};rt.useState=function(e){return rn.current.useState(e)};rt.useSyncExternalStore=function(e,t,r){return rn.current.useSyncExternalStore(e,t,r)};rt.useTransition=function(){return rn.current.useTransition()};rt.version="18.3.1";E2.exports=rt;var E=E2.exports;const xt=_2(E),tj=BC({__proto__:null,default:xt},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rj=E,nj=Symbol.for("react.element"),sj=Symbol.for("react.fragment"),aj=Object.prototype.hasOwnProperty,ij=rj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oj={key:!0,ref:!0,__self:!0,__source:!0};function R2(e,t,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)aj.call(t,n)&&!oj.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:nj,type:e,key:a,ref:o,props:s,_owner:ij.current}}H0.Fragment=sj;H0.jsx=R2;H0.jsxs=R2;S2.exports=H0;var i=S2.exports,Zh={},L2={exports:{}},Fn={},O2={exports:{}},M2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,S){var F=q.length;q.push(S);e:for(;0<F;){var L=F-1>>>1,T=q[L];if(0<s(T,S))q[L]=S,q[F]=T,F=L;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var S=q[0],F=q.pop();if(F!==S){q[0]=F;e:for(var L=0,T=q.length,U=T>>>1;L<U;){var X=2*(L+1)-1,H=q[X],ee=X+1,me=q[ee];if(0>s(H,F))ee<T&&0>s(me,H)?(q[L]=me,q[ee]=F,L=ee):(q[L]=H,q[X]=F,L=X);else if(ee<T&&0>s(me,F))q[L]=me,q[ee]=F,L=ee;else break e}}return S}function s(q,S){var F=q.sortIndex-S.sortIndex;return F!==0?F:q.id-S.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,g=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(q){for(var S=r(u);S!==null;){if(S.callback===null)n(u);else if(S.startTime<=q)n(u),S.sortIndex=S.expirationTime,t(c,S);else break;S=r(u)}}function N(q){if(p=!1,x(q),!g)if(r(c)!==null)g=!0,j(_);else{var S=r(u);S!==null&&Y(N,S.startTime-q)}}function _(q,S){g=!1,p&&(p=!1,b(C),C=-1),m=!0;var F=h;try{for(x(S),f=r(c);f!==null&&(!(f.expirationTime>S)||q&&!A());){var L=f.callback;if(typeof L=="function"){f.callback=null,h=f.priorityLevel;var T=L(f.expirationTime<=S);S=e.unstable_now(),typeof T=="function"?f.callback=T:f===r(c)&&n(c),x(S)}else n(c);f=r(c)}if(f!==null)var U=!0;else{var X=r(u);X!==null&&Y(N,X.startTime-S),U=!1}return U}finally{f=null,h=F,m=!1}}var k=!1,w=null,C=-1,D=5,z=-1;function A(){return!(e.unstable_now()-z<D)}function R(){if(w!==null){var q=e.unstable_now();z=q;var S=!0;try{S=w(!0,q)}finally{S?G():(k=!1,w=null)}}else k=!1}var G;if(typeof y=="function")G=function(){y(R)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,Z=I.port2;I.port1.onmessage=R,G=function(){Z.postMessage(null)}}else G=function(){v(R,0)};function j(q){w=q,k||(k=!0,G())}function Y(q,S){C=v(function(){q(e.unstable_now())},S)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,j(_))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(h){case 1:case 2:case 3:var S=3;break;default:S=h}var F=h;h=S;try{return q()}finally{h=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,S){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var F=h;h=q;try{return S()}finally{h=F}},e.unstable_scheduleCallback=function(q,S,F){var L=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?L+F:L):F=L,q){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=F+T,q={id:d++,callback:S,priorityLevel:q,startTime:F,expirationTime:T,sortIndex:-1},F>L?(q.sortIndex=F,t(u,q),r(c)===null&&q===r(u)&&(p?(b(C),C=-1):p=!0,Y(N,F-L))):(q.sortIndex=T,t(c,q),g||m||(g=!0,j(_))),q},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(q){var S=h;return function(){var F=h;h=S;try{return q.apply(this,arguments)}finally{h=F}}}})(M2);O2.exports=M2;var lj=O2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cj=E,En=lj;function we(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var B2=new Set,wc={};function Zi(e,t){Ko(e,t),Ko(e+"Capture",t)}function Ko(e,t){for(wc[e]=t,e=0;e<t.length;e++)B2.add(t[e])}var na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jh=Object.prototype.hasOwnProperty,uj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p1={},x1={};function dj(e){return Jh.call(x1,e)?!0:Jh.call(p1,e)?!1:uj.test(e)?x1[e]=!0:(p1[e]=!0,!1)}function fj(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hj(e,t,r,n){if(t===null||typeof t>"u"||fj(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function nn(e,t,r,n,s,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Er[e]=new nn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Er[t]=new nn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Er[e]=new nn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Er[e]=new nn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Er[e]=new nn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Er[e]=new nn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Er[e]=new nn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Er[e]=new nn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Er[e]=new nn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mp=/[\-:]([a-z])/g;function Bp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Mp,Bp);Er[t]=new nn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Mp,Bp);Er[t]=new nn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Mp,Bp);Er[t]=new nn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Er[e]=new nn(e,1,!1,e.toLowerCase(),null,!1,!1)});Er.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Er[e]=new nn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Up(e,t,r,n){var s=Er.hasOwnProperty(t)?Er[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hj(t,r,s,n)&&(r=null),n||s===null?dj(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var fa=cj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ru=Symbol.for("react.element"),vo=Symbol.for("react.portal"),yo=Symbol.for("react.fragment"),Vp=Symbol.for("react.strict_mode"),Qh=Symbol.for("react.profiler"),U2=Symbol.for("react.provider"),V2=Symbol.for("react.context"),$p=Symbol.for("react.forward_ref"),em=Symbol.for("react.suspense"),tm=Symbol.for("react.suspense_list"),zp=Symbol.for("react.memo"),Na=Symbol.for("react.lazy"),$2=Symbol.for("react.offscreen"),g1=Symbol.iterator;function jl(e){return e===null||typeof e!="object"?null:(e=g1&&e[g1]||e["@@iterator"],typeof e=="function"?e:null)}var Bt=Object.assign,$f;function zl(e){if($f===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);$f=t&&t[1]||""}return`
`+$f+e}var zf=!1;function Hf(e,t){if(!e||zf)return"";zf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{zf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?zl(e):""}function mj(e){switch(e.tag){case 5:return zl(e.type);case 16:return zl("Lazy");case 13:return zl("Suspense");case 19:return zl("SuspenseList");case 0:case 2:case 15:return e=Hf(e.type,!1),e;case 11:return e=Hf(e.type.render,!1),e;case 1:return e=Hf(e.type,!0),e;default:return""}}function rm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yo:return"Fragment";case vo:return"Portal";case Qh:return"Profiler";case Vp:return"StrictMode";case em:return"Suspense";case tm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case V2:return(e.displayName||"Context")+".Consumer";case U2:return(e._context.displayName||"Context")+".Provider";case $p:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zp:return t=e.displayName||null,t!==null?t:rm(e.type)||"Memo";case Na:t=e._payload,e=e._init;try{return rm(e(t))}catch{}}return null}function pj(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rm(t);case 8:return t===Vp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Wa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function z2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xj(e){var t=z2(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lu(e){e._valueTracker||(e._valueTracker=xj(e))}function H2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=z2(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Md(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function nm(e,t){var r=t.checked;return Bt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function v1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Wa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function W2(e,t){t=t.checked,t!=null&&Up(e,"checked",t,!1)}function sm(e,t){W2(e,t);var r=Wa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?am(e,t.type,r):t.hasOwnProperty("defaultValue")&&am(e,t.type,Wa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function y1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function am(e,t,r){(t!=="number"||Md(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Hl=Array.isArray;function Lo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Wa(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function im(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(we(91));return Bt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function w1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(we(92));if(Hl(r)){if(1<r.length)throw Error(we(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Wa(r)}}function G2(e,t){var r=Wa(t.value),n=Wa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function b1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function X2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function om(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?X2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ou,K2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ou=Ou||document.createElement("div"),Ou.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ou.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function bc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Jl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gj=["Webkit","ms","Moz","O"];Object.keys(Jl).forEach(function(e){gj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Jl[t]=Jl[e]})});function Y2(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Jl.hasOwnProperty(e)&&Jl[e]?(""+t).trim():t+"px"}function q2(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Y2(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var vj=Bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lm(e,t){if(t){if(vj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(we(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(we(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(we(61))}if(t.style!=null&&typeof t.style!="object")throw Error(we(62))}}function cm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var um=null;function Hp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var dm=null,Oo=null,Mo=null;function N1(e){if(e=iu(e)){if(typeof dm!="function")throw Error(we(280));var t=e.stateNode;t&&(t=Y0(t),dm(e.stateNode,e.type,t))}}function Z2(e){Oo?Mo?Mo.push(e):Mo=[e]:Oo=e}function J2(){if(Oo){var e=Oo,t=Mo;if(Mo=Oo=null,N1(e),t)for(e=0;e<t.length;e++)N1(t[e])}}function Q2(e,t){return e(t)}function eb(){}var Wf=!1;function tb(e,t,r){if(Wf)return e(t,r);Wf=!0;try{return Q2(e,t,r)}finally{Wf=!1,(Oo!==null||Mo!==null)&&(eb(),J2())}}function Nc(e,t){var r=e.stateNode;if(r===null)return null;var n=Y0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(we(231,t,typeof r));return r}var fm=!1;if(na)try{var Tl={};Object.defineProperty(Tl,"passive",{get:function(){fm=!0}}),window.addEventListener("test",Tl,Tl),window.removeEventListener("test",Tl,Tl)}catch{fm=!1}function yj(e,t,r,n,s,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ql=!1,Bd=null,Ud=!1,hm=null,wj={onError:function(e){Ql=!0,Bd=e}};function bj(e,t,r,n,s,a,o,l,c){Ql=!1,Bd=null,yj.apply(wj,arguments)}function Nj(e,t,r,n,s,a,o,l,c){if(bj.apply(this,arguments),Ql){if(Ql){var u=Bd;Ql=!1,Bd=null}else throw Error(we(198));Ud||(Ud=!0,hm=u)}}function Ji(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function rb(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function k1(e){if(Ji(e)!==e)throw Error(we(188))}function kj(e){var t=e.alternate;if(!t){if(t=Ji(e),t===null)throw Error(we(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return k1(s),e;if(a===n)return k1(s),t;a=a.sibling}throw Error(we(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(we(189))}}if(r.alternate!==n)throw Error(we(190))}if(r.tag!==3)throw Error(we(188));return r.stateNode.current===r?e:t}function nb(e){return e=kj(e),e!==null?sb(e):null}function sb(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=sb(e);if(t!==null)return t;e=e.sibling}return null}var ab=En.unstable_scheduleCallback,_1=En.unstable_cancelCallback,_j=En.unstable_shouldYield,Sj=En.unstable_requestPaint,Zt=En.unstable_now,Ej=En.unstable_getCurrentPriorityLevel,Wp=En.unstable_ImmediatePriority,ib=En.unstable_UserBlockingPriority,Vd=En.unstable_NormalPriority,Cj=En.unstable_LowPriority,ob=En.unstable_IdlePriority,W0=null,Ds=null;function jj(e){if(Ds&&typeof Ds.onCommitFiberRoot=="function")try{Ds.onCommitFiberRoot(W0,e,void 0,(e.current.flags&128)===128)}catch{}}var hs=Math.clz32?Math.clz32:Fj,Tj=Math.log,Aj=Math.LN2;function Fj(e){return e>>>=0,e===0?32:31-(Tj(e)/Aj|0)|0}var Mu=64,Bu=4194304;function Wl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $d(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=Wl(l):(a&=o,a!==0&&(n=Wl(a)))}else o=r&~s,o!==0?n=Wl(o):a!==0&&(n=Wl(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-hs(t),s=1<<r,n|=e[r],t&=~s;return n}function Pj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dj(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-hs(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=Pj(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function mm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function lb(){var e=Mu;return Mu<<=1,!(Mu&4194240)&&(Mu=64),e}function Gf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function su(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hs(t),e[t]=r}function Ij(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-hs(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function Gp(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-hs(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var pt=0;function cb(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ub,Xp,db,fb,hb,pm=!1,Uu=[],Ra=null,La=null,Oa=null,kc=new Map,_c=new Map,Ea=[],Rj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function S1(e,t){switch(e){case"focusin":case"focusout":Ra=null;break;case"dragenter":case"dragleave":La=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":kc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_c.delete(t.pointerId)}}function Al(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=iu(t),t!==null&&Xp(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Lj(e,t,r,n,s){switch(t){case"focusin":return Ra=Al(Ra,e,t,r,n,s),!0;case"dragenter":return La=Al(La,e,t,r,n,s),!0;case"mouseover":return Oa=Al(Oa,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return kc.set(a,Al(kc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,_c.set(a,Al(_c.get(a)||null,e,t,r,n,s)),!0}return!1}function mb(e){var t=gi(e.target);if(t!==null){var r=Ji(t);if(r!==null){if(t=r.tag,t===13){if(t=rb(r),t!==null){e.blockedOn=t,hb(e.priority,function(){db(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function wd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=xm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);um=n,r.target.dispatchEvent(n),um=null}else return t=iu(r),t!==null&&Xp(t),e.blockedOn=r,!1;t.shift()}return!0}function E1(e,t,r){wd(e)&&r.delete(t)}function Oj(){pm=!1,Ra!==null&&wd(Ra)&&(Ra=null),La!==null&&wd(La)&&(La=null),Oa!==null&&wd(Oa)&&(Oa=null),kc.forEach(E1),_c.forEach(E1)}function Fl(e,t){e.blockedOn===t&&(e.blockedOn=null,pm||(pm=!0,En.unstable_scheduleCallback(En.unstable_NormalPriority,Oj)))}function Sc(e){function t(s){return Fl(s,e)}if(0<Uu.length){Fl(Uu[0],e);for(var r=1;r<Uu.length;r++){var n=Uu[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ra!==null&&Fl(Ra,e),La!==null&&Fl(La,e),Oa!==null&&Fl(Oa,e),kc.forEach(t),_c.forEach(t),r=0;r<Ea.length;r++)n=Ea[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ea.length&&(r=Ea[0],r.blockedOn===null);)mb(r),r.blockedOn===null&&Ea.shift()}var Bo=fa.ReactCurrentBatchConfig,zd=!0;function Mj(e,t,r,n){var s=pt,a=Bo.transition;Bo.transition=null;try{pt=1,Kp(e,t,r,n)}finally{pt=s,Bo.transition=a}}function Bj(e,t,r,n){var s=pt,a=Bo.transition;Bo.transition=null;try{pt=4,Kp(e,t,r,n)}finally{pt=s,Bo.transition=a}}function Kp(e,t,r,n){if(zd){var s=xm(e,t,r,n);if(s===null)rh(e,t,n,Hd,r),S1(e,n);else if(Lj(s,e,t,r,n))n.stopPropagation();else if(S1(e,n),t&4&&-1<Rj.indexOf(e)){for(;s!==null;){var a=iu(s);if(a!==null&&ub(a),a=xm(e,t,r,n),a===null&&rh(e,t,n,Hd,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else rh(e,t,n,null,r)}}var Hd=null;function xm(e,t,r,n){if(Hd=null,e=Hp(n),e=gi(e),e!==null)if(t=Ji(e),t===null)e=null;else if(r=t.tag,r===13){if(e=rb(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Hd=e,null}function pb(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ej()){case Wp:return 1;case ib:return 4;case Vd:case Cj:return 16;case ob:return 536870912;default:return 16}default:return 16}}var Ta=null,Yp=null,bd=null;function xb(){if(bd)return bd;var e,t=Yp,r=t.length,n,s="value"in Ta?Ta.value:Ta.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[a-n];n++);return bd=s.slice(e,1<n?1-n:void 0)}function Nd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Vu(){return!0}function C1(){return!1}function Pn(e){function t(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Vu:C1,this.isPropagationStopped=C1,this}return Bt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Vu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Vu)},persist:function(){},isPersistent:Vu}),t}var ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qp=Pn(ul),au=Bt({},ul,{view:0,detail:0}),Uj=Pn(au),Xf,Kf,Pl,G0=Bt({},au,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pl&&(Pl&&e.type==="mousemove"?(Xf=e.screenX-Pl.screenX,Kf=e.screenY-Pl.screenY):Kf=Xf=0,Pl=e),Xf)},movementY:function(e){return"movementY"in e?e.movementY:Kf}}),j1=Pn(G0),Vj=Bt({},G0,{dataTransfer:0}),$j=Pn(Vj),zj=Bt({},au,{relatedTarget:0}),Yf=Pn(zj),Hj=Bt({},ul,{animationName:0,elapsedTime:0,pseudoElement:0}),Wj=Pn(Hj),Gj=Bt({},ul,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xj=Pn(Gj),Kj=Bt({},ul,{data:0}),T1=Pn(Kj),Yj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Zj[e])?!!t[e]:!1}function Zp(){return Jj}var Qj=Bt({},au,{key:function(e){if(e.key){var t=Yj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zp,charCode:function(e){return e.type==="keypress"?Nd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),e3=Pn(Qj),t3=Bt({},G0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A1=Pn(t3),r3=Bt({},au,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zp}),n3=Pn(r3),s3=Bt({},ul,{propertyName:0,elapsedTime:0,pseudoElement:0}),a3=Pn(s3),i3=Bt({},G0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),o3=Pn(i3),l3=[9,13,27,32],Jp=na&&"CompositionEvent"in window,ec=null;na&&"documentMode"in document&&(ec=document.documentMode);var c3=na&&"TextEvent"in window&&!ec,gb=na&&(!Jp||ec&&8<ec&&11>=ec),F1=String.fromCharCode(32),P1=!1;function vb(e,t){switch(e){case"keyup":return l3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wo=!1;function u3(e,t){switch(e){case"compositionend":return yb(t);case"keypress":return t.which!==32?null:(P1=!0,F1);case"textInput":return e=t.data,e===F1&&P1?null:e;default:return null}}function d3(e,t){if(wo)return e==="compositionend"||!Jp&&vb(e,t)?(e=xb(),bd=Yp=Ta=null,wo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return gb&&t.locale!=="ko"?null:t.data;default:return null}}var f3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function D1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!f3[e.type]:t==="textarea"}function wb(e,t,r,n){Z2(n),t=Wd(t,"onChange"),0<t.length&&(r=new qp("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var tc=null,Ec=null;function h3(e){Fb(e,0)}function X0(e){var t=ko(e);if(H2(t))return e}function m3(e,t){if(e==="change")return t}var bb=!1;if(na){var qf;if(na){var Zf="oninput"in document;if(!Zf){var I1=document.createElement("div");I1.setAttribute("oninput","return;"),Zf=typeof I1.oninput=="function"}qf=Zf}else qf=!1;bb=qf&&(!document.documentMode||9<document.documentMode)}function R1(){tc&&(tc.detachEvent("onpropertychange",Nb),Ec=tc=null)}function Nb(e){if(e.propertyName==="value"&&X0(Ec)){var t=[];wb(t,Ec,e,Hp(e)),tb(h3,t)}}function p3(e,t,r){e==="focusin"?(R1(),tc=t,Ec=r,tc.attachEvent("onpropertychange",Nb)):e==="focusout"&&R1()}function x3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return X0(Ec)}function g3(e,t){if(e==="click")return X0(t)}function v3(e,t){if(e==="input"||e==="change")return X0(t)}function y3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vs=typeof Object.is=="function"?Object.is:y3;function Cc(e,t){if(vs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Jh.call(t,s)||!vs(e[s],t[s]))return!1}return!0}function L1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function O1(e,t){var r=L1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=L1(r)}}function kb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?kb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _b(){for(var e=window,t=Md();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Md(e.document)}return t}function Qp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function w3(e){var t=_b(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&kb(r.ownerDocument.documentElement,r)){if(n!==null&&Qp(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=O1(r,a);var o=O1(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var b3=na&&"documentMode"in document&&11>=document.documentMode,bo=null,gm=null,rc=null,vm=!1;function M1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vm||bo==null||bo!==Md(n)||(n=bo,"selectionStart"in n&&Qp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),rc&&Cc(rc,n)||(rc=n,n=Wd(gm,"onSelect"),0<n.length&&(t=new qp("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=bo)))}function $u(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var No={animationend:$u("Animation","AnimationEnd"),animationiteration:$u("Animation","AnimationIteration"),animationstart:$u("Animation","AnimationStart"),transitionend:$u("Transition","TransitionEnd")},Jf={},Sb={};na&&(Sb=document.createElement("div").style,"AnimationEvent"in window||(delete No.animationend.animation,delete No.animationiteration.animation,delete No.animationstart.animation),"TransitionEvent"in window||delete No.transitionend.transition);function K0(e){if(Jf[e])return Jf[e];if(!No[e])return e;var t=No[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Sb)return Jf[e]=t[r];return e}var Eb=K0("animationend"),Cb=K0("animationiteration"),jb=K0("animationstart"),Tb=K0("transitionend"),Ab=new Map,B1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qa(e,t){Ab.set(e,t),Zi(t,[e])}for(var Qf=0;Qf<B1.length;Qf++){var eh=B1[Qf],N3=eh.toLowerCase(),k3=eh[0].toUpperCase()+eh.slice(1);Qa(N3,"on"+k3)}Qa(Eb,"onAnimationEnd");Qa(Cb,"onAnimationIteration");Qa(jb,"onAnimationStart");Qa("dblclick","onDoubleClick");Qa("focusin","onFocus");Qa("focusout","onBlur");Qa(Tb,"onTransitionEnd");Ko("onMouseEnter",["mouseout","mouseover"]);Ko("onMouseLeave",["mouseout","mouseover"]);Ko("onPointerEnter",["pointerout","pointerover"]);Ko("onPointerLeave",["pointerout","pointerover"]);Zi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gl));function U1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Nj(n,t,void 0,e),e.currentTarget=null}function Fb(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;U1(s,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;U1(s,l,u),a=c}}}if(Ud)throw e=hm,Ud=!1,hm=null,e}function _t(e,t){var r=t[km];r===void 0&&(r=t[km]=new Set);var n=e+"__bubble";r.has(n)||(Pb(t,e,2,!1),r.add(n))}function th(e,t,r){var n=0;t&&(n|=4),Pb(r,e,n,t)}var zu="_reactListening"+Math.random().toString(36).slice(2);function jc(e){if(!e[zu]){e[zu]=!0,B2.forEach(function(r){r!=="selectionchange"&&(_3.has(r)||th(r,!1,e),th(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[zu]||(t[zu]=!0,th("selectionchange",!1,t))}}function Pb(e,t,r,n){switch(pb(t)){case 1:var s=Mj;break;case 4:s=Bj;break;default:s=Kp}r=s.bind(null,t,r,e),s=void 0,!fm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function rh(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=gi(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}tb(function(){var u=a,d=Hp(r),f=[];e:{var h=Ab.get(e);if(h!==void 0){var m=qp,g=e;switch(e){case"keypress":if(Nd(r)===0)break e;case"keydown":case"keyup":m=e3;break;case"focusin":g="focus",m=Yf;break;case"focusout":g="blur",m=Yf;break;case"beforeblur":case"afterblur":m=Yf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=j1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=$j;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=n3;break;case Eb:case Cb:case jb:m=Wj;break;case Tb:m=a3;break;case"scroll":m=Uj;break;case"wheel":m=o3;break;case"copy":case"cut":case"paste":m=Xj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=A1}var p=(t&4)!==0,v=!p&&e==="scroll",b=p?h!==null?h+"Capture":null:h;p=[];for(var y=u,x;y!==null;){x=y;var N=x.stateNode;if(x.tag===5&&N!==null&&(x=N,b!==null&&(N=Nc(y,b),N!=null&&p.push(Tc(y,N,x)))),v)break;y=y.return}0<p.length&&(h=new m(h,g,null,r,d),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==um&&(g=r.relatedTarget||r.fromElement)&&(gi(g)||g[sa]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=u,g=g?gi(g):null,g!==null&&(v=Ji(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(p=j1,N="onMouseLeave",b="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=A1,N="onPointerLeave",b="onPointerEnter",y="pointer"),v=m==null?h:ko(m),x=g==null?h:ko(g),h=new p(N,y+"leave",m,r,d),h.target=v,h.relatedTarget=x,N=null,gi(d)===u&&(p=new p(b,y+"enter",g,r,d),p.target=x,p.relatedTarget=v,N=p),v=N,m&&g)t:{for(p=m,b=g,y=0,x=p;x;x=uo(x))y++;for(x=0,N=b;N;N=uo(N))x++;for(;0<y-x;)p=uo(p),y--;for(;0<x-y;)b=uo(b),x--;for(;y--;){if(p===b||b!==null&&p===b.alternate)break t;p=uo(p),b=uo(b)}p=null}else p=null;m!==null&&V1(f,h,m,p,!1),g!==null&&v!==null&&V1(f,v,g,p,!0)}}e:{if(h=u?ko(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var _=m3;else if(D1(h))if(bb)_=v3;else{_=x3;var k=p3}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=g3);if(_&&(_=_(e,u))){wb(f,_,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&am(h,"number",h.value)}switch(k=u?ko(u):window,e){case"focusin":(D1(k)||k.contentEditable==="true")&&(bo=k,gm=u,rc=null);break;case"focusout":rc=gm=bo=null;break;case"mousedown":vm=!0;break;case"contextmenu":case"mouseup":case"dragend":vm=!1,M1(f,r,d);break;case"selectionchange":if(b3)break;case"keydown":case"keyup":M1(f,r,d)}var w;if(Jp)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else wo?vb(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(gb&&r.locale!=="ko"&&(wo||C!=="onCompositionStart"?C==="onCompositionEnd"&&wo&&(w=xb()):(Ta=d,Yp="value"in Ta?Ta.value:Ta.textContent,wo=!0)),k=Wd(u,C),0<k.length&&(C=new T1(C,e,null,r,d),f.push({event:C,listeners:k}),w?C.data=w:(w=yb(r),w!==null&&(C.data=w)))),(w=c3?u3(e,r):d3(e,r))&&(u=Wd(u,"onBeforeInput"),0<u.length&&(d=new T1("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=w))}Fb(f,t)})}function Tc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Wd(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Nc(e,r),a!=null&&n.unshift(Tc(e,a,s)),a=Nc(e,t),a!=null&&n.push(Tc(e,a,s))),e=e.return}return n}function uo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V1(e,t,r,n,s){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Nc(r,a),c!=null&&o.unshift(Tc(r,c,l))):s||(c=Nc(r,a),c!=null&&o.push(Tc(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var S3=/\r\n?/g,E3=/\u0000|\uFFFD/g;function $1(e){return(typeof e=="string"?e:""+e).replace(S3,`
`).replace(E3,"")}function Hu(e,t,r){if(t=$1(t),$1(e)!==t&&r)throw Error(we(425))}function Gd(){}var ym=null,wm=null;function bm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Nm=typeof setTimeout=="function"?setTimeout:void 0,C3=typeof clearTimeout=="function"?clearTimeout:void 0,z1=typeof Promise=="function"?Promise:void 0,j3=typeof queueMicrotask=="function"?queueMicrotask:typeof z1<"u"?function(e){return z1.resolve(null).then(e).catch(T3)}:Nm;function T3(e){setTimeout(function(){throw e})}function nh(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Sc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Sc(t)}function Ma(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function H1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var dl=Math.random().toString(36).slice(2),Ts="__reactFiber$"+dl,Ac="__reactProps$"+dl,sa="__reactContainer$"+dl,km="__reactEvents$"+dl,A3="__reactListeners$"+dl,F3="__reactHandles$"+dl;function gi(e){var t=e[Ts];if(t)return t;for(var r=e.parentNode;r;){if(t=r[sa]||r[Ts]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=H1(e);e!==null;){if(r=e[Ts])return r;e=H1(e)}return t}e=r,r=e.parentNode}return null}function iu(e){return e=e[Ts]||e[sa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ko(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(we(33))}function Y0(e){return e[Ac]||null}var _m=[],_o=-1;function ei(e){return{current:e}}function Et(e){0>_o||(e.current=_m[_o],_m[_o]=null,_o--)}function wt(e,t){_o++,_m[_o]=e.current,e.current=t}var Ga={},$r=ei(Ga),cn=ei(!1),Di=Ga;function Yo(e,t){var r=e.type.contextTypes;if(!r)return Ga;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function un(e){return e=e.childContextTypes,e!=null}function Xd(){Et(cn),Et($r)}function W1(e,t,r){if($r.current!==Ga)throw Error(we(168));wt($r,t),wt(cn,r)}function Db(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(we(108,pj(e)||"Unknown",s));return Bt({},r,n)}function Kd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ga,Di=$r.current,wt($r,e),wt(cn,cn.current),!0}function G1(e,t,r){var n=e.stateNode;if(!n)throw Error(we(169));r?(e=Db(e,t,Di),n.__reactInternalMemoizedMergedChildContext=e,Et(cn),Et($r),wt($r,e)):Et(cn),wt(cn,r)}var Hs=null,q0=!1,sh=!1;function Ib(e){Hs===null?Hs=[e]:Hs.push(e)}function P3(e){q0=!0,Ib(e)}function ti(){if(!sh&&Hs!==null){sh=!0;var e=0,t=pt;try{var r=Hs;for(pt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Hs=null,q0=!1}catch(s){throw Hs!==null&&(Hs=Hs.slice(e+1)),ab(Wp,ti),s}finally{pt=t,sh=!1}}return null}var So=[],Eo=0,Yd=null,qd=0,zn=[],Hn=0,Ii=null,Ws=1,Gs="";function ui(e,t){So[Eo++]=qd,So[Eo++]=Yd,Yd=e,qd=t}function Rb(e,t,r){zn[Hn++]=Ws,zn[Hn++]=Gs,zn[Hn++]=Ii,Ii=e;var n=Ws;e=Gs;var s=32-hs(n)-1;n&=~(1<<s),r+=1;var a=32-hs(t)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ws=1<<32-hs(t)+s|r<<s|n,Gs=a+e}else Ws=1<<a|r<<s|n,Gs=e}function ex(e){e.return!==null&&(ui(e,1),Rb(e,1,0))}function tx(e){for(;e===Yd;)Yd=So[--Eo],So[Eo]=null,qd=So[--Eo],So[Eo]=null;for(;e===Ii;)Ii=zn[--Hn],zn[Hn]=null,Gs=zn[--Hn],zn[Hn]=null,Ws=zn[--Hn],zn[Hn]=null}var Sn=null,_n=null,Ft=!1,us=null;function Lb(e,t){var r=Kn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function X1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Sn=e,_n=Ma(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Sn=e,_n=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ii!==null?{id:Ws,overflow:Gs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Kn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Sn=e,_n=null,!0):!1;default:return!1}}function Sm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Em(e){if(Ft){var t=_n;if(t){var r=t;if(!X1(e,t)){if(Sm(e))throw Error(we(418));t=Ma(r.nextSibling);var n=Sn;t&&X1(e,t)?Lb(n,r):(e.flags=e.flags&-4097|2,Ft=!1,Sn=e)}}else{if(Sm(e))throw Error(we(418));e.flags=e.flags&-4097|2,Ft=!1,Sn=e}}}function K1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Sn=e}function Wu(e){if(e!==Sn)return!1;if(!Ft)return K1(e),Ft=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!bm(e.type,e.memoizedProps)),t&&(t=_n)){if(Sm(e))throw Ob(),Error(we(418));for(;t;)Lb(e,t),t=Ma(t.nextSibling)}if(K1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(we(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_n=Ma(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_n=null}}else _n=Sn?Ma(e.stateNode.nextSibling):null;return!0}function Ob(){for(var e=_n;e;)e=Ma(e.nextSibling)}function qo(){_n=Sn=null,Ft=!1}function rx(e){us===null?us=[e]:us.push(e)}var D3=fa.ReactCurrentBatchConfig;function Dl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(we(309));var n=r.stateNode}if(!n)throw Error(we(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(we(284));if(!r._owner)throw Error(we(290,e))}return e}function Gu(e,t){throw e=Object.prototype.toString.call(t),Error(we(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Y1(e){var t=e._init;return t(e._payload)}function Mb(e){function t(b,y){if(e){var x=b.deletions;x===null?(b.deletions=[y],b.flags|=16):x.push(y)}}function r(b,y){if(!e)return null;for(;y!==null;)t(b,y),y=y.sibling;return null}function n(b,y){for(b=new Map;y!==null;)y.key!==null?b.set(y.key,y):b.set(y.index,y),y=y.sibling;return b}function s(b,y){return b=$a(b,y),b.index=0,b.sibling=null,b}function a(b,y,x){return b.index=x,e?(x=b.alternate,x!==null?(x=x.index,x<y?(b.flags|=2,y):x):(b.flags|=2,y)):(b.flags|=1048576,y)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,y,x,N){return y===null||y.tag!==6?(y=dh(x,b.mode,N),y.return=b,y):(y=s(y,x),y.return=b,y)}function c(b,y,x,N){var _=x.type;return _===yo?d(b,y,x.props.children,N,x.key):y!==null&&(y.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Na&&Y1(_)===y.type)?(N=s(y,x.props),N.ref=Dl(b,y,x),N.return=b,N):(N=Td(x.type,x.key,x.props,null,b.mode,N),N.ref=Dl(b,y,x),N.return=b,N)}function u(b,y,x,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=fh(x,b.mode,N),y.return=b,y):(y=s(y,x.children||[]),y.return=b,y)}function d(b,y,x,N,_){return y===null||y.tag!==7?(y=Ei(x,b.mode,N,_),y.return=b,y):(y=s(y,x),y.return=b,y)}function f(b,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=dh(""+y,b.mode,x),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ru:return x=Td(y.type,y.key,y.props,null,b.mode,x),x.ref=Dl(b,null,y),x.return=b,x;case vo:return y=fh(y,b.mode,x),y.return=b,y;case Na:var N=y._init;return f(b,N(y._payload),x)}if(Hl(y)||jl(y))return y=Ei(y,b.mode,x,null),y.return=b,y;Gu(b,y)}return null}function h(b,y,x,N){var _=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return _!==null?null:l(b,y,""+x,N);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ru:return x.key===_?c(b,y,x,N):null;case vo:return x.key===_?u(b,y,x,N):null;case Na:return _=x._init,h(b,y,_(x._payload),N)}if(Hl(x)||jl(x))return _!==null?null:d(b,y,x,N,null);Gu(b,x)}return null}function m(b,y,x,N,_){if(typeof N=="string"&&N!==""||typeof N=="number")return b=b.get(x)||null,l(y,b,""+N,_);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ru:return b=b.get(N.key===null?x:N.key)||null,c(y,b,N,_);case vo:return b=b.get(N.key===null?x:N.key)||null,u(y,b,N,_);case Na:var k=N._init;return m(b,y,x,k(N._payload),_)}if(Hl(N)||jl(N))return b=b.get(x)||null,d(y,b,N,_,null);Gu(y,N)}return null}function g(b,y,x,N){for(var _=null,k=null,w=y,C=y=0,D=null;w!==null&&C<x.length;C++){w.index>C?(D=w,w=null):D=w.sibling;var z=h(b,w,x[C],N);if(z===null){w===null&&(w=D);break}e&&w&&z.alternate===null&&t(b,w),y=a(z,y,C),k===null?_=z:k.sibling=z,k=z,w=D}if(C===x.length)return r(b,w),Ft&&ui(b,C),_;if(w===null){for(;C<x.length;C++)w=f(b,x[C],N),w!==null&&(y=a(w,y,C),k===null?_=w:k.sibling=w,k=w);return Ft&&ui(b,C),_}for(w=n(b,w);C<x.length;C++)D=m(w,b,C,x[C],N),D!==null&&(e&&D.alternate!==null&&w.delete(D.key===null?C:D.key),y=a(D,y,C),k===null?_=D:k.sibling=D,k=D);return e&&w.forEach(function(A){return t(b,A)}),Ft&&ui(b,C),_}function p(b,y,x,N){var _=jl(x);if(typeof _!="function")throw Error(we(150));if(x=_.call(x),x==null)throw Error(we(151));for(var k=_=null,w=y,C=y=0,D=null,z=x.next();w!==null&&!z.done;C++,z=x.next()){w.index>C?(D=w,w=null):D=w.sibling;var A=h(b,w,z.value,N);if(A===null){w===null&&(w=D);break}e&&w&&A.alternate===null&&t(b,w),y=a(A,y,C),k===null?_=A:k.sibling=A,k=A,w=D}if(z.done)return r(b,w),Ft&&ui(b,C),_;if(w===null){for(;!z.done;C++,z=x.next())z=f(b,z.value,N),z!==null&&(y=a(z,y,C),k===null?_=z:k.sibling=z,k=z);return Ft&&ui(b,C),_}for(w=n(b,w);!z.done;C++,z=x.next())z=m(w,b,C,z.value,N),z!==null&&(e&&z.alternate!==null&&w.delete(z.key===null?C:z.key),y=a(z,y,C),k===null?_=z:k.sibling=z,k=z);return e&&w.forEach(function(R){return t(b,R)}),Ft&&ui(b,C),_}function v(b,y,x,N){if(typeof x=="object"&&x!==null&&x.type===yo&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ru:e:{for(var _=x.key,k=y;k!==null;){if(k.key===_){if(_=x.type,_===yo){if(k.tag===7){r(b,k.sibling),y=s(k,x.props.children),y.return=b,b=y;break e}}else if(k.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Na&&Y1(_)===k.type){r(b,k.sibling),y=s(k,x.props),y.ref=Dl(b,k,x),y.return=b,b=y;break e}r(b,k);break}else t(b,k);k=k.sibling}x.type===yo?(y=Ei(x.props.children,b.mode,N,x.key),y.return=b,b=y):(N=Td(x.type,x.key,x.props,null,b.mode,N),N.ref=Dl(b,y,x),N.return=b,b=N)}return o(b);case vo:e:{for(k=x.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(b,y.sibling),y=s(y,x.children||[]),y.return=b,b=y;break e}else{r(b,y);break}else t(b,y);y=y.sibling}y=fh(x,b.mode,N),y.return=b,b=y}return o(b);case Na:return k=x._init,v(b,y,k(x._payload),N)}if(Hl(x))return g(b,y,x,N);if(jl(x))return p(b,y,x,N);Gu(b,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(b,y.sibling),y=s(y,x),y.return=b,b=y):(r(b,y),y=dh(x,b.mode,N),y.return=b,b=y),o(b)):r(b,y)}return v}var Zo=Mb(!0),Bb=Mb(!1),Zd=ei(null),Jd=null,Co=null,nx=null;function sx(){nx=Co=Jd=null}function ax(e){var t=Zd.current;Et(Zd),e._currentValue=t}function Cm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Uo(e,t){Jd=e,nx=Co=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ln=!0),e.firstContext=null)}function Zn(e){var t=e._currentValue;if(nx!==e)if(e={context:e,memoizedValue:t,next:null},Co===null){if(Jd===null)throw Error(we(308));Co=e,Jd.dependencies={lanes:0,firstContext:e}}else Co=Co.next=e;return t}var vi=null;function ix(e){vi===null?vi=[e]:vi.push(e)}function Ub(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,ix(t)):(r.next=s.next,s.next=r),t.interleaved=r,aa(e,n)}function aa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ka=!1;function ox(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vb(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ba(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,it&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,aa(e,r)}return s=n.interleaved,s===null?(t.next=t,ix(n)):(t.next=s.next,s.next=t),n.interleaved=t,aa(e,r)}function kd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Gp(e,r)}}function q1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Qd(e,t,r,n){var s=e.updateQueue;ka=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=s.baseState;o=0,d=u=c=null,l=a;do{var h=l.lane,m=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,p=l;switch(h=t,m=r,p.tag){case 1:if(g=p.payload,typeof g=="function"){f=g.call(m,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,h=typeof g=="function"?g.call(m,f,h):g,h==null)break e;f=Bt({},f,h);break e;case 2:ka=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(1);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Li|=o,e.lanes=o,e.memoizedState=f}}function Z1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(we(191,s));s.call(n)}}}var ou={},Is=ei(ou),Fc=ei(ou),Pc=ei(ou);function yi(e){if(e===ou)throw Error(we(174));return e}function lx(e,t){switch(wt(Pc,t),wt(Fc,e),wt(Is,ou),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:om(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=om(t,e)}Et(Is),wt(Is,t)}function Jo(){Et(Is),Et(Fc),Et(Pc)}function $b(e){yi(Pc.current);var t=yi(Is.current),r=om(t,e.type);t!==r&&(wt(Fc,e),wt(Is,r))}function cx(e){Fc.current===e&&(Et(Is),Et(Fc))}var It=ei(0);function e0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ah=[];function ux(){for(var e=0;e<ah.length;e++)ah[e]._workInProgressVersionPrimary=null;ah.length=0}var _d=fa.ReactCurrentDispatcher,ih=fa.ReactCurrentBatchConfig,Ri=0,Mt=null,or=null,hr=null,t0=!1,nc=!1,Dc=0,I3=0;function Tr(){throw Error(we(321))}function dx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!vs(e[r],t[r]))return!1;return!0}function fx(e,t,r,n,s,a){if(Ri=a,Mt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_d.current=e===null||e.memoizedState===null?M3:B3,e=r(n,s),nc){a=0;do{if(nc=!1,Dc=0,25<=a)throw Error(we(301));a+=1,hr=or=null,t.updateQueue=null,_d.current=U3,e=r(n,s)}while(nc)}if(_d.current=r0,t=or!==null&&or.next!==null,Ri=0,hr=or=Mt=null,t0=!1,t)throw Error(we(300));return e}function hx(){var e=Dc!==0;return Dc=0,e}function Es(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hr===null?Mt.memoizedState=hr=e:hr=hr.next=e,hr}function Jn(){if(or===null){var e=Mt.alternate;e=e!==null?e.memoizedState:null}else e=or.next;var t=hr===null?Mt.memoizedState:hr.next;if(t!==null)hr=t,or=e;else{if(e===null)throw Error(we(310));or=e,e={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},hr===null?Mt.memoizedState=hr=e:hr=hr.next=e}return hr}function Ic(e,t){return typeof t=="function"?t(e):t}function oh(e){var t=Jn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=or,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((Ri&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Mt.lanes|=d,Li|=d}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,vs(n,t.memoizedState)||(ln=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Mt.lanes|=a,Li|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function lh(e){var t=Jn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=e(a,o.action),o=o.next;while(o!==s);vs(a,t.memoizedState)||(ln=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function zb(){}function Hb(e,t){var r=Mt,n=Jn(),s=t(),a=!vs(n.memoizedState,s);if(a&&(n.memoizedState=s,ln=!0),n=n.queue,mx(Xb.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||hr!==null&&hr.memoizedState.tag&1){if(r.flags|=2048,Rc(9,Gb.bind(null,r,n,s,t),void 0,null),yr===null)throw Error(we(349));Ri&30||Wb(r,t,s)}return s}function Wb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Gb(e,t,r,n){t.value=r,t.getSnapshot=n,Kb(t)&&Yb(e)}function Xb(e,t,r){return r(function(){Kb(t)&&Yb(e)})}function Kb(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vs(e,r)}catch{return!0}}function Yb(e){var t=aa(e,1);t!==null&&ms(t,e,1,-1)}function J1(e){var t=Es();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ic,lastRenderedState:e},t.queue=e,e=e.dispatch=O3.bind(null,Mt,e),[t.memoizedState,e]}function Rc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function qb(){return Jn().memoizedState}function Sd(e,t,r,n){var s=Es();Mt.flags|=e,s.memoizedState=Rc(1|t,r,void 0,n===void 0?null:n)}function Z0(e,t,r,n){var s=Jn();n=n===void 0?null:n;var a=void 0;if(or!==null){var o=or.memoizedState;if(a=o.destroy,n!==null&&dx(n,o.deps)){s.memoizedState=Rc(t,r,a,n);return}}Mt.flags|=e,s.memoizedState=Rc(1|t,r,a,n)}function Q1(e,t){return Sd(8390656,8,e,t)}function mx(e,t){return Z0(2048,8,e,t)}function Zb(e,t){return Z0(4,2,e,t)}function Jb(e,t){return Z0(4,4,e,t)}function Qb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function eN(e,t,r){return r=r!=null?r.concat([e]):null,Z0(4,4,Qb.bind(null,t,e),r)}function px(){}function tN(e,t){var r=Jn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&dx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function rN(e,t){var r=Jn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&dx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function nN(e,t,r){return Ri&21?(vs(r,t)||(r=lb(),Mt.lanes|=r,Li|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ln=!0),e.memoizedState=r)}function R3(e,t){var r=pt;pt=r!==0&&4>r?r:4,e(!0);var n=ih.transition;ih.transition={};try{e(!1),t()}finally{pt=r,ih.transition=n}}function sN(){return Jn().memoizedState}function L3(e,t,r){var n=Va(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},aN(e))iN(t,r);else if(r=Ub(e,t,r,n),r!==null){var s=Jr();ms(r,e,n,s),oN(r,t,n)}}function O3(e,t,r){var n=Va(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(aN(e))iN(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,vs(l,o)){var c=t.interleaved;c===null?(s.next=s,ix(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=Ub(e,t,s,n),r!==null&&(s=Jr(),ms(r,e,n,s),oN(r,t,n))}}function aN(e){var t=e.alternate;return e===Mt||t!==null&&t===Mt}function iN(e,t){nc=t0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function oN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Gp(e,r)}}var r0={readContext:Zn,useCallback:Tr,useContext:Tr,useEffect:Tr,useImperativeHandle:Tr,useInsertionEffect:Tr,useLayoutEffect:Tr,useMemo:Tr,useReducer:Tr,useRef:Tr,useState:Tr,useDebugValue:Tr,useDeferredValue:Tr,useTransition:Tr,useMutableSource:Tr,useSyncExternalStore:Tr,useId:Tr,unstable_isNewReconciler:!1},M3={readContext:Zn,useCallback:function(e,t){return Es().memoizedState=[e,t===void 0?null:t],e},useContext:Zn,useEffect:Q1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Sd(4194308,4,Qb.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Sd(4194308,4,e,t)},useInsertionEffect:function(e,t){return Sd(4,2,e,t)},useMemo:function(e,t){var r=Es();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Es();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=L3.bind(null,Mt,e),[n.memoizedState,e]},useRef:function(e){var t=Es();return e={current:e},t.memoizedState=e},useState:J1,useDebugValue:px,useDeferredValue:function(e){return Es().memoizedState=e},useTransition:function(){var e=J1(!1),t=e[0];return e=R3.bind(null,e[1]),Es().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Mt,s=Es();if(Ft){if(r===void 0)throw Error(we(407));r=r()}else{if(r=t(),yr===null)throw Error(we(349));Ri&30||Wb(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,Q1(Xb.bind(null,n,a,e),[e]),n.flags|=2048,Rc(9,Gb.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Es(),t=yr.identifierPrefix;if(Ft){var r=Gs,n=Ws;r=(n&~(1<<32-hs(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Dc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=I3++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},B3={readContext:Zn,useCallback:tN,useContext:Zn,useEffect:mx,useImperativeHandle:eN,useInsertionEffect:Zb,useLayoutEffect:Jb,useMemo:rN,useReducer:oh,useRef:qb,useState:function(){return oh(Ic)},useDebugValue:px,useDeferredValue:function(e){var t=Jn();return nN(t,or.memoizedState,e)},useTransition:function(){var e=oh(Ic)[0],t=Jn().memoizedState;return[e,t]},useMutableSource:zb,useSyncExternalStore:Hb,useId:sN,unstable_isNewReconciler:!1},U3={readContext:Zn,useCallback:tN,useContext:Zn,useEffect:mx,useImperativeHandle:eN,useInsertionEffect:Zb,useLayoutEffect:Jb,useMemo:rN,useReducer:lh,useRef:qb,useState:function(){return lh(Ic)},useDebugValue:px,useDeferredValue:function(e){var t=Jn();return or===null?t.memoizedState=e:nN(t,or.memoizedState,e)},useTransition:function(){var e=lh(Ic)[0],t=Jn().memoizedState;return[e,t]},useMutableSource:zb,useSyncExternalStore:Hb,useId:sN,unstable_isNewReconciler:!1};function ls(e,t){if(e&&e.defaultProps){t=Bt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function jm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Bt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var J0={isMounted:function(e){return(e=e._reactInternals)?Ji(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Va(e),a=qs(n,s);a.payload=t,r!=null&&(a.callback=r),t=Ba(e,a,s),t!==null&&(ms(t,e,s,n),kd(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Va(e),a=qs(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ba(e,a,s),t!==null&&(ms(t,e,s,n),kd(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jr(),n=Va(e),s=qs(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ba(e,s,n),t!==null&&(ms(t,e,n,r),kd(t,e,n))}};function ev(e,t,r,n,s,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!Cc(r,n)||!Cc(s,a):!0}function lN(e,t,r){var n=!1,s=Ga,a=t.contextType;return typeof a=="object"&&a!==null?a=Zn(a):(s=un(t)?Di:$r.current,n=t.contextTypes,a=(n=n!=null)?Yo(e,s):Ga),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=J0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function tv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&J0.enqueueReplaceState(t,t.state,null)}function Tm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},ox(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Zn(a):(a=un(t)?Di:$r.current,s.context=Yo(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(jm(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&J0.enqueueReplaceState(s,s.state,null),Qd(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Qo(e,t){try{var r="",n=t;do r+=mj(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function ch(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Am(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var V3=typeof WeakMap=="function"?WeakMap:Map;function cN(e,t,r){r=qs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){s0||(s0=!0,Um=n),Am(e,t)},r}function uN(e,t,r){r=qs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Am(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Am(e,t),typeof n!="function"&&(Ua===null?Ua=new Set([this]):Ua.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function rv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new V3;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=tT.bind(null,e,t,r),t.then(e,e))}function nv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function sv(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qs(-1,1),t.tag=2,Ba(r,t,1))),r.lanes|=1),e)}var $3=fa.ReactCurrentOwner,ln=!1;function Yr(e,t,r,n){t.child=e===null?Bb(t,null,r,n):Zo(t,e.child,r,n)}function av(e,t,r,n,s){r=r.render;var a=t.ref;return Uo(t,s),n=fx(e,t,r,n,a,s),r=hx(),e!==null&&!ln?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ia(e,t,s)):(Ft&&r&&ex(t),t.flags|=1,Yr(e,t,n,s),t.child)}function iv(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!kx(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,dN(e,t,a,n,s)):(e=Td(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:Cc,r(o,n)&&e.ref===t.ref)return ia(e,t,s)}return t.flags|=1,e=$a(a,n),e.ref=t.ref,e.return=t,t.child=e}function dN(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Cc(a,n)&&e.ref===t.ref)if(ln=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(ln=!0);else return t.lanes=e.lanes,ia(e,t,s)}return Fm(e,t,r,n,s)}function fN(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(To,vn),vn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wt(To,vn),vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,wt(To,vn),vn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,wt(To,vn),vn|=n;return Yr(e,t,s,r),t.child}function hN(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Fm(e,t,r,n,s){var a=un(r)?Di:$r.current;return a=Yo(t,a),Uo(t,s),r=fx(e,t,r,n,a,s),n=hx(),e!==null&&!ln?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ia(e,t,s)):(Ft&&n&&ex(t),t.flags|=1,Yr(e,t,r,s),t.child)}function ov(e,t,r,n,s){if(un(r)){var a=!0;Kd(t)}else a=!1;if(Uo(t,s),t.stateNode===null)Ed(e,t),lN(t,r,n),Tm(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zn(u):(u=un(r)?Di:$r.current,u=Yo(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&tv(t,o,n,u),ka=!1;var h=t.memoizedState;o.state=h,Qd(t,n,o,s),c=t.memoizedState,l!==n||h!==c||cn.current||ka?(typeof d=="function"&&(jm(t,r,d,n),c=t.memoizedState),(l=ka||ev(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Vb(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:ls(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Zn(c):(c=un(r)?Di:$r.current,c=Yo(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&tv(t,o,n,c),ka=!1,h=t.memoizedState,o.state=h,Qd(t,n,o,s);var g=t.memoizedState;l!==f||h!==g||cn.current||ka?(typeof m=="function"&&(jm(t,r,m,n),g=t.memoizedState),(u=ka||ev(t,r,u,n,h,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Pm(e,t,r,n,a,s)}function Pm(e,t,r,n,s,a){hN(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&G1(t,r,!1),ia(e,t,a);n=t.stateNode,$3.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Zo(t,e.child,null,a),t.child=Zo(t,null,l,a)):Yr(e,t,l,a),t.memoizedState=n.state,s&&G1(t,r,!0),t.child}function mN(e){var t=e.stateNode;t.pendingContext?W1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&W1(e,t.context,!1),lx(e,t.containerInfo)}function lv(e,t,r,n,s){return qo(),rx(s),t.flags|=256,Yr(e,t,r,n),t.child}var Dm={dehydrated:null,treeContext:null,retryLane:0};function Im(e){return{baseLanes:e,cachePool:null,transitions:null}}function pN(e,t,r){var n=t.pendingProps,s=It.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),wt(It,s&1),e===null)return Em(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=tf(o,n,0,null),e=Ei(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Im(r),t.memoizedState=Dm,e):xx(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return z3(e,t,o,n,l,s,r);if(a){a=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=$a(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=$a(l,a):(a=Ei(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?Im(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=Dm,n}return a=e.child,e=a.sibling,n=$a(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function xx(e,t){return t=tf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Xu(e,t,r,n){return n!==null&&rx(n),Zo(t,e.child,null,r),e=xx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function z3(e,t,r,n,s,a,o){if(r)return t.flags&256?(t.flags&=-257,n=ch(Error(we(422))),Xu(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=tf({mode:"visible",children:n.children},s,0,null),a=Ei(a,s,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Zo(t,e.child,null,o),t.child.memoizedState=Im(o),t.memoizedState=Dm,a);if(!(t.mode&1))return Xu(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(we(419)),n=ch(a,n,void 0),Xu(e,t,o,n)}if(l=(o&e.childLanes)!==0,ln||l){if(n=yr,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,aa(e,s),ms(n,e,s,-1))}return Nx(),n=ch(Error(we(421))),Xu(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=rT.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,_n=Ma(s.nextSibling),Sn=t,Ft=!0,us=null,e!==null&&(zn[Hn++]=Ws,zn[Hn++]=Gs,zn[Hn++]=Ii,Ws=e.id,Gs=e.overflow,Ii=t),t=xx(t,n.children),t.flags|=4096,t)}function cv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Cm(e.return,t,r)}function uh(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function xN(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Yr(e,t,n.children,r),n=It.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cv(e,r,t);else if(e.tag===19)cv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(wt(It,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&e0(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),uh(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&e0(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}uh(t,!0,r,null,a);break;case"together":uh(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ed(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ia(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Li|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(we(153));if(t.child!==null){for(e=t.child,r=$a(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=$a(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function H3(e,t,r){switch(t.tag){case 3:mN(t),qo();break;case 5:$b(t);break;case 1:un(t.type)&&Kd(t);break;case 4:lx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;wt(Zd,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(wt(It,It.current&1),t.flags|=128,null):r&t.child.childLanes?pN(e,t,r):(wt(It,It.current&1),e=ia(e,t,r),e!==null?e.sibling:null);wt(It,It.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return xN(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),wt(It,It.current),n)break;return null;case 22:case 23:return t.lanes=0,fN(e,t,r)}return ia(e,t,r)}var gN,Rm,vN,yN;gN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Rm=function(){};vN=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,yi(Is.current);var a=null;switch(r){case"input":s=nm(e,s),n=nm(e,n),a=[];break;case"select":s=Bt({},s,{value:void 0}),n=Bt({},n,{value:void 0}),a=[];break;case"textarea":s=im(e,s),n=im(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Gd)}lm(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wc.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&_t("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};yN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Il(e,t){if(!Ft)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ar(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function W3(e,t,r){var n=t.pendingProps;switch(tx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ar(t),null;case 1:return un(t.type)&&Xd(),Ar(t),null;case 3:return n=t.stateNode,Jo(),Et(cn),Et($r),ux(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Wu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,us!==null&&(zm(us),us=null))),Rm(e,t),Ar(t),null;case 5:cx(t);var s=yi(Pc.current);if(r=t.type,e!==null&&t.stateNode!=null)vN(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(we(166));return Ar(t),null}if(e=yi(Is.current),Wu(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Ts]=t,n[Ac]=a,e=(t.mode&1)!==0,r){case"dialog":_t("cancel",n),_t("close",n);break;case"iframe":case"object":case"embed":_t("load",n);break;case"video":case"audio":for(s=0;s<Gl.length;s++)_t(Gl[s],n);break;case"source":_t("error",n);break;case"img":case"image":case"link":_t("error",n),_t("load",n);break;case"details":_t("toggle",n);break;case"input":v1(n,a),_t("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},_t("invalid",n);break;case"textarea":w1(n,a),_t("invalid",n)}lm(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Hu(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Hu(n.textContent,l,e),s=["children",""+l]):wc.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&_t("scroll",n)}switch(r){case"input":Lu(n),y1(n,a,!0);break;case"textarea":Lu(n),b1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Gd)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=X2(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Ts]=t,e[Ac]=n,gN(e,t,!1,!1),t.stateNode=e;e:{switch(o=cm(r,n),r){case"dialog":_t("cancel",e),_t("close",e),s=n;break;case"iframe":case"object":case"embed":_t("load",e),s=n;break;case"video":case"audio":for(s=0;s<Gl.length;s++)_t(Gl[s],e);s=n;break;case"source":_t("error",e),s=n;break;case"img":case"image":case"link":_t("error",e),_t("load",e),s=n;break;case"details":_t("toggle",e),s=n;break;case"input":v1(e,n),s=nm(e,n),_t("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Bt({},n,{value:void 0}),_t("invalid",e);break;case"textarea":w1(e,n),s=im(e,n),_t("invalid",e);break;default:s=n}lm(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?q2(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&K2(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&bc(e,c):typeof c=="number"&&bc(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(wc.hasOwnProperty(a)?c!=null&&a==="onScroll"&&_t("scroll",e):c!=null&&Up(e,a,c,o))}switch(r){case"input":Lu(e),y1(e,n,!1);break;case"textarea":Lu(e),b1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Wa(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Lo(e,!!n.multiple,a,!1):n.defaultValue!=null&&Lo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Gd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ar(t),null;case 6:if(e&&t.stateNode!=null)yN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(we(166));if(r=yi(Pc.current),yi(Is.current),Wu(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ts]=t,(a=n.nodeValue!==r)&&(e=Sn,e!==null))switch(e.tag){case 3:Hu(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Hu(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ts]=t,t.stateNode=n}return Ar(t),null;case 13:if(Et(It),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ft&&_n!==null&&t.mode&1&&!(t.flags&128))Ob(),qo(),t.flags|=98560,a=!1;else if(a=Wu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(we(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(we(317));a[Ts]=t}else qo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ar(t),a=!1}else us!==null&&(zm(us),us=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||It.current&1?cr===0&&(cr=3):Nx())),t.updateQueue!==null&&(t.flags|=4),Ar(t),null);case 4:return Jo(),Rm(e,t),e===null&&jc(t.stateNode.containerInfo),Ar(t),null;case 10:return ax(t.type._context),Ar(t),null;case 17:return un(t.type)&&Xd(),Ar(t),null;case 19:if(Et(It),a=t.memoizedState,a===null)return Ar(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Il(a,!1);else{if(cr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=e0(e),o!==null){for(t.flags|=128,Il(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return wt(It,It.current&1|2),t.child}e=e.sibling}a.tail!==null&&Zt()>el&&(t.flags|=128,n=!0,Il(a,!1),t.lanes=4194304)}else{if(!n)if(e=e0(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Il(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Ft)return Ar(t),null}else 2*Zt()-a.renderingStartTime>el&&r!==1073741824&&(t.flags|=128,n=!0,Il(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Zt(),t.sibling=null,r=It.current,wt(It,n?r&1|2:r&1),t):(Ar(t),null);case 22:case 23:return bx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?vn&1073741824&&(Ar(t),t.subtreeFlags&6&&(t.flags|=8192)):Ar(t),null;case 24:return null;case 25:return null}throw Error(we(156,t.tag))}function G3(e,t){switch(tx(t),t.tag){case 1:return un(t.type)&&Xd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Jo(),Et(cn),Et($r),ux(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return cx(t),null;case 13:if(Et(It),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(we(340));qo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Et(It),null;case 4:return Jo(),null;case 10:return ax(t.type._context),null;case 22:case 23:return bx(),null;case 24:return null;default:return null}}var Ku=!1,Lr=!1,X3=typeof WeakSet=="function"?WeakSet:Set,De=null;function jo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){zt(e,t,n)}else r.current=null}function Lm(e,t,r){try{r()}catch(n){zt(e,t,n)}}var uv=!1;function K3(e,t){if(ym=zd,e=_b(),Qp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==a||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===s&&(l=o),h===a&&++d===n&&(c=o),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(wm={focusedElem:e,selectionRange:r},zd=!1,De=t;De!==null;)if(t=De,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,De=e;else for(;De!==null;){t=De;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,v=g.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?p:ls(t.type,p),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(N){zt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,De=e;break}De=t.return}return g=uv,uv=!1,g}function sc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Lm(t,r,a)}s=s.next}while(s!==n)}}function Q0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Om(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function wN(e){var t=e.alternate;t!==null&&(e.alternate=null,wN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ts],delete t[Ac],delete t[km],delete t[A3],delete t[F3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function bN(e){return e.tag===5||e.tag===3||e.tag===4}function dv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||bN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Mm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Gd));else if(n!==4&&(e=e.child,e!==null))for(Mm(e,t,r),e=e.sibling;e!==null;)Mm(e,t,r),e=e.sibling}function Bm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Bm(e,t,r),e=e.sibling;e!==null;)Bm(e,t,r),e=e.sibling}var Nr=null,cs=!1;function ga(e,t,r){for(r=r.child;r!==null;)NN(e,t,r),r=r.sibling}function NN(e,t,r){if(Ds&&typeof Ds.onCommitFiberUnmount=="function")try{Ds.onCommitFiberUnmount(W0,r)}catch{}switch(r.tag){case 5:Lr||jo(r,t);case 6:var n=Nr,s=cs;Nr=null,ga(e,t,r),Nr=n,cs=s,Nr!==null&&(cs?(e=Nr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Nr.removeChild(r.stateNode));break;case 18:Nr!==null&&(cs?(e=Nr,r=r.stateNode,e.nodeType===8?nh(e.parentNode,r):e.nodeType===1&&nh(e,r),Sc(e)):nh(Nr,r.stateNode));break;case 4:n=Nr,s=cs,Nr=r.stateNode.containerInfo,cs=!0,ga(e,t,r),Nr=n,cs=s;break;case 0:case 11:case 14:case 15:if(!Lr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Lm(r,t,o),s=s.next}while(s!==n)}ga(e,t,r);break;case 1:if(!Lr&&(jo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){zt(r,t,l)}ga(e,t,r);break;case 21:ga(e,t,r);break;case 22:r.mode&1?(Lr=(n=Lr)||r.memoizedState!==null,ga(e,t,r),Lr=n):ga(e,t,r);break;default:ga(e,t,r)}}function fv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new X3),t.forEach(function(n){var s=nT.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function as(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Nr=l.stateNode,cs=!1;break e;case 3:Nr=l.stateNode.containerInfo,cs=!0;break e;case 4:Nr=l.stateNode.containerInfo,cs=!0;break e}l=l.return}if(Nr===null)throw Error(we(160));NN(a,o,s),Nr=null,cs=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){zt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kN(t,e),t=t.sibling}function kN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(as(t,e),bs(e),n&4){try{sc(3,e,e.return),Q0(3,e)}catch(p){zt(e,e.return,p)}try{sc(5,e,e.return)}catch(p){zt(e,e.return,p)}}break;case 1:as(t,e),bs(e),n&512&&r!==null&&jo(r,r.return);break;case 5:if(as(t,e),bs(e),n&512&&r!==null&&jo(r,r.return),e.flags&32){var s=e.stateNode;try{bc(s,"")}catch(p){zt(e,e.return,p)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&W2(s,a),cm(l,o);var u=cm(l,a);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?q2(s,f):d==="dangerouslySetInnerHTML"?K2(s,f):d==="children"?bc(s,f):Up(s,d,f,u)}switch(l){case"input":sm(s,a);break;case"textarea":G2(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Lo(s,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?Lo(s,!!a.multiple,a.defaultValue,!0):Lo(s,!!a.multiple,a.multiple?[]:"",!1))}s[Ac]=a}catch(p){zt(e,e.return,p)}}break;case 6:if(as(t,e),bs(e),n&4){if(e.stateNode===null)throw Error(we(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(p){zt(e,e.return,p)}}break;case 3:if(as(t,e),bs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Sc(t.containerInfo)}catch(p){zt(e,e.return,p)}break;case 4:as(t,e),bs(e);break;case 13:as(t,e),bs(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(yx=Zt())),n&4&&fv(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Lr=(u=Lr)||d,as(t,e),Lr=u):as(t,e),bs(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(De=e,d=e.child;d!==null;){for(f=De=d;De!==null;){switch(h=De,m=h.child,h.tag){case 0:case 11:case 14:case 15:sc(4,h,h.return);break;case 1:jo(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(p){zt(n,r,p)}}break;case 5:jo(h,h.return);break;case 22:if(h.memoizedState!==null){mv(f);continue}}m!==null?(m.return=h,De=m):mv(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Y2("display",o))}catch(p){zt(e,e.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){zt(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:as(t,e),bs(e),n&4&&fv(e);break;case 21:break;default:as(t,e),bs(e)}}function bs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(bN(r)){var n=r;break e}r=r.return}throw Error(we(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(bc(s,""),n.flags&=-33);var a=dv(e);Bm(e,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=dv(e);Mm(e,l,o);break;default:throw Error(we(161))}}catch(c){zt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Y3(e,t,r){De=e,_N(e)}function _N(e,t,r){for(var n=(e.mode&1)!==0;De!==null;){var s=De,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Ku;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Lr;l=Ku;var u=Lr;if(Ku=o,(Lr=c)&&!u)for(De=s;De!==null;)o=De,c=o.child,o.tag===22&&o.memoizedState!==null?pv(s):c!==null?(c.return=o,De=c):pv(s);for(;a!==null;)De=a,_N(a),a=a.sibling;De=s,Ku=l,Lr=u}hv(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,De=a):hv(e)}}function hv(e){for(;De!==null;){var t=De;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lr||Q0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Lr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ls(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Z1(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Z1(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Sc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}Lr||t.flags&512&&Om(t)}catch(h){zt(t,t.return,h)}}if(t===e){De=null;break}if(r=t.sibling,r!==null){r.return=t.return,De=r;break}De=t.return}}function mv(e){for(;De!==null;){var t=De;if(t===e){De=null;break}var r=t.sibling;if(r!==null){r.return=t.return,De=r;break}De=t.return}}function pv(e){for(;De!==null;){var t=De;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Q0(4,t)}catch(c){zt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){zt(t,s,c)}}var a=t.return;try{Om(t)}catch(c){zt(t,a,c)}break;case 5:var o=t.return;try{Om(t)}catch(c){zt(t,o,c)}}}catch(c){zt(t,t.return,c)}if(t===e){De=null;break}var l=t.sibling;if(l!==null){l.return=t.return,De=l;break}De=t.return}}var q3=Math.ceil,n0=fa.ReactCurrentDispatcher,gx=fa.ReactCurrentOwner,Yn=fa.ReactCurrentBatchConfig,it=0,yr=null,ar=null,Sr=0,vn=0,To=ei(0),cr=0,Lc=null,Li=0,ef=0,vx=0,ac=null,on=null,yx=0,el=1/0,zs=null,s0=!1,Um=null,Ua=null,Yu=!1,Aa=null,a0=0,ic=0,Vm=null,Cd=-1,jd=0;function Jr(){return it&6?Zt():Cd!==-1?Cd:Cd=Zt()}function Va(e){return e.mode&1?it&2&&Sr!==0?Sr&-Sr:D3.transition!==null?(jd===0&&(jd=lb()),jd):(e=pt,e!==0||(e=window.event,e=e===void 0?16:pb(e.type)),e):1}function ms(e,t,r,n){if(50<ic)throw ic=0,Vm=null,Error(we(185));su(e,r,n),(!(it&2)||e!==yr)&&(e===yr&&(!(it&2)&&(ef|=r),cr===4&&Ca(e,Sr)),dn(e,n),r===1&&it===0&&!(t.mode&1)&&(el=Zt()+500,q0&&ti()))}function dn(e,t){var r=e.callbackNode;Dj(e,t);var n=$d(e,e===yr?Sr:0);if(n===0)r!==null&&_1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&_1(r),t===1)e.tag===0?P3(xv.bind(null,e)):Ib(xv.bind(null,e)),j3(function(){!(it&6)&&ti()}),r=null;else{switch(cb(n)){case 1:r=Wp;break;case 4:r=ib;break;case 16:r=Vd;break;case 536870912:r=ob;break;default:r=Vd}r=PN(r,SN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function SN(e,t){if(Cd=-1,jd=0,it&6)throw Error(we(327));var r=e.callbackNode;if(Vo()&&e.callbackNode!==r)return null;var n=$d(e,e===yr?Sr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=i0(e,n);else{t=n;var s=it;it|=2;var a=CN();(yr!==e||Sr!==t)&&(zs=null,el=Zt()+500,Si(e,t));do try{Q3();break}catch(l){EN(e,l)}while(1);sx(),n0.current=a,it=s,ar!==null?t=0:(yr=null,Sr=0,t=cr)}if(t!==0){if(t===2&&(s=mm(e),s!==0&&(n=s,t=$m(e,s))),t===1)throw r=Lc,Si(e,0),Ca(e,n),dn(e,Zt()),r;if(t===6)Ca(e,n);else{if(s=e.current.alternate,!(n&30)&&!Z3(s)&&(t=i0(e,n),t===2&&(a=mm(e),a!==0&&(n=a,t=$m(e,a))),t===1))throw r=Lc,Si(e,0),Ca(e,n),dn(e,Zt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(we(345));case 2:di(e,on,zs);break;case 3:if(Ca(e,n),(n&130023424)===n&&(t=yx+500-Zt(),10<t)){if($d(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Jr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Nm(di.bind(null,e,on,zs),t);break}di(e,on,zs);break;case 4:if(Ca(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-hs(n);a=1<<o,o=t[o],o>s&&(s=o),n&=~a}if(n=s,n=Zt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*q3(n/1960))-n,10<n){e.timeoutHandle=Nm(di.bind(null,e,on,zs),n);break}di(e,on,zs);break;case 5:di(e,on,zs);break;default:throw Error(we(329))}}}return dn(e,Zt()),e.callbackNode===r?SN.bind(null,e):null}function $m(e,t){var r=ac;return e.current.memoizedState.isDehydrated&&(Si(e,t).flags|=256),e=i0(e,t),e!==2&&(t=on,on=r,t!==null&&zm(t)),e}function zm(e){on===null?on=e:on.push.apply(on,e)}function Z3(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!vs(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ca(e,t){for(t&=~vx,t&=~ef,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-hs(t),n=1<<r;e[r]=-1,t&=~n}}function xv(e){if(it&6)throw Error(we(327));Vo();var t=$d(e,0);if(!(t&1))return dn(e,Zt()),null;var r=i0(e,t);if(e.tag!==0&&r===2){var n=mm(e);n!==0&&(t=n,r=$m(e,n))}if(r===1)throw r=Lc,Si(e,0),Ca(e,t),dn(e,Zt()),r;if(r===6)throw Error(we(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,di(e,on,zs),dn(e,Zt()),null}function wx(e,t){var r=it;it|=1;try{return e(t)}finally{it=r,it===0&&(el=Zt()+500,q0&&ti())}}function Oi(e){Aa!==null&&Aa.tag===0&&!(it&6)&&Vo();var t=it;it|=1;var r=Yn.transition,n=pt;try{if(Yn.transition=null,pt=1,e)return e()}finally{pt=n,Yn.transition=r,it=t,!(it&6)&&ti()}}function bx(){vn=To.current,Et(To)}function Si(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,C3(r)),ar!==null)for(r=ar.return;r!==null;){var n=r;switch(tx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Xd();break;case 3:Jo(),Et(cn),Et($r),ux();break;case 5:cx(n);break;case 4:Jo();break;case 13:Et(It);break;case 19:Et(It);break;case 10:ax(n.type._context);break;case 22:case 23:bx()}r=r.return}if(yr=e,ar=e=$a(e.current,null),Sr=vn=t,cr=0,Lc=null,vx=ef=Li=0,on=ac=null,vi!==null){for(t=0;t<vi.length;t++)if(r=vi[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}vi=null}return e}function EN(e,t){do{var r=ar;try{if(sx(),_d.current=r0,t0){for(var n=Mt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}t0=!1}if(Ri=0,hr=or=Mt=null,nc=!1,Dc=0,gx.current=null,r===null||r.return===null){cr=1,Lc=t,ar=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=Sr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=nv(o);if(m!==null){m.flags&=-257,sv(m,o,l,a,t),m.mode&1&&rv(a,u,t),t=m,c=u;var g=t.updateQueue;if(g===null){var p=new Set;p.add(c),t.updateQueue=p}else g.add(c);break e}else{if(!(t&1)){rv(a,u,t),Nx();break e}c=Error(we(426))}}else if(Ft&&l.mode&1){var v=nv(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),sv(v,o,l,a,t),rx(Qo(c,l));break e}}a=c=Qo(c,l),cr!==4&&(cr=2),ac===null?ac=[a]:ac.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var b=cN(a,c,t);q1(a,b);break e;case 1:l=c;var y=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ua===null||!Ua.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=uN(a,l,t);q1(a,N);break e}}a=a.return}while(a!==null)}TN(r)}catch(_){t=_,ar===r&&r!==null&&(ar=r=r.return);continue}break}while(1)}function CN(){var e=n0.current;return n0.current=r0,e===null?r0:e}function Nx(){(cr===0||cr===3||cr===2)&&(cr=4),yr===null||!(Li&268435455)&&!(ef&268435455)||Ca(yr,Sr)}function i0(e,t){var r=it;it|=2;var n=CN();(yr!==e||Sr!==t)&&(zs=null,Si(e,t));do try{J3();break}catch(s){EN(e,s)}while(1);if(sx(),it=r,n0.current=n,ar!==null)throw Error(we(261));return yr=null,Sr=0,cr}function J3(){for(;ar!==null;)jN(ar)}function Q3(){for(;ar!==null&&!_j();)jN(ar)}function jN(e){var t=FN(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?TN(e):ar=t,gx.current=null}function TN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=G3(r,t),r!==null){r.flags&=32767,ar=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cr=6,ar=null;return}}else if(r=W3(r,t,vn),r!==null){ar=r;return}if(t=t.sibling,t!==null){ar=t;return}ar=t=e}while(t!==null);cr===0&&(cr=5)}function di(e,t,r){var n=pt,s=Yn.transition;try{Yn.transition=null,pt=1,eT(e,t,r,n)}finally{Yn.transition=s,pt=n}return null}function eT(e,t,r,n){do Vo();while(Aa!==null);if(it&6)throw Error(we(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(we(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Ij(e,a),e===yr&&(ar=yr=null,Sr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Yu||(Yu=!0,PN(Vd,function(){return Vo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Yn.transition,Yn.transition=null;var o=pt;pt=1;var l=it;it|=4,gx.current=null,K3(e,r),kN(r,e),w3(wm),zd=!!ym,wm=ym=null,e.current=r,Y3(r),Sj(),it=l,pt=o,Yn.transition=a}else e.current=r;if(Yu&&(Yu=!1,Aa=e,a0=s),a=e.pendingLanes,a===0&&(Ua=null),jj(r.stateNode),dn(e,Zt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(s0)throw s0=!1,e=Um,Um=null,e;return a0&1&&e.tag!==0&&Vo(),a=e.pendingLanes,a&1?e===Vm?ic++:(ic=0,Vm=e):ic=0,ti(),null}function Vo(){if(Aa!==null){var e=cb(a0),t=Yn.transition,r=pt;try{if(Yn.transition=null,pt=16>e?16:e,Aa===null)var n=!1;else{if(e=Aa,Aa=null,a0=0,it&6)throw Error(we(331));var s=it;for(it|=4,De=e.current;De!==null;){var a=De,o=a.child;if(De.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(De=u;De!==null;){var d=De;switch(d.tag){case 0:case 11:case 15:sc(8,d,a)}var f=d.child;if(f!==null)f.return=d,De=f;else for(;De!==null;){d=De;var h=d.sibling,m=d.return;if(wN(d),d===u){De=null;break}if(h!==null){h.return=m,De=h;break}De=m}}}var g=a.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}De=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,De=o;else e:for(;De!==null;){if(a=De,a.flags&2048)switch(a.tag){case 0:case 11:case 15:sc(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,De=b;break e}De=a.return}}var y=e.current;for(De=y;De!==null;){o=De;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,De=x;else e:for(o=y;De!==null;){if(l=De,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Q0(9,l)}}catch(_){zt(l,l.return,_)}if(l===o){De=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,De=N;break e}De=l.return}}if(it=s,ti(),Ds&&typeof Ds.onPostCommitFiberRoot=="function")try{Ds.onPostCommitFiberRoot(W0,e)}catch{}n=!0}return n}finally{pt=r,Yn.transition=t}}return!1}function gv(e,t,r){t=Qo(r,t),t=cN(e,t,1),e=Ba(e,t,1),t=Jr(),e!==null&&(su(e,1,t),dn(e,t))}function zt(e,t,r){if(e.tag===3)gv(e,e,r);else for(;t!==null;){if(t.tag===3){gv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ua===null||!Ua.has(n))){e=Qo(r,e),e=uN(t,e,1),t=Ba(t,e,1),e=Jr(),t!==null&&(su(t,1,e),dn(t,e));break}}t=t.return}}function tT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jr(),e.pingedLanes|=e.suspendedLanes&r,yr===e&&(Sr&r)===r&&(cr===4||cr===3&&(Sr&130023424)===Sr&&500>Zt()-yx?Si(e,0):vx|=r),dn(e,t)}function AN(e,t){t===0&&(e.mode&1?(t=Bu,Bu<<=1,!(Bu&130023424)&&(Bu=4194304)):t=1);var r=Jr();e=aa(e,t),e!==null&&(su(e,t,r),dn(e,r))}function rT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),AN(e,r)}function nT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(we(314))}n!==null&&n.delete(t),AN(e,r)}var FN;FN=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||cn.current)ln=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ln=!1,H3(e,t,r);ln=!!(e.flags&131072)}else ln=!1,Ft&&t.flags&1048576&&Rb(t,qd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ed(e,t),e=t.pendingProps;var s=Yo(t,$r.current);Uo(t,r),s=fx(null,t,n,e,s,r);var a=hx();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,un(n)?(a=!0,Kd(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ox(t),s.updater=J0,t.stateNode=s,s._reactInternals=t,Tm(t,n,e,r),t=Pm(null,t,n,!0,a,r)):(t.tag=0,Ft&&a&&ex(t),Yr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ed(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=aT(n),e=ls(n,e),s){case 0:t=Fm(null,t,n,e,r);break e;case 1:t=ov(null,t,n,e,r);break e;case 11:t=av(null,t,n,e,r);break e;case 14:t=iv(null,t,n,ls(n.type,e),r);break e}throw Error(we(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),Fm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),ov(e,t,n,s,r);case 3:e:{if(mN(t),e===null)throw Error(we(387));n=t.pendingProps,a=t.memoizedState,s=a.element,Vb(e,t),Qd(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Qo(Error(we(423)),t),t=lv(e,t,n,r,s);break e}else if(n!==s){s=Qo(Error(we(424)),t),t=lv(e,t,n,r,s);break e}else for(_n=Ma(t.stateNode.containerInfo.firstChild),Sn=t,Ft=!0,us=null,r=Bb(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(qo(),n===s){t=ia(e,t,r);break e}Yr(e,t,n,r)}t=t.child}return t;case 5:return $b(t),e===null&&Em(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,o=s.children,bm(n,s)?o=null:a!==null&&bm(n,a)&&(t.flags|=32),hN(e,t),Yr(e,t,o,r),t.child;case 6:return e===null&&Em(t),null;case 13:return pN(e,t,r);case 4:return lx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Zo(t,null,n,r):Yr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),av(e,t,n,s,r);case 7:return Yr(e,t,t.pendingProps,r),t.child;case 8:return Yr(e,t,t.pendingProps.children,r),t.child;case 12:return Yr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,wt(Zd,n._currentValue),n._currentValue=o,a!==null)if(vs(a.value,o)){if(a.children===s.children&&!cn.current){t=ia(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=qs(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Cm(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(we(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Cm(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Yr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Uo(t,r),s=Zn(s),n=n(s),t.flags|=1,Yr(e,t,n,r),t.child;case 14:return n=t.type,s=ls(n,t.pendingProps),s=ls(n.type,s),iv(e,t,n,s,r);case 15:return dN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),Ed(e,t),t.tag=1,un(n)?(e=!0,Kd(t)):e=!1,Uo(t,r),lN(t,n,s),Tm(t,n,s,r),Pm(null,t,n,!0,e,r);case 19:return xN(e,t,r);case 22:return fN(e,t,r)}throw Error(we(156,t.tag))};function PN(e,t){return ab(e,t)}function sT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(e,t,r,n){return new sT(e,t,r,n)}function kx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function aT(e){if(typeof e=="function")return kx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===$p)return 11;if(e===zp)return 14}return 2}function $a(e,t){var r=e.alternate;return r===null?(r=Kn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Td(e,t,r,n,s,a){var o=2;if(n=e,typeof e=="function")kx(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case yo:return Ei(r.children,s,a,t);case Vp:o=8,s|=8;break;case Qh:return e=Kn(12,r,t,s|2),e.elementType=Qh,e.lanes=a,e;case em:return e=Kn(13,r,t,s),e.elementType=em,e.lanes=a,e;case tm:return e=Kn(19,r,t,s),e.elementType=tm,e.lanes=a,e;case $2:return tf(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case U2:o=10;break e;case V2:o=9;break e;case $p:o=11;break e;case zp:o=14;break e;case Na:o=16,n=null;break e}throw Error(we(130,e==null?e:typeof e,""))}return t=Kn(o,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Ei(e,t,r,n){return e=Kn(7,e,n,t),e.lanes=r,e}function tf(e,t,r,n){return e=Kn(22,e,n,t),e.elementType=$2,e.lanes=r,e.stateNode={isHidden:!1},e}function dh(e,t,r){return e=Kn(6,e,null,t),e.lanes=r,e}function fh(e,t,r){return t=Kn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function iT(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gf(0),this.expirationTimes=Gf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gf(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _x(e,t,r,n,s,a,o,l,c){return e=new iT(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Kn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ox(a),e}function oT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function DN(e){if(!e)return Ga;e=e._reactInternals;e:{if(Ji(e)!==e||e.tag!==1)throw Error(we(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(un(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(we(171))}if(e.tag===1){var r=e.type;if(un(r))return Db(e,r,t)}return t}function IN(e,t,r,n,s,a,o,l,c){return e=_x(r,n,!0,e,s,a,o,l,c),e.context=DN(null),r=e.current,n=Jr(),s=Va(r),a=qs(n,s),a.callback=t??null,Ba(r,a,s),e.current.lanes=s,su(e,s,n),dn(e,n),e}function rf(e,t,r,n){var s=t.current,a=Jr(),o=Va(s);return r=DN(r),t.context===null?t.context=r:t.pendingContext=r,t=qs(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ba(s,t,o),e!==null&&(ms(e,s,o,a),kd(e,s,o)),o}function o0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function vv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Sx(e,t){vv(e,t),(e=e.alternate)&&vv(e,t)}function lT(){return null}var RN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ex(e){this._internalRoot=e}nf.prototype.render=Ex.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(we(409));rf(e,t,null,null)};nf.prototype.unmount=Ex.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Oi(function(){rf(null,e,null,null)}),t[sa]=null}};function nf(e){this._internalRoot=e}nf.prototype.unstable_scheduleHydration=function(e){if(e){var t=fb();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ea.length&&t!==0&&t<Ea[r].priority;r++);Ea.splice(r,0,e),r===0&&mb(e)}};function Cx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function sf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function yv(){}function cT(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=o0(o);a.call(u)}}var o=IN(t,n,e,0,null,!1,!1,"",yv);return e._reactRootContainer=o,e[sa]=o.current,jc(e.nodeType===8?e.parentNode:e),Oi(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=o0(c);l.call(u)}}var c=_x(e,0,!1,null,null,!1,!1,"",yv);return e._reactRootContainer=c,e[sa]=c.current,jc(e.nodeType===8?e.parentNode:e),Oi(function(){rf(t,c,r,n)}),c}function af(e,t,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=o0(o);l.call(c)}}rf(t,o,e,s)}else o=cT(r,t,e,s,n);return o0(o)}ub=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Wl(t.pendingLanes);r!==0&&(Gp(t,r|1),dn(t,Zt()),!(it&6)&&(el=Zt()+500,ti()))}break;case 13:Oi(function(){var n=aa(e,1);if(n!==null){var s=Jr();ms(n,e,1,s)}}),Sx(e,1)}};Xp=function(e){if(e.tag===13){var t=aa(e,134217728);if(t!==null){var r=Jr();ms(t,e,134217728,r)}Sx(e,134217728)}};db=function(e){if(e.tag===13){var t=Va(e),r=aa(e,t);if(r!==null){var n=Jr();ms(r,e,t,n)}Sx(e,t)}};fb=function(){return pt};hb=function(e,t){var r=pt;try{return pt=e,t()}finally{pt=r}};dm=function(e,t,r){switch(t){case"input":if(sm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Y0(n);if(!s)throw Error(we(90));H2(n),sm(n,s)}}}break;case"textarea":G2(e,r);break;case"select":t=r.value,t!=null&&Lo(e,!!r.multiple,t,!1)}};Q2=wx;eb=Oi;var uT={usingClientEntryPoint:!1,Events:[iu,ko,Y0,Z2,J2,wx]},Rl={findFiberByHostInstance:gi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dT={bundleType:Rl.bundleType,version:Rl.version,rendererPackageName:Rl.rendererPackageName,rendererConfig:Rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=nb(e),e===null?null:e.stateNode},findFiberByHostInstance:Rl.findFiberByHostInstance||lT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qu.isDisabled&&qu.supportsFiber)try{W0=qu.inject(dT),Ds=qu}catch{}}Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uT;Fn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cx(t))throw Error(we(200));return oT(e,t,null,r)};Fn.createRoot=function(e,t){if(!Cx(e))throw Error(we(299));var r=!1,n="",s=RN;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=_x(e,1,!1,null,null,r,!1,n,s),e[sa]=t.current,jc(e.nodeType===8?e.parentNode:e),new Ex(t)};Fn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(we(188)):(e=Object.keys(e).join(","),Error(we(268,e)));return e=nb(t),e=e===null?null:e.stateNode,e};Fn.flushSync=function(e){return Oi(e)};Fn.hydrate=function(e,t,r){if(!sf(t))throw Error(we(200));return af(null,e,t,!0,r)};Fn.hydrateRoot=function(e,t,r){if(!Cx(e))throw Error(we(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=RN;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=IN(t,null,e,1,r??null,s,!1,a,o),e[sa]=t.current,jc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new nf(t)};Fn.render=function(e,t,r){if(!sf(t))throw Error(we(200));return af(null,e,t,!1,r)};Fn.unmountComponentAtNode=function(e){if(!sf(e))throw Error(we(40));return e._reactRootContainer?(Oi(function(){af(null,null,e,!1,function(){e._reactRootContainer=null,e[sa]=null})}),!0):!1};Fn.unstable_batchedUpdates=wx;Fn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!sf(r))throw Error(we(200));if(e==null||e._reactInternals===void 0)throw Error(we(38));return af(e,t,r,!1,n)};Fn.version="18.3.1-next-f1338f8080-20240426";function LN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(LN)}catch(e){console.error(e)}}LN(),L2.exports=Fn;var of=L2.exports;const fT=_2(of);var wv=of;Zh.createRoot=wv.createRoot,Zh.hydrateRoot=wv.hydrateRoot;const ON=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),lf=E.createContext({}),cf=E.createContext(null),uf=typeof document<"u",jx=uf?E.useLayoutEffect:E.useEffect,MN=E.createContext({strict:!1}),Tx=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),hT="framerAppearId",BN="data-"+Tx(hT);function mT(e,t,r,n){const{visualElement:s}=E.useContext(lf),a=E.useContext(MN),o=E.useContext(cf),l=E.useContext(ON).reducedMotion,c=E.useRef();n=n||a.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:s,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;E.useInsertionEffect(()=>{u&&u.update(r,o)});const d=E.useRef(!!(r[BN]&&!window.HandoffComplete));return jx(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),E.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function Ao(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function pT(e,t,r){return E.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Ao(r)&&(r.current=n))},[t])}function Oc(e){return typeof e=="string"||Array.isArray(e)}function df(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Ax=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Fx=["initial",...Ax];function ff(e){return df(e.animate)||Fx.some(t=>Oc(e[t]))}function UN(e){return!!(ff(e)||e.variants)}function xT(e,t){if(ff(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Oc(r)?r:void 0,animate:Oc(n)?n:void 0}}return e.inherit!==!1?t:{}}function gT(e){const{initial:t,animate:r}=xT(e,E.useContext(lf));return E.useMemo(()=>({initial:t,animate:r}),[bv(t),bv(r)])}function bv(e){return Array.isArray(e)?e.join(" "):e}const Nv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Mc={};for(const e in Nv)Mc[e]={isEnabled:t=>Nv[e].some(r=>!!t[r])};function vT(e){for(const t in e)Mc[t]={...Mc[t],...e[t]}}const Px=E.createContext({}),VN=E.createContext({}),yT=Symbol.for("motionComponentSymbol");function wT({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){e&&vT(e);function a(l,c){let u;const d={...E.useContext(ON),...l,layoutId:bT(l)},{isStatic:f}=d,h=gT(l),m=n(l,f);if(!f&&uf){h.visualElement=mT(s,m,d,t);const g=E.useContext(VN),p=E.useContext(MN).strict;h.visualElement&&(u=h.visualElement.loadFeatures(d,p,e,g))}return E.createElement(lf.Provider,{value:h},u&&h.visualElement?E.createElement(u,{visualElement:h.visualElement,...d}):null,r(s,l,pT(m,h.visualElement,c),m,f,h.visualElement))}const o=E.forwardRef(a);return o[yT]=s,o}function bT({layoutId:e}){const t=E.useContext(Px).id;return t&&e!==void 0?t+"-"+e:e}function NT(e){function t(n,s={}){return wT(e(n,s))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,s)=>(r.has(s)||r.set(s,t(s)),r.get(s))})}const kT=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Dx(e){return typeof e!="string"||e.includes("-")?!1:!!(kT.indexOf(e)>-1||/[A-Z]/.test(e))}const l0={};function _T(e){Object.assign(l0,e)}const lu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Qi=new Set(lu);function $N(e,{layout:t,layoutId:r}){return Qi.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!l0[e]||e==="opacity")}const pn=e=>!!(e&&e.getVelocity),ST={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ET=lu.length;function CT(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,s){let a="";for(let o=0;o<ET;o++){const l=lu[o];if(e[l]!==void 0){const c=ST[l]||l;a+=`${c}(${e[l]}) `}}return t&&!e.z&&(a+="translateZ(0)"),a=a.trim(),s?a=s(e,n?"":a):r&&n&&(a="none"),a}const zN=e=>t=>typeof t=="string"&&t.startsWith(e),HN=zN("--"),Hm=zN("var(--"),jT=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,TT=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Xa=(e,t,r)=>Math.min(Math.max(r,e),t),eo={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},oc={...eo,transform:e=>Xa(0,1,e)},Zu={...eo,default:1},lc=e=>Math.round(e*1e5)/1e5,hf=/(-)?([\d]*\.?[\d])+/g,WN=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,AT=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function cu(e){return typeof e=="string"}const uu=e=>({test:t=>cu(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ba=uu("deg"),Rs=uu("%"),ze=uu("px"),FT=uu("vh"),PT=uu("vw"),kv={...Rs,parse:e=>Rs.parse(e)/100,transform:e=>Rs.transform(e*100)},_v={...eo,transform:Math.round},GN={borderWidth:ze,borderTopWidth:ze,borderRightWidth:ze,borderBottomWidth:ze,borderLeftWidth:ze,borderRadius:ze,radius:ze,borderTopLeftRadius:ze,borderTopRightRadius:ze,borderBottomRightRadius:ze,borderBottomLeftRadius:ze,width:ze,maxWidth:ze,height:ze,maxHeight:ze,size:ze,top:ze,right:ze,bottom:ze,left:ze,padding:ze,paddingTop:ze,paddingRight:ze,paddingBottom:ze,paddingLeft:ze,margin:ze,marginTop:ze,marginRight:ze,marginBottom:ze,marginLeft:ze,rotate:ba,rotateX:ba,rotateY:ba,rotateZ:ba,scale:Zu,scaleX:Zu,scaleY:Zu,scaleZ:Zu,skew:ba,skewX:ba,skewY:ba,distance:ze,translateX:ze,translateY:ze,translateZ:ze,x:ze,y:ze,z:ze,perspective:ze,transformPerspective:ze,opacity:oc,originX:kv,originY:kv,originZ:ze,zIndex:_v,fillOpacity:oc,strokeOpacity:oc,numOctaves:_v};function Ix(e,t,r,n){const{style:s,vars:a,transform:o,transformOrigin:l}=e;let c=!1,u=!1,d=!0;for(const f in t){const h=t[f];if(HN(f)){a[f]=h;continue}const m=GN[f],g=TT(h,m);if(Qi.has(f)){if(c=!0,o[f]=g,!d)continue;h!==(m.default||0)&&(d=!1)}else f.startsWith("origin")?(u=!0,l[f]=g):s[f]=g}if(t.transform||(c||n?s.transform=CT(e.transform,r,d,n):s.transform&&(s.transform="none")),u){const{originX:f="50%",originY:h="50%",originZ:m=0}=l;s.transformOrigin=`${f} ${h} ${m}`}}const Rx=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function XN(e,t,r){for(const n in t)!pn(t[n])&&!$N(n,r)&&(e[n]=t[n])}function DT({transformTemplate:e},t,r){return E.useMemo(()=>{const n=Rx();return Ix(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function IT(e,t,r){const n=e.style||{},s={};return XN(s,n,e),Object.assign(s,DT(e,t,r)),e.transformValues?e.transformValues(s):s}function RT(e,t,r){const n={},s=IT(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const LT=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function c0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||LT.has(e)}let KN=e=>!c0(e);function OT(e){e&&(KN=t=>t.startsWith("on")?!c0(t):e(t))}try{OT(require("@emotion/is-prop-valid").default)}catch{}function MT(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(KN(s)||r===!0&&c0(s)||!t&&!c0(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function Sv(e,t,r){return typeof e=="string"?e:ze.transform(t+r*e)}function BT(e,t,r){const n=Sv(t,e.x,e.width),s=Sv(r,e.y,e.height);return`${n} ${s}`}const UT={offset:"stroke-dashoffset",array:"stroke-dasharray"},VT={offset:"strokeDashoffset",array:"strokeDasharray"};function $T(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?UT:VT;e[a.offset]=ze.transform(-n);const o=ze.transform(t),l=ze.transform(r);e[a.array]=`${o} ${l}`}function Lx(e,{attrX:t,attrY:r,attrScale:n,originX:s,originY:a,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,f,h){if(Ix(e,u,d,h),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:g,dimensions:p}=e;m.transform&&(p&&(g.transform=m.transform),delete m.transform),p&&(s!==void 0||a!==void 0||g.transform)&&(g.transformOrigin=BT(p,s!==void 0?s:.5,a!==void 0?a:.5)),t!==void 0&&(m.x=t),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),o!==void 0&&$T(m,o,l,c,!1)}const YN=()=>({...Rx(),attrs:{}}),Ox=e=>typeof e=="string"&&e.toLowerCase()==="svg";function zT(e,t,r,n){const s=E.useMemo(()=>{const a=YN();return Lx(a,t,{enableHardwareAcceleration:!1},Ox(n),e.transformTemplate),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};XN(a,e.style,e),s.style={...a,...s.style}}return s}function HT(e=!1){return(r,n,s,{latestValues:a},o)=>{const c=(Dx(r)?zT:RT)(n,a,o,r),d={...MT(n,typeof r=="string",e),...c,ref:s},{children:f}=n,h=E.useMemo(()=>pn(f)?f.get():f,[f]);return E.createElement(r,{...d,children:h})}}function qN(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const a in r)e.style.setProperty(a,r[a])}const ZN=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function JN(e,t,r,n){qN(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(ZN.has(s)?s:Tx(s),t.attrs[s])}function Mx(e,t){const{style:r}=e,n={};for(const s in r)(pn(r[s])||t.style&&pn(t.style[s])||$N(s,e))&&(n[s]=r[s]);return n}function QN(e,t){const r=Mx(e,t);for(const n in e)if(pn(e[n])||pn(t[n])){const s=lu.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=e[n]}return r}function Bx(e,t,r,n={},s={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),t}function ek(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const u0=e=>Array.isArray(e),WT=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),GT=e=>u0(e)?e[e.length-1]||0:e;function Ad(e){const t=pn(e)?e.get():e;return WT(t)?t.toValue():t}function XT({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,s,a){const o={latestValues:KT(n,s,a,e),renderState:t()};return r&&(o.mount=l=>r(n,l,o)),o}const tk=e=>(t,r)=>{const n=E.useContext(lf),s=E.useContext(cf),a=()=>XT(e,t,n,s);return r?a():ek(a)};function KT(e,t,r,n){const s={},a=n(e,{});for(const h in a)s[h]=Ad(a[h]);let{initial:o,animate:l}=e;const c=ff(e),u=UN(e);t&&u&&!c&&e.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let d=r?r.initial===!1:!1;d=d||o===!1;const f=d?l:o;return f&&typeof f!="boolean"&&!df(f)&&(Array.isArray(f)?f:[f]).forEach(m=>{const g=Bx(e,m);if(!g)return;const{transitionEnd:p,transition:v,...b}=g;for(const y in b){let x=b[y];if(Array.isArray(x)){const N=d?x.length-1:0;x=x[N]}x!==null&&(s[y]=x)}for(const y in p)s[y]=p[y]}),s}const Wt=e=>e;class Ev{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function YT(e){let t=new Ev,r=new Ev,n=0,s=!1,a=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const f=d&&s,h=f?t:r;return u&&o.add(c),h.add(c)&&f&&s&&(n=t.order.length),c},cancel:c=>{r.remove(c),o.delete(c)},process:c=>{if(s){a=!0;return}if(s=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let u=0;u<n;u++){const d=t.order[u];d(c),o.has(d)&&(l.schedule(d),e())}s=!1,a&&(a=!1,l.process(c))}};return l}const Ju=["prepare","read","update","preRender","render","postRender"],qT=40;function ZT(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=Ju.reduce((f,h)=>(f[h]=YT(()=>r=!0),f),{}),o=f=>a[f].process(s),l=()=>{const f=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(f-s.timestamp,qT),1),s.timestamp=f,s.isProcessing=!0,Ju.forEach(o),s.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,s.isProcessing||e(l)};return{schedule:Ju.reduce((f,h)=>{const m=a[h];return f[h]=(g,p=!1,v=!1)=>(r||c(),m.schedule(g,p,v)),f},{}),cancel:f=>Ju.forEach(h=>a[h].cancel(f)),state:s,steps:a}}const{schedule:bt,cancel:oa,state:Dr,steps:hh}=ZT(typeof requestAnimationFrame<"u"?requestAnimationFrame:Wt,!0),JT={useVisualState:tk({scrapeMotionValuesFromProps:QN,createRenderState:YN,onMount:(e,t,{renderState:r,latestValues:n})=>{bt.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),bt.render(()=>{Lx(r,n,{enableHardwareAcceleration:!1},Ox(t.tagName),e.transformTemplate),JN(t,r)})}})},QT={useVisualState:tk({scrapeMotionValuesFromProps:Mx,createRenderState:Rx})};function eA(e,{forwardMotionProps:t=!1},r,n){return{...Dx(e)?JT:QT,preloadedFeatures:r,useRender:HT(t),createVisualElement:n,Component:e}}function Xs(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const rk=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function mf(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const tA=e=>t=>rk(t)&&e(t,mf(t));function Zs(e,t,r,n){return Xs(e,t,tA(r),n)}const rA=(e,t)=>r=>t(e(r)),za=(...e)=>e.reduce(rA);function nk(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const Cv=nk("dragHorizontal"),jv=nk("dragVertical");function sk(e){let t=!1;if(e==="y")t=jv();else if(e==="x")t=Cv();else{const r=Cv(),n=jv();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function ak(){const e=sk(!0);return e?(e(),!1):!0}class ri{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Tv(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),s=(a,o)=>{if(a.pointerType==="touch"||ak())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&bt.update(()=>l[n](a,o))};return Zs(e.current,r,s,{passive:!e.getProps()[n]})}class nA extends ri{mount(){this.unmount=za(Tv(this.node,!0),Tv(this.node,!1))}unmount(){}}class sA extends ri{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=za(Xs(this.node.current,"focus",()=>this.onFocus()),Xs(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const ik=(e,t)=>t?e===t?!0:ik(e,t.parentElement):!1;function mh(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,mf(r))}class aA extends ri{constructor(){super(...arguments),this.removeStartListeners=Wt,this.removeEndListeners=Wt,this.removeAccessibleListeners=Wt,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),a=Zs(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:f}=this.node.getProps();bt.update(()=>{!f&&!ik(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),o=Zs(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=za(a,o),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=a=>{if(a.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||mh("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&bt.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=Xs(this.node.current,"keyup",o),mh("down",(l,c)=>{this.startPress(l,c)})},r=Xs(this.node.current,"keydown",t),n=()=>{this.isPressing&&mh("cancel",(a,o)=>this.cancelPress(a,o))},s=Xs(this.node.current,"blur",n);this.removeAccessibleListeners=za(r,s)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&bt.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!ak()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&bt.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Zs(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Xs(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=za(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Wm=new WeakMap,ph=new WeakMap,iA=e=>{const t=Wm.get(e.target);t&&t(e)},oA=e=>{e.forEach(iA)};function lA({root:e,...t}){const r=e||document;ph.has(r)||ph.set(r,{});const n=ph.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(oA,{root:e,...t})),n[s]}function cA(e,t,r){const n=lA(t);return Wm.set(e,r),n.observe(e),()=>{Wm.delete(e),n.unobserve(e)}}const uA={some:0,all:1};class dA extends ri{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:uA[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return cA(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(fA(t,r))&&this.startObserver()}unmount(){}}function fA({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const hA={inView:{Feature:dA},tap:{Feature:aA},focus:{Feature:sA},hover:{Feature:nA}};function ok(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function mA(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function pA(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function pf(e,t,r){const n=e.getProps();return Bx(n,t,r!==void 0?r:n.custom,mA(e),pA(e))}let xA=Wt,Ux=Wt;const Ha=e=>e*1e3,Js=e=>e/1e3,gA={current:!1},lk=e=>Array.isArray(e)&&typeof e[0]=="number";function ck(e){return!!(!e||typeof e=="string"&&uk[e]||lk(e)||Array.isArray(e)&&e.every(ck))}const Xl=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,uk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xl([0,.65,.55,1]),circOut:Xl([.55,0,1,.45]),backIn:Xl([.31,.01,.66,-.59]),backOut:Xl([.33,1.53,.69,.99])};function dk(e){if(e)return lk(e)?Xl(e):Array.isArray(e)?e.map(dk):uk[e]}function vA(e,t,r,{delay:n=0,duration:s,repeat:a=0,repeatType:o="loop",ease:l,times:c}={}){const u={[t]:r};c&&(u.offset=c);const d=dk(l);return Array.isArray(d)&&(u.easing=d),e.animate(u,{delay:n,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"})}function yA(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const fk=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,wA=1e-7,bA=12;function NA(e,t,r,n,s){let a,o,l=0;do o=t+(r-t)/2,a=fk(o,n,s)-e,a>0?r=o:t=o;while(Math.abs(a)>wA&&++l<bA);return o}function du(e,t,r,n){if(e===t&&r===n)return Wt;const s=a=>NA(a,0,1,e,r);return a=>a===0||a===1?a:fk(s(a),t,n)}const kA=du(.42,0,1,1),_A=du(0,0,.58,1),hk=du(.42,0,.58,1),SA=e=>Array.isArray(e)&&typeof e[0]!="number",mk=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,pk=e=>t=>1-e(1-t),Vx=e=>1-Math.sin(Math.acos(e)),xk=pk(Vx),EA=mk(Vx),gk=du(.33,1.53,.69,.99),$x=pk(gk),CA=mk($x),jA=e=>(e*=2)<1?.5*$x(e):.5*(2-Math.pow(2,-10*(e-1))),TA={linear:Wt,easeIn:kA,easeInOut:hk,easeOut:_A,circIn:Vx,circInOut:EA,circOut:xk,backIn:$x,backInOut:CA,backOut:gk,anticipate:jA},Av=e=>{if(Array.isArray(e)){Ux(e.length===4);const[t,r,n,s]=e;return du(t,r,n,s)}else if(typeof e=="string")return TA[e];return e},zx=(e,t)=>r=>!!(cu(r)&&AT.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),vk=(e,t,r)=>n=>{if(!cu(n))return n;const[s,a,o,l]=n.match(hf);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},AA=e=>Xa(0,255,e),xh={...eo,transform:e=>Math.round(AA(e))},wi={test:zx("rgb","red"),parse:vk("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+xh.transform(e)+", "+xh.transform(t)+", "+xh.transform(r)+", "+lc(oc.transform(n))+")"};function FA(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const Gm={test:zx("#"),parse:FA,transform:wi.transform},Fo={test:zx("hsl","hue"),parse:vk("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Rs.transform(lc(t))+", "+Rs.transform(lc(r))+", "+lc(oc.transform(n))+")"},Xr={test:e=>wi.test(e)||Gm.test(e)||Fo.test(e),parse:e=>wi.test(e)?wi.parse(e):Fo.test(e)?Fo.parse(e):Gm.parse(e),transform:e=>cu(e)?e:e.hasOwnProperty("red")?wi.transform(e):Fo.transform(e)},Rt=(e,t,r)=>-r*e+r*t+e;function gh(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function PA({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,o=0;if(!t)s=a=o=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;s=gh(c,l,e+1/3),a=gh(c,l,e),o=gh(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:n}}const vh=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},DA=[Gm,wi,Fo],IA=e=>DA.find(t=>t.test(e));function Fv(e){const t=IA(e);let r=t.parse(e);return t===Fo&&(r=PA(r)),r}const yk=(e,t)=>{const r=Fv(e),n=Fv(t),s={...r};return a=>(s.red=vh(r.red,n.red,a),s.green=vh(r.green,n.green,a),s.blue=vh(r.blue,n.blue,a),s.alpha=Rt(r.alpha,n.alpha,a),wi.transform(s))};function RA(e){var t,r;return isNaN(e)&&cu(e)&&(((t=e.match(hf))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(WN))===null||r===void 0?void 0:r.length)||0)>0}const wk={regex:jT,countKey:"Vars",token:"${v}",parse:Wt},bk={regex:WN,countKey:"Colors",token:"${c}",parse:Xr.parse},Nk={regex:hf,countKey:"Numbers",token:"${n}",parse:eo.parse};function yh(e,{regex:t,countKey:r,token:n,parse:s}){const a=e.tokenised.match(t);a&&(e["num"+r]=a.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...a.map(s)))}function d0(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&yh(r,wk),yh(r,bk),yh(r,Nk),r}function kk(e){return d0(e).values}function _k(e){const{values:t,numColors:r,numVars:n,tokenised:s}=d0(e),a=t.length;return o=>{let l=s;for(let c=0;c<a;c++)c<n?l=l.replace(wk.token,o[c]):c<n+r?l=l.replace(bk.token,Xr.transform(o[c])):l=l.replace(Nk.token,lc(o[c]));return l}}const LA=e=>typeof e=="number"?0:e;function OA(e){const t=kk(e);return _k(e)(t.map(LA))}const Ka={test:RA,parse:kk,createTransformer:_k,getAnimatableNone:OA},Sk=(e,t)=>r=>`${r>0?t:e}`;function Ek(e,t){return typeof e=="number"?r=>Rt(e,t,r):Xr.test(e)?yk(e,t):e.startsWith("var(")?Sk(e,t):jk(e,t)}const Ck=(e,t)=>{const r=[...e],n=r.length,s=e.map((a,o)=>Ek(a,t[o]));return a=>{for(let o=0;o<n;o++)r[o]=s[o](a);return r}},MA=(e,t)=>{const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=Ek(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}},jk=(e,t)=>{const r=Ka.createTransformer(t),n=d0(e),s=d0(t);return n.numVars===s.numVars&&n.numColors===s.numColors&&n.numNumbers>=s.numNumbers?za(Ck(n.values,s.values),r):Sk(e,t)},Bc=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},Pv=(e,t)=>r=>Rt(e,t,r);function BA(e){return typeof e=="number"?Pv:typeof e=="string"?Xr.test(e)?yk:jk:Array.isArray(e)?Ck:typeof e=="object"?MA:Pv}function UA(e,t,r){const n=[],s=r||BA(e[0]),a=e.length-1;for(let o=0;o<a;o++){let l=s(e[o],e[o+1]);if(t){const c=Array.isArray(t)?t[o]||Wt:t;l=za(c,l)}n.push(l)}return n}function Tk(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(Ux(a===t.length),a===1)return()=>t[0];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=UA(t,n,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const f=Bc(e[d],e[d+1],u);return o[d](f)};return r?u=>c(Xa(e[0],e[a-1],u)):c}function VA(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Bc(0,t,n);e.push(Rt(r,1,s))}}function $A(e){const t=[0];return VA(t,e.length-1),t}function zA(e,t){return e.map(r=>r*t)}function HA(e,t){return e.map(()=>t||hk).splice(0,e.length-1)}function f0({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=SA(n)?n.map(Av):Av(n),a={done:!1,value:t[0]},o=zA(r&&r.length===t.length?r:$A(t),e),l=Tk(o,t,{ease:Array.isArray(s)?s:HA(t,s)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}function Ak(e,t){return t?e*(1e3/t):0}const WA=5;function Fk(e,t,r){const n=Math.max(t-WA,0);return Ak(r-e(n),t-n)}const wh=.001,GA=.01,Dv=10,XA=.05,KA=1;function YA({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let s,a;xA(e<=Ha(Dv));let o=1-t;o=Xa(XA,KA,o),e=Xa(GA,Dv,Js(e)),o<1?(s=u=>{const d=u*o,f=d*e,h=d-r,m=Xm(u,o),g=Math.exp(-f);return wh-h/m*g},a=u=>{const f=u*o*e,h=f*r+r,m=Math.pow(o,2)*Math.pow(u,2)*e,g=Math.exp(-f),p=Xm(Math.pow(u,2),o);return(-s(u)+wh>0?-1:1)*((h-m)*g)/p}):(s=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-wh+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const l=5/e,c=ZA(s,a,l);if(e=Ha(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:e}}}const qA=12;function ZA(e,t,r){let n=r;for(let s=1;s<qA;s++)n=n-e(n)/t(n);return n}function Xm(e,t){return e*Math.sqrt(1-t*t)}const JA=["duration","bounce"],QA=["stiffness","damping","mass"];function Iv(e,t){return t.some(r=>e[r]!==void 0)}function e6(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Iv(e,QA)&&Iv(e,JA)){const r=YA(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function Pk({keyframes:e,restDelta:t,restSpeed:r,...n}){const s=e[0],a=e[e.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:f,isResolvedFromDuration:h}=e6({...n,velocity:-Js(n.velocity||0)}),m=f||0,g=c/(2*Math.sqrt(l*u)),p=a-s,v=Js(Math.sqrt(l/u)),b=Math.abs(p)<5;r||(r=b?.01:2),t||(t=b?.005:.5);let y;if(g<1){const x=Xm(v,g);y=N=>{const _=Math.exp(-g*v*N);return a-_*((m+g*v*p)/x*Math.sin(x*N)+p*Math.cos(x*N))}}else if(g===1)y=x=>a-Math.exp(-v*x)*(p+(m+v*p)*x);else{const x=v*Math.sqrt(g*g-1);y=N=>{const _=Math.exp(-g*v*N),k=Math.min(x*N,300);return a-_*((m+g*v*p)*Math.sinh(k)+x*p*Math.cosh(k))/x}}return{calculatedDuration:h&&d||null,next:x=>{const N=y(x);if(h)o.done=x>=d;else{let _=m;x!==0&&(g<1?_=Fk(y,x,N):_=0);const k=Math.abs(_)<=r,w=Math.abs(a-N)<=t;o.done=k&&w}return o.value=o.done?a:N,o}}}function Rv({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},m=C=>l!==void 0&&C<l||c!==void 0&&C>c,g=C=>l===void 0?c:c===void 0||Math.abs(l-C)<Math.abs(c-C)?l:c;let p=r*t;const v=f+p,b=o===void 0?v:o(v);b!==v&&(p=b-f);const y=C=>-p*Math.exp(-C/n),x=C=>b+y(C),N=C=>{const D=y(C),z=x(C);h.done=Math.abs(D)<=u,h.value=h.done?b:z};let _,k;const w=C=>{m(h.value)&&(_=C,k=Pk({keyframes:[h.value,g(h.value)],velocity:Fk(x,C,h.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return w(0),{calculatedDuration:null,next:C=>{let D=!1;return!k&&_===void 0&&(D=!0,N(C),w(C)),_!==void 0&&C>_?k.next(C-_):(!D&&N(C),h)}}}const t6=e=>{const t=({timestamp:r})=>e(r);return{start:()=>bt.update(t,!0),stop:()=>oa(t),now:()=>Dr.isProcessing?Dr.timestamp:performance.now()}},Lv=2e4;function Ov(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<Lv;)t+=r,n=e.next(t);return t>=Lv?1/0:t}const r6={decay:Rv,inertia:Rv,tween:f0,keyframes:f0,spring:Pk};function h0({autoplay:e=!0,delay:t=0,driver:r=t6,keyframes:n,type:s="keyframes",repeat:a=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:f,...h}){let m=1,g=!1,p,v;const b=()=>{v=new Promise(L=>{p=L})};b();let y;const x=r6[s]||f0;let N;x!==f0&&typeof n[0]!="number"&&(N=Tk([0,100],n,{clamp:!1}),n=[0,100]);const _=x({...h,keyframes:n});let k;l==="mirror"&&(k=x({...h,keyframes:[...n].reverse(),velocity:-(h.velocity||0)}));let w="idle",C=null,D=null,z=null;_.calculatedDuration===null&&a&&(_.calculatedDuration=Ov(_));const{calculatedDuration:A}=_;let R=1/0,G=1/0;A!==null&&(R=A+o,G=R*(a+1)-o);let I=0;const Z=L=>{if(D===null)return;m>0&&(D=Math.min(D,L)),m<0&&(D=Math.min(L-G/m,D)),C!==null?I=C:I=Math.round(L-D)*m;const T=I-t*(m>=0?1:-1),U=m>=0?T<0:T>G;I=Math.max(T,0),w==="finished"&&C===null&&(I=G);let X=I,H=_;if(a){const ce=Math.min(I,G)/R;let J=Math.floor(ce),Se=ce%1;!Se&&ce>=1&&(Se=1),Se===1&&J--,J=Math.min(J,a+1),!!(J%2)&&(l==="reverse"?(Se=1-Se,o&&(Se-=o/R)):l==="mirror"&&(H=k)),X=Xa(0,1,Se)*R}const ee=U?{done:!1,value:n[0]}:H.next(X);N&&(ee.value=N(ee.value));let{done:me}=ee;!U&&A!==null&&(me=m>=0?I>=G:I<=0);const le=C===null&&(w==="finished"||w==="running"&&me);return f&&f(ee.value),le&&q(),ee},j=()=>{y&&y.stop(),y=void 0},Y=()=>{w="idle",j(),p(),b(),D=z=null},q=()=>{w="finished",d&&d(),j(),p()},S=()=>{if(g)return;y||(y=r(Z));const L=y.now();c&&c(),C!==null?D=L-C:(!D||w==="finished")&&(D=L),w==="finished"&&b(),z=D,C=null,w="running",y.start()};e&&S();const F={then(L,T){return v.then(L,T)},get time(){return Js(I)},set time(L){L=Ha(L),I=L,C!==null||!y||m===0?C=L:D=y.now()-L/m},get duration(){const L=_.calculatedDuration===null?Ov(_):_.calculatedDuration;return Js(L)},get speed(){return m},set speed(L){L===m||!y||(m=L,F.time=Js(I))},get state(){return w},play:S,pause:()=>{w="paused",C=I},stop:()=>{g=!0,w!=="idle"&&(w="idle",u&&u(),Y())},cancel:()=>{z!==null&&Z(z),Y()},complete:()=>{w="finished"},sample:L=>(D=0,Z(L))};return F}function n6(e){let t;return()=>(t===void 0&&(t=e()),t)}const s6=n6(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),a6=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Qu=10,i6=2e4,o6=(e,t)=>t.type==="spring"||e==="backgroundColor"||!ck(t.ease);function l6(e,t,{onUpdate:r,onComplete:n,...s}){if(!(s6()&&a6.has(t)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(x=>{l=x})};d();let{keyframes:f,duration:h=300,ease:m,times:g}=s;if(o6(t,s)){const x=h0({...s,repeat:0,delay:0});let N={done:!1,value:f[0]};const _=[];let k=0;for(;!N.done&&k<i6;)N=x.sample(k),_.push(N.value),k+=Qu;g=void 0,f=_,h=k-Qu,m="linear"}const p=vA(e.owner.current,t,f,{...s,duration:h,ease:m,times:g}),v=()=>{u=!1,p.cancel()},b=()=>{u=!0,bt.update(v),l(),d()};return p.onfinish=()=>{u||(e.set(yA(f,s)),n&&n(),b())},{then(x,N){return c.then(x,N)},attachTimeline(x){return p.timeline=x,p.onfinish=null,Wt},get time(){return Js(p.currentTime||0)},set time(x){p.currentTime=Ha(x)},get speed(){return p.playbackRate},set speed(x){p.playbackRate=x},get duration(){return Js(h)},play:()=>{o||(p.play(),oa(v))},pause:()=>p.pause(),stop:()=>{if(o=!0,p.playState==="idle")return;const{currentTime:x}=p;if(x){const N=h0({...s,autoplay:!1});e.setWithVelocity(N.sample(x-Qu).value,N.sample(x).value,Qu)}b()},complete:()=>{u||p.finish()},cancel:b}}function c6({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const s=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:Wt,pause:Wt,stop:Wt,then:a=>(a(),Promise.resolve()),cancel:Wt,complete:Wt});return t?h0({keyframes:[0,1],duration:0,delay:t,onComplete:s}):s()}const u6={type:"spring",stiffness:500,damping:25,restSpeed:10},d6=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),f6={type:"keyframes",duration:.8},h6={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},m6=(e,{keyframes:t})=>t.length>2?f6:Qi.has(e)?e.startsWith("scale")?d6(t[1]):u6:h6,Km=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Ka.test(t)||t==="0")&&!t.startsWith("url(")),p6=new Set(["brightness","contrast","saturate","opacity"]);function x6(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(hf)||[];if(!n)return e;const s=r.replace(n,"");let a=p6.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const g6=/([a-z-]*)\(.*?\)/g,Ym={...Ka,getAnimatableNone:e=>{const t=e.match(g6);return t?t.map(x6).join(" "):e}},v6={...GN,color:Xr,backgroundColor:Xr,outlineColor:Xr,fill:Xr,stroke:Xr,borderColor:Xr,borderTopColor:Xr,borderRightColor:Xr,borderBottomColor:Xr,borderLeftColor:Xr,filter:Ym,WebkitFilter:Ym},Hx=e=>v6[e];function Dk(e,t){let r=Hx(e);return r!==Ym&&(r=Ka),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const Ik=e=>/^0[^.\s]+$/.test(e);function y6(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Ik(e)}function w6(e,t,r,n){const s=Km(t,r);let a;Array.isArray(r)?a=[...r]:a=[null,r];const o=n.from!==void 0?n.from:e.get();let l;const c=[];for(let u=0;u<a.length;u++)a[u]===null&&(a[u]=u===0?o:a[u-1]),y6(a[u])&&c.push(u),typeof a[u]=="string"&&a[u]!=="none"&&a[u]!=="0"&&(l=a[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];a[d]=Dk(t,l)}return a}function b6({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function Wx(e,t){return e[t]||e.default||e}const N6={skipAnimations:!1},Gx=(e,t,r,n={})=>s=>{const a=Wx(n,e)||{},o=a.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Ha(o);const c=w6(t,e,r,a),u=c[0],d=c[c.length-1],f=Km(e,u),h=Km(e,d);let m={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...a,delay:-l,onUpdate:g=>{t.set(g),a.onUpdate&&a.onUpdate(g)},onComplete:()=>{s(),a.onComplete&&a.onComplete()}};if(b6(a)||(m={...m,...m6(e,m)}),m.duration&&(m.duration=Ha(m.duration)),m.repeatDelay&&(m.repeatDelay=Ha(m.repeatDelay)),!f||!h||gA.current||a.type===!1||N6.skipAnimations)return c6(m);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const g=l6(t,e,m);if(g)return g}return h0(m)};function m0(e){return!!(pn(e)&&e.add)}const Rk=e=>/^\-?\d*\.?\d+$/.test(e);function Xx(e,t){e.indexOf(t)===-1&&e.push(t)}function Kx(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class Yx{constructor(){this.subscriptions=[]}add(t){return Xx(this.subscriptions,t),()=>Kx(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const o=this.subscriptions[a];o&&o(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const k6=e=>!isNaN(parseFloat(e));class _6{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,s=!0)=>{this.prev=this.current,this.current=n;const{delta:a,timestamp:o}=Dr;this.lastUpdated!==o&&(this.timeDelta=a,this.lastUpdated=o,bt.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>bt.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=k6(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Yx);const n=this.events[t].add(r);return t==="change"?()=>{n(),bt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Ak(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function tl(e,t){return new _6(e,t)}const Lk=e=>t=>t.test(e),S6={test:e=>e==="auto",parse:e=>e},Ok=[eo,ze,Rs,ba,PT,FT,S6],Ll=e=>Ok.find(Lk(e)),E6=[...Ok,Xr,Ka],C6=e=>E6.find(Lk(e));function j6(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,tl(r))}function T6(e,t){const r=pf(e,t);let{transitionEnd:n={},transition:s={},...a}=r?e.makeTargetAnimatable(r,!1):{};a={...a,...n};for(const o in a){const l=GT(a[o]);j6(e,o,l)}}function A6(e,t,r){var n,s;const a=Object.keys(t).filter(l=>!e.hasValue(l)),o=a.length;if(o)for(let l=0;l<o;l++){const c=a[l],u=t[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&s!==void 0?s:t[c]),d!=null&&(typeof d=="string"&&(Rk(d)||Ik(d))?d=parseFloat(d):!C6(d)&&Ka.test(u)&&(d=Dk(c,u)),e.addValue(c,tl(d,{owner:e})),r[c]===void 0&&(r[c]=d),d!==null&&e.setBaseTarget(c,d))}}function F6(e,t){return t?(t[e]||t.default||t).from:void 0}function P6(e,t,r){const n={};for(const s in e){const a=F6(s,t);if(a!==void 0)n[s]=a;else{const o=r.getValue(s);o&&(n[s]=o.get())}}return n}function D6({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function I6(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function Mk(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:o,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(a=n);const u=[],d=s&&e.animationState&&e.animationState.getState()[s];for(const f in l){const h=e.getValue(f),m=l[f];if(!h||m===void 0||d&&D6(d,f))continue;const g={delay:r,elapsed:0,...Wx(a||{},f)};if(window.HandoffAppearAnimations){const b=e.getProps()[BN];if(b){const y=window.HandoffAppearAnimations(b,f,h,bt);y!==null&&(g.elapsed=y,g.isHandoff=!0)}}let p=!g.isHandoff&&!I6(h,m);if(g.type==="spring"&&(h.getVelocity()||g.velocity)&&(p=!1),h.animation&&(p=!1),p)continue;h.start(Gx(f,h,m,e.shouldReduceMotion&&Qi.has(f)?{type:!1}:g));const v=h.animation;m0(c)&&(c.add(f),v.then(()=>c.remove(f))),u.push(v)}return o&&Promise.all(u).then(()=>{o&&T6(e,o)}),u}function qm(e,t,r={}){const n=pf(e,t,r.custom);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(Mk(e,n,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=s;return R6(e,t,u+c,d,f,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>u())}else return Promise.all([a(),o(r.delay)])}function R6(e,t,r=0,n=0,s=1,a){const o=[],l=(e.variantChildren.size-1)*n,c=s===1?(u=0)=>u*n:(u=0)=>l-u*n;return Array.from(e.variantChildren).sort(L6).forEach((u,d)=>{u.notify("AnimationStart",t),o.push(qm(u,t,{...a,delay:r+c(d)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(o)}function L6(e,t){return e.sortNodePosition(t)}function O6(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>qm(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=qm(e,t,r);else{const s=typeof t=="function"?pf(e,t,r.custom):t;n=Promise.all(Mk(e,s,r))}return n.then(()=>e.notify("AnimationComplete",t))}const M6=[...Ax].reverse(),B6=Ax.length;function U6(e){return t=>Promise.all(t.map(({animation:r,options:n})=>O6(e,r,n)))}function V6(e){let t=U6(e);const r=z6();let n=!0;const s=(c,u)=>{const d=pf(e,u);if(d){const{transition:f,transitionEnd:h,...m}=d;c={...c,...m,...h}}return c};function a(c){t=c(e)}function o(c,u){const d=e.getProps(),f=e.getVariantContext(!0)||{},h=[],m=new Set;let g={},p=1/0;for(let b=0;b<B6;b++){const y=M6[b],x=r[y],N=d[y]!==void 0?d[y]:f[y],_=Oc(N),k=y===u?x.isActive:null;k===!1&&(p=b);let w=N===f[y]&&N!==d[y]&&_;if(w&&n&&e.manuallyAnimateOnMount&&(w=!1),x.protectedKeys={...g},!x.isActive&&k===null||!N&&!x.prevProp||df(N)||typeof N=="boolean")continue;let D=$6(x.prevProp,N)||y===u&&x.isActive&&!w&&_||b>p&&_,z=!1;const A=Array.isArray(N)?N:[N];let R=A.reduce(s,{});k===!1&&(R={});const{prevResolvedValues:G={}}=x,I={...G,...R},Z=j=>{D=!0,m.has(j)&&(z=!0,m.delete(j)),x.needsAnimating[j]=!0};for(const j in I){const Y=R[j],q=G[j];if(g.hasOwnProperty(j))continue;let S=!1;u0(Y)&&u0(q)?S=!ok(Y,q):S=Y!==q,S?Y!==void 0?Z(j):m.add(j):Y!==void 0&&m.has(j)?Z(j):x.protectedKeys[j]=!0}x.prevProp=N,x.prevResolvedValues=R,x.isActive&&(g={...g,...R}),n&&e.blockInitialAnimation&&(D=!1),D&&(!w||z)&&h.push(...A.map(j=>({animation:j,options:{type:y,...c}})))}if(m.size){const b={};m.forEach(y=>{const x=e.getBaseTarget(y);x!==void 0&&(b[y]=x)}),h.push({animation:b})}let v=!!h.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(v=!1),n=!1,v?t(h):Promise.resolve()}function l(c,u,d){var f;if(r[c].isActive===u)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),r[c].isActive=u;const h=o(d,c);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>r}}function $6(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!ok(t,e):!1}function oi(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function z6(){return{animate:oi(!0),whileInView:oi(),whileHover:oi(),whileTap:oi(),whileDrag:oi(),whileFocus:oi(),exit:oi()}}class H6 extends ri{constructor(t){super(t),t.animationState||(t.animationState=V6(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),df(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let W6=0;class G6 extends ri{constructor(){super(...arguments),this.id=W6++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const a=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&a.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const X6={animation:{Feature:H6},exit:{Feature:G6}},Mv=(e,t)=>Math.abs(e-t);function K6(e,t){const r=Mv(e.x,t.x),n=Mv(e.y,t.y);return Math.sqrt(r**2+n**2)}class Bk{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Nh(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=K6(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:g}=f,{timestamp:p}=Dr;this.history.push({...g,timestamp:p});const{onStart:v,onMove:b}=this.handlers;h||(v&&v(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=bh(h,this.transformPagePoint),bt.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:p}=this.handlers;if(this.dragSnapToOrigin&&p&&p(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=Nh(f.type==="pointercancel"?this.lastMoveEventInfo:bh(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,v),g&&g(f,v)},!rk(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const o=mf(t),l=bh(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=Dr;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(t,Nh(l,this.history)),this.removeListeners=za(Zs(this.contextWindow,"pointermove",this.handlePointerMove),Zs(this.contextWindow,"pointerup",this.handlePointerUp),Zs(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),oa(this.updatePoint)}}function bh(e,t){return t?{point:t(e.point)}:e}function Bv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Nh({point:e},t){return{point:e,delta:Bv(e,Uk(t)),offset:Bv(e,Y6(t)),velocity:q6(t,.1)}}function Y6(e){return e[0]}function Uk(e){return e[e.length-1]}function q6(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=Uk(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Ha(t)));)r--;if(!n)return{x:0,y:0};const a=Js(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const o={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Cn(e){return e.max-e.min}function Zm(e,t=0,r=.01){return Math.abs(e-t)<=r}function Uv(e,t,r,n=.5){e.origin=n,e.originPoint=Rt(t.min,t.max,e.origin),e.scale=Cn(r)/Cn(t),(Zm(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Rt(r.min,r.max,e.origin)-e.originPoint,(Zm(e.translate)||isNaN(e.translate))&&(e.translate=0)}function cc(e,t,r,n){Uv(e.x,t.x,r.x,n?n.originX:void 0),Uv(e.y,t.y,r.y,n?n.originY:void 0)}function Vv(e,t,r){e.min=r.min+t.min,e.max=e.min+Cn(t)}function Z6(e,t,r){Vv(e.x,t.x,r.x),Vv(e.y,t.y,r.y)}function $v(e,t,r){e.min=t.min-r.min,e.max=e.min+Cn(t)}function uc(e,t,r){$v(e.x,t.x,r.x),$v(e.y,t.y,r.y)}function J6(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Rt(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Rt(r,e,n.max):Math.min(e,r)),e}function zv(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function Q6(e,{top:t,left:r,bottom:n,right:s}){return{x:zv(e.x,r,s),y:zv(e.y,t,n)}}function Hv(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function e5(e,t){return{x:Hv(e.x,t.x),y:Hv(e.y,t.y)}}function t5(e,t){let r=.5;const n=Cn(e),s=Cn(t);return s>n?r=Bc(t.min,t.max-n,e.min):n>s&&(r=Bc(e.min,e.max-s,t.min)),Xa(0,1,r)}function r5(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Jm=.35;function n5(e=Jm){return e===!1?e=0:e===!0&&(e=Jm),{x:Wv(e,"left","right"),y:Wv(e,"top","bottom")}}function Wv(e,t,r){return{min:Gv(e,t),max:Gv(e,r)}}function Gv(e,t){return typeof e=="number"?e:e[t]||0}const Xv=()=>({translate:0,scale:1,origin:0,originPoint:0}),Po=()=>({x:Xv(),y:Xv()}),Kv=()=>({min:0,max:0}),rr=()=>({x:Kv(),y:Kv()});function Un(e){return[e("x"),e("y")]}function Vk({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function s5({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function a5(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function kh(e){return e===void 0||e===1}function Qm({scale:e,scaleX:t,scaleY:r}){return!kh(e)||!kh(t)||!kh(r)}function fi(e){return Qm(e)||$k(e)||e.z||e.rotate||e.rotateX||e.rotateY}function $k(e){return Yv(e.x)||Yv(e.y)}function Yv(e){return e&&e!=="0%"}function p0(e,t,r){const n=e-r,s=t*n;return r+s}function qv(e,t,r,n,s){return s!==void 0&&(e=p0(e,s,n)),p0(e,r,n)+t}function ep(e,t=0,r=1,n,s){e.min=qv(e.min,t,r,n,s),e.max=qv(e.max,t,r,n,s)}function zk(e,{x:t,y:r}){ep(e.x,t.translate,t.scale,t.originPoint),ep(e.y,r.translate,r.scale,r.originPoint)}function i5(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,o;for(let l=0;l<s;l++){a=r[l],o=a.projectionDelta;const c=a.instance;c&&c.style&&c.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Do(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,zk(e,o)),n&&fi(a.latestValues)&&Do(e,a.latestValues))}t.x=Zv(t.x),t.y=Zv(t.y)}function Zv(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function _a(e,t){e.min=e.min+t,e.max=e.max+t}function Jv(e,t,[r,n,s]){const a=t[s]!==void 0?t[s]:.5,o=Rt(e.min,e.max,a);ep(e,t[r],t[n],o,t.scale)}const o5=["x","scaleX","originX"],l5=["y","scaleY","originY"];function Do(e,t){Jv(e.x,t,o5),Jv(e.y,t,l5)}function Hk(e,t){return Vk(a5(e.getBoundingClientRect(),t))}function c5(e,t,r){const n=Hk(e,r),{scroll:s}=t;return s&&(_a(n.x,s.offset.x),_a(n.y,s.offset.y)),n}const Wk=({current:e})=>e?e.ownerDocument.defaultView:null,u5=new WeakMap;class d5{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=rr(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(mf(d,"page").point)},a=(d,f)=>{const{drag:h,dragPropagation:m,onDragStart:g}=this.getProps();if(h&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=sk(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Un(v=>{let b=this.getAxisMotionValue(v).get()||0;if(Rs.test(b)){const{projection:y}=this.visualElement;if(y&&y.layout){const x=y.layout.layoutBox[v];x&&(b=Cn(x)*(parseFloat(b)/100))}}this.originPoint[v]=b}),g&&bt.update(()=>g(d,f),!1,!0);const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},o=(d,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:g,onDrag:p}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:v}=f;if(m&&this.currentDirection===null){this.currentDirection=f5(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),p&&p(d,f)},l=(d,f)=>this.stop(d,f),c=()=>Un(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Bk(t,{onSessionStart:s,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:Wk(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:a}=this.getProps();a&&bt.update(()=>a(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!ed(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let o=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(o=J6(o,this.constraints[t],this.elastic[t])),a.set(o)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,a=this.constraints;r&&Ao(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=Q6(s.layoutBox,r):this.constraints=!1,this.elastic=n5(n),a!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Un(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=r5(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Ao(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=c5(n,s.root,this.visualElement.getTransformPagePoint());let o=e5(s.layout.layoutBox,a);if(r){const l=r(s5(o));this.hasMutatedConstraints=!!l,l&&(o=Vk(l))}return o}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Un(d=>{if(!ed(d,r,this.currentDirection))return;let f=c&&c[d]||{};o&&(f={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:n?t[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(Gx(t,n,0,r))}stopAnimation(){Un(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Un(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Un(r=>{const{drag:n}=this.getProps();if(!ed(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[r];a.set(t[r]-Rt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Ao(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Un(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=t5({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Un(o=>{if(!ed(o,t,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(Rt(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;u5.set(this.visualElement,this);const t=this.visualElement.current,r=Zs(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Ao(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),n();const o=Xs(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Un(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),r(),a(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:o=Jm,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function ed(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function f5(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class h5 extends ri{constructor(t){super(t),this.removeGroupControls=Wt,this.removeListeners=Wt,this.controls=new d5(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Wt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Qv=e=>(t,r)=>{e&&bt.update(()=>e(t,r))};class m5 extends ri{constructor(){super(...arguments),this.removePointerDownListener=Wt}onPointerDown(t){this.session=new Bk(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Wk(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:Qv(t),onStart:Qv(r),onMove:n,onEnd:(a,o)=>{delete this.session,s&&bt.update(()=>s(a,o))}}}mount(){this.removePointerDownListener=Zs(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function p5(){const e=E.useContext(cf);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,s=E.useId();return E.useEffect(()=>n(s),[]),!t&&r?[!1,()=>r&&r(s)]:[!0]}const Fd={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ey(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ol={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ze.test(e))e=parseFloat(e);else return e;const r=ey(e,t.target.x),n=ey(e,t.target.y);return`${r}% ${n}%`}},x5={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Ka.parse(e);if(s.length>5)return n;const a=Ka.createTransformer(e),o=typeof s[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;s[0+o]/=l,s[1+o]/=c;const u=Rt(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),a(s)}};class g5 extends xt.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;_T(v5),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Fd.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,o=n.projection;return o&&(o.isPresent=a,s||t.layoutDependency!==r||r===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?o.promote():o.relegate()||bt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Gk(e){const[t,r]=p5(),n=E.useContext(Px);return xt.createElement(g5,{...e,layoutGroup:n,switchLayoutGroup:E.useContext(VN),isPresent:t,safeToRemove:r})}const v5={borderRadius:{...Ol,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ol,borderTopRightRadius:Ol,borderBottomLeftRadius:Ol,borderBottomRightRadius:Ol,boxShadow:x5},Xk=["TopLeft","TopRight","BottomLeft","BottomRight"],y5=Xk.length,ty=e=>typeof e=="string"?parseFloat(e):e,ry=e=>typeof e=="number"||ze.test(e);function w5(e,t,r,n,s,a){s?(e.opacity=Rt(0,r.opacity!==void 0?r.opacity:1,b5(n)),e.opacityExit=Rt(t.opacity!==void 0?t.opacity:1,0,N5(n))):a&&(e.opacity=Rt(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let o=0;o<y5;o++){const l=`border${Xk[o]}Radius`;let c=ny(t,l),u=ny(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||ry(c)===ry(u)?(e[l]=Math.max(Rt(ty(c),ty(u),n),0),(Rs.test(u)||Rs.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||r.rotate)&&(e.rotate=Rt(t.rotate||0,r.rotate||0,n))}function ny(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const b5=Kk(0,.5,xk),N5=Kk(.5,.95,Wt);function Kk(e,t,r){return n=>n<e?0:n>t?1:r(Bc(e,t,n))}function sy(e,t){e.min=t.min,e.max=t.max}function Rn(e,t){sy(e.x,t.x),sy(e.y,t.y)}function ay(e,t,r,n,s){return e-=t,e=p0(e,1/r,n),s!==void 0&&(e=p0(e,1/s,n)),e}function k5(e,t=0,r=1,n=.5,s,a=e,o=e){if(Rs.test(t)&&(t=parseFloat(t),t=Rt(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=Rt(a.min,a.max,n);e===a&&(l-=t),e.min=ay(e.min,t,r,l,s),e.max=ay(e.max,t,r,l,s)}function iy(e,t,[r,n,s],a,o){k5(e,t[r],t[n],t[s],t.scale,a,o)}const _5=["x","scaleX","originX"],S5=["y","scaleY","originY"];function oy(e,t,r,n){iy(e.x,t,_5,r?r.x:void 0,n?n.x:void 0),iy(e.y,t,S5,r?r.y:void 0,n?n.y:void 0)}function ly(e){return e.translate===0&&e.scale===1}function Yk(e){return ly(e.x)&&ly(e.y)}function E5(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function qk(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function cy(e){return Cn(e.x)/Cn(e.y)}class C5{constructor(){this.members=[]}add(t){Xx(this.members,t),t.scheduleRender()}remove(t){if(Kx(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function uy(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y;if((s||a)&&(n=`translate3d(${s}px, ${a}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:u,rotateY:d}=r;c&&(n+=`rotate(${c}deg) `),u&&(n+=`rotateX(${u}deg) `),d&&(n+=`rotateY(${d}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const j5=(e,t)=>e.depth-t.depth;class T5{constructor(){this.children=[],this.isDirty=!1}add(t){Xx(this.children,t),this.isDirty=!0}remove(t){Kx(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(j5),this.isDirty=!1,this.children.forEach(t)}}function A5(e,t){const r=performance.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(oa(n),e(a-t))};return bt.read(n,!0),()=>oa(n)}function F5(e){window.MotionDebug&&window.MotionDebug.record(e)}function P5(e){return e instanceof SVGElement&&e.tagName!=="svg"}function D5(e,t,r){const n=pn(e)?e:tl(e);return n.start(Gx("",n,t,r)),n.animation}const dy=["","X","Y","Z"],I5={visibility:"hidden"},fy=1e3;let R5=0;const hi={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Zk({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},l=t==null?void 0:t()){this.id=R5++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,hi.totalNodes=hi.resolvedTargetDeltas=hi.recalculatedProjection=0,this.nodes.forEach(M5),this.nodes.forEach(z5),this.nodes.forEach(H5),this.nodes.forEach(B5),F5(hi)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new T5)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Yx),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=P5(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),e){let f;const h=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=A5(h,250),Fd.hasAnimatedSinceResize&&(Fd.hasAnimatedSinceResize=!1,this.nodes.forEach(my))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||d.getDefaultTransition()||Y5,{onLayoutAnimationStart:v,onLayoutAnimationComplete:b}=d.getProps(),y=!this.targetLayout||!qk(this.targetLayout,g)||m,x=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||h&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,x);const N={...Wx(p,"layout"),onPlay:v,onComplete:b};(d.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N)}else h||my(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,oa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(W5),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hy);return}this.isUpdating||this.nodes.forEach(V5),this.isUpdating=!1,this.nodes.forEach($5),this.nodes.forEach(L5),this.nodes.forEach(O5),this.clearAllSnapshots();const l=performance.now();Dr.delta=Xa(0,1e3/60,l-Dr.timestamp),Dr.timestamp=l,Dr.isProcessing=!0,hh.update.process(Dr),hh.preRender.process(Dr),hh.render.process(Dr),Dr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(U5),this.sharedNodes.forEach(G5)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,bt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){bt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=rr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!Yk(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||fi(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),q5(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return rr();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(_a(l.x,c.offset.x),_a(l.y,c.offset.y)),l}removeElementScroll(o){const l=rr();Rn(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:f}=u;if(u!==this.root&&d&&f.layoutScroll){if(d.isRoot){Rn(l,o);const{scroll:h}=this.root;h&&(_a(l.x,-h.offset.x),_a(l.y,-h.offset.y))}_a(l.x,d.offset.x),_a(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=rr();Rn(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Do(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),fi(d.latestValues)&&Do(c,d.latestValues)}return fi(this.latestValues)&&Do(c,this.latestValues),c}removeTransform(o){const l=rr();Rn(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!fi(u.latestValues))continue;Qm(u.latestValues)&&u.updateSnapshot();const d=rr(),f=u.measurePageBox();Rn(d,f),oy(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return fi(this.latestValues)&&oy(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Dr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=Dr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rr(),this.relativeTargetOrigin=rr(),uc(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Rn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=rr(),this.targetWithTransforms=rr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Z6(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Rn(this.target,this.layout.layoutBox),zk(this.target,this.targetDelta)):Rn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rr(),this.relativeTargetOrigin=rr(),uc(this.relativeTargetOrigin,this.target,m.target),Rn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}hi.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Qm(this.parent.latestValues)||$k(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Dr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;Rn(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;i5(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=Po(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Po(),this.projectionDeltaWithTransform=Po());const p=this.projectionTransform;cc(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=uy(this.projectionDelta,this.treeScale),(this.projectionTransform!==p||this.treeScale.x!==h||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),hi.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Po();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=rr(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,p=m!==g,v=this.getStack(),b=!v||v.members.length<=1,y=!!(p&&!b&&this.options.crossfade===!0&&!this.path.some(K5));this.animationProgress=0;let x;this.mixTargetDelta=N=>{const _=N/1e3;py(f.x,o.x,_),py(f.y,o.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(uc(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),X5(this.relativeTarget,this.relativeTargetOrigin,h,_),x&&E5(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=rr()),Rn(x,this.relativeTarget)),p&&(this.animationValues=d,w5(d,u,this.latestValues,_,y,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(oa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=bt.update(()=>{Fd.hasAnimatedSinceResize=!0,this.currentAnimation=D5(0,fy,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fy),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&Jk(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||rr();const f=Cn(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+f;const h=Cn(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+h}Rn(l,c),Do(l,d),cc(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new C5),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<dy.length;d++){const f="rotate"+dy[d];c[f]&&(u[f]=c[f],o.setStaticValue(f,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return I5;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Ad(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const p={};return this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=Ad(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!fi(this.latestValues)&&(p.transform=d?d({},""):"none",this.hasProjected=!1),p}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=uy(this.projectionDeltaWithTransform,this.treeScale,h),d&&(u.transform=d(h,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,f.animationValues?u.opacity=f===this?(c=(l=h.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const p in l0){if(h[p]===void 0)continue;const{correct:v,applyTo:b}=l0[p],y=u.transform==="none"?h[p]:v(h[p],f);if(b){const x=b.length;for(let N=0;N<x;N++)u[b[N]]=y}else u[p]=y}return this.options.layoutId&&(u.pointerEvents=f===this?Ad(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(hy),this.root.sharedNodes.clear()}}}function L5(e){e.updateLayout()}function O5(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:a}=e.options,o=r.source!==e.layout.source;a==="size"?Un(f=>{const h=o?r.measuredBox[f]:r.layoutBox[f],m=Cn(h);h.min=n[f].min,h.max=h.min+m}):Jk(a,r.layoutBox,n)&&Un(f=>{const h=o?r.measuredBox[f]:r.layoutBox[f],m=Cn(n[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const l=Po();cc(l,n,r.layoutBox);const c=Po();o?cc(c,e.applyTransform(s,!0),r.measuredBox):cc(c,n,r.layoutBox);const u=!Yk(l);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const g=rr();uc(g,r.layoutBox,h.layoutBox);const p=rr();uc(p,n,m.layoutBox),qk(g,p)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=g,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function M5(e){hi.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function B5(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function U5(e){e.clearSnapshot()}function hy(e){e.clearMeasurements()}function V5(e){e.isLayoutDirty=!1}function $5(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function my(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function z5(e){e.resolveTargetDelta()}function H5(e){e.calcProjection()}function W5(e){e.resetRotation()}function G5(e){e.removeLeadSnapshot()}function py(e,t,r){e.translate=Rt(t.translate,0,r),e.scale=Rt(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function xy(e,t,r,n){e.min=Rt(t.min,r.min,n),e.max=Rt(t.max,r.max,n)}function X5(e,t,r,n){xy(e.x,t.x,r.x,n),xy(e.y,t.y,r.y,n)}function K5(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Y5={duration:.45,ease:[.4,0,.1,1]},gy=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),vy=gy("applewebkit/")&&!gy("chrome/")?Math.round:Wt;function yy(e){e.min=vy(e.min),e.max=vy(e.max)}function q5(e){yy(e.x),yy(e.y)}function Jk(e,t,r){return e==="position"||e==="preserve-aspect"&&!Zm(cy(t),cy(r),.2)}const Z5=Zk({attachResizeListener:(e,t)=>Xs(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),_h={current:void 0},Qk=Zk({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!_h.current){const e=new Z5({});e.mount(window),e.setOptions({layoutScroll:!0}),_h.current=e}return _h.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),J5={pan:{Feature:m5},drag:{Feature:h5,ProjectionNode:Qk,MeasureLayout:Gk}},Q5=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function eF(e){const t=Q5.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function tp(e,t,r=1){const[n,s]=eF(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const o=a.trim();return Rk(o)?parseFloat(o):o}else return Hm(s)?tp(s,t,r+1):s}function tF(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(s=>{const a=s.get();if(!Hm(a))return;const o=tp(a,n);o&&s.set(o)});for(const s in t){const a=t[s];if(!Hm(a))continue;const o=tp(a,n);o&&(t[s]=o,r||(r={}),r[s]===void 0&&(r[s]=a))}return{target:t,transitionEnd:r}}const rF=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),e4=e=>rF.has(e),nF=e=>Object.keys(e).some(e4),wy=e=>e===eo||e===ze,by=(e,t)=>parseFloat(e.split(", ")[t]),Ny=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/);if(s)return by(s[1],t);{const a=n.match(/^matrix\((.+)\)$/);return a?by(a[1],e):0}},sF=new Set(["x","y","z"]),aF=lu.filter(e=>!sF.has(e));function iF(e){const t=[];return aF.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const rl={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:Ny(4,13),y:Ny(5,14)};rl.translateX=rl.x;rl.translateY=rl.y;const oF=(e,t,r)=>{const n=t.measureViewportBox(),s=t.current,a=getComputedStyle(s),{display:o}=a,l={};o==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(u=>{l[u]=rl[u](n,a)}),t.render();const c=t.measureViewportBox();return r.forEach(u=>{const d=t.getValue(u);d&&d.jump(l[u]),e[u]=rl[u](c,a)}),e},lF=(e,t,r={},n={})=>{t={...t},n={...n};const s=Object.keys(t).filter(e4);let a=[],o=!1;const l=[];if(s.forEach(c=>{const u=e.getValue(c);if(!e.hasValue(c))return;let d=r[c],f=Ll(d);const h=t[c];let m;if(u0(h)){const g=h.length,p=h[0]===null?1:0;d=h[p],f=Ll(d);for(let v=p;v<g&&h[v]!==null;v++)m?Ux(Ll(h[v])===m):m=Ll(h[v])}else m=Ll(h);if(f!==m)if(wy(f)&&wy(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof h=="string"?t[c]=parseFloat(h):Array.isArray(h)&&m===ze&&(t[c]=h.map(parseFloat))}else f!=null&&f.transform&&(m!=null&&m.transform)&&(d===0||h===0)?d===0?u.set(m.transform(d)):t[c]=f.transform(h):(o||(a=iF(e),o=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],u.jump(h))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=oF(t,e,l);return a.length&&a.forEach(([d,f])=>{e.getValue(d).set(f)}),e.render(),uf&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:n}}else return{target:t,transitionEnd:n}};function cF(e,t,r,n){return nF(t)?lF(e,t,r,n):{target:t,transitionEnd:n}}const uF=(e,t,r,n)=>{const s=tF(e,t,n);return t=s.target,n=s.transitionEnd,cF(e,t,r,n)},rp={current:null},t4={current:!1};function dF(){if(t4.current=!0,!!uf)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>rp.current=e.matches;e.addListener(t),t()}else rp.current=!1}function fF(e,t,r){const{willChange:n}=t;for(const s in t){const a=t[s],o=r[s];if(pn(a))e.addValue(s,a),m0(n)&&n.add(s);else if(pn(o))e.addValue(s,tl(a,{owner:e})),m0(n)&&n.remove(s);else if(o!==a)if(e.hasValue(s)){const l=e.getValue(s);!l.hasAnimated&&l.set(a)}else{const l=e.getStaticValue(s);e.addValue(s,tl(l!==void 0?l:a,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const ky=new WeakMap,r4=Object.keys(Mc),hF=r4.length,_y=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],mF=Fx.length;class pF{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>bt.render(this.render,!1,!0);const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=ff(r),this.isVariantNode=UN(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(r,{});for(const f in d){const h=d[f];l[f]!==void 0&&pn(h)&&(h.set(l[f],!1),m0(u)&&u.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,ky.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),t4.current||dF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:rp.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){ky.delete(this.current),this.projection&&this.projection.unmount(),oa(this.notifyUpdate),oa(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=Qi.has(t),s=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&bt.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),a=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{s(),a()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,s,a){let o,l;for(let c=0;c<hF;c++){const u=r4[c],{isEnabled:d,Feature:f,ProjectionNode:h,MeasureLayout:m}=Mc[u];h&&(o=h),d(r)&&(!this.features[u]&&f&&(this.features[u]=new f(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:f,layoutScroll:h,layoutRoot:m}=r;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||f&&Ao(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:a,layoutScroll:h,layoutRoot:m})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):rr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<_y.length;n++){const s=_y[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a=t["on"+s];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=fF(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<mF;n++){const s=Fx[n],a=this.props[s];(Oc(a)||a===!1)&&(r[s]=a)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=tl(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,s=typeof n=="string"||typeof n=="object"?(r=Bx(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&s!==void 0)return s;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!pn(a)?a:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Yx),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class n4 extends pF{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:s},a){let o=P6(n,t||{},this);if(s&&(r&&(r=s(r)),n&&(n=s(n)),o&&(o=s(o))),a){A6(this,n,o);const l=uF(this,n,o,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function xF(e){return window.getComputedStyle(e)}class gF extends n4{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(Qi.has(r)){const n=Hx(r);return n&&n.default||0}else{const n=xF(t),s=(HN(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return Hk(t,r)}build(t,r,n,s){Ix(t,r,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,r){return Mx(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;pn(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,s){qN(t,r,n,s)}}class vF extends n4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Qi.has(r)){const n=Hx(r);return n&&n.default||0}return r=ZN.has(r)?r:Tx(r),t.getAttribute(r)}measureInstanceViewportBox(){return rr()}scrapeMotionValuesFromProps(t,r){return QN(t,r)}build(t,r,n,s){Lx(t,r,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,r,n,s){JN(t,r,n,s)}mount(t){this.isSVGTag=Ox(t.tagName),super.mount(t)}}const yF=(e,t)=>Dx(e)?new vF(t,{enableHardwareAcceleration:!1}):new gF(t,{enableHardwareAcceleration:!0}),wF={layout:{ProjectionNode:Qk,MeasureLayout:Gk}},bF={...X6,...hA,...J5,...wF},Me=NT((e,t)=>eA(e,t,bF,yF));function s4(){const e=E.useRef(!1);return jx(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function NF(){const e=s4(),[t,r]=E.useState(0),n=E.useCallback(()=>{e.current&&r(t+1)},[t]);return[E.useCallback(()=>bt.postRender(n),[n]),t]}class kF extends E.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function _F({children:e,isPresent:t}){const r=E.useId(),n=E.useRef(null),s=E.useRef({width:0,height:0,top:0,left:0});return E.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=s.current;if(t||!n.current||!a||!o)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),E.createElement(kF,{isPresent:t,childRef:n,sizeRef:s},E.cloneElement(e,{ref:n}))}const Sh=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:o})=>{const l=ek(SF),c=E.useId(),u=E.useMemo(()=>({id:c,initial:t,isPresent:r,custom:s,onExitComplete:d=>{l.set(d,!0);for(const f of l.values())if(!f)return;n&&n()},register:d=>(l.set(d,!1),()=>l.delete(d))}),a?void 0:[r]);return E.useMemo(()=>{l.forEach((d,f)=>l.set(f,!1))},[r]),E.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),o==="popLayout"&&(e=E.createElement(_F,{isPresent:r},e)),E.createElement(cf.Provider,{value:u},e)};function SF(){return new Map}function EF(e){return E.useEffect(()=>()=>e(),[])}const mi=e=>e.key||"";function CF(e,t){e.forEach(r=>{const n=mi(r);t.set(n,r)})}function jF(e){const t=[];return E.Children.forEach(e,r=>{E.isValidElement(r)&&t.push(r)}),t}const dc=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:s,presenceAffectsLayout:a=!0,mode:o="sync"})=>{const l=E.useContext(Px).forceRender||NF()[0],c=s4(),u=jF(e);let d=u;const f=E.useRef(new Map).current,h=E.useRef(d),m=E.useRef(new Map).current,g=E.useRef(!0);if(jx(()=>{g.current=!1,CF(u,m),h.current=d}),EF(()=>{g.current=!0,m.clear(),f.clear()}),g.current)return E.createElement(E.Fragment,null,d.map(y=>E.createElement(Sh,{key:mi(y),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:a,mode:o},y)));d=[...d];const p=h.current.map(mi),v=u.map(mi),b=p.length;for(let y=0;y<b;y++){const x=p[y];v.indexOf(x)===-1&&!f.has(x)&&f.set(x,void 0)}return o==="wait"&&f.size&&(d=[]),f.forEach((y,x)=>{if(v.indexOf(x)!==-1)return;const N=m.get(x);if(!N)return;const _=p.indexOf(x);let k=y;if(!k){const w=()=>{f.delete(x);const C=Array.from(m.keys()).filter(D=>!v.includes(D));if(C.forEach(D=>m.delete(D)),h.current=u.filter(D=>{const z=mi(D);return z===x||C.includes(z)}),!f.size){if(c.current===!1)return;l(),n&&n()}};k=E.createElement(Sh,{key:mi(N),isPresent:!1,onExitComplete:w,custom:t,presenceAffectsLayout:a,mode:o},N),f.set(x,k)}d.splice(_,0,k)}),d=d.map(y=>{const x=y.key;return f.has(x)?y:E.createElement(Sh,{key:mi(y),isPresent:!0,presenceAffectsLayout:a,mode:o},y)}),E.createElement(E.Fragment,null,f.size?d:d.map(y=>E.cloneElement(y)))};function a4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=a4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function i4(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=a4(e))&&(n&&(n+=" "),n+=t);return n}function TF(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=o4(t))&&(n&&(n+=" "),n+=r);return n}function o4(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=o4(e[n]))&&(r&&(r+=" "),r+=t);return r}var qx="-";function AF(e){var t=PF(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,s=n===void 0?{}:n;function a(l){var c=l.split(qx);return c[0]===""&&c.length!==1&&c.shift(),l4(c,t)||FF(l)}function o(l,c){var u=r[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:a,getConflictingClassGroupIds:o}}function l4(e,t){var o;if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),s=n?l4(e.slice(1),n):void 0;if(s)return s;if(t.validators.length!==0){var a=e.join(qx);return(o=t.validators.find(function(l){var c=l.validator;return c(a)}))==null?void 0:o.classGroupId}}var Sy=/^\[(.+)\]$/;function FF(e){if(Sy.test(e)){var t=Sy.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function PF(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},s=IF(Object.entries(e.classGroups),r);return s.forEach(function(a){var o=a[0],l=a[1];np(l,n,o,t)}),n}function np(e,t,r,n){e.forEach(function(s){if(typeof s=="string"){var a=s===""?t:Ey(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(DF(s)){np(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];np(c,Ey(t,l),r,n)})})}function Ey(e,t){var r=e;return t.split(qx).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function DF(e){return e.isThemeGetter}function IF(e,t){return t?e.map(function(r){var n=r[0],s=r[1],a=s.map(function(o){return typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[t+c,u]})):o});return[n,a]}):e}function RF(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function s(a,o){r.set(a,o),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(o){var l=r.get(o);if(l!==void 0)return l;if((l=n.get(o))!==void 0)return s(o,l),l},set:function(o,l){r.has(o)?r.set(o,l):s(o,l)}}}var c4="!";function LF(e){var t=e.separator||":",r=t.length===1,n=t[0],s=t.length;return function(o){for(var l=[],c=0,u=0,d,f=0;f<o.length;f++){var h=o[f];if(c===0){if(h===n&&(r||o.slice(f,f+s)===t)){l.push(o.slice(u,f)),u=f+s;continue}if(h==="/"){d=f;continue}}h==="["?c++:h==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(c4),p=g?m.substring(1):m,v=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:p,maybePostfixModifierPosition:v}}}function OF(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var s=n[0]==="[";s?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function MF(e){return{cache:RF(e.cacheSize),splitModifiers:LF(e),...AF(e)}}var BF=/\s+/;function UF(e,t){var r=t.splitModifiers,n=t.getClassGroupId,s=t.getConflictingClassGroupIds,a=new Set;return e.trim().split(BF).map(function(o){var l=r(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,f=l.maybePostfixModifierPosition,h=n(f?d.substring(0,f):d),m=!!f;if(!h){if(!f)return{isTailwindClass:!1,originalClassName:o};if(h=n(d),!h)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=OF(c).join(":"),p=u?g+c4:g;return{isTailwindClass:!0,modifierId:p,classGroupId:h,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return a.has(d)?!1:(a.add(d),s(c,u).forEach(function(f){return a.add(l+f)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function VF(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,s,a,o=l;function l(u){var d=t[0],f=t.slice(1),h=f.reduce(function(m,g){return g(m)},d());return n=MF(h),s=n.cache.get,a=n.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var f=UF(u,n);return a(u,f),f}return function(){return o(TF.apply(null,arguments))}}function kt(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var u4=/^\[(?:([a-z-]+):)?(.+)\]$/i,$F=/^\d+\/\d+$/,zF=new Set(["px","full","screen"]),HF=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,WF=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,GF=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function is(e){return bi(e)||zF.has(e)||$F.test(e)||sp(e)}function sp(e){return to(e,"length",JF)}function XF(e){return to(e,"size",d4)}function KF(e){return to(e,"position",d4)}function YF(e){return to(e,"url",QF)}function td(e){return to(e,"number",bi)}function bi(e){return!Number.isNaN(Number(e))}function qF(e){return e.endsWith("%")&&bi(e.slice(0,-1))}function Ml(e){return Cy(e)||to(e,"number",Cy)}function nt(e){return u4.test(e)}function Bl(){return!0}function va(e){return HF.test(e)}function ZF(e){return to(e,"",eP)}function to(e,t,r){var n=u4.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function JF(e){return WF.test(e)}function d4(){return!1}function QF(e){return e.startsWith("url(")}function Cy(e){return Number.isInteger(Number(e))}function eP(e){return GF.test(e)}function tP(){var e=kt("colors"),t=kt("spacing"),r=kt("blur"),n=kt("brightness"),s=kt("borderColor"),a=kt("borderRadius"),o=kt("borderSpacing"),l=kt("borderWidth"),c=kt("contrast"),u=kt("grayscale"),d=kt("hueRotate"),f=kt("invert"),h=kt("gap"),m=kt("gradientColorStops"),g=kt("gradientColorStopPositions"),p=kt("inset"),v=kt("margin"),b=kt("opacity"),y=kt("padding"),x=kt("saturate"),N=kt("scale"),_=kt("sepia"),k=kt("skew"),w=kt("space"),C=kt("translate"),D=function(){return["auto","contain","none"]},z=function(){return["auto","hidden","clip","visible","scroll"]},A=function(){return["auto",nt,t]},R=function(){return[nt,t]},G=function(){return["",is]},I=function(){return["auto",bi,nt]},Z=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},j=function(){return["solid","dashed","dotted","double","none"]},Y=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},q=function(){return["start","end","center","between","around","evenly","stretch"]},S=function(){return["","0",nt]},F=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},L=function(){return[bi,td]},T=function(){return[bi,nt]};return{cacheSize:500,theme:{colors:[Bl],spacing:[is],blur:["none","",va,nt],brightness:L(),borderColor:[e],borderRadius:["none","","full",va,nt],borderSpacing:R(),borderWidth:G(),contrast:L(),grayscale:S(),hueRotate:T(),invert:S(),gap:R(),gradientColorStops:[e],gradientColorStopPositions:[qF,sp],inset:A(),margin:A(),opacity:L(),padding:R(),saturate:L(),scale:L(),sepia:S(),skew:T(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",nt]}],container:["container"],columns:[{columns:[va]}],"break-after":[{"break-after":F()}],"break-before":[{"break-before":F()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(Z(),[nt])}],overflow:[{overflow:z()}],"overflow-x":[{"overflow-x":z()}],"overflow-y":[{"overflow-y":z()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ml]}],basis:[{basis:A()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",nt]}],grow:[{grow:S()}],shrink:[{shrink:S()}],order:[{order:["first","last","none",Ml]}],"grid-cols":[{"grid-cols":[Bl]}],"col-start-end":[{col:["auto",{span:["full",Ml]},nt]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[Bl]}],"row-start-end":[{row:["auto",{span:[Ml]},nt]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",nt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",nt]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(q())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(q(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(q(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[w]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[w]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",nt,t]}],"min-w":[{"min-w":["min","max","fit",nt,is]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[va]},va,nt]}],h:[{h:[nt,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",nt,is]}],"max-h":[{"max-h":[nt,t,"min","max","fit"]}],"font-size":[{text:["base",va,sp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",td]}],"font-family":[{font:[Bl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",nt]}],"line-clamp":[{"line-clamp":["none",bi,td]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",nt,is]}],"list-image":[{"list-image":["none",nt]}],"list-style-type":[{list:["none","disc","decimal",nt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(j(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",is]}],"underline-offset":[{"underline-offset":["auto",nt,is]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",nt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",nt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(Z(),[KF])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",XF]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},YF]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[].concat(j(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:j()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(j())}],"outline-offset":[{"outline-offset":[nt,is]}],"outline-w":[{outline:[is]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:G()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[is]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",va,ZF]}],"shadow-color":[{shadow:[Bl]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":Y()}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",va,nt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[f]}],saturate:[{saturate:[x]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",nt]}],duration:[{duration:T()}],ease:[{ease:["linear","in","out","in-out",nt]}],delay:[{delay:T()}],animate:[{animate:["none","spin","ping","pulse","bounce",nt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Ml,nt]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",nt]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",nt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",nt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[is,td]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var rP=VF(tP);function Cr(...e){return rP(i4(e))}function bn(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function jy(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function f4(...e){return t=>{let r=!1;const n=e.map(s=>{const a=jy(s,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():jy(e[s],null)}}}}function Mi(...e){return E.useCallback(f4(...e),e)}function h4(e,t=[]){let r=[];function n(a,o){const l=E.createContext(o),c=r.length;r=[...r,o];const u=f=>{var b;const{scope:h,children:m,...g}=f,p=((b=h==null?void 0:h[e])==null?void 0:b[c])||l,v=E.useMemo(()=>g,Object.values(g));return i.jsx(p.Provider,{value:v,children:m})};u.displayName=a+"Provider";function d(f,h){var p;const m=((p=h==null?void 0:h[e])==null?void 0:p[c])||l,g=E.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${a}\``)}return[u,d]}const s=()=>{const a=r.map(o=>E.createContext(o));return function(l){const c=(l==null?void 0:l[e])||a;return E.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,nP(s,...t)]}function nP(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const o=n.reduce((l,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...l,...f}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function x0(e){const t=aP(e),r=E.forwardRef((n,s)=>{const{children:a,...o}=n,l=E.Children.toArray(a),c=l.find(oP);if(c){const u=c.props.children,d=l.map(f=>f===c?E.Children.count(u)>1?E.Children.only(null):E.isValidElement(u)?u.props.children:null:f);return i.jsx(t,{...o,ref:s,children:E.isValidElement(u)?E.cloneElement(u,void 0,d):null})}return i.jsx(t,{...o,ref:s,children:a})});return r.displayName=`${e}.Slot`,r}var sP=x0("Slot");function aP(e){const t=E.forwardRef((r,n)=>{const{children:s,...a}=r;if(E.isValidElement(s)){const o=cP(s),l=lP(a,s.props);return s.type!==E.Fragment&&(l.ref=n?f4(n,o):o),E.cloneElement(s,l)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var iP=Symbol("radix.slottable");function oP(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===iP}function lP(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...l)=>{const c=a(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function cP(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function uP(e){const t=e+"CollectionProvider",[r,n]=h4(t),[s,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:v,children:b}=p,y=xt.useRef(null),x=xt.useRef(new Map).current;return i.jsx(s,{scope:v,itemMap:x,collectionRef:y,children:b})};o.displayName=t;const l=e+"CollectionSlot",c=x0(l),u=xt.forwardRef((p,v)=>{const{scope:b,children:y}=p,x=a(l,b),N=Mi(v,x.collectionRef);return i.jsx(c,{ref:N,children:y})});u.displayName=l;const d=e+"CollectionItemSlot",f="data-radix-collection-item",h=x0(d),m=xt.forwardRef((p,v)=>{const{scope:b,children:y,...x}=p,N=xt.useRef(null),_=Mi(v,N),k=a(d,b);return xt.useEffect(()=>(k.itemMap.set(N,{ref:N,...x}),()=>void k.itemMap.delete(N))),i.jsx(h,{[f]:"",ref:_,children:y})});m.displayName=d;function g(p){const v=a(e+"CollectionConsumer",p);return xt.useCallback(()=>{const y=v.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${f}]`));return Array.from(v.itemMap.values()).sort((k,w)=>x.indexOf(k.ref.current)-x.indexOf(w.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,n]}var dP=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ms=dP.reduce((e,t)=>{const r=x0(`Primitive.${t}`),n=E.forwardRef((s,a)=>{const{asChild:o,...l}=s,c=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),i.jsx(c,{...l,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function m4(e,t){e&&of.flushSync(()=>e.dispatchEvent(t))}function Bi(e){const t=E.useRef(e);return E.useEffect(()=>{t.current=e}),E.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function fP(e,t=globalThis==null?void 0:globalThis.document){const r=Bi(e);E.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var hP="DismissableLayer",ap="dismissableLayer.update",mP="dismissableLayer.pointerDownOutside",pP="dismissableLayer.focusOutside",Ty,p4=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),x4=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,onDismiss:l,...c}=e,u=E.useContext(p4),[d,f]=E.useState(null),h=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),g=Mi(t,w=>f(w)),p=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=p.indexOf(v),y=d?p.indexOf(d):-1,x=u.layersWithOutsidePointerEventsDisabled.size>0,N=y>=b,_=gP(w=>{const C=w.target,D=[...u.branches].some(z=>z.contains(C));!N||D||(s==null||s(w),o==null||o(w),w.defaultPrevented||l==null||l())},h),k=vP(w=>{const C=w.target;[...u.branches].some(z=>z.contains(C))||(a==null||a(w),o==null||o(w),w.defaultPrevented||l==null||l())},h);return fP(w=>{y===u.layers.size-1&&(n==null||n(w),!w.defaultPrevented&&l&&(w.preventDefault(),l()))},h),E.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Ty=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),Ay(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Ty)}},[d,h,r,u]),E.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),Ay())},[d,u]),E.useEffect(()=>{const w=()=>m({});return document.addEventListener(ap,w),()=>document.removeEventListener(ap,w)},[]),i.jsx(Ms.div,{...c,ref:g,style:{pointerEvents:x?N?"auto":"none":void 0,...e.style},onFocusCapture:bn(e.onFocusCapture,k.onFocusCapture),onBlurCapture:bn(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:bn(e.onPointerDownCapture,_.onPointerDownCapture)})});x4.displayName=hP;var xP="DismissableLayerBranch",g4=E.forwardRef((e,t)=>{const r=E.useContext(p4),n=E.useRef(null),s=Mi(t,n);return E.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),i.jsx(Ms.div,{...e,ref:s})});g4.displayName=xP;function gP(e,t=globalThis==null?void 0:globalThis.document){const r=Bi(e),n=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let c=function(){v4(mP,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function vP(e,t=globalThis==null?void 0:globalThis.document){const r=Bi(e),n=E.useRef(!1);return E.useEffect(()=>{const s=a=>{a.target&&!n.current&&v4(pP,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Ay(){const e=new CustomEvent(ap);document.dispatchEvent(e)}function v4(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?m4(s,a):s.dispatchEvent(a)}var yP=x4,wP=g4,Uc=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},bP="Portal",y4=E.forwardRef((e,t)=>{var l;const{container:r,...n}=e,[s,a]=E.useState(!1);Uc(()=>a(!0),[]);const o=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?fT.createPortal(i.jsx(Ms.div,{...n,ref:t}),o):null});y4.displayName=bP;function NP(e,t){return E.useReducer((r,n)=>t[r][n]??r,e)}var w4=e=>{const{present:t,children:r}=e,n=kP(t),s=typeof r=="function"?r({present:n.isPresent}):E.Children.only(r),a=Mi(n.ref,_P(s));return typeof r=="function"||n.isPresent?E.cloneElement(s,{ref:a}):null};w4.displayName="Presence";function kP(e){const[t,r]=E.useState(),n=E.useRef(null),s=E.useRef(e),a=E.useRef("none"),o=e?"mounted":"unmounted",[l,c]=NP(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const u=rd(n.current);a.current=l==="mounted"?u:"none"},[l]),Uc(()=>{const u=n.current,d=s.current;if(d!==e){const h=a.current,m=rd(u);e?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Uc(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,f=m=>{const p=rd(n.current).includes(m.animationName);if(m.target===t&&p&&(c("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(a.current=rd(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:E.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function rd(e){return(e==null?void 0:e.animationName)||"none"}function _P(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var SP=tj[" useInsertionEffect ".trim().toString()]||Uc;function EP({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,a,o]=CP({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:s;{const d=E.useRef(e!==void 0);E.useEffect(()=>{const f=d.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const u=E.useCallback(d=>{var f;if(l){const h=jP(d)?d(e):d;h!==e&&((f=o.current)==null||f.call(o,h))}else a(d)},[l,e,a,o]);return[c,u]}function CP({defaultProp:e,onChange:t}){const[r,n]=E.useState(e),s=E.useRef(r),a=E.useRef(t);return SP(()=>{a.current=t},[t]),E.useEffect(()=>{var o;s.current!==r&&((o=a.current)==null||o.call(a,r),s.current=r)},[r,s]),[r,n,a]}function jP(e){return typeof e=="function"}var TP=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),AP="VisuallyHidden",Zx=E.forwardRef((e,t)=>i.jsx(Ms.span,{...e,ref:t,style:{...TP,...e.style}}));Zx.displayName=AP;var Jx="ToastProvider",[Qx,FP,PP]=uP("Toast"),[b4,EX]=h4("Toast",[PP]),[DP,xf]=b4(Jx),N4=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:a=50,children:o}=e,[l,c]=E.useState(null),[u,d]=E.useState(0),f=E.useRef(!1),h=E.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${Jx}\`. Expected non-empty \`string\`.`),i.jsx(Qx.Provider,{scope:t,children:i.jsx(DP,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:a,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:E.useCallback(()=>d(m=>m+1),[]),onToastRemove:E.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:o})})};N4.displayName=Jx;var k4="ToastViewport",IP=["F8"],ip="toast.viewportPause",op="toast.viewportResume",_4=E.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=IP,label:s="Notifications ({hotkey})",...a}=e,o=xf(k4,r),l=FP(r),c=E.useRef(null),u=E.useRef(null),d=E.useRef(null),f=E.useRef(null),h=Mi(t,f,o.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;E.useEffect(()=>{const v=b=>{var x;n.length!==0&&n.every(N=>b[N]||b.code===N)&&((x=f.current)==null||x.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n]),E.useEffect(()=>{const v=c.current,b=f.current;if(g&&v&&b){const y=()=>{if(!o.isClosePausedRef.current){const k=new CustomEvent(ip);b.dispatchEvent(k),o.isClosePausedRef.current=!0}},x=()=>{if(o.isClosePausedRef.current){const k=new CustomEvent(op);b.dispatchEvent(k),o.isClosePausedRef.current=!1}},N=k=>{!v.contains(k.relatedTarget)&&x()},_=()=>{v.contains(document.activeElement)||x()};return v.addEventListener("focusin",y),v.addEventListener("focusout",N),v.addEventListener("pointermove",y),v.addEventListener("pointerleave",_),window.addEventListener("blur",y),window.addEventListener("focus",x),()=>{v.removeEventListener("focusin",y),v.removeEventListener("focusout",N),v.removeEventListener("pointermove",y),v.removeEventListener("pointerleave",_),window.removeEventListener("blur",y),window.removeEventListener("focus",x)}}},[g,o.isClosePausedRef]);const p=E.useCallback(({tabbingDirection:v})=>{const y=l().map(x=>{const N=x.ref.current,_=[N,...XP(N)];return v==="forwards"?_:_.reverse()});return(v==="forwards"?y.reverse():y).flat()},[l]);return E.useEffect(()=>{const v=f.current;if(v){const b=y=>{var _,k,w;const x=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!x){const C=document.activeElement,D=y.shiftKey;if(y.target===v&&D){(_=u.current)==null||_.focus();return}const R=p({tabbingDirection:D?"backwards":"forwards"}),G=R.findIndex(I=>I===C);Eh(R.slice(G+1))?y.preventDefault():D?(k=u.current)==null||k.focus():(w=d.current)==null||w.focus()}};return v.addEventListener("keydown",b),()=>v.removeEventListener("keydown",b)}},[l,p]),i.jsxs(wP,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&i.jsx(lp,{ref:u,onFocusFromOutsideViewport:()=>{const v=p({tabbingDirection:"forwards"});Eh(v)}}),i.jsx(Qx.Slot,{scope:r,children:i.jsx(Ms.ol,{tabIndex:-1,...a,ref:h})}),g&&i.jsx(lp,{ref:d,onFocusFromOutsideViewport:()=>{const v=p({tabbingDirection:"backwards"});Eh(v)}})]})});_4.displayName=k4;var S4="ToastFocusProxy",lp=E.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,a=xf(S4,r);return i.jsx(Zx,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=a.viewport)!=null&&u.contains(l))&&n()}})});lp.displayName=S4;var fu="Toast",RP="toast.swipeStart",LP="toast.swipeMove",OP="toast.swipeCancel",MP="toast.swipeEnd",E4=E.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:a,...o}=e,[l,c]=EP({prop:n,defaultProp:s??!0,onChange:a,caller:fu});return i.jsx(w4,{present:r||l,children:i.jsx(VP,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:Bi(e.onPause),onResume:Bi(e.onResume),onSwipeStart:bn(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:bn(e.onSwipeMove,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:bn(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:bn(e.onSwipeEnd,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});E4.displayName=fu;var[BP,UP]=b4(fu,{onClose(){}}),VP=E.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:a,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:m,...g}=e,p=xf(fu,r),[v,b]=E.useState(null),y=Mi(t,I=>b(I)),x=E.useRef(null),N=E.useRef(null),_=s||p.duration,k=E.useRef(0),w=E.useRef(_),C=E.useRef(0),{onToastAdd:D,onToastRemove:z}=p,A=Bi(()=>{var Z;(v==null?void 0:v.contains(document.activeElement))&&((Z=p.viewport)==null||Z.focus()),o()}),R=E.useCallback(I=>{!I||I===1/0||(window.clearTimeout(C.current),k.current=new Date().getTime(),C.current=window.setTimeout(A,I))},[A]);E.useEffect(()=>{const I=p.viewport;if(I){const Z=()=>{R(w.current),u==null||u()},j=()=>{const Y=new Date().getTime()-k.current;w.current=w.current-Y,window.clearTimeout(C.current),c==null||c()};return I.addEventListener(ip,j),I.addEventListener(op,Z),()=>{I.removeEventListener(ip,j),I.removeEventListener(op,Z)}}},[p.viewport,_,c,u,R]),E.useEffect(()=>{a&&!p.isClosePausedRef.current&&R(_)},[a,_,p.isClosePausedRef,R]),E.useEffect(()=>(D(),()=>z()),[D,z]);const G=E.useMemo(()=>v?D4(v):null,[v]);return p.viewport?i.jsxs(i.Fragment,{children:[G&&i.jsx($P,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:G}),i.jsx(BP,{scope:r,onClose:A,children:of.createPortal(i.jsx(Qx.ItemSlot,{scope:r,children:i.jsx(yP,{asChild:!0,onEscapeKeyDown:bn(l,()=>{p.isFocusedToastEscapeKeyDownRef.current||A(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:i.jsx(Ms.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":p.swipeDirection,...g,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:bn(e.onKeyDown,I=>{I.key==="Escape"&&(l==null||l(I.nativeEvent),I.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,A()))}),onPointerDown:bn(e.onPointerDown,I=>{I.button===0&&(x.current={x:I.clientX,y:I.clientY})}),onPointerMove:bn(e.onPointerMove,I=>{if(!x.current)return;const Z=I.clientX-x.current.x,j=I.clientY-x.current.y,Y=!!N.current,q=["left","right"].includes(p.swipeDirection),S=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,F=q?S(0,Z):0,L=q?0:S(0,j),T=I.pointerType==="touch"?10:2,U={x:F,y:L},X={originalEvent:I,delta:U};Y?(N.current=U,nd(LP,f,X,{discrete:!1})):Fy(U,p.swipeDirection,T)?(N.current=U,nd(RP,d,X,{discrete:!1}),I.target.setPointerCapture(I.pointerId)):(Math.abs(Z)>T||Math.abs(j)>T)&&(x.current=null)}),onPointerUp:bn(e.onPointerUp,I=>{const Z=N.current,j=I.target;if(j.hasPointerCapture(I.pointerId)&&j.releasePointerCapture(I.pointerId),N.current=null,x.current=null,Z){const Y=I.currentTarget,q={originalEvent:I,delta:Z};Fy(Z,p.swipeDirection,p.swipeThreshold)?nd(MP,m,q,{discrete:!0}):nd(OP,h,q,{discrete:!0}),Y.addEventListener("click",S=>S.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),$P=e=>{const{__scopeToast:t,children:r,...n}=e,s=xf(fu,t),[a,o]=E.useState(!1),[l,c]=E.useState(!1);return WP(()=>o(!0)),E.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:i.jsx(y4,{asChild:!0,children:i.jsx(Zx,{...n,children:a&&i.jsxs(i.Fragment,{children:[s.label," ",r]})})})},zP="ToastTitle",C4=E.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return i.jsx(Ms.div,{...n,ref:t})});C4.displayName=zP;var HP="ToastDescription",j4=E.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return i.jsx(Ms.div,{...n,ref:t})});j4.displayName=HP;var T4="ToastAction",A4=E.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?i.jsx(P4,{altText:r,asChild:!0,children:i.jsx(eg,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${T4}\`. Expected non-empty \`string\`.`),null)});A4.displayName=T4;var F4="ToastClose",eg=E.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=UP(F4,r);return i.jsx(P4,{asChild:!0,children:i.jsx(Ms.button,{type:"button",...n,ref:t,onClick:bn(e.onClick,s.onClose)})})});eg.displayName=F4;var P4=E.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return i.jsx(Ms.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function D4(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),GP(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",a=n.dataset.radixToastAnnounceExclude==="";if(!s)if(a){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...D4(n))}}),t}function nd(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?m4(s,a):s.dispatchEvent(a)}var Fy=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),a=n>s;return t==="left"||t==="right"?a&&n>r:!a&&s>r};function WP(e=()=>{}){const t=Bi(e);Uc(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function GP(e){return e.nodeType===e.ELEMENT_NODE}function XP(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Eh(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var KP=N4,I4=_4,R4=E4,L4=C4,O4=j4,M4=A4,B4=eg;const Py=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Dy=i4,tg=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return Dy(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:a}=t,o=Object.keys(s).map(u=>{const d=r==null?void 0:r[u],f=a==null?void 0:a[u];if(d===null)return null;const h=Py(d)||Py(f);return s[u][h]}),l=r&&Object.entries(r).reduce((u,d)=>{let[f,h]=d;return h===void 0||(u[f]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:h,...m}=d;return Object.entries(m).every(g=>{let[p,v]=g;return Array.isArray(v)?v.includes({...a,...l}[p]):{...a,...l}[p]===v})?[...u,f,h]:u},[]);return Dy(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};var YP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ie=(e,t)=>{const r=E.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,children:l,...c},u)=>E.createElement("svg",{ref:u,...YP,width:s,height:s,stroke:n,strokeWidth:o?Number(a)*24/Number(s):a,className:`lucide lucide-${qP(e)}`,...c},[...t.map(([d,f])=>E.createElement(d,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},Ui=Ie("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ZP=Ie("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Vi=Ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Iy=Ie("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Ch=Ie("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),rg=Ie("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),JP=Ie("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),la=Ie("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),jh=Ie("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),ca=Ie("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Xn=Ie("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),U4=Ie("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),$t=Ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),V4=Ie("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),$4=Ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),qt=Ie("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ng=Ie("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),Vc=Ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),nl=Ie("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Ry=Ie("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),Ly=Ie("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),fl=Ie("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ua=Ie("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),cp=Ie("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),g0=Ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),QP=Ie("FileSignature",[["path",{d:"M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L18 5.5",key:"kd5d3"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z",key:"johvi5"}]]),Th=Ie("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),gr=Ie("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),$c=Ie("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),eD=Ie("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Oy=Ie("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),tD=Ie("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),Ut=Ie("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),up=Ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),rD=Ie("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),nD=Ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),z4=Ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),v0=Ie("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),sD=Ie("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Qr=Ie("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Bs=Ie("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),As=Ie("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),aD=Ie("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),ur=Ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),hu=Ie("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),dp=Ie("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),iD=Ie("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),xn=Ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),$i=Ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),oD=Ie("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),jn=Ie("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),lD=Ie("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),cD=Ie("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),uD=Ie("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),ha=Ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),hl=Ie("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),My=Ie("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),fp=Ie("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ls=Ie("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),dD=Ie("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Mr=Ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Qn=Ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),gf=Ie("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),H4=Ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),fD=Ie("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),hD=KP,W4=xt.forwardRef(({className:e,...t},r)=>i.jsx(I4,{ref:r,className:Cr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));W4.displayName=I4.displayName;const mD=tg("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),G4=xt.forwardRef(({className:e,variant:t,...r},n)=>i.jsx(R4,{ref:n,className:Cr(mD({variant:t}),e),...r}));G4.displayName=R4.displayName;const pD=xt.forwardRef(({className:e,...t},r)=>i.jsx(M4,{ref:r,className:Cr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));pD.displayName=M4.displayName;const X4=xt.forwardRef(({className:e,...t},r)=>i.jsx(B4,{ref:r,className:Cr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:i.jsx(H4,{className:"h-4 w-4"})}));X4.displayName=B4.displayName;const K4=xt.forwardRef(({className:e,...t},r)=>i.jsx(L4,{ref:r,className:Cr("text-sm font-semibold",e),...t}));K4.displayName=L4.displayName;const Y4=xt.forwardRef(({className:e,...t},r)=>i.jsx(O4,{ref:r,className:Cr("text-sm opacity-90",e),...t}));Y4.displayName=O4.displayName;const xD=1;let Ah=0;function gD(){return Ah=(Ah+1)%Number.MAX_VALUE,Ah.toString()}const Kr={state:{toasts:[]},listeners:[],getState:()=>Kr.state,setState:e=>{typeof e=="function"?Kr.state=e(Kr.state):Kr.state={...Kr.state,...e},Kr.listeners.forEach(t=>t(Kr.state))},subscribe:e=>(Kr.listeners.push(e),()=>{Kr.listeners=Kr.listeners.filter(t=>t!==e)})},ge=({...e})=>{const t=gD(),r=s=>Kr.setState(a=>({...a,toasts:a.toasts.map(o=>o.id===t?{...o,...s}:o)})),n=()=>Kr.setState(s=>({...s,toasts:s.toasts.filter(a=>a.id!==t)}));return Kr.setState(s=>({...s,toasts:[{...e,id:t,dismiss:n},...s.toasts].slice(0,xD)})),{id:t,dismiss:n,update:r}};function vD(){const[e,t]=E.useState(Kr.getState());return E.useEffect(()=>Kr.subscribe(n=>{t(n)}),[]),E.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const s=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(s)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:ge,toasts:e.toasts}}function By(){const{toasts:e}=vD();return i.jsxs(hD,{children:[e.map(({id:t,title:r,description:n,action:s,...a})=>i.jsxs(G4,{...a,children:[i.jsxs("div",{className:"grid gap-1",children:[r&&i.jsx(K4,{children:r}),n&&i.jsx(Y4,{children:n})]}),s,i.jsx(X4,{})]},t)),i.jsx(W4,{})]})}const yD=tg("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),oe=xt.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},a)=>{const o=n?sP:"button";return i.jsx(o,{className:Cr(yD({variant:t,size:r,className:e})),ref:a,...s})});oe.displayName="Button";const wD=({activeTab:e,setActiveTab:t,collapsed:r,setCollapsed:n,currentBranch:s})=>{const a=[{id:"dashboard",label:"แดชบอร์ด",icon:tD},{id:"branches",label:"จัดการสาขา",icon:la},{id:"products",label:"จัดการสินค้า",icon:Qr},{id:"contracts",label:"รายการสัญญา",icon:ng},{id:"payments",label:"ค่างวด",icon:ca},{id:"returns",label:"รับคืนสินค้า",icon:dp},{id:"customers",label:"ลูกค้า",icon:Qn},{id:"employees",label:"พนักงานขาย",icon:Ls},{id:"salespeople",label:"พนักงานเก็บเงิน",icon:Qn},{id:"checkers",label:"เช็คเกอร์",icon:jn},{id:"sales-index",label:"สารบัญการขาย",icon:hl},{id:"import-data",label:"Import ข้อมูล",icon:fp},{id:"admin-users",label:"จัดการผู้ใช้งาน",icon:Ls},{id:"settings",label:"ตั้งค่า",icon:$i}];return i.jsx(Me.div,{initial:{x:-250},animate:{x:0,width:r?64:256},transition:{duration:.3},className:"fixed left-0 top-0 h-full bg-white border-r border-gray-200 shadow-lg z-50",children:i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[!r&&i.jsxs(Me.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center",children:i.jsx(nl,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-gray-800",children:"Admin Panel"}),i.jsx("p",{className:"text-xs text-gray-500",children:"ระบบผ่อนสินค้า"})]})]}),i.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>n(!r),className:"p-1.5 hover:bg-gray-100",children:r?i.jsx($4,{className:"w-4 h-4"}):i.jsx(V4,{className:"w-4 h-4"})})]})}),!r&&s&&i.jsx("div",{className:"p-3 bg-gradient-to-r from-emerald-50 to-teal-50 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[i.jsx(la,{className:"w-4 h-4 text-emerald-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"font-medium text-emerald-800 truncate",children:s.name}),i.jsx("div",{className:"text-xs text-emerald-600 truncate",children:s.address})]})]})}),i.jsx("nav",{className:"flex-1 p-2 space-y-1 overflow-y-auto sidebar-scrollbar",children:a.map(o=>{const l=o.icon,c=e===o.id;return i.jsxs(oe,{variant:c?"default":"ghost",onClick:()=>t(o.id),className:`w-full justify-start gap-3 h-10 ${r?"px-2":"px-3"} ${c?"bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-md":"hover:bg-gray-100 text-gray-700"}`,children:[i.jsx(l,{className:`${r?"w-5 h-5":"w-4 h-4"} flex-shrink-0`}),!r&&i.jsx("span",{className:"text-sm font-medium",children:o.label})]},o.id)})}),i.jsx("div",{className:"p-4 border-t border-gray-200",children:!r&&i.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-3",children:[i.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"ระบบผ่อนสินค้า v1.0"}),i.jsx("div",{className:"text-xs text-gray-500",children:"พัฒนาโดย wooyou creative"})]})})]})})},bD=({sidebarCollapsed:e,setSidebarCollapsed:t,branches:r,selectedBranch:n,setSelectedBranch:s,currentBranch:a,currentUser:o,onLogout:l})=>{const[c,u]=E.useState(!1),[d,f]=E.useState(!1),h=m=>{s(m),u(!1)};return i.jsx(Me.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>t(!e),className:"lg:hidden",children:i.jsx(sD,{className:"w-5 h-5"})}),i.jsxs("div",{className:"relative",children:[i.jsxs(oe,{variant:"outline",onClick:()=>u(!c),className:"branch-selector flex items-center gap-2 min-w-[200px] max-w-[300px] justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[i.jsx(la,{className:"w-4 h-4 flex-shrink-0"}),i.jsx("span",{className:"font-medium truncate",children:(a==null?void 0:a.name)||"เลือกสาขา"})]}),i.jsx($t,{className:"w-4 h-4 flex-shrink-0"})]}),i.jsx(dc,{children:c&&i.jsx(Me.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 mt-2 w-full max-w-[400px] bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:i.jsx("div",{className:"p-2",children:r.map(m=>i.jsxs(oe,{variant:"ghost",onClick:()=>h(m.id),className:`w-full justify-start gap-2 h-auto py-2 ${m.id===n?"bg-emerald-50 text-emerald-700":""}`,children:[i.jsx(v0,{className:"w-4 h-4 flex-shrink-0"}),i.jsxs("div",{className:"text-left min-w-0 flex-1",children:[i.jsx("div",{className:"font-medium truncate",children:m.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:m.address})]})]},m.id))})})})]}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหา...",className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent w-64"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(oe,{variant:"ghost",size:"sm",className:"relative",children:[i.jsx(rg,{className:"w-5 h-5"}),i.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full text-xs"})]}),i.jsx(oe,{variant:"ghost",size:"sm",children:i.jsx($i,{className:"w-5 h-5"})}),i.jsxs("div",{className:"relative",children:[i.jsxs(oe,{variant:"ghost",onClick:()=>f(!d),className:"flex items-center gap-3 pl-3 border-l border-gray-200",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-medium text-gray-800",children:(o==null?void 0:o.full_name)||(o==null?void 0:o.username)||"ผู้ดูแลระบบ"}),i.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[i.jsx(jn,{className:"w-3 h-3"}),(o==null?void 0:o.role)==="super_admin"?"Super Admin":(o==null?void 0:o.role)==="admin"?"Admin":(o==null?void 0:o.role)==="manager"?"Manager":"User"]})]}),i.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white font-medium text-sm",children:((o==null?void 0:o.full_name)||(o==null?void 0:o.username)||"A").charAt(0).toUpperCase()})}),i.jsx($t,{className:"w-4 h-4 text-gray-400"})]}),i.jsx(dc,{children:d&&i.jsxs(Me.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[i.jsx("div",{className:"font-medium text-gray-900",children:(o==null?void 0:o.full_name)||(o==null?void 0:o.username)}),i.jsx("div",{className:"text-sm text-gray-500",children:o==null?void 0:o.email}),i.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["สาขา: ",(o==null?void 0:o.branch_name)||(a==null?void 0:a.name)||"ทุกสาขา"]})]}),i.jsxs("div",{className:"py-1",children:[i.jsxs("button",{onClick:()=>{f(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[i.jsx(Mr,{className:"w-4 h-4"}),"โปรไฟล์"]}),i.jsxs("button",{onClick:()=>{f(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[i.jsx($i,{className:"w-4 h-4"}),"การตั้งค่า"]})]}),i.jsx("div",{className:"border-t border-gray-100 py-1",children:i.jsxs("button",{onClick:()=>{f(!1),l()},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(nD,{className:"w-4 h-4"}),"ออกจากระบบ"]})})]})})]})]})]})})},Uy=({products:e,installmentPlans:t,customers:r,employees:n,checkers:s})=>{const a=(e==null?void 0:e.length)||0,o=(t==null?void 0:t.length)||0,l=(r==null?void 0:r.length)||0,c=(n==null?void 0:n.length)||0,u=(s==null?void 0:s.length)||0,d=(n==null?void 0:n.filter(x=>x.isCheckedIn).length)||0,f=(e==null?void 0:e.reduce((x,N)=>x+N.price,0))||0,h=(t==null?void 0:t.flatMap(x=>x.payments))||[],m=h.filter(x=>x.status==="paid"),g=h.filter(x=>x.status==="pending"),p=h.filter(x=>x.status==="paid"?!1:new Date(x.dueDate)<new Date),v=m.reduce((x,N)=>x+N.amount,0),b=[{title:"สินค้าทั้งหมด",value:a,icon:Qr,color:"from-blue-500 to-blue-600",bgColor:"bg-blue-50",textColor:"text-blue-600"},{title:"แผนการผ่อน",value:o,icon:nl,color:"from-purple-500 to-purple-600",bgColor:"bg-purple-50",textColor:"text-purple-600"},{title:"ลูกค้าทั้งหมด",value:l,icon:Qn,color:"from-indigo-500 to-indigo-600",bgColor:"bg-indigo-50",textColor:"text-indigo-600"},{title:"พนักงานเข้างาน",value:`${d}/${c}`,icon:Ls,color:"from-green-500 to-green-600",bgColor:"bg-green-50",textColor:"text-green-600"},{title:"มูลค่ารวม",value:`฿${f.toLocaleString()}`,icon:fl,color:"from-yellow-500 to-yellow-600",bgColor:"bg-yellow-50",textColor:"text-yellow-600"},{title:"ยอดที่ชำระแล้ว",value:`฿${v.toLocaleString()}`,icon:Xn,color:"from-emerald-500 to-emerald-600",bgColor:"bg-emerald-50",textColor:"text-emerald-600"},{title:"ผู้ตรวจสอบ",value:u,icon:jn,color:"from-orange-500 to-orange-600",bgColor:"bg-orange-50",textColor:"text-orange-600"}],y=[{title:"ชำระแล้ว",count:m.length,icon:Xn,color:"text-green-500",bgColor:"bg-green-100"},{title:"รอชำระ",count:g.length,icon:Vc,color:"text-yellow-500",bgColor:"bg-yellow-100"},{title:"เกินกำหนด",count:p.length,icon:Ui,color:"text-red-500",bgColor:"bg-red-100"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"แดชบอร์ด"}),i.jsx("p",{className:"text-gray-600",children:"ภาพรวมและสถิติของระบบผ่อนสินค้า"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map((x,N)=>{const _=x.icon;return i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsx("div",{className:`p-3 rounded-lg ${x.bgColor}`,children:i.jsx(_,{className:`w-6 h-6 ${x.textColor}`})})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("p",{className:"text-sm text-gray-600",children:x.title}),i.jsx("p",{className:"text-2xl font-bold text-gray-800",children:x.value})]})]},x.title)})}),t&&t.length>0&&i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[i.jsx(aD,{className:"w-5 h-5"}),"สถานะการชำระเงิน"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:y.map((x,N)=>{const _=x.icon;return i.jsxs(Me.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.5+N*.1},className:"text-center",children:[i.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full ${x.bgColor} mb-3`,children:i.jsx(_,{className:`w-8 h-8 ${x.color}`})}),i.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-1",children:x.count}),i.jsx("div",{className:"text-sm text-gray-600",children:x.title})]},x.title)})})]}),t&&t.length>0&&i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[i.jsx(ca,{className:"w-5 h-5"}),"แผนการผ่อนล่าสุด"]}),i.jsx("div",{className:"space-y-4",children:t.slice(0,3).map((x,N)=>{const _=x.payments.filter(w=>w.status==="paid").length,k=_/x.payments.length*100;return i.jsxs(Me.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7+N*.1},className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:x.productName}),i.jsxs("p",{className:"text-gray-600 text-sm",children:["ผ่อน ",x.months," งวด × ฿",x.monthlyPayment.toLocaleString()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm text-gray-500",children:"ความคืบหน้า"}),i.jsxs("div",{className:"font-semibold",children:[_,"/",x.payments.length]})]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${k}%`}})}),i.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[k.toFixed(1),"% เสร็จสิ้น"]})]},x.id)})})]}),(!e||e.length===0)&&(!t||t.length===0)&&(!r||r.length===0)&&(!n||n.length===0)&&i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[i.jsx(Qr,{className:"w-24 h-24 text-gray-300 mx-auto mb-6"}),i.jsx("h3",{className:"text-2xl font-bold text-gray-600 mb-4",children:"ยินดีต้อนรับสู่ระบบผ่อนสินค้า! 🎉"}),i.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:"เริ่มต้นใช้งานโดยการเพิ่มสินค้าแรกของคุณ จากนั้นสร้างแผนการผ่อนที่เหมาะสม"}),i.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-full",children:[i.jsx(Qr,{className:"w-4 h-4"}),"เพิ่มสินค้า"]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-full",children:[i.jsx(nl,{className:"w-4 h-4"}),"สร้างแผนผ่อน"]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-full",children:[i.jsx(ca,{className:"w-4 h-4"}),"ติดตามการชำระ"]})]})]})]})},Vy=({onAddProduct:e,submitting:t=!1,initialData:r=null,contracts:n=[]})=>{const[s,a]=E.useState({productCode:(r==null?void 0:r.productCode)||"",productName:(r==null?void 0:r.productName)||"",shopName:(r==null?void 0:r.shopName)||"",contract:(r==null?void 0:r.contract)||"",costPrice:(r==null?void 0:r.costPrice)||"",receiveDate:(r==null?void 0:r.receiveDate)||"",remarks:(r==null?void 0:r.remarks)||""});E.useEffect(()=>{if(r){const c=r.costPrice?typeof r.costPrice=="string"?r.costPrice:parseFloat(r.costPrice).toLocaleString():"";a({productCode:r.productCode||"",productName:r.productName||"",shopName:r.shopName||"",contract:r.contract||"",costPrice:c,receiveDate:r.receiveDate||"",remarks:r.remarks||""})}},[r]);const o=c=>{if(c.preventDefault(),!s.productName||!s.costPrice){ge({title:"กรุณากรอกข้อมูลให้ครบถ้วน",description:"ชื่อสินค้าและราคาต้นทุนเป็นข้อมูลที่จำเป็น",variant:"destructive"});return}const u=parseFloat(s.costPrice.replace(/,/g,""));if(isNaN(u)||u<=0){ge({title:"ราคาไม่ถูกต้อง",description:"กรุณาใส่ราคาที่เป็นตัวเลขและมากกว่า 0",variant:"destructive"});return}e({...s,costPrice:u.toLocaleString(),name:s.productName,price:u,code:s.productCode,shopName:s.shopName,contract:s.contract,receiveDate:s.receiveDate,remarks:s.remarks}),r||a({productCode:"",productName:"",shopName:"",contract:"",costPrice:"",receiveDate:"",remarks:""})},l=c=>{const{name:u,value:d}=c.target;if(u==="costPrice"){const f=d.replace(/[^\d]/g,""),h=f?parseInt(f).toLocaleString():"";a(m=>({...m,[u]:h}))}else a(f=>({...f,[u]:d}))};return i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:i.jsxs("form",{onSubmit:o,className:"space-y-6",children:[i.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(eD,{className:"w-4 h-4"}),"รหัสสินค้า"]}),i.jsx("input",{type:"text",name:"productCode",value:s.productCode,onChange:l,placeholder:"เช่น R43, N903",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(Qr,{className:"w-4 h-4"}),"ชื่อสินค้า *"]}),i.jsx("input",{type:"text",name:"productName",value:s.productName,onChange:l,placeholder:"เช่น เครื่องซักผ้า 11 กิโล",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm",required:!0})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(uD,{className:"w-4 h-4"}),"ชื่อร้านค้า"]}),i.jsx("input",{type:"text",name:"shopName",value:s.shopName,onChange:l,placeholder:"เช่น ร้านค้า A, ร้านค้า B",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(QP,{className:"w-4 h-4"}),"สัญญา"]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",name:"contract",value:s.contract,onChange:l,placeholder:"พิมพ์ - หรือเลือกเลขที่สัญญา",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm pr-8"}),n.length>0&&i.jsxs("select",{value:"",onChange:c=>{c.target.value&&a(u=>({...u,contract:c.target.value}))},className:"absolute right-1 top-1/2 transform -translate-y-1/2 w-6 h-6 text-xs border-none bg-transparent focus:outline-none cursor-pointer",children:[i.jsx("option",{value:"",children:"📋"}),n.map(c=>i.jsxs("option",{value:c.contractNumber,children:[c.contractNumber," - ",c.customerName]},c.id))]})]}),n.length>0&&i.jsx("p",{className:"text-xs text-gray-500",children:'💡 สามารถพิมพ์ "-" หรือเลือกเลขที่สัญญาจากระบบ'})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(fl,{className:"w-4 h-4"}),"ราคาต้นทุน *"]}),i.jsx("input",{type:"text",name:"costPrice",value:s.costPrice,onChange:l,placeholder:"เช่น 2,740",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm",required:!0})]})]}),i.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(ca,{className:"w-4 h-4"}),"ว.ด.ป./รับ"]}),i.jsx("input",{type:"date",name:"receiveDate",value:s.receiveDate,onChange:l,className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(gr,{className:"w-4 h-4"}),"หมายเหตุ"]}),i.jsx("input",{type:"text",name:"remarks",value:s.remarks,onChange:l,placeholder:"เช่น ซ่อมแล้ว, มาวันที่ 23/6/68",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 opacity-0",children:[i.jsx(ur,{className:"w-4 h-4"}),"เพิ่มสินค้า"]}),i.jsx(oe,{type:"submit",disabled:t,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white py-3 px-4 rounded-lg font-medium text-base transition-all duration-300 transform hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:t?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),r?"กำลังแก้ไขสินค้า...":"กำลังเพิ่มสินค้า..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),r?"แก้ไขสินค้า":"เพิ่มสินค้า"]})})]})]})]})})};function q4(e,t){return function(){return e.apply(t,arguments)}}const{toString:ND}=Object.prototype,{getPrototypeOf:sg}=Object,{iterator:vf,toStringTag:Z4}=Symbol,yf=(e=>t=>{const r=ND.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ys=e=>(e=e.toLowerCase(),t=>yf(t)===e),wf=e=>t=>typeof t===e,{isArray:ml}=Array,zc=wf("undefined");function mu(e){return e!==null&&!zc(e)&&e.constructor!==null&&!zc(e.constructor)&&fn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const J4=ys("ArrayBuffer");function kD(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&J4(e.buffer),t}const _D=wf("string"),fn=wf("function"),Q4=wf("number"),pu=e=>e!==null&&typeof e=="object",SD=e=>e===!0||e===!1,Pd=e=>{if(yf(e)!=="object")return!1;const t=sg(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Z4 in e)&&!(vf in e)},ED=e=>{if(!pu(e)||mu(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},CD=ys("Date"),jD=ys("File"),TD=ys("Blob"),AD=ys("FileList"),FD=e=>pu(e)&&fn(e.pipe),PD=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||fn(e.append)&&((t=yf(e))==="formdata"||t==="object"&&fn(e.toString)&&e.toString()==="[object FormData]"))},DD=ys("URLSearchParams"),[ID,RD,LD,OD]=["ReadableStream","Request","Response","Headers"].map(ys),MD=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xu(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),ml(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(mu(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let l;for(n=0;n<o;n++)l=a[n],t.call(null,e[l],l,e)}}function e_(e,t){if(mu(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Ni=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),t_=e=>!zc(e)&&e!==Ni;function hp(){const{caseless:e}=t_(this)&&this||{},t={},r=(n,s)=>{const a=e&&e_(t,s)||s;Pd(t[a])&&Pd(n)?t[a]=hp(t[a],n):Pd(n)?t[a]=hp({},n):ml(n)?t[a]=n.slice():t[a]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&xu(arguments[n],r);return t}const BD=(e,t,r,{allOwnKeys:n}={})=>(xu(t,(s,a)=>{r&&fn(s)?e[a]=q4(s,r):e[a]=s},{allOwnKeys:n}),e),UD=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),VD=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},$D=(e,t,r,n)=>{let s,a,o;const l={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)o=s[a],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&sg(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},zD=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},HD=e=>{if(!e)return null;if(ml(e))return e;let t=e.length;if(!Q4(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},WD=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&sg(Uint8Array)),GD=(e,t)=>{const n=(e&&e[vf]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},XD=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},KD=ys("HTMLFormElement"),YD=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),$y=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),qD=ys("RegExp"),r_=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};xu(r,(s,a)=>{let o;(o=t(s,a,e))!==!1&&(n[a]=o||s)}),Object.defineProperties(e,n)},ZD=e=>{r_(e,(t,r)=>{if(fn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(fn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},JD=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return ml(e)?n(e):n(String(e).split(t)),r},QD=()=>{},e8=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function t8(e){return!!(e&&fn(e.append)&&e[Z4]==="FormData"&&e[vf])}const r8=e=>{const t=new Array(10),r=(n,s)=>{if(pu(n)){if(t.indexOf(n)>=0)return;if(mu(n))return n;if(!("toJSON"in n)){t[s]=n;const a=ml(n)?[]:{};return xu(n,(o,l)=>{const c=r(o,s+1);!zc(c)&&(a[l]=c)}),t[s]=void 0,a}}return n};return r(e,0)},n8=ys("AsyncFunction"),s8=e=>e&&(pu(e)||fn(e))&&fn(e.then)&&fn(e.catch),n_=((e,t)=>e?setImmediate:t?((r,n)=>(Ni.addEventListener("message",({source:s,data:a})=>{s===Ni&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Ni.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",fn(Ni.postMessage)),a8=typeof queueMicrotask<"u"?queueMicrotask.bind(Ni):typeof process<"u"&&process.nextTick||n_,i8=e=>e!=null&&fn(e[vf]),ie={isArray:ml,isArrayBuffer:J4,isBuffer:mu,isFormData:PD,isArrayBufferView:kD,isString:_D,isNumber:Q4,isBoolean:SD,isObject:pu,isPlainObject:Pd,isEmptyObject:ED,isReadableStream:ID,isRequest:RD,isResponse:LD,isHeaders:OD,isUndefined:zc,isDate:CD,isFile:jD,isBlob:TD,isRegExp:qD,isFunction:fn,isStream:FD,isURLSearchParams:DD,isTypedArray:WD,isFileList:AD,forEach:xu,merge:hp,extend:BD,trim:MD,stripBOM:UD,inherits:VD,toFlatObject:$D,kindOf:yf,kindOfTest:ys,endsWith:zD,toArray:HD,forEachEntry:GD,matchAll:XD,isHTMLForm:KD,hasOwnProperty:$y,hasOwnProp:$y,reduceDescriptors:r_,freezeMethods:ZD,toObjectSet:JD,toCamelCase:YD,noop:QD,toFiniteNumber:e8,findKey:e_,global:Ni,isContextDefined:t_,isSpecCompliantForm:t8,toJSONObject:r8,isAsyncFn:n8,isThenable:s8,setImmediate:n_,asap:a8,isIterable:i8};function Xe(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}ie.inherits(Xe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const s_=Xe.prototype,a_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{a_[e]={value:e}});Object.defineProperties(Xe,a_);Object.defineProperty(s_,"isAxiosError",{value:!0});Xe.from=(e,t,r,n,s,a)=>{const o=Object.create(s_);return ie.toFlatObject(e,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),Xe.call(o,e.message,t,r,n,s),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};const o8=null;function mp(e){return ie.isPlainObject(e)||ie.isArray(e)}function i_(e){return ie.endsWith(e,"[]")?e.slice(0,-2):e}function zy(e,t,r){return e?e.concat(t).map(function(s,a){return s=i_(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function l8(e){return ie.isArray(e)&&!e.some(mp)}const c8=ie.toFlatObject(ie,{},null,function(t){return/^is[A-Z]/.test(t)});function bf(e,t,r){if(!ie.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ie.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,v){return!ie.isUndefined(v[p])});const n=r.metaTokens,s=r.visitor||d,a=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(t);if(!ie.isFunction(s))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(ie.isDate(g))return g.toISOString();if(ie.isBoolean(g))return g.toString();if(!c&&ie.isBlob(g))throw new Xe("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(g)||ie.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function d(g,p,v){let b=g;if(g&&!v&&typeof g=="object"){if(ie.endsWith(p,"{}"))p=n?p:p.slice(0,-2),g=JSON.stringify(g);else if(ie.isArray(g)&&l8(g)||(ie.isFileList(g)||ie.endsWith(p,"[]"))&&(b=ie.toArray(g)))return p=i_(p),b.forEach(function(x,N){!(ie.isUndefined(x)||x===null)&&t.append(o===!0?zy([p],N,a):o===null?p:p+"[]",u(x))}),!1}return mp(g)?!0:(t.append(zy(v,p,a),u(g)),!1)}const f=[],h=Object.assign(c8,{defaultVisitor:d,convertValue:u,isVisitable:mp});function m(g,p){if(!ie.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(g),ie.forEach(g,function(b,y){(!(ie.isUndefined(b)||b===null)&&s.call(t,b,ie.isString(y)?y.trim():y,p,h))===!0&&m(b,p?p.concat(y):[y])}),f.pop()}}if(!ie.isObject(e))throw new TypeError("data must be an object");return m(e),t}function Hy(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function ag(e,t){this._pairs=[],e&&bf(e,this,t)}const o_=ag.prototype;o_.append=function(t,r){this._pairs.push([t,r])};o_.toString=function(t){const r=t?function(n){return t.call(this,n,Hy)}:Hy;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function u8(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function l_(e,t,r){if(!t)return e;const n=r&&r.encode||u8;ie.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(t,r):a=ie.isURLSearchParams(t)?t.toString():new ag(t,r).toString(n),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class d8{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ie.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Wy=d8,c_={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},f8=typeof URLSearchParams<"u"?URLSearchParams:ag,h8=typeof FormData<"u"?FormData:null,m8=typeof Blob<"u"?Blob:null,p8={isBrowser:!0,classes:{URLSearchParams:f8,FormData:h8,Blob:m8},protocols:["http","https","file","blob","url","data"]},ig=typeof window<"u"&&typeof document<"u",pp=typeof navigator=="object"&&navigator||void 0,x8=ig&&(!pp||["ReactNative","NativeScript","NS"].indexOf(pp.product)<0),g8=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),v8=ig&&window.location.href||"http://localhost",y8=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ig,hasStandardBrowserEnv:x8,hasStandardBrowserWebWorkerEnv:g8,navigator:pp,origin:v8},Symbol.toStringTag,{value:"Module"})),Br={...y8,...p8};function w8(e,t){return bf(e,new Br.classes.URLSearchParams,{visitor:function(r,n,s,a){return Br.isNode&&ie.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function b8(e){return ie.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function N8(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function u_(e){function t(r,n,s,a){let o=r[a++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=a>=r.length;return o=!o&&ie.isArray(s)?s.length:o,c?(ie.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!l):((!s[o]||!ie.isObject(s[o]))&&(s[o]=[]),t(r,n,s[o],a)&&ie.isArray(s[o])&&(s[o]=N8(s[o])),!l)}if(ie.isFormData(e)&&ie.isFunction(e.entries)){const r={};return ie.forEachEntry(e,(n,s)=>{t(b8(n),s,r,0)}),r}return null}function k8(e,t,r){if(ie.isString(e))try{return(t||JSON.parse)(e),ie.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const og={transitional:c_,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=ie.isObject(t);if(a&&ie.isHTMLForm(t)&&(t=new FormData(t)),ie.isFormData(t))return s?JSON.stringify(u_(t)):t;if(ie.isArrayBuffer(t)||ie.isBuffer(t)||ie.isStream(t)||ie.isFile(t)||ie.isBlob(t)||ie.isReadableStream(t))return t;if(ie.isArrayBufferView(t))return t.buffer;if(ie.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return w8(t,this.formSerializer).toString();if((l=ie.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return bf(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),k8(t)):t}],transformResponse:[function(t){const r=this.transitional||og.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(ie.isResponse(t)||ie.isReadableStream(t))return t;if(t&&ie.isString(t)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?Xe.from(l,Xe.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Br.classes.FormData,Blob:Br.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],e=>{og.headers[e]={}});const lg=og,_8=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),S8=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||t[r]&&_8[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Gy=Symbol("internals");function Ul(e){return e&&String(e).trim().toLowerCase()}function Dd(e){return e===!1||e==null?e:ie.isArray(e)?e.map(Dd):String(e)}function E8(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const C8=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Fh(e,t,r,n,s){if(ie.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!ie.isString(t)){if(ie.isString(n))return t.indexOf(n)!==-1;if(ie.isRegExp(n))return n.test(t)}}function j8(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function T8(e,t){const r=ie.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,o){return this[n].call(this,t,s,a,o)},configurable:!0})})}class Nf{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(l,c,u){const d=Ul(c);if(!d)throw new Error("header name must be a non-empty string");const f=ie.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=Dd(l))}const o=(l,c)=>ie.forEach(l,(u,d)=>a(u,d,c));if(ie.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(ie.isString(t)&&(t=t.trim())&&!C8(t))o(S8(t),r);else if(ie.isObject(t)&&ie.isIterable(t)){let l={},c,u;for(const d of t){if(!ie.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?ie.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=Ul(t),t){const n=ie.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return E8(s);if(ie.isFunction(r))return r.call(this,s,n);if(ie.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ul(t),t){const n=ie.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Fh(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(o){if(o=Ul(o),o){const l=ie.findKey(n,o);l&&(!r||Fh(n,n[l],l,r))&&(delete n[l],s=!0)}}return ie.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||Fh(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return ie.forEach(this,(s,a)=>{const o=ie.findKey(n,a);if(o){r[o]=Dd(s),delete r[a];return}const l=t?j8(a):String(a).trim();l!==a&&delete r[a],r[l]=Dd(s),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ie.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&ie.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[Gy]=this[Gy]={accessors:{}}).accessors,s=this.prototype;function a(o){const l=Ul(o);n[l]||(T8(s,o),n[l]=!0)}return ie.isArray(t)?t.forEach(a):a(t),this}}Nf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(Nf.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});ie.freezeMethods(Nf);const ps=Nf;function Ph(e,t){const r=this||lg,n=t||r,s=ps.from(n.headers);let a=n.data;return ie.forEach(e,function(l){a=l.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function d_(e){return!!(e&&e.__CANCEL__)}function pl(e,t,r){Xe.call(this,e??"canceled",Xe.ERR_CANCELED,t,r),this.name="CanceledError"}ie.inherits(pl,Xe,{__CANCEL__:!0});function f_(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Xe("Request failed with status code "+r.status,[Xe.ERR_BAD_REQUEST,Xe.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function A8(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function F8(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[a];o||(o=u),r[s]=c,n[s]=u;let f=a,h=0;for(;f!==s;)h+=r[f++],f=f%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-o<t)return;const m=d&&u-d;return m?Math.round(h*1e3/m):void 0}}function P8(e,t){let r=0,n=1e3/t,s,a;const o=(u,d=Date.now())=>{r=d,s=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(s=u,a||(a=setTimeout(()=>{a=null,o(s)},n-f)))},()=>s&&o(s)]}const y0=(e,t,r=3)=>{let n=0;const s=F8(50,250);return P8(a=>{const o=a.loaded,l=a.lengthComputable?a.total:void 0,c=o-n,u=s(c),d=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:a,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},Xy=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Ky=e=>(...t)=>ie.asap(()=>e(...t)),D8=Br.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Br.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Br.origin),Br.navigator&&/(msie|trident)/i.test(Br.navigator.userAgent)):()=>!0,I8=Br.hasStandardBrowserEnv?{write(e,t,r,n,s,a){const o=[e+"="+encodeURIComponent(t)];ie.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),ie.isString(n)&&o.push("path="+n),ie.isString(s)&&o.push("domain="+s),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function R8(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function L8(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function h_(e,t,r){let n=!R8(t);return e&&(n||r==!1)?L8(e,t):t}const Yy=e=>e instanceof ps?{...e}:e;function zi(e,t){t=t||{};const r={};function n(u,d,f,h){return ie.isPlainObject(u)&&ie.isPlainObject(d)?ie.merge.call({caseless:h},u,d):ie.isPlainObject(d)?ie.merge({},d):ie.isArray(d)?d.slice():d}function s(u,d,f,h){if(ie.isUndefined(d)){if(!ie.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function a(u,d){if(!ie.isUndefined(d))return n(void 0,d)}function o(u,d){if(ie.isUndefined(d)){if(!ie.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>s(Yy(u),Yy(d),f,!0)};return ie.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||s,h=f(e[d],t[d],d);ie.isUndefined(h)&&f!==l||(r[d]=h)}),r}const m_=e=>{const t=zi({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:l}=t;t.headers=o=ps.from(o),t.url=l_(h_(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(ie.isFormData(r)){if(Br.hasStandardBrowserEnv||Br.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(Br.hasStandardBrowserEnv&&(n&&ie.isFunction(n)&&(n=n(t)),n||n!==!1&&D8(t.url))){const u=s&&a&&I8.read(a);u&&o.set(s,u)}return t},O8=typeof XMLHttpRequest<"u",M8=O8&&function(e){return new Promise(function(r,n){const s=m_(e);let a=s.data;const o=ps.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,f,h,m,g;function p(){m&&m(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function b(){if(!v)return;const x=ps.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),_={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:x,config:e,request:v};f_(function(w){r(w),p()},function(w){n(w),p()},_),v=null}"onloadend"in v?v.onloadend=b:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(b)},v.onabort=function(){v&&(n(new Xe("Request aborted",Xe.ECONNABORTED,e,v)),v=null)},v.onerror=function(){n(new Xe("Network Error",Xe.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let N=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const _=s.transitional||c_;s.timeoutErrorMessage&&(N=s.timeoutErrorMessage),n(new Xe(N,_.clarifyTimeoutError?Xe.ETIMEDOUT:Xe.ECONNABORTED,e,v)),v=null},a===void 0&&o.setContentType(null),"setRequestHeader"in v&&ie.forEach(o.toJSON(),function(N,_){v.setRequestHeader(_,N)}),ie.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),l&&l!=="json"&&(v.responseType=s.responseType),u&&([h,g]=y0(u,!0),v.addEventListener("progress",h)),c&&v.upload&&([f,m]=y0(c),v.upload.addEventListener("progress",f),v.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(d=x=>{v&&(n(!x||x.type?new pl(null,e,v):x),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const y=A8(s.url);if(y&&Br.protocols.indexOf(y)===-1){n(new Xe("Unsupported protocol "+y+":",Xe.ERR_BAD_REQUEST,e));return}v.send(a||null)})},B8=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof Xe?d:new pl(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,a(new Xe(`timeout ${t} of ms exceeded`,Xe.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>ie.asap(l),c}},U8=B8,V8=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},$8=async function*(e,t){for await(const r of z8(e))yield*V8(r,t)},z8=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},qy=(e,t,r,n)=>{const s=$8(e,t);let a=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let h=a+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},kf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",p_=kf&&typeof ReadableStream=="function",H8=kf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),x_=(e,...t)=>{try{return!!e(...t)}catch{return!1}},W8=p_&&x_(()=>{let e=!1;const t=new Request(Br.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Zy=64*1024,xp=p_&&x_(()=>ie.isReadableStream(new Response("").body)),w0={stream:xp&&(e=>e.body)};kf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!w0[t]&&(w0[t]=ie.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new Xe(`Response type '${t}' is not supported`,Xe.ERR_NOT_SUPPORT,n)})})})(new Response);const G8=async e=>{if(e==null)return 0;if(ie.isBlob(e))return e.size;if(ie.isSpecCompliantForm(e))return(await new Request(Br.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(e)||ie.isArrayBuffer(e))return e.byteLength;if(ie.isURLSearchParams(e)&&(e=e+""),ie.isString(e))return(await H8(e)).byteLength},X8=async(e,t)=>{const r=ie.toFiniteNumber(e.getContentLength());return r??G8(t)},K8=kf&&(async e=>{let{url:t,method:r,data:n,signal:s,cancelToken:a,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:h}=m_(e);u=u?(u+"").toLowerCase():"text";let m=U8([s,a&&a.toAbortSignal()],o),g;const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(c&&W8&&r!=="get"&&r!=="head"&&(v=await X8(d,n))!==0){let _=new Request(t,{method:"POST",body:n,duplex:"half"}),k;if(ie.isFormData(n)&&(k=_.headers.get("content-type"))&&d.setContentType(k),_.body){const[w,C]=Xy(v,y0(Ky(c)));n=qy(_.body,Zy,w,C)}}ie.isString(f)||(f=f?"include":"omit");const b="credentials"in Request.prototype;g=new Request(t,{...h,signal:m,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:b?f:void 0});let y=await fetch(g,h);const x=xp&&(u==="stream"||u==="response");if(xp&&(l||x&&p)){const _={};["status","statusText","headers"].forEach(D=>{_[D]=y[D]});const k=ie.toFiniteNumber(y.headers.get("content-length")),[w,C]=l&&Xy(k,y0(Ky(l),!0))||[];y=new Response(qy(y.body,Zy,w,()=>{C&&C(),p&&p()}),_)}u=u||"text";let N=await w0[ie.findKey(w0,u)||"text"](y,e);return!x&&p&&p(),await new Promise((_,k)=>{f_(_,k,{data:N,headers:ps.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:g})})}catch(b){throw p&&p(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new Xe("Network Error",Xe.ERR_NETWORK,e,g),{cause:b.cause||b}):Xe.from(b,b&&b.code,e,g)}}),gp={http:o8,xhr:M8,fetch:K8};ie.forEach(gp,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Jy=e=>`- ${e}`,Y8=e=>ie.isFunction(e)||e===null||e===!1,g_={getAdapter:e=>{e=ie.isArray(e)?e:[e];const{length:t}=e;let r,n;const s={};for(let a=0;a<t;a++){r=e[a];let o;if(n=r,!Y8(r)&&(n=gp[(o=String(r)).toLowerCase()],n===void 0))throw new Xe(`Unknown adapter '${o}'`);if(n)break;s[o||"#"+a]=n}if(!n){const a=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(Jy).join(`
`):" "+Jy(a[0]):"as no adapter specified";throw new Xe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:gp};function Dh(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new pl(null,e)}function Qy(e){return Dh(e),e.headers=ps.from(e.headers),e.data=Ph.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),g_.getAdapter(e.adapter||lg.adapter)(e).then(function(n){return Dh(e),n.data=Ph.call(e,e.transformResponse,n),n.headers=ps.from(n.headers),n},function(n){return d_(n)||(Dh(e),n&&n.response&&(n.response.data=Ph.call(e,e.transformResponse,n.response),n.response.headers=ps.from(n.response.headers))),Promise.reject(n)})}const v_="1.11.0",_f={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{_f[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const ew={};_f.transitional=function(t,r,n){function s(a,o){return"[Axios v"+v_+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,l)=>{if(t===!1)throw new Xe(s(o," has been removed"+(r?" in "+r:"")),Xe.ERR_DEPRECATED);return r&&!ew[o]&&(ew[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,o,l):!0}};_f.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function q8(e,t,r){if(typeof e!="object")throw new Xe("options must be an object",Xe.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],o=t[a];if(o){const l=e[a],c=l===void 0||o(l,a,e);if(c!==!0)throw new Xe("option "+a+" must be "+c,Xe.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Xe("Unknown option "+a,Xe.ERR_BAD_OPTION)}}const Id={assertOptions:q8,validators:_f},Ns=Id.validators;class b0{constructor(t){this.defaults=t||{},this.interceptors={request:new Wy,response:new Wy}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=zi(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&Id.assertOptions(n,{silentJSONParsing:Ns.transitional(Ns.boolean),forcedJSONParsing:Ns.transitional(Ns.boolean),clarifyTimeoutError:Ns.transitional(Ns.boolean)},!1),s!=null&&(ie.isFunction(s)?r.paramsSerializer={serialize:s}:Id.assertOptions(s,{encode:Ns.function,serialize:Ns.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Id.assertOptions(r,{baseUrl:Ns.spelling("baseURL"),withXsrfToken:Ns.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=a&&ie.merge(a.common,a[r.method]);a&&ie.forEach(["delete","get","head","post","put","patch","common"],g=>{delete a[g]}),r.headers=ps.concat(o,a);const l=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,f=0,h;if(!c){const g=[Qy.bind(this),void 0];for(g.unshift(...l),g.push(...u),h=g.length,d=Promise.resolve(r);f<h;)d=d.then(g[f++],g[f++]);return d}h=l.length;let m=r;for(f=0;f<h;){const g=l[f++],p=l[f++];try{m=g(m)}catch(v){p.call(this,v);break}}try{d=Qy.call(this,m)}catch(g){return Promise.reject(g)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=zi(this.defaults,t);const r=h_(t.baseURL,t.url,t.allowAbsoluteUrls);return l_(r,t.params,t.paramsSerializer)}}ie.forEach(["delete","get","head","options"],function(t){b0.prototype[t]=function(r,n){return this.request(zi(n||{},{method:t,url:r,data:(n||{}).data}))}});ie.forEach(["post","put","patch"],function(t){function r(n){return function(a,o,l){return this.request(zi(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}b0.prototype[t]=r(),b0.prototype[t+"Form"]=r(!0)});const Rd=b0;class cg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const o=new Promise(l=>{n.subscribe(l),a=l}).then(s);return o.cancel=function(){n.unsubscribe(a)},o},t(function(a,o,l){n.reason||(n.reason=new pl(a,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new cg(function(s){t=s}),cancel:t}}}const Z8=cg;function J8(e){return function(r){return e.apply(null,r)}}function Q8(e){return ie.isObject(e)&&e.isAxiosError===!0}const vp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(vp).forEach(([e,t])=>{vp[t]=e});const eI=vp;function y_(e){const t=new Rd(e),r=q4(Rd.prototype.request,t);return ie.extend(r,Rd.prototype,t,{allOwnKeys:!0}),ie.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return y_(zi(e,s))},r}const ir=y_(lg);ir.Axios=Rd;ir.CanceledError=pl;ir.CancelToken=Z8;ir.isCancel=d_;ir.VERSION=v_;ir.toFormData=bf;ir.AxiosError=Xe;ir.Cancel=ir.CanceledError;ir.all=function(t){return Promise.all(t)};ir.spread=J8;ir.isAxiosError=Q8;ir.mergeConfig=zi;ir.AxiosHeaders=ps;ir.formToJSON=e=>u_(ie.isHTMLForm(e)?new FormData(e):e);ir.getAdapter=g_.getAdapter;ir.HttpStatusCode=eI;ir.default=ir;const tI=ir,rI="https://kuntran-backend-api-86c9bb65f6fb.herokuapp.com/api",ye=tI.create({baseURL:rI,timeout:1e4,headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});ye.interceptors.request.use(e=>e,e=>Promise.reject(e));ye.interceptors.response.use(e=>e,e=>{if(e.response)switch(console.error("API Error:",e.response.data),e.response.status){case 401:console.error("Unauthorized access");break;case 403:console.error("Access forbidden");break;case 404:console.error("Resource not found");break;case 500:console.error("Server error");break;default:console.error("API request failed")}else e.request?console.error("Network error:",e.request):console.error("Error:",e.message);return Promise.reject(e)});const Cs={getAll:async(e={})=>{const t={page:e.page||1,limit:e.limit||15,...e};return ye.get("/inventory",{params:t})},getById:async e=>ye.get(`/inventory/${e}`),create:async e=>ye.post("/inventory",e),update:async(e,t)=>ye.put(`/inventory/${e}`,t),delete:async e=>ye.delete(`/inventory/${e}`),search:async(e,t={})=>{const r={search:e,page:t.page||1,limit:t.limit||15,...t};return ye.get("/inventory",{params:r})}},Ci={getAll:async e=>{const t=e?{branchId:e}:{};return ye.get("/installments",{params:t})},getById:async e=>ye.get(`/installments/${e}`),create:async e=>ye.post("/installments",e),update:async(e,t)=>ye.put(`/installments/${e}`,t),delete:async e=>ye.delete(`/installments/${e}`)};/*!
* sweetalert2 v11.22.2
* Released under the MIT License.
*/function w_(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function nI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tw(e,t){return e.get(w_(e,t))}function sI(e,t,r){nI(e,t),t.set(e,r)}function aI(e,t,r){return e.set(w_(e,t),r),r}const iI=100,Ue={},oI=()=>{Ue.previousActiveElement instanceof HTMLElement?(Ue.previousActiveElement.focus(),Ue.previousActiveElement=null):document.body&&document.body.focus()},lI=e=>new Promise(t=>{if(!e)return t();const r=window.scrollX,n=window.scrollY;Ue.restoreFocusTimeout=setTimeout(()=>{oI(),t()},iI),window.scrollTo(r,n)}),b_="swal2-",cI=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],ue=cI.reduce((e,t)=>(e[t]=b_+t,e),{}),uI=["success","warning","info","question","error"],N0=uI.reduce((e,t)=>(e[t]=b_+t,e),{}),N_="SweetAlert2:",ug=e=>e.charAt(0).toUpperCase()+e.slice(1),tn=e=>{console.warn(`${N_} ${typeof e=="object"?e.join(" "):e}`)},ro=e=>{console.error(`${N_} ${e}`)},rw=[],dI=e=>{rw.includes(e)||(rw.push(e),tn(e))},k_=(e,t=null)=>{dI(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},Sf=e=>typeof e=="function"?e():e,dg=e=>e&&typeof e.toPromise=="function",gu=e=>dg(e)?e.toPromise():Promise.resolve(e),fg=e=>e&&Promise.resolve(e)===e,sn=()=>document.body.querySelector(`.${ue.container}`),vu=e=>{const t=sn();return t?t.querySelector(e):null},Dn=e=>vu(`.${e}`),ut=()=>Dn(ue.popup),xl=()=>Dn(ue.icon),fI=()=>Dn(ue["icon-content"]),__=()=>Dn(ue.title),hg=()=>Dn(ue["html-container"]),S_=()=>Dn(ue.image),mg=()=>Dn(ue["progress-steps"]),Ef=()=>Dn(ue["validation-message"]),Os=()=>vu(`.${ue.actions} .${ue.confirm}`),gl=()=>vu(`.${ue.actions} .${ue.cancel}`),no=()=>vu(`.${ue.actions} .${ue.deny}`),hI=()=>Dn(ue["input-label"]),vl=()=>vu(`.${ue.loader}`),yu=()=>Dn(ue.actions),E_=()=>Dn(ue.footer),Cf=()=>Dn(ue["timer-progress-bar"]),pg=()=>Dn(ue.close),mI=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,xg=()=>{const e=ut();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),r=Array.from(t).sort((a,o)=>{const l=parseInt(a.getAttribute("tabindex")||"0"),c=parseInt(o.getAttribute("tabindex")||"0");return l>c?1:l<c?-1:0}),n=e.querySelectorAll(mI),s=Array.from(n).filter(a=>a.getAttribute("tabindex")!=="-1");return[...new Set(r.concat(s))].filter(a=>hn(a))},gg=()=>Qs(document.body,ue.shown)&&!Qs(document.body,ue["toast-shown"])&&!Qs(document.body,ue["no-backdrop"]),jf=()=>{const e=ut();return e?Qs(e,ue.toast):!1},pI=()=>{const e=ut();return e?e.hasAttribute("data-loading"):!1},In=(e,t)=>{if(e.textContent="",t){const n=new DOMParser().parseFromString(t,"text/html"),s=n.querySelector("head");s&&Array.from(s.childNodes).forEach(o=>{e.appendChild(o)});const a=n.querySelector("body");a&&Array.from(a.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?e.appendChild(o.cloneNode(!0)):e.appendChild(o)})}},Qs=(e,t)=>{if(!t)return!1;const r=t.split(/\s+/);for(let n=0;n<r.length;n++)if(!e.classList.contains(r[n]))return!1;return!0},xI=(e,t)=>{Array.from(e.classList).forEach(r=>{!Object.values(ue).includes(r)&&!Object.values(N0).includes(r)&&!Object.values(t.showClass||{}).includes(r)&&e.classList.remove(r)})},Tn=(e,t,r)=>{if(xI(e,t),!t.customClass)return;const n=t.customClass[r];if(n){if(typeof n!="string"&&!n.forEach){tn(`Invalid type of customClass.${r}! Expected string or iterable object, got "${typeof n}"`);return}dt(e,n)}},Tf=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${ue.popup} > .${ue[t]}`);case"checkbox":return e.querySelector(`.${ue.popup} > .${ue.checkbox} input`);case"radio":return e.querySelector(`.${ue.popup} > .${ue.radio} input:checked`)||e.querySelector(`.${ue.popup} > .${ue.radio} input:first-child`);case"range":return e.querySelector(`.${ue.popup} > .${ue.range} input`);default:return e.querySelector(`.${ue.popup} > .${ue.input}`)}},C_=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},j_=(e,t,r)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(n=>{Array.isArray(e)?e.forEach(s=>{r?s.classList.add(n):s.classList.remove(n)}):r?e.classList.add(n):e.classList.remove(n)}))},dt=(e,t)=>{j_(e,t,!0)},es=(e,t)=>{j_(e,t,!1)},Fa=(e,t)=>{const r=Array.from(e.children);for(let n=0;n<r.length;n++){const s=r[n];if(s instanceof HTMLElement&&Qs(s,t))return s}},ji=(e,t,r)=>{r===`${parseInt(r)}`&&(r=parseInt(r)),r||parseInt(r)===0?e.style.setProperty(t,typeof r=="number"?`${r}px`:r):e.style.removeProperty(t)},wr=(e,t="flex")=>{e&&(e.style.display=t)},zr=e=>{e&&(e.style.display="none")},vg=(e,t="block")=>{e&&new MutationObserver(()=>{wu(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},nw=(e,t,r,n)=>{const s=e.querySelector(t);s&&s.style.setProperty(r,n)},wu=(e,t,r="flex")=>{t?wr(e,r):zr(e)},hn=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),gI=()=>!hn(Os())&&!hn(no())&&!hn(gl()),yp=e=>e.scrollHeight>e.clientHeight,vI=(e,t)=>{let r=e;for(;r&&r!==t;){if(yp(r))return!0;r=r.parentElement}return!1},T_=e=>{const t=window.getComputedStyle(e),r=parseFloat(t.getPropertyValue("animation-duration")||"0"),n=parseFloat(t.getPropertyValue("transition-duration")||"0");return r>0||n>0},yg=(e,t=!1)=>{const r=Cf();r&&hn(r)&&(t&&(r.style.transition="none",r.style.width="100%"),setTimeout(()=>{r.style.transition=`width ${e/1e3}s linear`,r.style.width="0%"},10))},yI=()=>{const e=Cf();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const r=parseInt(window.getComputedStyle(e).width),n=t/r*100;e.style.width=`${n}%`},wI=()=>typeof window>"u"||typeof document>"u",bI=`
 <div aria-labelledby="${ue.title}" aria-describedby="${ue["html-container"]}" class="${ue.popup}" tabindex="-1">
   <button type="button" class="${ue.close}"></button>
   <ul class="${ue["progress-steps"]}"></ul>
   <div class="${ue.icon}"></div>
   <img class="${ue.image}" />
   <h2 class="${ue.title}" id="${ue.title}"></h2>
   <div class="${ue["html-container"]}" id="${ue["html-container"]}"></div>
   <input class="${ue.input}" id="${ue.input}" />
   <input type="file" class="${ue.file}" />
   <div class="${ue.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${ue.select}" id="${ue.select}"></select>
   <div class="${ue.radio}"></div>
   <label class="${ue.checkbox}">
     <input type="checkbox" id="${ue.checkbox}" />
     <span class="${ue.label}"></span>
   </label>
   <textarea class="${ue.textarea}" id="${ue.textarea}"></textarea>
   <div class="${ue["validation-message"]}" id="${ue["validation-message"]}"></div>
   <div class="${ue.actions}">
     <div class="${ue.loader}"></div>
     <button type="button" class="${ue.confirm}"></button>
     <button type="button" class="${ue.deny}"></button>
     <button type="button" class="${ue.cancel}"></button>
   </div>
   <div class="${ue.footer}"></div>
   <div class="${ue["timer-progress-bar-container"]}">
     <div class="${ue["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),NI=()=>{const e=sn();return e?(e.remove(),es([document.documentElement,document.body],[ue["no-backdrop"],ue["toast-shown"],ue["has-column"]]),!0):!1},li=()=>{Ue.currentInstance.resetValidationMessage()},kI=()=>{const e=ut(),t=Fa(e,ue.input),r=Fa(e,ue.file),n=e.querySelector(`.${ue.range} input`),s=e.querySelector(`.${ue.range} output`),a=Fa(e,ue.select),o=e.querySelector(`.${ue.checkbox} input`),l=Fa(e,ue.textarea);t.oninput=li,r.onchange=li,a.onchange=li,o.onchange=li,l.oninput=li,n.oninput=()=>{li(),s.value=n.value},n.onchange=()=>{li(),s.value=n.value}},_I=e=>typeof e=="string"?document.querySelector(e):e,SI=e=>{const t=ut();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},EI=e=>{window.getComputedStyle(e).direction==="rtl"&&dt(sn(),ue.rtl)},CI=e=>{const t=NI();if(wI()){ro("SweetAlert2 requires document to initialize");return}const r=document.createElement("div");r.className=ue.container,t&&dt(r,ue["no-transition"]),In(r,bI),r.dataset.swal2Theme=e.theme;const n=_I(e.target);n.appendChild(r),e.topLayer&&(r.setAttribute("popover",""),r.showPopover()),SI(e),EI(n),kI()},wg=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?jI(e,t):e&&In(t,e)},jI=(e,t)=>{e.jquery?TI(t,e):In(t,e.toString())},TI=(e,t)=>{if(e.textContent="",0 in t)for(let r=0;r in t;r++)e.appendChild(t[r].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},AI=(e,t)=>{const r=yu(),n=vl();!r||!n||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?zr(r):wr(r),Tn(r,t,"actions"),FI(r,n,t),In(n,t.loaderHtml||""),Tn(n,t,"loader"))};function FI(e,t,r){const n=Os(),s=no(),a=gl();!n||!s||!a||(Rh(n,"confirm",r),Rh(s,"deny",r),Rh(a,"cancel",r),PI(n,s,a,r),r.reverseButtons&&(r.toast?(e.insertBefore(a,n),e.insertBefore(s,n)):(e.insertBefore(a,t),e.insertBefore(s,t),e.insertBefore(n,t))))}function PI(e,t,r,n){if(!n.buttonsStyling){es([e,t,r],ue.styled);return}dt([e,t,r],ue.styled),n.confirmButtonColor&&e.style.setProperty("--swal2-confirm-button-background-color",n.confirmButtonColor),n.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",n.denyButtonColor),n.cancelButtonColor&&r.style.setProperty("--swal2-cancel-button-background-color",n.cancelButtonColor),Ih(e),Ih(t),Ih(r)}function Ih(e){const t=window.getComputedStyle(e);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const r=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");e.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${r}`))}function Rh(e,t,r){const n=ug(t);wu(e,r[`show${n}Button`],"inline-block"),In(e,r[`${t}ButtonText`]||""),e.setAttribute("aria-label",r[`${t}ButtonAriaLabel`]||""),e.className=ue[t],Tn(e,r,`${t}Button`)}const DI=(e,t)=>{const r=pg();r&&(In(r,t.closeButtonHtml||""),Tn(r,t,"closeButton"),wu(r,t.showCloseButton),r.setAttribute("aria-label",t.closeButtonAriaLabel||""))},II=(e,t)=>{const r=sn();r&&(RI(r,t.backdrop),LI(r,t.position),OI(r,t.grow),Tn(r,t,"container"))};function RI(e,t){typeof t=="string"?e.style.background=t:t||dt([document.documentElement,document.body],ue["no-backdrop"])}function LI(e,t){t&&(t in ue?dt(e,ue[t]):(tn('The "position" parameter is not valid, defaulting to "center"'),dt(e,ue.center)))}function OI(e,t){t&&dt(e,ue[`grow-${t}`])}var Nt={innerParams:new WeakMap,domCache:new WeakMap};const MI=["input","file","range","select","radio","checkbox","textarea"],BI=(e,t)=>{const r=ut();if(!r)return;const n=Nt.innerParams.get(e),s=!n||t.input!==n.input;MI.forEach(a=>{const o=Fa(r,ue[a]);o&&($I(a,t.inputAttributes),o.className=ue[a],s&&zr(o))}),t.input&&(s&&UI(t),zI(t))},UI=e=>{if(!e.input)return;if(!Yt[e.input]){ro(`Unexpected type of input! Expected ${Object.keys(Yt).join(" | ")}, got "${e.input}"`);return}const t=A_(e.input);if(!t)return;const r=Yt[e.input](t,e);wr(t),e.inputAutoFocus&&setTimeout(()=>{C_(r)})},VI=e=>{for(let t=0;t<e.attributes.length;t++){const r=e.attributes[t].name;["id","type","value","style"].includes(r)||e.removeAttribute(r)}},$I=(e,t)=>{const r=ut();if(!r)return;const n=Tf(r,e);if(n){VI(n);for(const s in t)n.setAttribute(s,t[s])}},zI=e=>{if(!e.input)return;const t=A_(e.input);t&&Tn(t,e,"input")},bg=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},bu=(e,t,r)=>{if(r.inputLabel){const n=document.createElement("label"),s=ue["input-label"];n.setAttribute("for",e.id),n.className=s,typeof r.customClass=="object"&&dt(n,r.customClass.inputLabel),n.innerText=r.inputLabel,t.insertAdjacentElement("beforebegin",n)}},A_=e=>{const t=ut();if(t)return Fa(t,ue[e]||ue.input)},k0=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:fg(t)||tn(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},Yt={};Yt.text=Yt.email=Yt.password=Yt.number=Yt.tel=Yt.url=Yt.search=Yt.date=Yt["datetime-local"]=Yt.time=Yt.week=Yt.month=(e,t)=>(k0(e,t.inputValue),bu(e,e,t),bg(e,t),e.type=t.input,e);Yt.file=(e,t)=>(bu(e,e,t),bg(e,t),e);Yt.range=(e,t)=>{const r=e.querySelector("input"),n=e.querySelector("output");return k0(r,t.inputValue),r.type=t.input,k0(n,t.inputValue),bu(r,e,t),e};Yt.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const r=document.createElement("option");In(r,t.inputPlaceholder),r.value="",r.disabled=!0,r.selected=!0,e.appendChild(r)}return bu(e,e,t),e};Yt.radio=e=>(e.textContent="",e);Yt.checkbox=(e,t)=>{const r=Tf(ut(),"checkbox");r.value="1",r.checked=!!t.inputValue;const n=e.querySelector("span");return In(n,t.inputPlaceholder||t.inputLabel),r};Yt.textarea=(e,t)=>{k0(e,t.inputValue),bg(e,t),bu(e,e,t);const r=n=>parseInt(window.getComputedStyle(n).marginLeft)+parseInt(window.getComputedStyle(n).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const n=parseInt(window.getComputedStyle(ut()).width),s=()=>{if(!document.body.contains(e))return;const a=e.offsetWidth+r(e);a>n?ut().style.width=`${a}px`:ji(ut(),"width",t.width)};new MutationObserver(s).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const HI=(e,t)=>{const r=hg();r&&(vg(r),Tn(r,t,"htmlContainer"),t.html?(wg(t.html,r),wr(r,"block")):t.text?(r.textContent=t.text,wr(r,"block")):zr(r),BI(e,t))},WI=(e,t)=>{const r=E_();r&&(vg(r),wu(r,t.footer,"block"),t.footer&&wg(t.footer,r),Tn(r,t,"footer"))},GI=(e,t)=>{const r=Nt.innerParams.get(e),n=xl();if(!n)return;if(r&&t.icon===r.icon){aw(n,t),sw(n,t);return}if(!t.icon&&!t.iconHtml){zr(n);return}if(t.icon&&Object.keys(N0).indexOf(t.icon)===-1){ro(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),zr(n);return}wr(n),aw(n,t),sw(n,t),dt(n,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",F_)},sw=(e,t)=>{for(const[r,n]of Object.entries(N0))t.icon!==r&&es(e,n);dt(e,t.icon&&N0[t.icon]),YI(e,t),F_(),Tn(e,t,"icon")},F_=()=>{const e=ut();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),r=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let n=0;n<r.length;n++)r[n].style.backgroundColor=t},XI=e=>`
  ${e.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${e.animation?'<div class="swal2-success-fix"></div>':""}
  ${e.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,KI=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,aw=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let r=e.innerHTML,n="";t.iconHtml?n=iw(t.iconHtml):t.icon==="success"?(n=XI(t),r=r.replace(/ style=".*?"/g,"")):t.icon==="error"?n=KI:t.icon&&(n=iw({question:"?",warning:"!",info:"i"}[t.icon])),r.trim()!==n.trim()&&In(e,n)},YI=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const r of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])nw(e,r,"background-color",t.iconColor);nw(e,".swal2-success-ring","border-color",t.iconColor)}},iw=e=>`<div class="${ue["icon-content"]}">${e}</div>`,qI=(e,t)=>{const r=S_();if(r){if(!t.imageUrl){zr(r);return}wr(r,""),r.setAttribute("src",t.imageUrl),r.setAttribute("alt",t.imageAlt||""),ji(r,"width",t.imageWidth),ji(r,"height",t.imageHeight),r.className=ue.image,Tn(r,t,"image")}};let Ng=!1,P_=0,D_=0,I_=0,R_=0;const ZI=e=>{e.addEventListener("mousedown",_0),document.body.addEventListener("mousemove",S0),e.addEventListener("mouseup",E0),e.addEventListener("touchstart",_0),document.body.addEventListener("touchmove",S0),e.addEventListener("touchend",E0)},JI=e=>{e.removeEventListener("mousedown",_0),document.body.removeEventListener("mousemove",S0),e.removeEventListener("mouseup",E0),e.removeEventListener("touchstart",_0),document.body.removeEventListener("touchmove",S0),e.removeEventListener("touchend",E0)},_0=e=>{const t=ut();if(e.target===t||xl().contains(e.target)){Ng=!0;const r=L_(e);P_=r.clientX,D_=r.clientY,I_=parseInt(t.style.insetInlineStart)||0,R_=parseInt(t.style.insetBlockStart)||0,dt(t,"swal2-dragging")}},S0=e=>{const t=ut();if(Ng){let{clientX:r,clientY:n}=L_(e);t.style.insetInlineStart=`${I_+(r-P_)}px`,t.style.insetBlockStart=`${R_+(n-D_)}px`}},E0=()=>{const e=ut();Ng=!1,es(e,"swal2-dragging")},L_=e=>{let t=0,r=0;return e.type.startsWith("mouse")?(t=e.clientX,r=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,r=e.touches[0].clientY),{clientX:t,clientY:r}},QI=(e,t)=>{const r=sn(),n=ut();if(!(!r||!n)){if(t.toast){ji(r,"width",t.width),n.style.width="100%";const s=vl();s&&n.insertBefore(s,xl())}else ji(n,"width",t.width);ji(n,"padding",t.padding),t.color&&(n.style.color=t.color),t.background&&(n.style.background=t.background),zr(Ef()),eR(n,t),t.draggable&&!t.toast?(dt(n,ue.draggable),ZI(n)):(es(n,ue.draggable),JI(n))}},eR=(e,t)=>{const r=t.showClass||{};e.className=`${ue.popup} ${hn(e)?r.popup:""}`,t.toast?(dt([document.documentElement,document.body],ue["toast-shown"]),dt(e,ue.toast)):dt(e,ue.modal),Tn(e,t,"popup"),typeof t.customClass=="string"&&dt(e,t.customClass),t.icon&&dt(e,ue[`icon-${t.icon}`])},tR=(e,t)=>{const r=mg();if(!r)return;const{progressSteps:n,currentProgressStep:s}=t;if(!n||n.length===0||s===void 0){zr(r);return}wr(r),r.textContent="",s>=n.length&&tn("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),n.forEach((a,o)=>{const l=rR(a);if(r.appendChild(l),o===s&&dt(l,ue["active-progress-step"]),o!==n.length-1){const c=nR(t);r.appendChild(c)}})},rR=e=>{const t=document.createElement("li");return dt(t,ue["progress-step"]),In(t,e),t},nR=e=>{const t=document.createElement("li");return dt(t,ue["progress-step-line"]),e.progressStepsDistance&&ji(t,"width",e.progressStepsDistance),t},sR=(e,t)=>{const r=__();r&&(vg(r),wu(r,t.title||t.titleText,"block"),t.title&&wg(t.title,r),t.titleText&&(r.innerText=t.titleText),Tn(r,t,"title"))},O_=(e,t)=>{QI(e,t),II(e,t),tR(e,t),GI(e,t),qI(e,t),sR(e,t),DI(e,t),HI(e,t),AI(e,t),WI(e,t);const r=ut();typeof t.didRender=="function"&&r&&t.didRender(r),Ue.eventEmitter.emit("didRender",r)},aR=()=>hn(ut()),M_=()=>{var e;return(e=Os())===null||e===void 0?void 0:e.click()},iR=()=>{var e;return(e=no())===null||e===void 0?void 0:e.click()},oR=()=>{var e;return(e=gl())===null||e===void 0?void 0:e.click()},yl=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),B_=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},lR=(e,t,r)=>{B_(e),t.toast||(e.keydownHandler=n=>uR(t,n,r),e.keydownTarget=t.keydownListenerCapture?window:ut(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},wp=(e,t)=>{var r;const n=xg();if(n.length){e=e+t,e===-2&&(e=n.length-1),e===n.length?e=0:e===-1&&(e=n.length-1),n[e].focus();return}(r=ut())===null||r===void 0||r.focus()},U_=["ArrowRight","ArrowDown"],cR=["ArrowLeft","ArrowUp"],uR=(e,t,r)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?dR(t,e):t.key==="Tab"?fR(t):[...U_,...cR].includes(t.key)?hR(t.key):t.key==="Escape"&&mR(t,e,r)))},dR=(e,t)=>{if(!Sf(t.allowEnterKey))return;const r=Tf(ut(),t.input);if(e.target&&r&&e.target instanceof HTMLElement&&e.target.outerHTML===r.outerHTML){if(["textarea","file"].includes(t.input))return;M_(),e.preventDefault()}},fR=e=>{const t=e.target,r=xg();let n=-1;for(let s=0;s<r.length;s++)if(t===r[s]){n=s;break}e.shiftKey?wp(n,-1):wp(n,1),e.stopPropagation(),e.preventDefault()},hR=e=>{const t=yu(),r=Os(),n=no(),s=gl();if(!t||!r||!n||!s)return;const a=[r,n,s];if(document.activeElement instanceof HTMLElement&&!a.includes(document.activeElement))return;const o=U_.includes(e)?"nextElementSibling":"previousElementSibling";let l=document.activeElement;if(l){for(let c=0;c<t.children.length;c++){if(l=l[o],!l)return;if(l instanceof HTMLButtonElement&&hn(l))break}l instanceof HTMLButtonElement&&l.focus()}},mR=(e,t,r)=>{e.preventDefault(),Sf(t.allowEscapeKey)&&r(yl.esc)};var sl={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const pR=()=>{const e=sn();Array.from(document.body.children).forEach(r=>{r.contains(e)||(r.hasAttribute("aria-hidden")&&r.setAttribute("data-previous-aria-hidden",r.getAttribute("aria-hidden")||""),r.setAttribute("aria-hidden","true"))})},V_=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},$_=typeof window<"u"&&!!window.GestureEvent,xR=()=>{if($_&&!Qs(document.body,ue.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,dt(document.body,ue.iosfix),gR()}},gR=()=>{const e=sn();if(!e)return;let t;e.ontouchstart=r=>{t=vR(r)},e.ontouchmove=r=>{t&&(r.preventDefault(),r.stopPropagation())}},vR=e=>{const t=e.target,r=sn(),n=hg();return!r||!n||yR(e)||wR(e)?!1:t===r||!yp(r)&&t instanceof HTMLElement&&!vI(t,n)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(yp(n)&&n.contains(t))},yR=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",wR=e=>e.touches&&e.touches.length>1,bR=()=>{if(Qs(document.body,ue.iosfix)){const e=parseInt(document.body.style.top,10);es(document.body,ue.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},NR=()=>{const e=document.createElement("div");e.className=ue["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let $o=null;const kR=e=>{$o===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&($o=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${$o+NR()}px`)},_R=()=>{$o!==null&&(document.body.style.paddingRight=`${$o}px`,$o=null)};function z_(e,t,r,n){jf()?ow(e,n):(lI(r).then(()=>ow(e,n)),B_(Ue)),$_?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),gg()&&(_R(),bR(),V_()),SR()}function SR(){es([document.documentElement,document.body],[ue.shown,ue["height-auto"],ue["no-backdrop"],ue["toast-shown"]])}function Pa(e){e=CR(e);const t=sl.swalPromiseResolve.get(this),r=ER(this);this.isAwaitingPromise?e.isDismissed||(Nu(this),t(e)):r&&t(e)}const ER=e=>{const t=ut();if(!t)return!1;const r=Nt.innerParams.get(e);if(!r||Qs(t,r.hideClass.popup))return!1;es(t,r.showClass.popup),dt(t,r.hideClass.popup);const n=sn();return es(n,r.showClass.backdrop),dt(n,r.hideClass.backdrop),jR(e,t,r),!0};function H_(e){const t=sl.swalPromiseReject.get(this);Nu(this),t&&t(e)}const Nu=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,Nt.innerParams.get(e)||e._destroy())},CR=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),jR=(e,t,r)=>{var n;const s=sn(),a=T_(t);typeof r.willClose=="function"&&r.willClose(t),(n=Ue.eventEmitter)===null||n===void 0||n.emit("willClose",t),a?TR(e,t,s,r.returnFocus,r.didClose):z_(e,s,r.returnFocus,r.didClose)},TR=(e,t,r,n,s)=>{Ue.swalCloseEventFinishedCallback=z_.bind(null,e,r,n,s);const a=function(o){if(o.target===t){var l;(l=Ue.swalCloseEventFinishedCallback)===null||l===void 0||l.call(Ue),delete Ue.swalCloseEventFinishedCallback,t.removeEventListener("animationend",a),t.removeEventListener("transitionend",a)}};t.addEventListener("animationend",a),t.addEventListener("transitionend",a)},ow=(e,t)=>{setTimeout(()=>{var r;typeof t=="function"&&t.bind(e.params)(),(r=Ue.eventEmitter)===null||r===void 0||r.emit("didClose"),e._destroy&&e._destroy()})},al=e=>{let t=ut();if(t||new tt,t=ut(),!t)return;const r=vl();jf()?zr(xl()):AR(t,e),wr(r),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},AR=(e,t)=>{const r=yu(),n=vl();!r||!n||(!t&&hn(Os())&&(t=Os()),wr(r),t&&(zr(t),n.setAttribute("data-button-to-replace",t.className),r.insertBefore(n,t)),dt([e,r],ue.loading))},FR=(e,t)=>{t.input==="select"||t.input==="radio"?LR(e,t):["text","email","number","tel","textarea"].some(r=>r===t.input)&&(dg(t.inputValue)||fg(t.inputValue))&&(al(Os()),OR(e,t))},PR=(e,t)=>{const r=e.getInput();if(!r)return null;switch(t.input){case"checkbox":return DR(r);case"radio":return IR(r);case"file":return RR(r);default:return t.inputAutoTrim?r.value.trim():r.value}},DR=e=>e.checked?1:0,IR=e=>e.checked?e.value:null,RR=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,LR=(e,t)=>{const r=ut();if(!r)return;const n=s=>{t.input==="select"?MR(r,C0(s),t):t.input==="radio"&&BR(r,C0(s),t)};dg(t.inputOptions)||fg(t.inputOptions)?(al(Os()),gu(t.inputOptions).then(s=>{e.hideLoading(),n(s)})):typeof t.inputOptions=="object"?n(t.inputOptions):ro(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},OR=(e,t)=>{const r=e.getInput();r&&(zr(r),gu(t.inputValue).then(n=>{r.value=t.input==="number"?`${parseFloat(n)||0}`:`${n}`,wr(r),r.focus(),e.hideLoading()}).catch(n=>{ro(`Error in inputValue promise: ${n}`),r.value="",wr(r),r.focus(),e.hideLoading()}))};function MR(e,t,r){const n=Fa(e,ue.select);if(!n)return;const s=(a,o,l)=>{const c=document.createElement("option");c.value=l,In(c,o),c.selected=W_(l,r.inputValue),a.appendChild(c)};t.forEach(a=>{const o=a[0],l=a[1];if(Array.isArray(l)){const c=document.createElement("optgroup");c.label=o,c.disabled=!1,n.appendChild(c),l.forEach(u=>s(c,u[1],u[0]))}else s(n,l,o)}),n.focus()}function BR(e,t,r){const n=Fa(e,ue.radio);if(!n)return;t.forEach(a=>{const o=a[0],l=a[1],c=document.createElement("input"),u=document.createElement("label");c.type="radio",c.name=ue.radio,c.value=o,W_(o,r.inputValue)&&(c.checked=!0);const d=document.createElement("span");In(d,l),d.className=ue.label,u.appendChild(c),u.appendChild(d),n.appendChild(u)});const s=n.querySelectorAll("input");s.length&&s[0].focus()}const C0=e=>{const t=[];return e instanceof Map?e.forEach((r,n)=>{let s=r;typeof s=="object"&&(s=C0(s)),t.push([n,s])}):Object.keys(e).forEach(r=>{let n=e[r];typeof n=="object"&&(n=C0(n)),t.push([r,n])}),t},W_=(e,t)=>!!t&&t.toString()===e.toString(),UR=e=>{const t=Nt.innerParams.get(e);e.disableButtons(),t.input?G_(e,"confirm"):_g(e,!0)},VR=e=>{const t=Nt.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?G_(e,"deny"):kg(e,!1)},$R=(e,t)=>{e.disableButtons(),t(yl.cancel)},G_=(e,t)=>{const r=Nt.innerParams.get(e);if(!r.input){ro(`The "input" parameter is needed to be set when using returnInputValueOn${ug(t)}`);return}const n=e.getInput(),s=PR(e,r);r.inputValidator?zR(e,s,t):n&&!n.checkValidity()?(e.enableButtons(),e.showValidationMessage(r.validationMessage||n.validationMessage)):t==="deny"?kg(e,s):_g(e,s)},zR=(e,t,r)=>{const n=Nt.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>gu(n.inputValidator(t,n.validationMessage))).then(a=>{e.enableButtons(),e.enableInput(),a?e.showValidationMessage(a):r==="deny"?kg(e,t):_g(e,t)})},kg=(e,t)=>{const r=Nt.innerParams.get(e||void 0);r.showLoaderOnDeny&&al(no()),r.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>gu(r.preDeny(t,r.validationMessage))).then(s=>{s===!1?(e.hideLoading(),Nu(e)):e.close({isDenied:!0,value:typeof s>"u"?t:s})}).catch(s=>X_(e||void 0,s))):e.close({isDenied:!0,value:t})},lw=(e,t)=>{e.close({isConfirmed:!0,value:t})},X_=(e,t)=>{e.rejectPromise(t)},_g=(e,t)=>{const r=Nt.innerParams.get(e||void 0);r.showLoaderOnConfirm&&al(),r.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>gu(r.preConfirm(t,r.validationMessage))).then(s=>{hn(Ef())||s===!1?(e.hideLoading(),Nu(e)):lw(e,typeof s>"u"?t:s)}).catch(s=>X_(e||void 0,s))):lw(e,t)};function j0(){const e=Nt.innerParams.get(this);if(!e)return;const t=Nt.domCache.get(this);zr(t.loader),jf()?e.icon&&wr(xl()):HR(t),es([t.popup,t.actions],ue.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const HR=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?wr(t[0],"inline-block"):gI()&&zr(e.actions)};function K_(){const e=Nt.innerParams.get(this),t=Nt.domCache.get(this);return t?Tf(t.popup,e.input):null}function Y_(e,t,r){const n=Nt.domCache.get(e);t.forEach(s=>{n[s].disabled=r})}function q_(e,t){const r=ut();if(!(!r||!e))if(e.type==="radio"){const n=r.querySelectorAll(`[name="${ue.radio}"]`);for(let s=0;s<n.length;s++)n[s].disabled=t}else e.disabled=t}function Z_(){Y_(this,["confirmButton","denyButton","cancelButton"],!1)}function J_(){Y_(this,["confirmButton","denyButton","cancelButton"],!0)}function Q_(){q_(this.getInput(),!1)}function eS(){q_(this.getInput(),!0)}function tS(e){const t=Nt.domCache.get(this),r=Nt.innerParams.get(this);In(t.validationMessage,e),t.validationMessage.className=ue["validation-message"],r.customClass&&r.customClass.validationMessage&&dt(t.validationMessage,r.customClass.validationMessage),wr(t.validationMessage);const n=this.getInput();n&&(n.setAttribute("aria-invalid","true"),n.setAttribute("aria-describedby",ue["validation-message"]),C_(n),dt(n,ue.inputerror))}function rS(){const e=Nt.domCache.get(this);e.validationMessage&&zr(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),es(t,ue.inputerror))}const zo={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},WR=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],GR={allowEnterKey:void 0},XR=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],nS=e=>Object.prototype.hasOwnProperty.call(zo,e),sS=e=>WR.indexOf(e)!==-1,aS=e=>GR[e],KR=e=>{nS(e)||tn(`Unknown parameter "${e}"`)},YR=e=>{XR.includes(e)&&tn(`The parameter "${e}" is incompatible with toasts`)},qR=e=>{const t=aS(e);t&&k_(e,t)},iS=e=>{e.backdrop===!1&&e.allowOutsideClick&&tn('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(e.theme)&&tn(`Invalid theme "${e.theme}"`);for(const t in e)KR(t),e.toast&&YR(t),qR(t)};function oS(e){const t=sn(),r=ut(),n=Nt.innerParams.get(this);if(!r||Qs(r,n.hideClass.popup)){tn("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const s=ZR(e),a=Object.assign({},n,s);iS(a),t.dataset.swal2Theme=a.theme,O_(this,a),Nt.innerParams.set(this,a),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const ZR=e=>{const t={};return Object.keys(e).forEach(r=>{sS(r)?t[r]=e[r]:tn(`Invalid parameter to update: ${r}`)}),t};function lS(){const e=Nt.domCache.get(this),t=Nt.innerParams.get(this);if(!t){cS(this);return}e.popup&&Ue.swalCloseEventFinishedCallback&&(Ue.swalCloseEventFinishedCallback(),delete Ue.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),Ue.eventEmitter.emit("didDestroy"),JR(this)}const JR=e=>{cS(e),delete e.params,delete Ue.keydownHandler,delete Ue.keydownTarget,delete Ue.currentInstance},cS=e=>{e.isAwaitingPromise?(Lh(Nt,e),e.isAwaitingPromise=!0):(Lh(sl,e),Lh(Nt,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},Lh=(e,t)=>{for(const r in e)e[r].delete(t)};var QR=Object.freeze({__proto__:null,_destroy:lS,close:Pa,closeModal:Pa,closePopup:Pa,closeToast:Pa,disableButtons:J_,disableInput:eS,disableLoading:j0,enableButtons:Z_,enableInput:Q_,getInput:K_,handleAwaitingPromise:Nu,hideLoading:j0,rejectPromise:H_,resetValidationMessage:rS,showValidationMessage:tS,update:oS});const eL=(e,t,r)=>{e.toast?tL(e,t,r):(nL(t),sL(t),aL(e,t,r))},tL=(e,t,r)=>{t.popup.onclick=()=>{e&&(rL(e)||e.timer||e.input)||r(yl.close)}},rL=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let T0=!1;const nL=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(T0=!0)}}},sL=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(r){e.popup.onmouseup=()=>{},(r.target===e.popup||r.target instanceof HTMLElement&&e.popup.contains(r.target))&&(T0=!0)}}},aL=(e,t,r)=>{t.container.onclick=n=>{if(T0){T0=!1;return}n.target===t.container&&Sf(e.allowOutsideClick)&&r(yl.backdrop)}},iL=e=>typeof e=="object"&&e.jquery,cw=e=>e instanceof Element||iL(e),oL=e=>{const t={};return typeof e[0]=="object"&&!cw(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((r,n)=>{const s=e[n];typeof s=="string"||cw(s)?t[r]=s:s!==void 0&&ro(`Unexpected type of ${r}! Expected "string" or "Element", got ${typeof s}`)}),t};function lL(...e){return new this(...e)}function cL(e){class t extends this{_main(n,s){return super._main(n,Object.assign({},e,s))}}return t}const uL=()=>Ue.timeout&&Ue.timeout.getTimerLeft(),uS=()=>{if(Ue.timeout)return yI(),Ue.timeout.stop()},dS=()=>{if(Ue.timeout){const e=Ue.timeout.start();return yg(e),e}},dL=()=>{const e=Ue.timeout;return e&&(e.running?uS():dS())},fL=e=>{if(Ue.timeout){const t=Ue.timeout.increase(e);return yg(t,!0),t}},hL=()=>!!(Ue.timeout&&Ue.timeout.isRunning());let uw=!1;const bp={};function mL(e="data-swal-template"){bp[e]=this,uw||(document.body.addEventListener("click",pL),uw=!0)}const pL=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const r in bp){const n=t.getAttribute(r);if(n){bp[r].fire({template:n});return}}};class xL{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,r){const n=this._getHandlersByEventName(t);n.includes(r)||n.push(r)}once(t,r){const n=(...s)=>{this.removeListener(t,n),r.apply(this,s)};this.on(t,n)}emit(t,...r){this._getHandlersByEventName(t).forEach(n=>{try{n.apply(this,r)}catch(s){console.error(s)}})}removeListener(t,r){const n=this._getHandlersByEventName(t),s=n.indexOf(r);s>-1&&n.splice(s,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}Ue.eventEmitter=new xL;const gL=(e,t)=>{Ue.eventEmitter.on(e,t)},vL=(e,t)=>{Ue.eventEmitter.once(e,t)},yL=(e,t)=>{if(!e){Ue.eventEmitter.reset();return}t?Ue.eventEmitter.removeListener(e,t):Ue.eventEmitter.removeAllListeners(e)};var wL=Object.freeze({__proto__:null,argsToParams:oL,bindClickHandler:mL,clickCancel:oR,clickConfirm:M_,clickDeny:iR,enableLoading:al,fire:lL,getActions:yu,getCancelButton:gl,getCloseButton:pg,getConfirmButton:Os,getContainer:sn,getDenyButton:no,getFocusableElements:xg,getFooter:E_,getHtmlContainer:hg,getIcon:xl,getIconContent:fI,getImage:S_,getInputLabel:hI,getLoader:vl,getPopup:ut,getProgressSteps:mg,getTimerLeft:uL,getTimerProgressBar:Cf,getTitle:__,getValidationMessage:Ef,increaseTimer:fL,isDeprecatedParameter:aS,isLoading:pI,isTimerRunning:hL,isUpdatableParameter:sS,isValidParameter:nS,isVisible:aR,mixin:cL,off:yL,on:gL,once:vL,resumeTimer:dS,showLoading:al,stopTimer:uS,toggleTimer:dL});class bL{constructor(t,r){this.callback=t,this.remaining=r,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const r=this.running;return r&&this.stop(),this.remaining+=t,r&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const fS=["swal-title","swal-html","swal-footer"],NL=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const r=t.content;return AL(r),Object.assign(kL(r),_L(r),SL(r),EL(r),CL(r),jL(r),TL(r,fS))},kL=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(n=>{Hi(n,["name","value"]);const s=n.getAttribute("name"),a=n.getAttribute("value");!s||!a||(typeof zo[s]=="boolean"?t[s]=a!=="false":typeof zo[s]=="object"?t[s]=JSON.parse(a):t[s]=a)}),t},_L=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(n=>{const s=n.getAttribute("name"),a=n.getAttribute("value");!s||!a||(t[s]=new Function(`return ${a}`)())}),t},SL=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(n=>{Hi(n,["type","color","aria-label"]);const s=n.getAttribute("type");!s||!["confirm","cancel","deny"].includes(s)||(t[`${s}ButtonText`]=n.innerHTML,t[`show${ug(s)}Button`]=!0,n.hasAttribute("color")&&(t[`${s}ButtonColor`]=n.getAttribute("color")),n.hasAttribute("aria-label")&&(t[`${s}ButtonAriaLabel`]=n.getAttribute("aria-label")))}),t},EL=e=>{const t={},r=e.querySelector("swal-image");return r&&(Hi(r,["src","width","height","alt"]),r.hasAttribute("src")&&(t.imageUrl=r.getAttribute("src")||void 0),r.hasAttribute("width")&&(t.imageWidth=r.getAttribute("width")||void 0),r.hasAttribute("height")&&(t.imageHeight=r.getAttribute("height")||void 0),r.hasAttribute("alt")&&(t.imageAlt=r.getAttribute("alt")||void 0)),t},CL=e=>{const t={},r=e.querySelector("swal-icon");return r&&(Hi(r,["type","color"]),r.hasAttribute("type")&&(t.icon=r.getAttribute("type")),r.hasAttribute("color")&&(t.iconColor=r.getAttribute("color")),t.iconHtml=r.innerHTML),t},jL=e=>{const t={},r=e.querySelector("swal-input");r&&(Hi(r,["type","label","placeholder","value"]),t.input=r.getAttribute("type")||"text",r.hasAttribute("label")&&(t.inputLabel=r.getAttribute("label")),r.hasAttribute("placeholder")&&(t.inputPlaceholder=r.getAttribute("placeholder")),r.hasAttribute("value")&&(t.inputValue=r.getAttribute("value")));const n=Array.from(e.querySelectorAll("swal-input-option"));return n.length&&(t.inputOptions={},n.forEach(s=>{Hi(s,["value"]);const a=s.getAttribute("value");if(!a)return;const o=s.innerHTML;t.inputOptions[a]=o})),t},TL=(e,t)=>{const r={};for(const n in t){const s=t[n],a=e.querySelector(s);a&&(Hi(a,[]),r[s.replace(/^swal-/,"")]=a.innerHTML.trim())}return r},AL=e=>{const t=fS.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(r=>{const n=r.tagName.toLowerCase();t.includes(n)||tn(`Unrecognized element <${n}>`)})},Hi=(e,t)=>{Array.from(e.attributes).forEach(r=>{t.indexOf(r.name)===-1&&tn([`Unrecognized attribute "${r.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},hS=10,FL=e=>{const t=sn(),r=ut();typeof e.willOpen=="function"&&e.willOpen(r),Ue.eventEmitter.emit("willOpen",r);const s=window.getComputedStyle(document.body).overflowY;IL(t,r,e),setTimeout(()=>{PL(t,r)},hS),gg()&&(DL(t,e.scrollbarPadding,s),pR()),!jf()&&!Ue.previousActiveElement&&(Ue.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(r)),Ue.eventEmitter.emit("didOpen",r),es(t,ue["no-transition"])},A0=e=>{const t=ut();if(e.target!==t)return;const r=sn();t.removeEventListener("animationend",A0),t.removeEventListener("transitionend",A0),r.style.overflowY="auto"},PL=(e,t)=>{T_(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",A0),t.addEventListener("transitionend",A0)):e.style.overflowY="auto"},DL=(e,t,r)=>{xR(),t&&r!=="hidden"&&kR(r),setTimeout(()=>{e.scrollTop=0})},IL=(e,t,r)=>{dt(e,r.showClass.backdrop),r.animation?(t.style.setProperty("opacity","0","important"),wr(t,"grid"),setTimeout(()=>{dt(t,r.showClass.popup),t.style.removeProperty("opacity")},hS)):wr(t,"grid"),dt([document.documentElement,document.body],ue.shown),r.heightAuto&&r.backdrop&&!r.toast&&dt([document.documentElement,document.body],ue["height-auto"])};var dw={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function RL(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=dw.email),e.input==="url"&&(e.inputValidator=dw.url))}function LL(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(tn('Target parameter is not valid, defaulting to "body"'),e.target="body")}function OL(e){RL(e),e.showLoaderOnConfirm&&!e.preConfirm&&tn(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),LL(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),CI(e)}let js;var sd=new WeakMap;class Qt{constructor(...t){if(sI(this,sd,void 0),typeof window>"u")return;js=this;const r=Object.freeze(this.constructor.argsToParams(t));this.params=r,this.isAwaitingPromise=!1,aI(sd,this,this._main(js.params))}_main(t,r={}){if(iS(Object.assign({},r,t)),Ue.currentInstance){const a=sl.swalPromiseResolve.get(Ue.currentInstance),{isAwaitingPromise:o}=Ue.currentInstance;Ue.currentInstance._destroy(),o||a({isDismissed:!0}),gg()&&V_()}Ue.currentInstance=js;const n=BL(t,r);OL(n),Object.freeze(n),Ue.timeout&&(Ue.timeout.stop(),delete Ue.timeout),clearTimeout(Ue.restoreFocusTimeout);const s=UL(js);return O_(js,n),Nt.innerParams.set(js,n),ML(js,s,n)}then(t){return tw(sd,this).then(t)}finally(t){return tw(sd,this).finally(t)}}const ML=(e,t,r)=>new Promise((n,s)=>{const a=o=>{e.close({isDismissed:!0,dismiss:o})};sl.swalPromiseResolve.set(e,n),sl.swalPromiseReject.set(e,s),t.confirmButton.onclick=()=>{UR(e)},t.denyButton.onclick=()=>{VR(e)},t.cancelButton.onclick=()=>{$R(e,a)},t.closeButton.onclick=()=>{a(yl.close)},eL(r,t,a),lR(Ue,r,a),FR(e,r),FL(r),VL(Ue,r,a),$L(t,r),setTimeout(()=>{t.container.scrollTop=0})}),BL=(e,t)=>{const r=NL(e),n=Object.assign({},zo,t,r,e);return n.showClass=Object.assign({},zo.showClass,n.showClass),n.hideClass=Object.assign({},zo.hideClass,n.hideClass),n.animation===!1&&(n.showClass={backdrop:"swal2-noanimation"},n.hideClass={}),n},UL=e=>{const t={popup:ut(),container:sn(),actions:yu(),confirmButton:Os(),denyButton:no(),cancelButton:gl(),loader:vl(),closeButton:pg(),validationMessage:Ef(),progressSteps:mg()};return Nt.domCache.set(e,t),t},VL=(e,t,r)=>{const n=Cf();zr(n),t.timer&&(e.timeout=new bL(()=>{r("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(wr(n),Tn(n,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&yg(t.timer)})))},$L=(e,t)=>{if(!t.toast){if(!Sf(t.allowEnterKey)){k_("allowEnterKey"),WL();return}zL(e)||HL(e,t)||wp(-1,1)}},zL=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const r of t)if(r instanceof HTMLElement&&hn(r))return r.focus(),!0;return!1},HL=(e,t)=>t.focusDeny&&hn(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&hn(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&hn(e.confirmButton)?(e.confirmButton.focus(),!0):!1,WL=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const e=new Date,t=localStorage.getItem("swal-initiation");t?(e.getTime()-Date.parse(t))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const r=document.createElement("audio");r.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",r.loop=!0,document.body.appendChild(r),setTimeout(()=>{r.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${e}`)}Qt.prototype.disableButtons=J_;Qt.prototype.enableButtons=Z_;Qt.prototype.getInput=K_;Qt.prototype.disableInput=eS;Qt.prototype.enableInput=Q_;Qt.prototype.hideLoading=j0;Qt.prototype.disableLoading=j0;Qt.prototype.showValidationMessage=tS;Qt.prototype.resetValidationMessage=rS;Qt.prototype.close=Pa;Qt.prototype.closePopup=Pa;Qt.prototype.closeModal=Pa;Qt.prototype.closeToast=Pa;Qt.prototype.rejectPromise=H_;Qt.prototype.update=oS;Qt.prototype._destroy=lS;Object.assign(Qt,wL);Object.keys(QR).forEach(e=>{Qt[e]=function(...t){return js&&js[e]?js[e](...t):null}});Qt.DismissReason=yl;Qt.version="11.22.2";const tt=Qt;tt.default=tt;typeof document<"u"&&function(e,t){var r=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(r),r.styleSheet)r.styleSheet.disabled||(r.styleSheet.cssText=t);else try{r.innerHTML=t}catch{r.innerText=t}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const GL=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,u]=E.useState(""),[d,f]=E.useState(1),[h]=E.useState(15),[m,g]=E.useState(null),[p,v]=E.useState([]);E.useEffect(()=>{(async()=>{a(!0);try{const Z=await b(),j=await Cs.getAll({branchId:e,page:d,limit:h});if(j.data.success){const Y=j.data.data.map(q=>{const S=Z.find(F=>F.product_id===q.id);return{...q,display_name:(S==null?void 0:S.product_name)||q.product_name}});n(Y)}else console.error("Error loading products:",j.data.message);a(!1)}catch(Z){console.error("Error loading data:",Z),a(!1)}})()},[e,d]);const b=async()=>{var I;try{if(e){const Z=await Ci.getAll(e),j=(I=Z.data)!=null&&I.success?Z.data.data:Z.data||[];return v(j),j}return[]}catch(Z){return console.error("Error loading contracts:",Z),v([]),[]}},y=r.filter(I=>I.display_name&&I.display_name.toLowerCase().includes(c.toLowerCase())||I.product_code&&I.product_code.toLowerCase().includes(c.toLowerCase())||I.shop_name&&I.shop_name.toLowerCase().includes(c.toLowerCase())||I.contract_number&&I.contract_number.toLowerCase().includes(c.toLowerCase())),x=d*h,N=x-h,_=y.slice(N,x),k=Math.ceil(y.length/h);E.useEffect(()=>{f(1)},[c]);const w=I=>{f(I)},C=I=>{tt.fire({title:"ไปดูตารางผ่อน",html:`
        <div class="text-left">
          <p>คุณต้องการไปดูตารางผ่อนของสัญญา</p>
          <p><strong>${I}</strong> ในหน้าของเช็คเกอร์หรือไม่?</p>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"ไปดู",cancelButtonText:"ยกเลิก",confirmButtonColor:"#7c3aed",cancelButtonColor:"#6b7280",reverseButtons:!0}).then(Z=>{Z.isConfirmed&&(localStorage.setItem("selectedContractForChecker",I),tt.fire({icon:"info",title:"ไปหน้าของเช็คเกอร์",html:`
            <div class="text-left">
              <p>กรุณาไปที่ <strong>เมนู "รายงานค่างวด"</strong> ในหน้าของเช็คเกอร์</p>
              <p>ระบบจะแสดงตารางผ่อนของสัญญา <strong>${I}</strong> ให้อัตโนมัติ</p>
            </div>
          `,confirmButtonText:"เข้าใจแล้ว",confirmButtonColor:"#7c3aed"}))})},D=async I=>{var Z;try{l(!0);const j={product_name:I.productName,product_code:I.productCode,shop_name:I.shopName,contract_number:I.contract,cost_price:parseFloat((Z=I.costPrice)==null?void 0:Z.replace(/,/g,"")),receive_date:I.receiveDate,remarks:I.remarks,branch_id:e,status:"active",remaining_quantity1:1,sold_quantity1:0},Y=await Cs.create(j);if(Y.data.success){const q=await Cs.getAll({branchId:e,page:d,limit:h});if(q.data.success){const S=q.data.data.map(F=>{const L=p.find(T=>T.product_id===F.id);return{...F,display_name:(L==null?void 0:L.product_name)||F.product_name}});n(S)}tt.fire({icon:"success",title:"สำเร็จ!",text:"เพิ่มสินค้าเรียบร้อยแล้ว",confirmButtonText:"ตกลง",confirmButtonColor:"#10b981"})}else throw new Error(Y.data.message||"Failed to add product")}catch(j){console.error("Error adding product:",j),tt.fire({icon:"error",title:"เกิดข้อผิดพลาด!",text:"ไม่สามารถเพิ่มสินค้าได้",confirmButtonText:"ตกลง",confirmButtonColor:"#ef4444"})}finally{l(!1)}},z=async I=>{if((await tt.fire({title:"ยืนยันการลบ",text:"คุณต้องการลบสินค้านี้หรือไม่?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก"})).isConfirmed)try{const j=await Cs.delete(I);if(j.data.success){const Y=await Cs.getAll({branchId:e,page:d,limit:h});if(Y.data.success){const q=Y.data.data.map(S=>{const F=p.find(L=>L.product_id===S.id);return{...S,display_name:(F==null?void 0:F.product_name)||S.product_name}});n(q)}tt.fire({icon:"success",title:"สำเร็จ!",text:"ลบสินค้าเรียบร้อยแล้ว",confirmButtonText:"ตกลง",confirmButtonColor:"#10b981"})}else throw new Error(j.data.message||"Failed to delete product")}catch(j){console.error("Error deleting product:",j),tt.fire({icon:"error",title:"เกิดข้อผิดพลาด!",text:"ไม่สามารถลบสินค้าได้",confirmButtonText:"ตกลง",confirmButtonColor:"#ef4444"})}},A=I=>{g(I)},R=async I=>{var Z;try{l(!0);const j={product_name:I.productName||m.product_name,product_code:I.productCode||m.product_code,shop_name:I.shopName||m.shop_name,contract_number:I.contract||m.contract_number,cost_price:parseFloat((Z=I.costPrice)==null?void 0:Z.replace(/,/g,""))||m.cost_price,receive_date:I.receiveDate||m.receive_date,remarks:I.remarks||m.remarks},Y=await Cs.update(m.id,j);if(Y.data.success){const q=await Cs.getAll({branchId:e,page:d,limit:h});if(q.data.success){const S=q.data.data.map(F=>{const L=p.find(T=>T.product_id===F.id);return{...F,display_name:(L==null?void 0:L.product_name)||F.product_name}});n(S)}g(null),tt.fire({icon:"success",title:"สำเร็จ!",text:"แก้ไขสินค้าเรียบร้อยแล้ว",confirmButtonText:"ตกลง",confirmButtonColor:"#10b981"})}else throw new Error(Y.data.message||"Failed to update product")}catch(j){console.error("Error updating product:",j),tt.fire({icon:"error",title:"เกิดข้อผิดพลาด!",text:"ไม่สามารถแก้ไขสินค้าได้",confirmButtonText:"ตกลง",confirmButtonColor:"#ef4444"})}finally{l(!1)}},G=async()=>{(await tt.fire({title:"ยืนยันการยกเลิก",text:"คุณต้องการยกเลิกการแก้ไขหรือไม่? ข้อมูลที่แก้ไขจะหายไป",icon:"question",showCancelButton:!0,confirmButtonColor:"#6b7280",cancelButtonColor:"#10b981",confirmButtonText:"ยกเลิก",cancelButtonText:"แก้ไขต่อ"})).isConfirmed&&g(null)};return s?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการสินค้า"}),i.jsx("p",{className:"text-gray-600",children:"กำลังโหลดข้อมูล..."})]})}),i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Ut,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"กำลังโหลดข้อมูลสินค้า..."})]})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการสินค้า"}),i.jsxs("p",{className:"text-gray-600",children:["เพิ่ม แก้ไข และจัดการสินค้าในระบบ - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Qr,{className:"w-4 h-4"}),i.jsxs("span",{children:["สินค้าทั้งหมด: ",r.length," รายการ"]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("div",{className:"mb-4 p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-emerald-700",children:[i.jsx(la,{className:"w-4 h-4"}),i.jsxs("span",{children:["สินค้าจะถูกเพิ่มในสาขา: ",i.jsx("strong",{children:t==null?void 0:t.name})]})]})}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:m?"แก้ไขสินค้า":"เพิ่มสินค้าใหม่"}),m?i.jsxs("div",{className:"space-y-4",children:[i.jsx(Vy,{onAddProduct:R,submitting:o,contracts:p,initialData:{productCode:m.product_code||"",productName:m.display_name||m.product_name||"",shopName:m.shop_name||"",contract:m.contract_number||"",costPrice:m.cost_price?m.cost_price.toString():"",receiveDate:m.receive_date?m.receive_date.split("T")[0]:"",remarks:m.remarks||""}}),i.jsx("div",{className:"flex gap-2",children:i.jsx(oe,{onClick:G,variant:"outline",className:"flex-1",children:"ยกเลิก"})})]}):i.jsx(Vy,{onAddProduct:D,submitting:o,contracts:p})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"ค้นหาสินค้า รหัส ร้านค้า หรือสัญญา...",value:c,onChange:I=>u(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs(oe,{variant:"outline",className:"flex items-center gap-2",children:[i.jsx($c,{className:"w-4 h-4"}),"กรอง"]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ลำดับ"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ว.ด.ป./รับ"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"รหัสสินค้า"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สินค้า"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ร้านค้า"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สัญญา"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ราคาต้นทุน"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ว.ด.ป./ขาย"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ต้นทุนขาย"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"คงเหลือ"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"รับ"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ขาย"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"คงเหลือ"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"หมายเหตุ"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จัดการ"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(I=>i.jsxs(Me.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:I.sequence}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.receive_date?new Date(I.receive_date).toLocaleDateString("th-TH"):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.product_code||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:I.display_name,children:I.display_name}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.shop_name||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:I.contract_number?i.jsx("button",{onClick:()=>C(I.contract_number),className:"text-red-600 font-medium hover:text-red-800 hover:underline cursor-pointer transition-colors",title:"คลิกเพื่อดูตารางผ่อน",children:I.contract_number}):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.cost_price?I.cost_price.toLocaleString():"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.sell_date?new Date(I.sell_date).toLocaleDateString("th-TH"):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.cost_price?I.cost_price.toLocaleString():"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.remaining_quantity1}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.received_quantity}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.sold_quantity||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:I.remaining_quantity2}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:I.remarks,children:I.remarks?i.jsx("span",{className:I.remarks.includes("มาวันที่")?"text-red-600":"",children:I.remarks}):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>A(I),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Bs,{className:"w-4 h-4"})}),i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>z(I.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ha,{className:"w-4 h-4"})})]})})]},I.id))})]})}),_.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Qr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ไม่พบสินค้า"}),i.jsx("p",{className:"text-gray-500",children:"ลองเปลี่ยนคำค้นหาหรือเพิ่มสินค้าใหม่"})]})]}),y.length>h&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["แสดง ",N+1," ถึง ",Math.min(x,y.length)," จาก ",y.length," รายการ"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>w(d-1),disabled:d===1,className:"flex items-center gap-1",children:[i.jsx(V4,{className:"w-4 h-4"}),"ก่อนหน้า"]}),i.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:k},(I,Z)=>{const j=Z+1;return j===1||j===k||j>=d-1&&j<=d+1?i.jsx(oe,{variant:j===d?"default":"outline",size:"sm",onClick:()=>w(j),className:"w-8 h-8 p-0",children:j},j):j===d-2||j===d+2?i.jsx("span",{className:"px-2 text-gray-500",children:"..."},j):null})}),i.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>w(d+1),disabled:d===k,className:"flex items-center gap-1",children:["ถัดไป",i.jsx($4,{className:"w-4 h-4"})]})]})]})})]})},ki={getAll:async(e,t,r,n)=>{const s={};return e&&(s.branchId=e),t&&(s.checkerId=t),r&&(s.search=r),n&&n!=="all"&&(s.status=n),s._t=new Date().getTime(),ye.get("/customers",{params:s})},getById:async e=>ye.get(`/customers/${e}`),getByChecker:async(e,t,r)=>{const n={};return t&&(n.search=t),r&&r!=="all"&&(n.status=r),ye.get(`/customers/checker/${e}`,{params:n})},create:async e=>ye.post("/customers",e),update:async(e,t)=>ye.put(`/customers/${e}`,t),delete:async e=>ye.delete(`/customers/${e}`)},XL=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,f]=E.useState(null),[h,m]=E.useState(""),[g,p]=E.useState("all"),[v,b]=E.useState(1),[y,x]=E.useState(10),[N,_]=E.useState(!1),[k,w]=E.useState({code:"",title:"นาย",name:"",surname:"",fullName:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:"",status:"active",checkerId:null}),C=[{id:1,code:"CUST001",title:"นาย",name:"สมชาย",surname:"ใจดี",full_name:"สมชาย ใจดี",id_card:"1234567890123",nickname:"สมชาย",age:"35",address:"123 ถนนสุขุมวิท",moo:"1",road:"สุขุมวิท",subdistrict:"คลองเตย",district:"คลองเตย",province:"กรุงเทพมหานคร",phone1:"082-111-1111",phone2:"02-123-4567",phone3:"02-987-6543",email:"customer1@example.com",status:"active",branch_id:1,checker_id:1,branch_name:"สาขาหลัก",checker_name:"ลินนา กล่อมเกลี้ยง",created_at:"2024-01-01T00:00:00.000Z",updated_at:"2024-01-01T00:00:00.000Z"},{id:2,code:"CUST002",title:"นาง",name:"สมหญิง",surname:"รักดี",full_name:"สมหญิง รักดี",id_card:"9876543210987",nickname:"หญิง",age:"28",address:"456 ถนนรัชดาภิเษก",moo:"2",road:"รัชดาภิเษก",subdistrict:"ดินแดง",district:"ดินแดง",province:"กรุงเทพมหานคร",phone1:"089-222-2222",phone2:"02-234-5678",phone3:"",email:"customer2@example.com",status:"active",branch_id:1,checker_id:1,branch_name:"สาขาหลัก",checker_name:"ลินนา กล่อมเกลี้ยง",created_at:"2024-01-02T00:00:00.000Z",updated_at:"2024-01-02T00:00:00.000Z"}];E.useEffect(()=>{e?D():(n(C),a(!1))},[e,h,g]),E.useEffect(()=>{if(e){const F=setTimeout(()=>{D()},100);return()=>clearTimeout(F)}},[]);const D=async()=>{var F,L;try{if(a(!0),_(!1),console.log("Loading customers for branch:",e),console.log("Search term:",h),console.log("Filter status:",g),!e){console.log("No selectedBranch, using mock data"),n(C);return}const T=await ki.getAll(e,null,h,g);if(console.log("API Response:",T),console.log("Response data:",T.data),console.log("Response data type:",typeof T.data),console.log("Response data is array:",Array.isArray(T.data)),console.log("Response data keys:",Object.keys(T.data||{})),T&&T.data)if(T.data.success&&Array.isArray(T.data.data)){const U=T.data.data;console.log("Customers data:",U),n(U),console.log("Customers loaded from API:",U)}else if(Array.isArray(T.data)){const U=T.data;console.log("Customers data (direct array):",U),n(U),console.log("Customers loaded from API (direct array):",U)}else console.warn("Invalid response format:",T),n([]);else console.warn("No response data:",T),n([])}catch(T){console.error("Error loading customers from API:",T),console.error("Error details:",(F=T.response)==null?void 0:F.data),console.error("Error status:",(L=T.response)==null?void 0:L.status),_(!0),console.log("Using mock data due to API error"),n(C),ge({title:"คำเตือน",description:"ไม่สามารถเชื่อมต่อ API ได้ กำลังแสดงข้อมูลตัวอย่าง",variant:"default"})}finally{a(!1)}},z=async F=>{if(F.preventDefault(),!k.name||!k.phone1||!k.code||!k.idCard){ge({title:"กรุณากรอกข้อมูลให้ครบถ้วน",description:"รหัส, ชื่อ-สกุล, โทรศัพท์ 1 และเลขบัตรประชาชนเป็นข้อมูลที่จำเป็น",variant:"destructive"});return}try{l(!0);const L={...k,fullName:`${k.name} ${k.surname}`.trim(),branchId:e};if(d){const U=(await ki.update(d.id,L)).data;n(X=>X.map(H=>H.id===d.id?U:H)),f(null),ge({title:"สำเร็จ",description:"อัปเดตข้อมูลลูกค้าเรียบร้อยแล้ว"})}else{const U=(await ki.create(L)).data;n(X=>[U,...X]),ge({title:"สำเร็จ",description:"เพิ่มลูกค้าเรียบร้อยแล้ว"})}G(),u(!1)}catch(L){console.error("Error saving customer:",L),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกข้อมูลลูกค้าได้",variant:"destructive"})}finally{l(!1)}},A=F=>{f(F),w({code:F.code||"",title:F.title||"นาย",name:F.name||"",surname:F.surname||"",fullName:F.full_name||"",nickname:F.nickname||"",age:F.age||"",idCard:F.id_card||"",address:F.address||"",moo:F.moo||"",road:F.road||"",subdistrict:F.subdistrict||"",district:F.district||"",province:F.province||"",phone1:F.phone1||F.phone||"",phone2:F.phone2||"",phone3:F.phone3||"",email:F.email||"",status:F.status||"active",checkerId:F.checker_id||null}),u(!0)},R=async F=>{if(window.confirm("คุณแน่ใจหรือไม่ที่จะลบลูกค้านี้?"))try{await ki.delete(F),n(L=>L.filter(T=>T.id!==F)),ge({title:"สำเร็จ",description:"ลบลูกค้าเรียบร้อยแล้ว"})}catch(L){console.error("Error deleting customer:",L),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบลูกค้าได้",variant:"destructive"})}},G=()=>{w({code:"",title:"นาย",name:"",surname:"",fullName:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:"",status:"active",checkerId:null})},I=F=>{switch(F){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"overdue":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Z=F=>{switch(F){case"active":return"ใช้งาน";case"inactive":return"ไม่ใช้งาน";case"overdue":return"ค้างชำระ";case"completed":return"เสร็จสิ้น";default:return F}},j=Math.ceil(((r==null?void 0:r.length)||0)/y),Y=(v-1)*y,q=Y+y,S=(r||[]).slice(Y,q);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการลูกค้า"}),i.jsx("p",{className:"text-gray-600",children:"จัดการข้อมูลลูกค้าทั้งหมดในระบบ"})]}),i.jsxs(oe,{onClick:()=>u(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มลูกค้าใหม่"]})]}),N&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"ไม่สามารถเชื่อมต่อ API ได้"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"กำลังแสดงข้อมูลตัวอย่าง ข้อมูลที่แสดงอาจไม่ใช่ข้อมูลจริง"})})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ค้นหา"}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",value:h,onChange:F=>m(F.target.value),placeholder:"ค้นหาด้วยรหัส, ชื่อ, เลขบัตร...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"สถานะ"}),i.jsxs("select",{value:g,onChange:F=>p(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:"ทั้งหมด"}),i.jsx("option",{value:"active",children:"ใช้งาน"}),i.jsx("option",{value:"inactive",children:"ไม่ใช้งาน"}),i.jsx("option",{value:"overdue",children:"ค้างชำระ"}),i.jsx("option",{value:"completed",children:"เสร็จสิ้น"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"แสดงต่อหน้า"}),i.jsxs("select",{value:y,onChange:F=>x(Number(F.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:10,children:"10"}),i.jsx("option",{value:25,children:"25"}),i.jsx("option",{value:50,children:"50"}),i.jsx("option",{value:100,children:"100"})]})]})]})}),c&&i.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:d?"แก้ไขลูกค้า":"เพิ่มลูกค้าใหม่"}),i.jsxs("form",{onSubmit:z,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx("div",{className:"lg:col-span-4",children:i.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3 border-b pb-2",children:"ข้อมูลลูกค้า"})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"รหัสลูกค้า *"}),i.jsx("input",{type:"text",value:k.code,onChange:F=>w(L=>({...L,code:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"CUST001",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"เลขบัตรประชาชน *"}),i.jsx("input",{type:"text",value:k.idCard,onChange:F=>w(L=>({...L,idCard:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"1234567890123",maxLength:"13",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"คำนำหน้าชื่อ"}),i.jsx("div",{className:"flex gap-4",children:["นาย","นาง","นางสาว"].map(F=>i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"radio",name:"title",value:F,checked:k.title===F,onChange:L=>w(T=>({...T,title:L.target.value}))}),F]},F))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ชื่อ-สกุล *"}),i.jsx("input",{type:"text",value:k.name,onChange:F=>w(L=>({...L,name:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ชื่อ-สกุล",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"นามสกุล"}),i.jsx("input",{type:"text",value:k.surname,onChange:F=>w(L=>({...L,surname:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"นามสกุล"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ชื่อเล่น"}),i.jsx("input",{type:"text",value:k.nickname,onChange:F=>w(L=>({...L,nickname:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ชื่อเล่น"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"อายุ"}),i.jsx("input",{type:"number",value:k.age,onChange:F=>w(L=>({...L,age:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"อายุ"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"บ้านเลขที่"}),i.jsx("input",{type:"text",value:k.address,onChange:F=>w(L=>({...L,address:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"บ้านเลขที่"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"หมู่ที่"}),i.jsx("input",{type:"text",value:k.moo,onChange:F=>w(L=>({...L,moo:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"หมู่ที่"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ถนน"}),i.jsx("input",{type:"text",value:k.road,onChange:F=>w(L=>({...L,road:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ถนน"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ตำบล/แขวง"}),i.jsx("input",{type:"text",value:k.subdistrict,onChange:F=>w(L=>({...L,subdistrict:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ตำบล/แขวง"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"อำเภอ/เขต"}),i.jsx("input",{type:"text",value:k.district,onChange:F=>w(L=>({...L,district:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"อำเภอ/เขต"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"จังหวัด"}),i.jsx("input",{type:"text",value:k.province,onChange:F=>w(L=>({...L,province:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"จังหวัด"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"โทรศัพท์ 1 *"}),i.jsx("input",{type:"tel",value:k.phone1,onChange:F=>w(L=>({...L,phone1:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"เบอร์โทรศัพท์",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"โทรศัพท์ 2"}),i.jsx("input",{type:"tel",value:k.phone2,onChange:F=>w(L=>({...L,phone2:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"เบอร์โทรศัพท์สำรอง"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"โทรศัพท์ 3"}),i.jsx("input",{type:"tel",value:k.phone3,onChange:F=>w(L=>({...L,phone3:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"เบอร์โทรศัพท์บ้าน"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"อีเมล"}),i.jsx("input",{type:"email",value:k.email,onChange:F=>w(L=>({...L,email:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"customer@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"สถานะ"}),i.jsxs("select",{value:k.status,onChange:F=>w(L=>({...L,status:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"active",children:"ใช้งาน"}),i.jsx("option",{value:"inactive",children:"ไม่ใช้งาน"}),i.jsx("option",{value:"overdue",children:"ค้างชำระ"}),i.jsx("option",{value:"completed",children:"เสร็จสิ้น"})]})]}),i.jsxs("div",{className:"lg:col-span-4 flex justify-end gap-3",children:[i.jsx(oe,{type:"button",variant:"outline",onClick:()=>{u(!1),f(null),G()},disabled:o,children:"ยกเลิก"}),i.jsx(oe,{type:"submit",disabled:o,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx(Ut,{className:"w-4 h-4 mr-2 animate-spin"}),"กำลังบันทึก..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),d?"อัปเดต":"เพิ่มลูกค้า"]})})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"รายการลูกค้าทั้งหมด"})}),i.jsx("div",{className:"overflow-x-auto",children:s?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx(Ut,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"text-gray-500",children:"กำลังโหลดข้อมูล..."})]}):r.length===0?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx(Qn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีลูกค้า"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"เริ่มต้นโดยการเพิ่มลูกค้าคนแรกของคุณในสาขานี้"}),i.jsxs(oe,{onClick:()=>u(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มลูกค้า"]})]}):i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky left-0 z-20 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"#"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"รหัส"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"ชื่อ-สกุล"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"เลขบัตรประชาชน"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"ชื่อเล่น"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"เบอร์โทร"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"สถานะ"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map((F,L)=>i.jsxs(Me.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:L*.05},className:"group hover:bg-gray-50",children:[i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 bg-white sticky left-0 z-10 group-hover:bg-gray-50 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:Y+L+1}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:F.code}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:F.full_name}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:F.id_card}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:F.nickname||"-"}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("div",{className:"space-y-1",children:F.primary_phone?i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(As,{className:"w-3 h-3 text-green-600"}),i.jsx("span",{children:F.primary_phone})]}):F.phone1?i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(As,{className:"w-3 h-3 text-green-600"}),i.jsx("span",{children:F.phone1})]}):F.phone2?i.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[i.jsx(As,{className:"w-3 h-3 text-blue-600"}),i.jsx("span",{children:F.phone2})]}):F.phone3?i.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[i.jsx(As,{className:"w-3 h-3 text-purple-600"}),i.jsx("span",{children:F.phone3})]}):i.jsx("span",{className:"text-gray-400",children:"-"})})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I(F.status)}`,children:Z(F.status)})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>A(F),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Bs,{className:"w-4 h-4"})}),i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>R(F.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ha,{className:"w-4 h-4"})})]})})]},F.id))})]})}),r.length>0&&i.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[i.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[i.jsx(oe,{onClick:()=>b(Math.max(1,v-1)),disabled:v===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),i.jsx(oe,{onClick:()=>b(v+1),disabled:v===j,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:Y+1})," to"," ",i.jsx("span",{className:"font-medium",children:Math.min(q,r.length)})," of"," ",i.jsx("span",{className:"font-medium",children:r.length})," entries"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[i.jsx(oe,{onClick:()=>b(1),disabled:v===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"First"}),i.jsx(oe,{onClick:()=>b(Math.max(1,v-1)),disabled:v===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),i.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:["Page ",v," of ",j]}),i.jsx(oe,{onClick:()=>b(v+1),disabled:v===j,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"}),i.jsx(oe,{onClick:()=>b(j),disabled:v===j,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Last"})]})})]})]})]})]})},Ks={getAll:async e=>{const t=e?{branchId:e}:{};return ye.get("/employees",{params:t})},getById:async e=>ye.get(`/employees/${e}`),create:async e=>ye.post("/employees",e),update:async(e,t)=>ye.put(`/employees/${e}`,t),delete:async e=>ye.delete(`/employees/${e}`)},KL=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,f]=E.useState(null),[h,m]=E.useState({name:"",surname:"",fullName:"",position:"",phone:"",email:""});E.useEffect(()=>{g()},[e]),E.useEffect(()=>{if(e){const x=setTimeout(()=>{g()},100);return()=>clearTimeout(x)}},[]);const g=async()=>{try{if(a(!0),!e){console.log("No selectedBranch, setting empty array"),n([]);return}const x=await Ks.getAll(e);console.log("API Response:",x),console.log("Response data:",x.data);let N=[];x&&x.data&&(x.data.success&&Array.isArray(x.data.data)?N=x.data.data:Array.isArray(x.data)?N=x.data:(console.warn("Invalid response format:",x),N=[])),console.log("Employees data:",N),n(N)}catch(x){console.error("Error loading employees:",x),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลพนักงานขายได้",variant:"destructive"})}finally{a(!1)}},p=async x=>{if(x.preventDefault(),!h.name||!h.position){ge({title:"กรุณากรอกข้อมูลให้ครบถ้วน",description:"ชื่อและตำแหน่งเป็นข้อมูลที่จำเป็น",variant:"destructive"});return}try{l(!0);const N={...h,fullName:`${h.name} ${h.surname}`.trim(),branchId:e};if(d){const k=(await Ks.update(d.id,N)).data;n(w=>w.map(C=>C.id===d.id?k:C)),f(null),ge({title:"สำเร็จ",description:"อัปเดตข้อมูลพนักงานเรียบร้อยแล้ว"})}else{const k=(await Ks.create(N)).data;n(w=>[k,...w]),ge({title:"สำเร็จ",description:"เพิ่มพนักงานเรียบร้อยแล้ว"})}m({name:"",surname:"",fullName:"",position:"",phone:"",email:""}),u(!1)}catch(N){console.error("Error saving employee:",N),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกข้อมูลพนักงานได้",variant:"destructive"})}finally{l(!1)}},v=x=>{f(x),m({name:x.name||"",surname:x.surname||"",fullName:x.fullName||"",position:x.position||"",phone:x.phone||"",email:x.email||""}),u(!0)},b=async x=>{try{await Ks.delete(x),n(N=>N.filter(_=>_.id!==x)),ge({title:"สำเร็จ",description:"ลบพนักงานเรียบร้อยแล้ว"})}catch(N){console.error("Error deleting employee:",N),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบพนักงานได้",variant:"destructive"})}},y=()=>{m({name:"",surname:"",fullName:"",position:"",phone:"",email:""}),f(null),u(!1)};return s?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการพนักงานขาย"}),i.jsx("p",{className:"text-gray-600",children:"กำลังโหลดข้อมูล..."})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Ut,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"กำลังโหลดข้อมูลพนักงานขาย..."})]})})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการพนักงานขาย"}),i.jsxs("p",{className:"text-gray-600",children:["เพิ่มพนักงานขายและติดตามการเข้างาน - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Ls,{className:"w-4 h-4"}),i.jsxs("span",{children:["พนักงานขายทั้งหมด: ",Array.isArray(r)?r.length:0," คน"]})]}),i.jsxs(oe,{onClick:()=>u(!c),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มพนักงานขาย"]})]})]}),c&&i.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:d?"แก้ไขพนักงานขาย":"เพิ่มพนักงานขายใหม่"}),i.jsx(oe,{variant:"outline",size:"sm",onClick:y,children:"ยกเลิก"})]}),i.jsx("div",{className:"mb-4 p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-emerald-700",children:[i.jsx(la,{className:"w-4 h-4"}),i.jsxs("span",{children:["พนักงานขายจะถูกเพิ่มในสาขา: ",i.jsx("strong",{children:t==null?void 0:t.name})]})]})}),i.jsxs("form",{onSubmit:p,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ชื่อ *"}),i.jsx("input",{type:"text",value:h.name,onChange:x=>m(N=>({...N,name:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ชื่อ",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"นามสกุล"}),i.jsx("input",{type:"text",value:h.surname,onChange:x=>m(N=>({...N,surname:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"นามสกุล"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ตำแหน่ง *"}),i.jsx("input",{type:"text",value:h.position,onChange:x=>m(N=>({...N,position:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"เช่น พนักงานขาย, ผู้จัดการ",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"เบอร์โทร"}),i.jsx("input",{type:"tel",value:h.phone,onChange:x=>m(N=>({...N,phone:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"081-234-5678"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"อีเมล"}),i.jsx("input",{type:"email",value:h.email,onChange:x=>m(N=>({...N,email:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"employee@example.com"})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3",children:[i.jsx(oe,{type:"button",variant:"outline",onClick:y,disabled:o,children:"ยกเลิก"}),i.jsx(oe,{type:"submit",disabled:o,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"กำลังบันทึก..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),d?"อัปเดต":"เพิ่มพนักงาน"]})})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"รายการพนักงานทั้งหมด"})}),i.jsx("div",{className:"p-6",children:!Array.isArray(r)||r.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Ls,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีพนักงาน"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"เริ่มต้นโดยการเพิ่มพนักงานคนแรกของคุณในสาขานี้"}),i.jsxs(oe,{onClick:()=>u(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มพนักงาน"]})]}):i.jsx("div",{className:"grid gap-4",children:Array.isArray(r)&&r.map((x,N)=>i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.1},className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:x.fullName}),i.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:x.branchName})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(JP,{className:"w-4 h-4"}),x.position]}),x.phone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(As,{className:"w-4 h-4"}),x.phone]}),x.email&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(z4,{className:"w-4 h-4"}),x.email]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>v(x),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Bs,{className:"w-4 h-4"})}),i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>b(x.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ha,{className:"w-4 h-4"})})]})]})},x.id))})})]})]})},YL=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(""),[c,u]=E.useState("all"),[d,f]=E.useState(25),[h,m]=E.useState(1),[g,p]=E.useState(!1),[v,b]=E.useState(null),[y,x]=E.useState({name:"",surname:"",fullName:"",phone:"",email:"",position:"collector",branchId:e||1,status:"active"});E.useEffect(()=>{N()},[e,o,c]);const N=async()=>{var R;try{a(!0);const G={};e&&(G.branchId=e),o&&(G.search=o),c&&c!=="all"&&(G.status=c);const I=await ye.get("/employees",{params:G});if((R=I.data)!=null&&R.success){const Z=I.data.data.filter(j=>j.position==="collector"||j.position==="พนักงานเก็บเงิน");n(Z)}else n([])}catch(G){console.error("Error loading collectors:",G),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลพนักงานเก็บเงินได้",variant:"destructive"}),n([])}finally{a(!1)}},_=async R=>{if(R.preventDefault(),!y.name||!y.fullName){ge({title:"กรุณากรอกข้อมูลให้ครบถ้วน",description:"ชื่อและชื่อ-สกุลเป็นข้อมูลที่จำเป็น",variant:"destructive"});return}try{v?(await ye.put(`/employees/${v.id}`,{...y,position:"collector"}),ge({title:"อัปเดตสำเร็จ",description:"ข้อมูลพนักงานเก็บเงินได้รับการอัปเดตแล้ว"})):(await ye.post("/employees",{...y,position:"collector"}),ge({title:"เพิ่มสำเร็จ",description:"พนักงานเก็บเงินใหม่ถูกเพิ่มแล้ว"})),p(!1),b(null),x({name:"",surname:"",fullName:"",phone:"",email:"",position:"collector",branchId:e||1,status:"active"}),N()}catch(G){console.error("Error saving collector:",G),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกข้อมูลได้",variant:"destructive"})}},k=R=>{b(R),x({name:R.name||"",surname:R.surname||"",fullName:R.fullName||R.full_name||"",phone:R.phone||"",email:R.email||"",position:"collector",branchId:R.branchId||R.branch_id||e||1,status:R.status||"active"}),p(!0)},w=async R=>{if(confirm(`คุณต้องการลบพนักงานเก็บเงิน "${R.fullName||R.full_name}" ใช่หรือไม่?`))try{await ye.delete(`/employees/${R.id}`),ge({title:"ลบสำเร็จ",description:"พนักงานเก็บเงินถูกลบแล้ว"}),N()}catch(G){console.error("Error deleting collector:",G),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบข้อมูลได้",variant:"destructive"})}},C=()=>{ge({title:"ส่งออกข้อมูล",description:"ฟีเจอร์นี้จะเปิดใช้งานเร็วๆ นี้"})},D=()=>{ge({title:"พิมพ์รายงาน",description:"ฟีเจอร์นี้จะเปิดใช้งานเร็วๆ นี้"})},z=R=>{const G={active:{label:"ทำงาน",className:"bg-green-100 text-green-800"},inactive:{label:"ไม่ทำงาน",className:"bg-red-100 text-red-800"},suspended:{label:"ระงับ",className:"bg-yellow-100 text-yellow-800"}},I=G[R]||G.inactive;return i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.className}`,children:I.label})},A=r;return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการพนักงานเก็บเงิน"}),i.jsxs("p",{className:"text-gray-600 mt-1",children:["สาขา ",(t==null?void 0:t.name)||"ทั้งหมด"," | พนักงานเก็บเงินทั้งหมด: ",r.length," คน"]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(oe,{onClick:N,variant:"outline",className:"flex items-center gap-2",disabled:s,children:[i.jsx(Ut,{className:`w-4 h-4 ${s?"animate-spin":""}`}),"รีเฟรช"]}),i.jsxs(oe,{onClick:()=>p(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มพนักงานเก็บเงิน"]}),i.jsxs(oe,{onClick:D,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[i.jsx(hu,{className:"w-4 h-4 mr-2"}),"พิมพ์รายงาน"]}),i.jsxs(oe,{onClick:C,className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(ua,{className:"w-4 h-4 mr-2"}),"ส่งออก"]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"แสดง"}),i.jsxs("select",{value:d,onChange:R=>f(parseInt(R.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:10,children:"10 entries"}),i.jsx("option",{value:25,children:"25 entries"}),i.jsx("option",{value:50,children:"50 entries"}),i.jsx("option",{value:100,children:"100 entries"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"สถานะ"}),i.jsxs("select",{value:c,onChange:R=>u(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:"ทั้งหมด"}),i.jsx("option",{value:"active",children:"ทำงาน"}),i.jsx("option",{value:"inactive",children:"ไม่ทำงาน"}),i.jsx("option",{value:"suspended",children:"ระงับ"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ค้นหา"}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหาชื่อ, เบอร์โทร, อีเมล...",value:o,onChange:R=>l(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),g&&i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:v?"แก้ไขพนักงานเก็บเงิน":"เพิ่มพนักงานเก็บเงินใหม่"}),i.jsxs("form",{onSubmit:_,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อ *"}),i.jsx("input",{type:"text",value:y.name,onChange:R=>x({...y,name:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ชื่อ",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"สกุล"}),i.jsx("input",{type:"text",value:y.surname,onChange:R=>x({...y,surname:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"สกุล"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อ-สกุล *"}),i.jsx("input",{type:"text",value:y.fullName,onChange:R=>x({...y,fullName:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ชื่อ-สกุล",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"เบอร์โทร"}),i.jsx("input",{type:"tel",value:y.phone,onChange:R=>x({...y,phone:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"081-234-5678"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"อีเมล"}),i.jsx("input",{type:"email",value:y.email,onChange:R=>x({...y,email:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"สถานะ"}),i.jsxs("select",{value:y.status,onChange:R=>x({...y,status:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"active",children:"ทำงาน"}),i.jsx("option",{value:"inactive",children:"ไม่ทำงาน"}),i.jsx("option",{value:"suspended",children:"ระงับ"})]})]})]}),i.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[i.jsx(oe,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",children:v?"อัปเดต":"เพิ่มพนักงานเก็บเงิน"}),i.jsx(oe,{type:"button",variant:"outline",onClick:()=>{p(!1),b(null),x({name:"",surname:"",fullName:"",phone:"",email:"",position:"collector",branchId:e||1,status:"active"})},children:"ยกเลิก"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky left-0 z-20 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:i.jsxs("div",{className:"flex items-center gap-2",children:["#",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["ชื่อ-สกุล",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["ตำแหน่ง",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["เบอร์โทร",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["อีเมล",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["สาขา",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["สถานะ",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(Ut,{className:"w-6 h-6 animate-spin mr-2"}),i.jsx("span",{children:"กำลังโหลดข้อมูล..."})]})})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"text-gray-500",children:[i.jsx(Qn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"ไม่พบข้อมูลพนักงานเก็บเงิน"})]})})}):A.map((R,G)=>i.jsxs(Me.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:G*.05},className:"hover:bg-gray-50 group",children:[i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 bg-white sticky left-0 z-10 group-hover:bg-gray-50 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:G+1}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Mr,{className:"w-4 h-4 text-gray-400"}),R.fullName||R.full_name]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:"พนักงานเก็บเงิน"})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(As,{className:"w-3 h-3 text-gray-400"}),R.phone||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(z4,{className:"w-3 h-3 text-gray-400"}),R.email||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(la,{className:"w-3 h-3 text-gray-400"}),R.branchName||R.branch_name||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:z(R.status)}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(oe,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>k(R),children:[i.jsx(Bs,{className:"w-3 h-3 mr-1"}),"แก้ไข"]}),i.jsxs(oe,{size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>w(R),children:[i.jsx(ha,{className:"w-3 h-3 mr-1"}),"ลบ"]})]})})]},R.id))})]})}),i.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[i.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[i.jsx(oe,{onClick:()=>m(Math.max(1,h-1)),disabled:h===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),i.jsx(oe,{onClick:()=>m(h+1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:"1"})," to ",i.jsx("span",{className:"font-medium",children:r.length})," of"," ",i.jsx("span",{className:"font-medium",children:r.length})," entries"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[i.jsx(oe,{onClick:()=>m(1),disabled:h===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"First"}),i.jsx(oe,{onClick:()=>m(Math.max(1,h-1)),disabled:h===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),i.jsx(oe,{onClick:()=>m(h+1),className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"}),i.jsx(oe,{onClick:()=>m(1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Last"})]})})]})]})]})]})},Io={getAll:async(e,t={})=>{try{console.log("🔍 checkersService.getAll called with branchId:",e,"params:",t);const r={branchId:e,...t};r._t=new Date().getTime(),console.log("🔄 Making API call to /checkers with params:",r);const n=await ye.get("/checkers",{params:r});return console.log("✅ checkersService.getAll response:",n),n}catch(r){throw console.error("❌ checkersService.getAll error:",r),console.error("❌ Error response:",r.response),r}},getById:async e=>{try{return(await ye.get(`/checkers/${e}`)).data}catch(t){throw t}},create:async e=>{try{return(await ye.post("/checkers",e)).data}catch(t){throw t}},update:async(e,t)=>{try{return(await ye.put(`/checkers/${e}`,t)).data}catch(r){throw r}},delete:async e=>{try{return(await ye.delete(`/checkers/${e}`)).data}catch(t){throw t}},getCollections:async(e,t={})=>{try{return(await ye.get(`/checkers/${e}/collections`,{params:t})).data}catch(r){throw r}},createCollection:async(e,t)=>{try{return(await ye.post(`/checkers/${e}/collections`,t)).data}catch(r){throw r}},getReports:async(e,t={})=>{try{return(await ye.get(`/checkers/${e}/reports`,{params:t})).data}catch(r){throw r}}},mS=({onBack:e,checker:t})=>{const[r,n]=E.useState("contract"),[s,a]=E.useState("asc"),[o,l]=E.useState(""),[c,u]=E.useState(""),[d,f]=E.useState(""),[h,m]=E.useState(!0),[g,p]=E.useState(null),[v,b]=E.useState([]),[y,x]=E.useState({}),[N,_]=E.useState({}),[k,w]=E.useState(0),[C,D]=E.useState(""),z=E.useCallback(S=>{if(!S||S==="-")return{pBlack:0,pBlue:0};try{const F=new Date(S);if(isNaN(F.getTime()))return{pBlack:0,pBlue:0};const L=new Date,T=L.getMonth()+1,U=L.getFullYear(),X=F.getMonth()+1,H=F.getFullYear();return console.log("CalculatePStatus Debug:",{dueDate:S,dueMonth:X,dueYear:H,currentMonth:T,currentYear:U,today:L.getDate(),dueDay:F.getDate()}),X===T&&H===U?(console.log('✅ เดือนที่ต้องเก็บเงิน - P ดำ = "P", P น้ำเงิน = "1"'),{pBlack:"P",pBlue:"1"}):X<T||H<U?(console.log('⚠️ เกินกำหนดชำระแล้ว - P ดำ = "P", P น้ำเงิน = "1"'),{pBlack:"P",pBlue:"1"}):(console.log("📅 ยังไม่ถึงกำหนดชำระ - P ดำ = 0, P น้ำเงิน = 0"),{pBlack:0,pBlue:0})}catch(F){return console.error("Error calculating P status:",F),{pBlack:0,pBlue:0}}},[]),A=E.useCallback(async()=>{var S,F;try{const L=await ye.get("/installments");let T=[];if((S=L.data)!=null&&S.success?T=L.data.data||[]:Array.isArray(L.data)&&(T=L.data),!Array.isArray(T)){console.error("installmentsData is not an array:",T);return}const X=T.filter(le=>le.inspectorId===(t==null?void 0:t.id)||le.inspectorId===parseInt(t==null?void 0:t.id)).filter((le,ce,J)=>ce===J.findIndex(Se=>Se.id===le.id)),H={};for(const le of X)try{const ce=await ye.get(`/installments/${le.id}/payments`);if((F=ce.data)!=null&&F.success&&ce.data.data){const J=ce.data.data,Se=J.reduce((Q,he)=>Q+parseFloat(he.amount||0),0),B=J.filter(Q=>Q.status==="paid").reduce((Q,he)=>Q+parseFloat(he.amount||0),0),je=Se-B,_e=new Date,Re=_e.getMonth()+1,Te=_e.getFullYear(),pe=J.filter(Q=>{const he=new Date(Q.dueDate);return he.getMonth()+1===Re&&he.getFullYear()===Te}),Ae=J.every(Q=>Q.status!=="paid"),et=J.some(Q=>{const he=new Date(Q.dueDate);return he.getMonth()+1>=Re&&he.getFullYear()>=Te});if(pe.length>0||Ae&&et){if(Ae&&et&&pe.length===0){const Q=J.filter(he=>{const Fe=new Date(he.dueDate);return Fe.getMonth()+1>=Re&&Fe.getFullYear()>=Te}).sort((he,Fe)=>new Date(he.dueDate)-new Date(Fe.dueDate))[0];if(Q){const he=Q.dueDate,Fe=new Date(he),Le=`${Te}-${String(Re).padStart(2,"0")}`,Oe=new Date(Te,Re-1).toLocaleDateString("th-TH",{year:"numeric",month:"long"});H[Le]||(H[Le]={monthName:Oe,monthKey:Le,installments:[],totalAmount:0,totalCollected:0,totalRemaining:0});const Ve=parseFloat(Q.amount)||0,Ye=0,vt=0,yt=Fe.toLocaleDateString("th-TH"),Tt={pBlack:0,pBlue:0};console.log("New Contract Debug:",{contract:le.contractNumber,isNewContract:!0,nextDueDate:he,currentMonth:Re,currentYear:Te,pStatus:Tt}),H[Le].installments.push({id:`${le.id}-${Q.id}`,contract:le.contractNumber||`C${le.id}`,name:le.customerFullName||`${le.customerName||""} ${le.customerSurname||""}`.trim(),collectionDate:yt,amountToCollect:Ve,amountCollected:Ye,remainingDebt:je,napheoRed:0,napheoBlue:vt,pBlack:Tt.pBlack,pRed:0,pBlue:Tt.pBlue,paymentStatus:Q.status,isNewContract:!0}),H[Le].totalAmount+=Ve,H[Le].totalCollected+=Ye,H[Le].totalRemaining+=je}}for(const Q of pe){const he=Q.dueDate,Fe=new Date(he),Le=`${Fe.getFullYear()}-${String(Fe.getMonth()+1).padStart(2,"0")}`,Oe=Fe.toLocaleDateString("th-TH",{year:"numeric",month:"long"});H[Le]||(H[Le]={monthName:Oe,monthKey:Le,installments:[],totalAmount:0,totalCollected:0,totalRemaining:0});const Ve=parseFloat(Q.amount)||0,Ye=Q.status==="paid"?Ve:0,vt=Q.status==="paid"?1:0,yt=Fe.toLocaleDateString("th-TH"),Tt=z(he);console.log("P Status Debug:",{contract:le.contractNumber,paymentId:Q.id,dueDate:he,pStatus:Tt,status:Q.status,actualRemainingDebt:je,currentDate:new Date().toLocaleDateString("th-TH"),currentMonth:Re,currentYear:Te}),H[Le].installments.push({id:`${le.id}-${Q.id}`,contract:le.contractNumber||`C${le.id}`,name:le.customerFullName||`${le.customerName||""} ${le.customerSurname||""}`.trim(),collectionDate:yt,amountToCollect:Ve,amountCollected:Ye,remainingDebt:je,napheoRed:0,napheoBlue:vt,pBlack:Tt.pBlack,pRed:0,pBlue:Tt.pBlue,paymentStatus:Q.status}),H[Le].totalAmount+=Ve,H[Le].totalCollected+=Ye,H[Le].totalRemaining+=je}}}}catch(ce){console.error("Error fetching payments for installment:",le.id,ce)}const ee=Object.keys(H).sort(),me={};ee.forEach(le=>{me[le]=H[le]}),_(me)}catch(L){console.error("Error fetching monthly data:",L),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถดึงข้อมูลรายเดือนได้",variant:"destructive"})}},[t==null?void 0:t.id,z]),R=E.useCallback(()=>{w(S=>S+1),m(!0),p(null)},[]);E.useEffect(()=>{const S=localStorage.getItem("selectedContractForChecker");S&&(D(S),localStorage.removeItem("selectedContractForChecker"),tt.fire({icon:"info",title:"กรองข้อมูลตามสัญญา",html:`
          <div class="text-left">
            <p>กำลังแสดงตารางผ่อนของสัญญา</p>
            <p><strong>${S}</strong></p>
          </div>
        `,confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"}))},[]),E.useEffect(()=>{const S=async()=>{var F,L,T,U,X;try{m(!0),p(null);const H=await ye.get("/installments");let ee=[];if((F=H.data)!=null&&F.success?ee=H.data.data||[]:Array.isArray(H.data)&&(ee=H.data),!Array.isArray(ee))throw new Error("ข้อมูลที่ได้รับไม่ใช่ Array");const le=ee.filter(pe=>pe.inspectorId===(t==null?void 0:t.id)||pe.inspectorId===parseInt(t==null?void 0:t.id)).filter((pe,Ae,et)=>Ae===et.findIndex(Q=>Q.id===pe.id)),ce=[];for(let pe=0;pe<le.length;pe++){const Ae=le[pe],et=Ae.dueDate||Ae.collectionDate;let Q="-";if(et)try{const Ve=new Date(et);isNaN(Ve.getTime())||(Q=Ve.toLocaleDateString("th-TH"))}catch(Ve){console.error("Error parsing date:",et,Ve)}const he=z(et);let Fe=0,Le=0,Oe="pending";try{const Ve=await ye.get(`/installments/${Ae.id}/payments`);(L=Ve.data)!=null&&L.success&&Ve.data.data&&(Fe=Ve.data.data.reduce((vt,yt)=>vt+parseFloat(yt.amount||0),0),Fe>0&&(Le=1,Oe="paid"))}catch(Ve){console.error("Error fetching payments for installment:",Ae.id,Ve)}ce.push({id:Ae.id,sequence:pe+1,contract:Ae.contractNumber||`C${Ae.id}`,name:Ae.customerFullName||`${Ae.customerName||""} ${Ae.customerSurname||""}`.trim(),collectionDate:Q,amountToCollect:parseFloat(Ae.installmentAmount)||0,amountCollected:Fe,remainingDebt:parseFloat(Ae.remainingAmount)||0,napheoRed:0,napheoBlue:Le,pBlack:he.pBlack,pRed:0,pBlue:he.pBlue,paymentStatus:Oe})}b(ce);const J=ce.reduce((pe,Ae)=>Ae.pBlack==="P"||Ae.pBlack===1?pe+1:pe,0),Se=ce.reduce((pe,Ae)=>Ae.pBlue==="1"||Ae.pBlue===1?pe+1:pe,0);let B=0,je=0,_e=0,Re=0;for(const pe of ce)try{const Ae=await ye.get(`/installments/${pe.id}/payments`);if((T=Ae.data)!=null&&T.success&&Ae.data.data){const et=Ae.data.data,Q=et.reduce((Le,Oe)=>Le+parseFloat(Oe.amount||0),0),he=et.filter(Le=>Le.status==="paid").reduce((Le,Oe)=>Le+parseFloat(Oe.amount||0),0),Fe=Q-he;B+=Fe,je+=he,he>0&&(_e++,Re++)}}catch(Ae){console.error("Error calculating remaining amount for installment:",pe.id,Ae)}const Te={totalCards:ce.length,cardsToCollect:ce.length,cardsCollected:_e,pGreen:Se,pRed:J,totalPCards:J+Se,pGreenCollected:Re,pRedCollected:0,totalPCardsCollected:Re,totalMoney:B,moneyToCollect:B,moneyCollected:je};x(Te),await A()}catch(H){console.error("Error fetching installments:",H),p(H.message||"เกิดข้อผิดพลาดในการดึงข้อมูล"),ge({title:"เกิดข้อผิดพลาด",description:((X=(U=H.response)==null?void 0:U.data)==null?void 0:X.message)||H.message||"ไม่สามารถดึงข้อมูลได้",variant:"destructive"}),b([]),x({totalCards:0,cardsToCollect:0,cardsCollected:0,pGreen:0,pRed:0,totalPCards:0,pGreenCollected:0,pRedCollected:0,totalPCardsCollected:0,totalMoney:0,moneyToCollect:0,moneyCollected:0})}finally{m(!1)}};t!=null&&t.id&&S()},[t==null?void 0:t.id,c,k,A,z]),E.useCallback(S=>{r===S?a(s==="asc"?"desc":"asc"):(n(S),a("asc"))},[r,s]),E.useCallback(S=>r!==S?null:s==="asc"?i.jsx(qt,{className:"w-4 h-4"}):i.jsx($t,{className:"w-4 h-4"}),[r,s]);const G=E.useMemo(()=>v.filter((F,L,T)=>L===T.findIndex(U=>U.id===F.id)).filter(F=>{const L=F.contract.toLowerCase().includes(o.toLowerCase())||F.name.toLowerCase().includes(o.toLowerCase()),T=!C||F.contract.toLowerCase().includes(C.toLowerCase());let U=!0;if(c&&c!==""||d&&d!=="")try{const X=new Date(F.collectionDate);if(isNaN(X.getTime()))U=!0;else{const H=X.getMonth()+1,ee=X.getFullYear();let me=!0,le=!0;c&&c!==""&&(me=H===parseInt(c)),d&&d!==""&&(le=ee===parseInt(d)),U=me&&le}}catch(X){console.error("Error parsing date:",F.collectionDate,X),U=!0}return L&&U&&T}),[v,o,c,d,C]),{totalAmountToCollect:I,totalAmountCollected:Z,totalRemainingDebt:j}=E.useMemo(()=>({totalAmountToCollect:G.reduce((S,F)=>S+(F.amountToCollect||0),0),totalAmountCollected:G.reduce((S,F)=>S+(F.amountCollected||0),0),totalRemainingDebt:G.reduce((S,F)=>S+(F.remainingDebt||0),0)}),[G]),Y=E.useMemo(()=>[...G.filter((F,L,T)=>L===T.findIndex(U=>U.id===F.id))].sort((F,L)=>{let T=F[r],U=L[r];return r==="sequence"&&(T=parseInt(T),U=parseInt(U)),s==="asc"?T>U?1:-1:T<U?1:-1}),[G,r,s]),q=E.useCallback(()=>{try{const S={checker:t,summary:y,installments:Y,exportDate:new Date().toLocaleDateString("th-TH"),totalAmountToCollect:I,totalAmountCollected:Z,totalRemainingDebt:j},F=JSON.stringify(S,null,2),L=new Blob([F],{type:"application/json"}),T=URL.createObjectURL(L),U=document.createElement("a");U.href=T,U.download=`checker-report-${t==null?void 0:t.id}-${new Date().toISOString().split("T")[0]}.json`,U.click(),URL.revokeObjectURL(T),ge({title:"ส่งออกสำเร็จ",description:"ไฟล์รายงานถูกดาวน์โหลดแล้ว"})}catch(S){console.error("Error exporting data:",S),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถส่งออกข้อมูลได้",variant:"destructive"})}},[t,y,Y,I,Z,j]);return t?i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center py-4",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs(oe,{variant:"ghost",size:"sm",onClick:e,className:"text-gray-600 hover:text-gray-900",children:[i.jsx(Vi,{className:"w-4 h-4 mr-2"}),"กลับ"]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"รายงานค่างวด"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["เช็คเกอร์: ",t==null?void 0:t.name," ",t==null?void 0:t.surname]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs(oe,{variant:"outline",size:"sm",onClick:R,disabled:h,children:[i.jsx(Ut,{className:`w-4 h-4 mr-2 ${h?"animate-spin":""}`}),"รีเฟรช"]}),i.jsxs(oe,{variant:"outline",size:"sm",onClick:q,disabled:h||Y.length===0,children:[i.jsx(ua,{className:"w-4 h-4 mr-2"}),"ส่งออก"]})]})]})})}),i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g&&i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Ui,{className:"w-5 h-5 text-red-400 mr-3"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"เกิดข้อผิดพลาด"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:g})]})]})}),h&&i.jsx("div",{className:"flex items-center justify-center py-20",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ut,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"กำลังโหลดข้อมูล..."}),i.jsx("p",{className:"text-sm text-gray-600",children:"กรุณารอสักครู่"})]})}),!h&&i.jsxs(i.Fragment,{children:[i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-12",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"จำนวนสัญญา"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:G.length})]}),i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(gr,{className:"w-6 h-6 text-blue-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"เงินต้องเก็บ"}),i.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["฿",I.toLocaleString()]})]}),i.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:i.jsx(fl,{className:"w-6 h-6 text-orange-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"เงินเก็บได้"}),i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["฿",Z.toLocaleString()]})]}),i.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:i.jsx(hl,{className:"w-6 h-6 text-green-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ลูกหนี้คงเหลือ"}),i.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["฿",j.toLocaleString()]})]}),i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:i.jsx(ca,{className:"w-6 h-6 text-red-600"})})]})})]}),i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[(c||d||C)&&i.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[i.jsx($c,{className:"w-4 h-4"}),i.jsx("span",{children:"กำลังกรองข้อมูล:"}),c&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:["เดือน ",c]}),d&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:["ปี ",d]}),C&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:["สัญญา ",C]}),i.jsxs("span",{className:"text-blue-600",children:["(แสดง ",G.length," รายการจากทั้งหมด ",v.length," รายการ)"]})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 md:space-x-4",children:[i.jsx("div",{className:"flex-1 max-w-md",children:i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"ค้นหาตามเลขสัญญา หรือชื่อลูกค้า...",value:o,onChange:S=>l(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx($c,{className:"w-4 h-4 text-gray-400"}),i.jsxs("select",{value:c,onChange:S=>u(S.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"ทุกเดือน"}),i.jsx("option",{value:"1",children:"มกราคม"}),i.jsx("option",{value:"2",children:"กุมภาพันธ์"}),i.jsx("option",{value:"3",children:"มีนาคม"}),i.jsx("option",{value:"4",children:"เมษายน"}),i.jsx("option",{value:"5",children:"พฤษภาคม"}),i.jsx("option",{value:"6",children:"มิถุนายน"}),i.jsx("option",{value:"7",children:"กรกฎาคม"}),i.jsx("option",{value:"8",children:"สิงหาคม"}),i.jsx("option",{value:"9",children:"กันยายน"}),i.jsx("option",{value:"10",children:"ตุลาคม"}),i.jsx("option",{value:"11",children:"พฤศจิกายน"}),i.jsx("option",{value:"12",children:"ธันวาคม"})]}),i.jsxs("select",{value:d,onChange:S=>f(S.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"ทุกปี"}),i.jsx("option",{value:"2024",children:"2024"}),i.jsx("option",{value:"2023",children:"2023"}),i.jsx("option",{value:"2022",children:"2022"}),i.jsx("option",{value:"2021",children:"2021"}),i.jsx("option",{value:"2020",children:"2020"}),i.jsx("option",{value:"2019",children:"2019"}),i.jsx("option",{value:"2018",children:"2018"}),i.jsx("option",{value:"2017",children:"2017"}),i.jsx("option",{value:"2016",children:"2016"}),i.jsx("option",{value:"2015",children:"2015"})]})]}),C&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"กรองสัญญา:"}),i.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-md",children:C}),i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>D(""),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:"ล้าง"})]}),(c||d||C)&&i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>{u(""),f(""),D("")},className:"text-gray-600 border-gray-300 hover:bg-gray-50 hover:border-gray-400",children:"ล้างทั้งหมด"})]})]})]}),i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"space-y-6 mb-12",children:Object.keys(N).length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[i.jsx(ca,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ไม่มีข้อมูลรายเดือน"}),i.jsx("p",{className:"text-gray-600",children:"ไม่พบข้อมูลการผ่อนชำระในเดือนต่างๆ"})]}):Object.entries(N).filter(([S,F])=>{if((!c||c==="")&&(!d||d===""))return!0;const[L,T]=S.split("-");let U=!0,X=!0;return c&&c!==""&&(U=T===c.padStart(2,"0")),d&&d!==""&&(X=L===d),U&&X}).map(([S,F])=>i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:F.monthName}),i.jsxs("p",{className:"text-sm text-gray-600",children:[F.installments.length," สัญญา | เงินต้องเก็บ: ฿",F.totalAmount.toLocaleString()," | เงินเก็บได้: ฿",F.totalCollected.toLocaleString()," | ยอดเหลือผ่อน: ฿",F.totalRemaining.toLocaleString()]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full",children:[F.installments.length," รายการ"]})})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ลำดับ"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เลขที่สัญญา"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ชื่อ-สกุล"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันนัดเก็บ"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold",children:"นับเพียว"}),i.jsx("div",{className:"text-xs text-gray-500",children:"น้ำเงิน"})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-600 font-bold",children:"นับเพียว"}),i.jsx("div",{className:"text-xs text-gray-500",children:"แดง"})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-black font-bold",children:"P"}),i.jsx("div",{className:"text-xs text-gray-500",children:"ดำ"})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-600 font-bold",children:"P"}),i.jsx("div",{className:"text-xs text-gray-500",children:"แดง"})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold",children:"P"}),i.jsx("div",{className:"text-xs text-gray-500",children:"น้ำเงิน"})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เงินต้องเก็บ"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เงินเก็บได้"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เงินคงเหลือ"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.installments.map((L,T)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:T+1}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:L.contract}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:L.name||"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:L.collectionDate}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600 text-center font-medium",children:L.napheoBlue>0?L.napheoBlue:"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 text-center font-medium",children:L.napheoRed>0?L.napheoRed:"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:L.pBlack&&L.pBlack!==0?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue text-blue-600",children:L.pBlack}):"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:L.pRed>0?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"P"}):"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:L.pBlue&&L.pBlue!==0?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:L.pBlue}):"-"}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-orange-600",children:["฿",L.amountToCollect.toLocaleString()]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["฿",L.amountCollected.toLocaleString()]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-red-600",children:["฿",L.remainingDebt.toLocaleString()]})]},L.id))})]})})]},S))}),i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-8",children:[i.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"สรุปข้อมูล"})}),i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:"จำนวนการ์ด"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"จำนวนการ์ดทั้งหมด:"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.totalCards||0," ใบ"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"จำนวนการ์ดที่ต้องเก็บ:"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.cardsToCollect||0," ใบ"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"จำนวนการ์ดที่เก็บได้:"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.cardsCollected||0," ใบ"]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:"P เขียว"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P เขียว:"}),i.jsxs("span",{className:"text-sm font-medium text-green-600",children:[y.pGreen||0," ใบ"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P แดง:"}),i.jsxs("span",{className:"text-sm font-medium text-red-600",children:[y.pRed||0," ใบ"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"รวมการ์ดทั้งหมด:"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.totalPCards||0," ใบ"]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:"P เก็บได้"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P เขียว เก็บได้:"}),i.jsxs("span",{className:"text-sm font-medium text-green-600",children:[y.pGreenCollected||0," ใบ"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P แดง เก็บได้:"}),i.jsxs("span",{className:"text-sm font-medium text-red-600",children:[y.pRedCollected||0," ใบ"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"รวมการ์ดเก็บได้:"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.totalPCardsCollected||0," ใบ"]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:"จำนวนเงิน"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"ยอดเงินคงเหลือทั้งหมด:"}),i.jsxs("span",{className:"text-sm font-medium",children:["฿",(y.totalMoney||0).toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"ยอดเงินคงเหลือ:"}),i.jsxs("span",{className:"text-sm font-medium",children:["฿",(y.moneyToCollect||0).toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"ยอดเงินที่เก็บได้:"}),i.jsxs("span",{className:"text-sm font-medium",children:["฿",(y.moneyCollected||0).toLocaleString()]})]})]})]})]})})]})]})]})]}):i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ui,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"ไม่พบข้อมูลเช็คเกอร์"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"กรุณาเลือกเช็คเกอร์ก่อน"}),i.jsxs(oe,{onClick:e,variant:"outline",children:[i.jsx(Vi,{className:"w-4 h-4 mr-2"}),"กลับ"]})]})})},qL=({selectedBranch:e,currentBranch:t,checker:r,onBack:n,onViewPaymentSchedule:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState(!0),[u,d]=E.useState(""),[f,h]=E.useState("all"),[m,g]=E.useState(25),[p,v]=E.useState(1);E.useEffect(()=>{r!=null&&r.id&&b()},[r==null?void 0:r.id,u,f]);const b=async()=>{var C;try{c(!0);const D={};u&&(D.search=u),f&&f!=="all"&&(D.status=f);const z=await ye.get(`/customers/checker/${r.id}/contracts`,{params:D});if(console.log("🔍 Checker customers API response:",z),(C=z.data)!=null&&C.success){const A=z.data.data||[];console.log("🔍 Customers data:",A),console.log("🔍 First customer guarantor data:",A[0]?{guarantor_name:A[0].guarantor_name,guarantor_id_card:A[0].guarantor_id_card,guarantor_nickname:A[0].guarantor_nickname}:"No customers"),o(A)}else o([])}catch(D){console.error("Error loading customers for checker:",D),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลลูกค้าได้",variant:"destructive"}),o([])}finally{c(!1)}},y=()=>{ge({title:"ส่งออกข้อมูล",description:"ฟังก์ชันส่งออกจะถูกเพิ่มในภายหลัง"})},x=()=>{ge({title:"พิมพ์รายงาน",description:"ฟังก์ชันพิมพ์จะถูกเพิ่มในภายหลัง"})},N=C=>{ge({title:"แก้ไขข้อมูลลูกค้า",description:`แก้ไขข้อมูล ${C.full_name}`})},_=C=>{console.log("🔍 viewPaymentSchedule called with customer:",C),console.log("🔍 Customer ID:",C.id),console.log("🔍 Customer full_name:",C.full_name),ge({title:"ดูตารางผ่อนของลูกค้า",description:`ดูตารางผ่อนของ ${C.full_name}`}),s(C)},k=C=>{const D={active:{label:"กำลังผ่อนชำระ",className:"bg-green-100 text-green-800"},overdue:{label:"ค้างชำระ",className:"bg-red-100 text-red-800"},completed:{label:"ผ่อนเสร็จ",className:"bg-blue-100 text-blue-800"},normal:{label:"ปกติ",className:"bg-gray-100 text-gray-800"}},z=D[C]||D.active;return i.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${z.className}`,children:z.label})},w=a;return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(oe,{onClick:n,variant:"outline",className:"flex items-center gap-2",children:[i.jsx(Vi,{className:"w-4 h-4"}),"กลับ"]}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["ลูกค้าของ ",r==null?void 0:r.fullName]}),i.jsxs("p",{className:"text-gray-600 mt-1",children:["สาขา ",(t==null?void 0:t.name)||"ทั้งหมด"," | ลูกค้าทั้งหมด: ",a.length," คน"]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(oe,{onClick:b,variant:"outline",className:"flex items-center gap-2",disabled:l,children:[i.jsx(Ut,{className:`w-4 h-4 ${l?"animate-spin":""}`}),"รีเฟรช"]}),i.jsxs(oe,{onClick:x,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[i.jsx(hu,{className:"w-4 h-4 mr-2"}),"พิมพ์รายงาน"]}),i.jsxs(oe,{onClick:y,className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(ua,{className:"w-4 h-4 mr-2"}),"ส่งออก"]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"แสดง"}),i.jsxs("select",{value:m,onChange:C=>g(parseInt(C.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:10,children:"10 entries"}),i.jsx("option",{value:25,children:"25 entries"}),i.jsx("option",{value:50,children:"50 entries"}),i.jsx("option",{value:100,children:"100 entries"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"สถานะ"}),i.jsxs("select",{value:f,onChange:C=>h(C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:"ทั้งหมด"}),i.jsx("option",{value:"active",children:"กำลังผ่อน"}),i.jsx("option",{value:"overdue",children:"ค้างชำระ"}),i.jsx("option",{value:"completed",children:"ผ่อนเสร็จ"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ค้นหา"}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหารหัส, ชื่อ, เลขบัตรประชาชน, ชื่อเล่น...",value:u,onChange:C=>d(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky left-0 z-20 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:i.jsxs("div",{className:"flex items-center gap-2",children:["#",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["เลขที่ทำสัญญา",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["ชื่อ-สกุล",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["เลขบัตรประชาชน",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["ชื่อเล่น",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["ชื่อผู้ค้ำ",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["เลขบัตรประชาชนผู้ค้ำ",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["ชื่อเล่นผู้ค้ำ",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["เบอร์โทร",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["สัญญา",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["สถานะ",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(qt,{className:"w-3 h-3 text-gray-400"}),i.jsx($t,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:"10",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(Ut,{className:"w-6 h-6 animate-spin mr-2"}),i.jsx("span",{children:"กำลังโหลดข้อมูล..."})]})})}):w.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"10",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"text-gray-500",children:[i.jsx(Qn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"ไม่พบข้อมูลลูกค้า"})]})})}):w.map((C,D)=>i.jsxs(Me.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:D*.05},className:"hover:bg-gray-50 group",children:[i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 bg-white sticky left-0 z-10 group-hover:bg-gray-50 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:D+1}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:C.contract_numbers||"-"}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Mr,{className:"w-4 h-4 text-gray-400"}),C.full_name]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 font-mono",children:C.id_card}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:C.nickname})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(jn,{className:"w-4 h-4 text-gray-400"}),C.guarantor_name||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 font-mono",children:C.guarantor_id_card||"-"}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:C.guarantor_nickname||"-"})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(As,{className:"w-3 h-3 text-gray-400"}),C.primary_phone||C.phone1||C.phone2||C.phone3||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(gr,{className:"w-3 h-3 text-gray-400"}),i.jsx("span",{className:"font-medium",children:C.contract_count||0})]}),C.total_contracts_amount&&i.jsxs("div",{className:"text-xs text-gray-500",children:["฿",parseFloat(C.total_contracts_amount).toLocaleString()]})]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:k(C.status)}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(oe,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>_(C),children:[i.jsx(gr,{className:"w-3 h-3 mr-1"}),"ดูตารางผ่อน"]}),i.jsxs(oe,{size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",onClick:()=>N(C),children:[i.jsx(Bs,{className:"w-3 h-3 mr-1"}),"แก้ไข"]})]})})]},C.id))})]})}),i.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[i.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[i.jsx(oe,{onClick:()=>v(Math.max(1,p-1)),disabled:p===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),i.jsx(oe,{onClick:()=>v(p+1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:"1"})," to ",i.jsx("span",{className:"font-medium",children:a.length})," of"," ",i.jsx("span",{className:"font-medium",children:a.length})," entries"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[i.jsx(oe,{onClick:()=>v(1),disabled:p===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"First"}),i.jsx(oe,{onClick:()=>v(Math.max(1,p-1)),disabled:p===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),i.jsx(oe,{onClick:()=>v(p+1),className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"}),i.jsx(oe,{onClick:()=>v(1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Last"})]})})]})]})]})]})},ZL=({selectedBranch:e,currentBranch:t,onViewPaymentSchedule:r})=>{const[n,s]=E.useState([]),[a,o]=E.useState(!0),[l,c]=E.useState(""),[u,d]=E.useState(!1),[f,h]=E.useState(null),[m,g]=E.useState(!1),[p,v]=E.useState(null),[b,y]=E.useState(!1),[x,N]=E.useState(!1);E.useEffect(()=>{e&&_()},[e]),E.useEffect(()=>{e&&setTimeout(()=>{_()},100)},[]);const _=async()=>{var Z;try{o(!0);const j={branchId:e};l&&(j.search=l);const Y=await Io.getAll(e,j);let q=[];(Z=Y.data)!=null&&Z.success&&Array.isArray(Y.data.data)?q=Y.data.data:(Array.isArray(Y.data)||Y.data&&Array.isArray(Y.data))&&(q=Y.data),console.log("Checkers API response:",Y),console.log("Processed checkers data:",q),s(q)}catch(j){console.error("Error loading checkers:",j),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลเช็คเกอร์ได้",variant:"destructive"})}finally{o(!1)}},k=async Z=>{try{g(!0);const j={...Z,branchId:e},Y=await Io.create(j);s(q=>[...q,Y.data]),d(!1),ge({title:"เพิ่มผู้ตรวจสอบสำเร็จ! ✅",description:`เพิ่ม ${Z.fullName} เข้าสู่ระบบแล้ว`})}catch(j){console.error("Error adding checker:",j),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถเพิ่มผู้ตรวจสอบได้",variant:"destructive"})}finally{g(!1)}},w=async Z=>{try{g(!0);const j=await Io.update(Z.id,Z);s(Y=>Y.map(q=>q.id===Z.id?j.data:q)),h(null),ge({title:"แก้ไขผู้ตรวจสอบสำเร็จ! ✏️",description:`แก้ไขข้อมูล ${Z.fullName} แล้ว`})}catch(j){console.error("Error updating checker:",j),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถแก้ไขผู้ตรวจสอบได้",variant:"destructive"})}finally{g(!1)}},C=async Z=>{try{await Io.delete(Z),s(j=>j.filter(Y=>Y.id!==Z)),ge({title:"ลบผู้ตรวจสอบสำเร็จ",description:"ลบผู้ตรวจสอบออกจากระบบแล้ว"})}catch(j){console.error("Error deleting checker:",j),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบผู้ตรวจสอบได้",variant:"destructive"})}},D=()=>{ge({title:"ส่งออกข้อมูล",description:"ฟังก์ชันส่งออกจะถูกเพิ่มในภายหลัง"})},z=Z=>{v(Z),y(!0)},A=()=>{v(null),y(!1)},R=Z=>{v(Z),N(!0)},G=()=>{v(null),N(!1)},I=Array.isArray(n)?n.filter(Z=>Z.fullName.toLowerCase().includes(l.toLowerCase())):[];return i.jsx("div",{className:"space-y-6",children:b&&p?i.jsx(mS,{selectedBranch:e,currentBranch:t,checker:p,onBack:A}):x&&p?i.jsx(qL,{selectedBranch:e,currentBranch:t,checker:p,onBack:G,onViewPaymentSchedule:r}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"เช็คเกอร์ รายการผู้ตรวจสอบ"}),i.jsxs("p",{className:"text-gray-600",children:["จัดการรายการผู้ตรวจสอบในระบบ - ",t==null?void 0:t.name]})]}),i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Ls,{className:"w-4 h-4"}),i.jsxs("span",{children:["ผู้ตรวจสอบทั้งหมด: ",I.length," คน"]})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs(oe,{onClick:D,className:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:[i.jsx(ua,{className:"w-4 h-4 mr-2"}),"บันทึกเป็น Excel"]})}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(rg,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Welcome, ลินนา กล่อมเกลี้ยง"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm text-gray-600",children:"Search:"}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหาผู้ตรวจสอบ...",value:l,onChange:Z=>{c(Z.target.value),setTimeout(()=>{_()},500)},className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"flex items-center gap-2",children:["ชื่อ-สกุล",i.jsx(Iy,{className:"w-4 h-4 cursor-pointer"})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"flex items-center gap-2",children:["Action",i.jsx(Iy,{className:"w-4 h-4 cursor-pointer"})]})})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:"3",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(Ut,{className:"w-6 h-6 animate-spin mr-2"}),i.jsx("span",{children:"กำลังโหลดข้อมูล..."})]})})}):I.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"3",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"text-gray-500",children:[i.jsx(Ls,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"ไม่พบข้อมูลเช็คเกอร์"})]})})}):I.map((Z,j)=>i.jsxs(Me.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:j*.05},className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j+1}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Z.fullName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(oe,{size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white",onClick:()=>z(Z),children:[i.jsx(gr,{className:"w-3 h-3 mr-1"}),"รายงานค่างวด"]}),i.jsxs(oe,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>R(Z),children:[i.jsx(Qn,{className:"w-3 h-3 mr-1"}),"ลูกค้า"]}),i.jsxs(oe,{size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",onClick:()=>h(Z),children:[i.jsx(Bs,{className:"w-3 h-3 mr-1"}),"แก้ไข"]}),i.jsxs(oe,{size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>C(Z.id),children:[i.jsx(ha,{className:"w-3 h-3 mr-1"}),"ลบ"]})]})})]},Z.id))})]})}),i.jsxs("div",{className:"bg-white px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Showing 1 to ",I.length," of ",I.length," entries"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(oe,{size:"sm",variant:"outline",disabled:!0,className:"text-gray-400",children:"Previous"}),i.jsx(oe,{size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white",children:"1"}),i.jsx(oe,{size:"sm",variant:"outline",disabled:!0,className:"text-gray-400",children:"Next"})]})]})]}),(u||f)&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:f?"แก้ไขผู้ตรวจสอบ":"เพิ่มผู้ตรวจสอบใหม่"}),i.jsxs("form",{onSubmit:Z=>{Z.preventDefault();const j=new FormData(Z.target),Y={name:j.get("name"),surname:j.get("surname"),fullName:`${j.get("name")} ${j.get("surname")}`.trim()};f?w({...f,...Y}):k(Y)},children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อ"}),i.jsx("input",{type:"text",name:"name",defaultValue:(f==null?void 0:f.name)||"",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"นามสกุล"}),i.jsx("input",{type:"text",name:"surname",defaultValue:(f==null?void 0:f.surname)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),i.jsxs("div",{className:"flex gap-2 mt-6",children:[i.jsx(oe,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700",disabled:m,children:m?i.jsxs(i.Fragment,{children:[i.jsx(Ut,{className:"w-4 h-4 mr-2 animate-spin"}),f?"กำลังบันทึก...":"กำลังเพิ่ม..."]}):f?"บันทึก":"เพิ่ม"}),i.jsx(oe,{type:"button",variant:"outline",onClick:()=>{d(!1),h(null)},className:"flex-1",children:"ยกเลิก"})]})]})]})}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(oe,{onClick:()=>d(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มผู้ตรวจสอบใหม่"]})})]})})},fw=e=>{if(!e||isNaN(e.getTime()))return"-";const t=e.getDate(),r=e.getMonth()+1,n=e.getFullYear(),s=n>2500,a=s?n:n+543;return console.log("🔍 Date Debug:",{original:e,day:t,month:r,year:n,isThaiYear:s,thaiYear:a,formatted:`${t}/${r}/${a}`}),`${t}/${r}/${a}`},JL=({selectedBranch:e,currentBranch:t})=>{console.log("🔍 SalesIndexPage props:",{selectedBranch:e,currentBranch:t});const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(null),[c,u]=E.useState(""),[d,f]=E.useState(""),[h,m]=E.useState(new Date().getFullYear()),[g,p]=E.useState(5),v=[{value:"01",label:"มกราคม"},{value:"02",label:"กุมภาพันธ์"},{value:"03",label:"มีนาคม"},{value:"04",label:"เมษายน"},{value:"05",label:"พฤษภาคม"},{value:"06",label:"มิถุนายน"},{value:"07",label:"กรกฎาคม"},{value:"08",label:"สิงหาคม"},{value:"09",label:"กันยายน"},{value:"10",label:"ตุลาคม"},{value:"11",label:"พฤศจิกายน"},{value:"12",label:"ธันวาคม"}],b=E.useMemo(()=>{const w=new Date().getFullYear(),C=[];for(let D=w;D>=w-5;D--)C.push(D);return C},[]),y=async()=>{var w;try{a(!0),l(null);let C="/installments";const D=new URLSearchParams;d&&D.append("month",d),h&&D.append("year",h),c&&D.append("search",c),e&&D.append("branchId",e),D.toString()&&(C+=`?${D.toString()}`),console.log("🔍 Calling API:",C);const z=await ye.get(C);if(console.log("🔍 API Response:",z.data),(w=z.data)!=null&&w.success){const A=z.data.data||[];console.log("🔍 API Response Data:",A);const R=A.map((G,I)=>{const Z=parseFloat(G.totalAmount)||0,j=parseFloat(G.downPayment)||0,Y=parseFloat(G.monthlyPayment)||0,q=parseInt(G.months)||0,S=j+Y*q,F=g,L=S*F/100,T=[G.customerMoo,G.customerRoad,G.customerSubdistrict,G.customerDistrict,G.customerProvince].filter(Boolean).join(" ");return{id:G.id,sequence:I+1,contractDate:G.contractDate?fw(new Date(G.contractDate)):"-",contractNumber:G.contractNumber||`C${G.id}`,customerName:G.customerName||"",customerSurname:G.customerSurname||"",customerFullName:G.customerFullName||`${G.customerName||""} ${G.customerSurname||""}`.trim(),customerAddress:T||G.customerAddress||"-",customerPhone:G.customerPhone1||G.customerPhone||"-",productName:G.productName||G.productDescription||"-",totalPrice:Z,downPayment:j,installmentAmount:Y,numberOfInstallments:q,collectionDate:G.collectionDate?fw(new Date(G.collectionDate)):"-",inspectorName:G.inspectorFullName||G.inspectorName||"-",salespersonName:G.salespersonFullName||G.salespersonName||"-",commissionRate:F,commissionAmount:L,grandTotal:S}});console.log("🔍 Processed Data:",R),n(R)}else l("ไม่สามารถดึงข้อมูลได้")}catch(C){console.error("Error fetching sales data:",C),l("เกิดข้อผิดพลาดในการดึงข้อมูล"),ge({title:"ข้อผิดพลาด",description:"ไม่สามารถดึงข้อมูลการขายได้",variant:"destructive"})}finally{a(!1)}},x=(w,C)=>{n(D=>D.map(z=>{if(z.id===w){const A=z.grandTotal*C/100;return{...z,commissionRate:C,commissionAmount:A}}return z}))};E.useEffect(()=>{console.log("🔍 useEffect triggered - fetching sales data"),y()},[d,h,g]);const N=E.useMemo(()=>{if(!r.length)return null;const w=r.length,C=r.reduce((R,G)=>R+G.grandTotal,0),D=r.reduce((R,G)=>R+G.downPayment,0),z=r.reduce((R,G)=>R+G.installmentAmount*G.numberOfInstallments,0),A=r.reduce((R,G)=>R+G.commissionAmount,0);return{totalContracts:w,totalSales:C,totalDownPayments:D,totalInstallments:z,totalCommission:A}},[r]),_=E.useMemo(()=>c?r.filter(w=>w.contractNumber.toLowerCase().includes(c.toLowerCase())||w.customerFullName.toLowerCase().includes(c.toLowerCase())||w.productName.toLowerCase().includes(c.toLowerCase())||w.salespersonName.toLowerCase().includes(c.toLowerCase())):r,[r,c]),k=()=>{var D;const w=window.open("","_blank"),C=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>รายงานสารบัญการขาย</title>
          <style>
            body { font-family: 'Sarabun', sans-serif; margin: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; font-weight: bold; }
            .header { text-align: center; margin-bottom: 20px; }
            .summary { margin-top: 20px; padding: 10px; background-color: #f9f9f9; }
            .text-right { text-align: right; }
            .text-center { text-align: center; }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>รายงานสารบัญการขาย</h1>
            <p>เดือน: ${d?(D=v.find(z=>z.value===d))==null?void 0:D.label:"ทั้งหมด"} ${h}</p>
            <p>อัตราค่าคอมมิชชัน: ${g}%</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>ลำดับ</th>
                <th>ว.ด.ป.</th>
                <th>สัญญา</th>
                <th>ชื่อ - นามสกุล</th>
                <th>ที่อยู่</th>
                <th>เบอร์โทรศัพท์</th>
                <th>สินค้า</th>
                <th>ราคา</th>
                <th>เงินดาวน์</th>
                <th>งวดละ</th>
                <th>จำนวน</th>
                <th>วันนัดเก็บ</th>
                <th>ตรวจสอบ</th>
                <th>พนักงานขาย</th>
                <th>คีย์%</th>
                <th>ค่าคอม</th>
              </tr>
            </thead>
            <tbody>
              ${_.map(z=>`
                <tr>
                  <td class="text-center">${z.sequence}</td>
                  <td>${z.contractDate}</td>
                  <td>${z.contractNumber}</td>
                  <td>${z.customerFullName}</td>
                  <td>${z.customerAddress}</td>
                  <td>${z.customerPhone}</td>
                  <td>${z.productName}</td>
                  <td class="text-right">฿${z.totalPrice.toLocaleString()}</td>
                  <td class="text-right">฿${z.downPayment.toLocaleString()}</td>
                  <td class="text-right">฿${z.installmentAmount.toLocaleString()}</td>
                  <td class="text-center">${z.numberOfInstallments}</td>
                  <td>${z.collectionDate}</td>
                  <td>${z.inspectorName}</td>
                  <td>${z.salespersonName}</td>
                  <td class="text-center">${z.commissionRate}%</td>
                  <td class="text-right">฿${z.commissionAmount.toLocaleString()}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          
          ${N?`
            <div class="summary">
              <h3>สรุปข้อมูล</h3>
              <p>จำนวนสัญญา: ${N.totalContracts} สัญญา</p>
              <p>ยอดขายรวม: ฿${N.totalSales.toLocaleString()}</p>
              <p>เงินดาวน์รวม: ฿${N.totalDownPayments.toLocaleString()}</p>
              <p>เงินผ่อนรวม: ฿${N.totalInstallments.toLocaleString()}</p>
              <p>ค่าคอมมิชชันรวม: ฿${N.totalCommission.toLocaleString()}</p>
            </div>
          `:""}
        </body>
      </html>
    `;w.document.write(C),w.document.close(),w.print()};return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"max-w-full mx-auto px-2 sm:px-4 lg:px-6 py-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(gr,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"สารบัญการขาย"}),i.jsxs("p",{className:"text-gray-600",children:["รายงานการขายและค่าคอมมิชชัน",t&&` - สาขา ${t.name}`]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("button",{onClick:k,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(ua,{className:"h-4 w-4"}),i.jsx("span",{children:"พิมพ์รายงาน"})]}),i.jsxs("button",{onClick:()=>{ge({title:"บันทึกสำเร็จ",description:"อัปเดตค่าคอมมิชชันเรียบร้อยแล้ว",variant:"default"})},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(jh,{className:"h-4 w-4"}),i.jsx("span",{children:"บันทึกการเปลี่ยนแปลง"})]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหาสัญญา, ลูกค้า, สินค้า...",value:c,onChange:w=>u(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("select",{value:d,onChange:w=>f(w.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"ทุกเดือน"}),v.map(w=>i.jsx("option",{value:w.value,children:w.label},w.value))]}),i.jsx("select",{value:h,onChange:w=>m(w.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:b.map(w=>i.jsx("option",{value:w,children:w},w))}),i.jsxs("div",{className:"relative",children:[i.jsx(jh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"number",placeholder:"อัตราค่าคอม %",value:g,onChange:w=>p(parseFloat(w.target.value)||0),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",max:"100",step:"0.1"})]}),i.jsxs("button",{onClick:y,disabled:s,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s?i.jsx(Ut,{className:"h-4 w-4 animate-spin"}):i.jsx($c,{className:"h-4 w-4"}),i.jsx("span",{children:"กรองข้อมูล"})]})]})}),N&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3 mb-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"จำนวนสัญญา"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.totalContracts})]}),i.jsx(gr,{className:"h-8 w-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ยอดขายรวม"}),i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["฿",N.totalSales.toLocaleString()]})]}),i.jsx(hl,{className:"h-8 w-8 text-green-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"เงินดาวน์รวม"}),i.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["฿",N.totalDownPayments.toLocaleString()]})]}),i.jsx(nl,{className:"h-8 w-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"เงินผ่อนรวม"}),i.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["฿",N.totalInstallments.toLocaleString()]})]}),i.jsx(Qr,{className:"h-8 w-8 text-purple-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ค่าคอมรวม"}),i.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["฿",N.totalCommission.toLocaleString()]})]}),i.jsx(jh,{className:"h-8 w-8 text-orange-600"})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ลำดับ"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ว.ด.ป."}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สัญญา"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ชื่อ - นามสกุล"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ที่อยู่"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เบอร์โทรศัพท์"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สินค้า"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ราคา"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เงินดาวน์"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"งวดละ"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จำนวน"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันนัดเก็บ"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ตรวจสอบ"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"พนักงานขาย"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"คีย์%"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ค่าคอม"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:"16",className:"px-4 py-3 text-center",children:i.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 animate-spin text-blue-600"}),i.jsx("span",{className:"text-gray-600",children:"กำลังโหลดข้อมูล..."})]})})}):o?i.jsx("tr",{children:i.jsx("td",{colSpan:"16",className:"px-4 py-3 text-center text-red-600",children:o})}):_.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"16",className:"px-4 py-3 text-center text-gray-500",children:"ไม่พบข้อมูลการขาย"})}):_.map(w=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center text-gray-900",children:w.sequence}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.contractDate}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-blue-600",children:w.contractNumber}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.customerFullName}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:w.customerAddress}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.customerPhone}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:w.productName}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900",children:["฿",w.totalPrice.toLocaleString()]}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900",children:["฿",w.downPayment.toLocaleString()]}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900",children:["฿",w.installmentAmount.toLocaleString()]}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center text-gray-900",children:w.numberOfInstallments}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.collectionDate}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.inspectorName}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.salespersonName}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center text-gray-900",children:[i.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:w.commissionRate,onChange:C=>{const D=parseFloat(C.target.value)||0;x(w.id,D)},className:"w-16 text-center border border-gray-300 rounded px-1 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsx("span",{className:"ml-1",children:"%"})]}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right font-medium text-orange-600",children:["฿",w.commissionAmount.toLocaleString()]})]},w.id))})]})})})]})})},ya="/installments",ci={getCustomerInstallment:async e=>{const t=new URLSearchParams({customerId:e});return ye.get(`${ya}?${t}`)},getInstallmentPayments:async e=>ye.get(`${ya}/${e}/payments`),createPayment:async(e,t)=>ye.post(`${ya}/${e}/payments`,t),updatePayment:async(e,t,r)=>(console.log("🔍 paymentScheduleService.updatePayment:",{installmentId:e,paymentId:t,paymentData:r}),ye.put(`${ya}/${e}/payments/${t}`,r)),deletePayment:async(e,t)=>ye.delete(`${ya}/${e}/payments/${t}`),createCollection:async(e,t)=>ye.post(`/checkers/${e}/collections`,t),getCollections:async e=>ye.get(`${ya}/${e}/collections`),update:async(e,t)=>(console.log("🔍 paymentScheduleService.update:",{installmentId:e,installmentData:t}),ye.put(`${ya}/${e}`,t)),updateDownPayment:async(e,t)=>(console.log("🔍 paymentScheduleService.updateDownPayment:",{installmentId:e,downPaymentData:t}),ye.put(`${ya}/${e}/down-payment`,t))},QL=({customer:e,onBack:t,customerData:r})=>{var Ae,et;const[n,s]=E.useState(""),[a,o]=E.useState(""),[l,c]=E.useState(""),[u,d]=E.useState(""),[f,h]=E.useState(""),[m,g]=E.useState("ปกติ"),[p,v]=E.useState("ไม่มีส่วนลด"),[b,y]=E.useState(!1),[x,N]=E.useState(!0),[_,k]=E.useState([]),[w,C]=E.useState(null),[D,z]=E.useState([]),[A,R]=E.useState(!1),[G,I]=E.useState(null),[Z,j]=E.useState({paymentDate:"",receiptNumber:"",amount:"",status:"ปกติ",discount:"ไม่มีส่วนลด",notes:""}),Y=r||e||{id:"F0002",name:"สมาน แก้วอุ่นเรือน",nickname:"สมาน",phone:"0870379475",address:"43/5 ม.8 ต.บางสะพาน อ.บางสะพานน้อย จ.ประจวบคีรีขันธ์",guarantorName:"ปรีชา มณีโชติ",guarantorNickname:"",guarantorPhone:"",guarantorAddress:"43/5 ม.8 ต.บางสะพาน อ.บางสะพานน้อย จ.ประจวบคีรีขันธ์",productType:"ที่นอน 5 ฟุต ยางอัดผ้านอก",totalPrice:12840,model:"",serialNumber:"",downPayment:1500,installmentAmount:756,months:15,collectionDate:"04-05-2564",salesperson:"อุดมศักดิ์ ประถมทอง",line:"4",inspector:"อนุชิต",status:"completed"},q=async()=>{var Q;try{R(!0);const he=await ye.get("/employees");let Fe=[];(Q=he.data)!=null&&Q.success?Fe=he.data.data||[]:Array.isArray(he.data)&&(Fe=he.data);const Le=Fe.filter(Oe=>Oe.position&&(Oe.position.toLowerCase().includes("collector")||Oe.position.toLowerCase().includes("เก็บเงิน")||Oe.position.toLowerCase().includes("พนักงานเก็บเงิน")));z(Le)}catch(he){console.error("Error loading collectors:",he),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลพนักงานเก็บเงินได้",variant:"destructive"})}finally{R(!1)}};E.useEffect(()=>{Y.id&&(S(),q())},[Y.id]);const S=async()=>{var Q,he,Fe,Le;try{N(!0),console.log("🔍 Loading customer data for ID:",Y.id),console.log("🔍 Calling getCustomerInstallment...");const Oe=await ci.getCustomerInstallment(Y.id);if(console.log("✅ Installment response:",Oe),(Q=Oe.data)!=null&&Q.success&&Oe.data.data.length>0){const Ve=Oe.data.data[0];console.log("✅ Found installment:",Ve),C(Ve),console.log("🔍 Calling getInstallmentPayments for installment ID:",Ve.id);const Ye=await ci.getInstallmentPayments(Ve.id);console.log("✅ Payments response:",Ye),(he=Ye.data)!=null&&he.success&&k(Ye.data.data||[])}else console.log("⚠️ No installment found for customer:",Y.id),k([])}catch(Oe){console.error("❌ Error loading customer data:",Oe),console.error("❌ Error details:",(Fe=Oe.response)==null?void 0:Fe.data),console.error("❌ Error status:",(Le=Oe.response)==null?void 0:Le.status),ge({title:"เกิดข้อผิดพลาด",description:`ไม่สามารถโหลดข้อมูลลูกค้าได้: ${Oe.message}`,variant:"destructive"}),k([])}finally{N(!1)}},F=w?{id:w.customerId||Y.id||Y.code||"N/A",name:w.customerFullName||Y.full_name||Y.name||"N/A",nickname:w.customerNickname||Y.nickname||"N/A",phone:w.customerPhone1||Y.phone1||Y.phone||"N/A",address:w.customerAddress||Y.address||"N/A",guarantorName:w.guarantorName||Y.guarantor_name||"N/A",guarantorNickname:w.guarantorNickname||Y.guarantor_nickname||"N/A",guarantorPhone:w.guarantorPhone1||Y.guarantor_phone||"N/A",guarantorAddress:w.guarantorAddress||Y.guarantor_address||"N/A",productType:w.productName||Y.product_type||Y.product_name||"N/A",totalPrice:w.totalAmount?parseFloat(w.totalAmount):0,model:w.productModel||Y.model||"N/A",serialNumber:w.productSerialNumber||Y.serial_number||"N/A",downPayment:w.downPayment?parseFloat(w.downPayment):0,installmentAmount:w.installmentAmount?parseFloat(w.installmentAmount):0,months:w.months||0,collectionDate:w.collectionDate||"N/A",salesperson:w.salespersonFullName||Y.salesperson||"N/A",line:w.line||Y.line||"N/A",inspector:w.inspectorFullName||Y.inspector||"N/A",status:w.status||Y.status||"active",contractNumber:w.contractNumber||"N/A"}:{id:Y.id||Y.code||"N/A",name:Y.full_name||Y.name||"N/A",nickname:Y.nickname||"N/A",phone:Y.phone1||Y.phone||"N/A",address:Y.address||"N/A",guarantorName:Y.guarantor_name||"N/A",guarantorNickname:Y.guarantor_nickname||"N/A",guarantorPhone:Y.guarantor_phone||"N/A",guarantorAddress:Y.guarantor_address||"N/A",productType:Y.product_type||Y.product_name||"N/A",totalPrice:Y.total_contracts_amount?parseFloat(Y.total_contracts_amount):0,model:Y.model||"N/A",serialNumber:Y.serial_number||"N/A",downPayment:Y.down_payment?parseFloat(Y.down_payment):0,installmentAmount:Y.installment_amount?parseFloat(Y.installment_amount):0,months:Y.months||0,collectionDate:Y.collection_date||"N/A",salesperson:Y.salesperson||"N/A",line:Y.line||"N/A",inspector:Y.inspector||"N/A",status:Y.status||"active",contractNumber:Y.contract_number||"N/A"},L=_.filter(Q=>{var he,Fe;return Q.status==="paid"&&!((he=Q.notes)!=null&&he.includes("เงินดาวน์"))&&!((Fe=Q.notes)!=null&&Fe.includes("งวดแรก"))}).reduce((Q,he)=>Q+parseFloat(he.amount||0),0),T=parseFloat(F.downPayment||0),U=L+T,X=Math.max(0,F.totalPrice-U),H=U/F.totalPrice*100;console.log("🔍 Payment calculation debug:"),console.log("📊 Total paid from API:",L),console.log("💰 Down payment from contract:",T),console.log("💵 Total paid with down payment:",U),console.log("📈 Progress percentage:",H),console.log("📋 Installments from API:",_),console.log("🔍 Customer installment data:",w),console.log("🔍 Customer info data:",Y),console.log("🔍 Mapped customer info:",F),console.log("🏠 Guarantor address from API:",w==null?void 0:w.guarantorAddress),console.log("🏠 Guarantor address from customer info:",Y==null?void 0:Y.guarantor_address),console.log("📅 Contract date from API:",w==null?void 0:w.contract_date),console.log("📅 Created date from API:",w==null?void 0:w.createdAt),console.log("📅 Collection date from customer info:",F.collectionDate);const ee=Q=>{if(!Q)return{receiptNumber:"-",status:"-",discount:"-"};const he=Q.match(/ใบเสร็จ:\s*([^,]+)/),Fe=Q.match(/สถานะ:\s*([^,]+)/),Le=Q.match(/ส่วนลด:\s*([^,]+)/);let Oe=Le?Le[1].trim():"-";return Oe==="ไม่มีส่วนลด"?Oe="ไม่มี":Oe==="มีส่วนลด"&&(Oe="มี"),{receiptNumber:he?he[1].trim():"-",status:Fe?Fe[1].trim():"-",discount:Oe}},me=()=>({receiptNumber:"-",status:"ปกติ",discount:"ไม่มี"}),le=Q=>{if(!Q)return"-";try{if(Q.includes("T"))return new Date(Q).toLocaleDateString("th-TH");const he=new Date(Q);return isNaN(he.getTime())?"-":he.toLocaleDateString("th-TH")}catch(he){return console.error("❌ Error formatting date:",Q,he),"-"}},ce=[...parseFloat(F.downPayment||0)>0?[{id:"down-payment",notes:"เงินดาวน์/งวดแรก",paymentDate:(w==null?void 0:w.contract_date)||(w==null?void 0:w.createdAt)||F.collectionDate,dueDate:(w==null?void 0:w.contract_date)||(w==null?void 0:w.createdAt)||F.collectionDate,amount:parseFloat(F.downPayment||0),status:"paid",isDownPayment:!0}]:[],..._.filter(Q=>{var he,Fe;return Q.status==="paid"&&!((he=Q.notes)!=null&&he.includes("เงินดาวน์"))&&!((Fe=Q.notes)!=null&&Fe.includes("งวดแรก"))}).map((Q,he)=>({...Q,notes:Q.notes||`งวดที่ ${he+2}`,isDownPayment:!1}))];console.log("📅 Down payment date debug:"),console.log("📅 Contract date:",w==null?void 0:w.contract_date),console.log("📅 Created date:",w==null?void 0:w.createdAt),console.log("📅 Collection date:",F.collectionDate),console.log("📅 Final payment date:",(Ae=ce[0])==null?void 0:Ae.paymentDate),console.log("📅 Formatted date:",le((et=ce[0])==null?void 0:et.paymentDate));const J=Q=>{const Fe=ce.slice(0,Q+1).reduce((Le,Oe)=>Le+parseFloat(Oe.amount||0),0);return Math.max(0,F.totalPrice-Fe)},Se=_.filter(Q=>{var he,Fe;return Q.status==="pending"&&!((he=Q.notes)!=null&&he.includes("เงินดาวน์"))&&!((Fe=Q.notes)!=null&&Fe.includes("งวดแรก"))}).map((Q,he)=>({...Q,notes:Q.notes||`งวดที่ ${he+2}`,isDownPayment:!1})),B=async()=>{if(!n||!a||!l){tt.fire({icon:"warning",title:"กรุณากรอกข้อมูลให้ครบ",text:"วันที่, เลขที่ใบเสร็จ และจำนวนเงินเป็นข้อมูลที่จำเป็น",confirmButtonColor:"#3B82F6"});return}if(!w){tt.fire({icon:"error",title:"ไม่พบข้อมูลสัญญา",text:"ไม่สามารถบันทึกการชำระเงินได้",confirmButtonColor:"#EF4444"});return}y(!0);try{const Q=_.find(he=>parseFloat(he.amount)===parseFloat(l)&&he.status==="pending");if(Q){const he={amount:parseFloat(l),payment_date:n,status:"paid",notes:`ใบเสร็จ: ${a}, สถานะ: ${m}, ส่วนลด: ${p}`,collector_id:f||null};console.log("🔍 Updating existing payment:",{installmentId:w.id,paymentId:Q.id,updateData:he,paymentDate:n,paymentDateType:typeof n,collectorId:f}),await ci.updatePayment(w.id,Q.id,he)}else{const he={amount:parseFloat(l),payment_date:n,due_date:n,status:"paid",notes:`ใบเสร็จ: ${a}, สถานะ: ${m}, ส่วนลด: ${p}`,collector_id:f||null};await ci.createPayment(w.id,he)}await S(),s(""),o(""),c(""),d(""),h(""),g("ปกติ"),v("ไม่มีส่วนลด"),tt.fire({icon:"success",title:"บันทึกการชำระเงินสำเร็จ!",text:`บันทึกการชำระเงิน ฿${parseFloat(l).toLocaleString()} เรียบร้อยแล้ว`,confirmButtonColor:"#10B981"})}catch(Q){console.error("Error saving payment:",Q),tt.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถบันทึกการชำระเงินได้",confirmButtonColor:"#EF4444"})}finally{y(!1)}},je=async Q=>{if((await tt.fire({title:"ยืนยันการลบ",text:"คุณต้องการลบรายการชำระเงินนี้หรือไม่?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#6B7280",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก"})).isConfirmed&&w)try{await ci.deletePayment(w.id,Q),await S(),ge({title:"ลบรายการชำระเงินสำเร็จ",description:"รายการชำระเงินถูกลบออกจากระบบแล้ว"})}catch(Fe){console.error("Error deleting payment:",Fe),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบรายการชำระเงินได้",variant:"destructive"})}},_e=async Q=>{try{if(Q==="down-payment"){const he={amount:parseFloat(Z.amount),paymentDate:Z.paymentDate,receiptNumber:Z.receiptNumber,status:Z.status,discount:Z.discount};console.log("🔍 Updating down payment:",{installmentId:w.id,updateData:he}),await ci.updateDownPayment(w.id,he)}else{const he={amount:parseFloat(Z.amount),payment_date:Z.paymentDate,status:"paid",notes:`ใบเสร็จ: ${Z.receiptNumber}, สถานะ: ${Z.status}, ส่วนลด: ${Z.discount}`,receipt_number:Z.receiptNumber};console.log("🔍 Updating payment:",{installmentId:w.id,paymentId:Q,updateData:he}),await ci.updatePayment(w.id,Q,he)}await S(),I(null),j({paymentDate:"",receiptNumber:"",amount:"",status:"ปกติ",discount:"ไม่มีส่วนลด",notes:""}),ge({title:"แก้ไขสำเร็จ",description:"แก้ไขรายการชำระเงินเรียบร้อยแล้ว"})}catch(he){console.error("Error updating payment:",he),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถแก้ไขรายการชำระเงินได้",variant:"destructive"})}},Re=Q=>{I(Q.id);const{receiptNumber:he,status:Fe,discount:Le}=Q.isDownPayment?me():ee(Q.notes);j({paymentDate:Q.paymentDate?new Date(Q.paymentDate).toISOString().split("T")[0]:"",receiptNumber:he!=="-"?he:"",amount:Q.amount||"",status:Fe!=="-"?Fe:"ปกติ",discount:Le!=="-"&&Le==="มี"?"ส่วนลด":"ไม่มีส่วนลด",notes:Q.notes||""}),Q.id==="down-payment"&&ge({title:"แก้ไขเงินดาวน์",description:"การแก้ไขเงินดาวน์จะอัปเดตข้อมูลในสัญญา"})},Te=()=>{var Fe,Le,Oe;const Q=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>ตารางผ่อนชำระ - ${F.name}</title>
        <style>
          body {
            font-family: 'Sarabun', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            font-size: 14px;
            line-height: 1.6;
          }
          .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
          }
          .header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: bold;
          }
          .header p {
            margin: 5px 0;
            font-size: 16px;
          }
          .customer-info {
            margin-bottom: 30px;
          }
          .customer-info h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
          }
          .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
          }
          .info-section {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
          }
          .info-section h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #555;
          }
          .info-item {
            margin-bottom: 8px;
          }
          .info-label {
            font-weight: bold;
            color: #333;
          }
          .contract-details {
            margin-bottom: 30px;
          }
          .contract-details h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
          }
          .payment-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
          }
          .payment-table th,
          .payment-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
          }
          .payment-table th {
            background-color: #f5f5f5;
            font-weight: bold;
            color: #333;
          }
          .payment-table tr:nth-child(even) {
            background-color: #f9f9f9;
          }
          .summary {
            margin-top: 30px;
            padding: 20px;
            background: #f0f8ff;
            border-radius: 5px;
          }
          .summary h2 {
            margin: 0 0 15px 0;
            font-size: 18px;
            color: #333;
          }
          .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
          }
          .summary-label {
            font-weight: bold;
            color: #333;
          }
          .summary-value {
            color: #555;
          }
          .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 12px;
            color: #666;
            border-top: 1px solid #ddd;
            padding-top: 20px;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>ตารางผ่อนชำระ</h1>
          <p>บริษัท กุนทาร จำกัด</p>
          <p>วันที่พิมพ์: ${new Date().toLocaleDateString("th-TH")}</p>
        </div>

        <div class="customer-info">
          <h2>ข้อมูลลูกค้า</h2>
          <div class="info-grid">
            <div class="info-section">
              <h3>ข้อมูลลูกค้า</h3>
              <div class="info-item">
                <span class="info-label">ชื่อ-สกุล:</span> ${F.name}
              </div>
              <div class="info-item">
                <span class="info-label">ชื่อเล่น:</span> ${F.nickname}
              </div>
              <div class="info-item">
                <span class="info-label">เบอร์โทร:</span> ${F.phone}
              </div>
              <div class="info-item">
                <span class="info-label">ที่อยู่:</span> ${F.address}
              </div>
            </div>
            <div class="info-section">
              <h3>ข้อมูลผู้ค้ำประกัน</h3>
              <div class="info-item">
                <span class="info-label">ชื่อ-สกุล:</span> ${F.guarantorName}
              </div>
              <div class="info-item">
                <span class="info-label">ชื่อเล่น:</span> ${F.guarantorNickname||"-"}
              </div>
              <div class="info-item">
                <span class="info-label">เบอร์โทร:</span> ${F.guarantorPhone||"-"}
              </div>
              <div class="info-item">
                <span class="info-label">ที่อยู่:</span> ${F.guarantorAddress||"-"}
              </div>
            </div>
          </div>
        </div>

        <div class="contract-details">
          <h2>รายละเอียดสัญญา</h2>
          <div class="info-grid">
            <div class="info-section">
              <div class="info-item">
                <span class="info-label">เลขที่สัญญา:</span> ${F.contractNumber||(w==null?void 0:w.contractNumber)||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">สินค้า:</span> ${F.productType}
              </div>
              <div class="info-item">
                <span class="info-label">ราคารวม:</span> ฿${((Fe=F.totalPrice)==null?void 0:Fe.toLocaleString())||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">เงินดาวน์:</span> ฿${((Le=F.downPayment)==null?void 0:Le.toLocaleString())||"N/A"}
              </div>
            </div>
            <div class="info-section">
              <div class="info-item">
                <span class="info-label">งวดต่อเดือน:</span> ฿${((Oe=F.installmentAmount)==null?void 0:Oe.toLocaleString())||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">จำนวนงวด:</span> ${F.months||"N/A"} งวด
              </div>
              <div class="info-item">
                <span class="info-label">วันที่เริ่ม:</span> ${le(w==null?void 0:w.startDate)||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">วันที่ครบกำหนด:</span> ${le(w==null?void 0:w.endDate)||"N/A"}
              </div>
            </div>
          </div>
        </div>

        <h2>รายการชำระเงิน</h2>
        <table class="payment-table">
          <thead>
            <tr>
              <th>งวดที่</th>
              <th>วันที่ชำระ</th>
              <th>เลขที่ใบเสร็จ</th>
              <th>จำนวนเงิน</th>
              <th>ยอดคงเหลือ</th>
              <th>สถานะ</th>
            </tr>
          </thead>
          <tbody>
            ${ce.map((Ve,Ye)=>{var vt,yt,Tt;return`
              <tr>
                <td>${Ye+1}</td>
                <td>${le(Ve.paymentDate)}</td>
                <td>${(vt=Ve.notes)!=null&&vt.includes("ใบเสร็จ:")&&((Tt=(yt=Ve.notes.split("ใบเสร็จ:")[1])==null?void 0:yt.split(",")[0])==null?void 0:Tt.trim())||"-"}</td>
                <td>฿${parseFloat(Ve.amount||0).toLocaleString()}</td>
                <td>฿${J(Ye).toLocaleString()}</td>
                <td>ชำระแล้ว</td>
              </tr>
            `}).join("")}
          </tbody>
        </table>

        <div class="summary">
          <h2>สรุปข้อมูล</h2>
          <div class="summary-item">
            <span class="summary-label">จำนวนงวดที่ชำระแล้ว:</span>
            <span class="summary-value">${ce.length} งวด</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">ยอดรวมที่ชำระแล้ว:</span>
            <span class="summary-value">฿${ce.reduce((Ve,Ye)=>Ve+parseFloat(Ye.amount||0),0).toLocaleString()}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">ยอดคงเหลือ:</span>
            <span class="summary-value">฿${Math.max(0,F.totalPrice-ce.reduce((Ve,Ye)=>Ve+parseFloat(Ye.amount||0),0)).toLocaleString()}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">จำนวนงวดที่เหลือ:</span>
            <span class="summary-value">${Math.max(0,(F.months||0)-ce.length)} งวด</span>
          </div>
        </div>

        <div class="footer">
          <p>เอกสารนี้พิมพ์จากระบบจัดการการผ่อนชำระ</p>
          <p>วันที่พิมพ์: ${new Date().toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}</p>
        </div>
      </body>
      </html>
    `,he=window.open("","_blank");he.document.write(Q),he.document.close(),he.onload=()=>{he.print(),he.close()}},pe=Q=>{const he={paid:{label:"ชำระแล้ว",className:"bg-green-100 text-green-800",icon:Xn},pending:{label:"รอชำระ",className:"bg-yellow-100 text-yellow-800",icon:Vc},overdue:{label:"ค้างชำระ",className:"bg-red-100 text-red-800",icon:Ui},cancelled:{label:"ยกเลิก",className:"bg-gray-100 text-gray-800",icon:gf},active:{label:"กำลังผ่อนชำระ",className:"bg-blue-100 text-blue-800",icon:Xn},completed:{label:"ผ่อนเสร็จ",className:"bg-green-100 text-green-800",icon:Xn},normal:{label:"ปกติ",className:"bg-gray-100 text-gray-800",icon:Xn}},Fe=he[Q]||he.pending,Le=Fe.icon;return i.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs rounded-full ${Fe.className}`,children:[i.jsx(Le,{className:"w-3 h-3 mr-1"}),Fe.label]})};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:x?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ut,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),i.jsx("p",{className:"text-gray-600",children:"กำลังโหลดข้อมูล..."})]})}):i.jsxs(i.Fragment,{children:[i.jsx(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs(oe,{onClick:t,variant:"outline",className:"bg-white hover:bg-gray-50 border-gray-200",children:[i.jsx(Vi,{className:"w-4 h-4 mr-2"}),"กลับ"]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ตารางผ่อนชำระ"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"จัดการการชำระเงินของลูกค้า"})]})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs(oe,{onClick:Te,variant:"outline",className:"bg-white hover:bg-gray-50 border-gray-200 text-gray-700",children:[i.jsx(hu,{className:"w-4 h-4 mr-2"}),"ปริ้นเอกสาร"]}),pe(F.status)]})]})}),i.jsxs("div",{className:"space-y-8",children:[i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4",children:i.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[i.jsx(Mr,{className:"w-5 h-5 mr-2"}),"ข้อมูลลูกค้า"]})}),i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(Mr,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:F.name}),i.jsxs("p",{className:"text-sm text-gray-500",children:["เลขที่สัญญา: ",F.contractNumber]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Mr,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["ชื่อเล่น: ",F.nickname]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(As,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.phone})]}),i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx(v0,{className:"w-4 h-4 text-gray-400 mt-0.5"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.address})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[i.jsx(Qn,{className:"w-4 h-4 mr-2 text-purple-600"}),"ข้อมูลผู้ค้ำประกัน"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Mr,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.guarantorName})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Mr,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["ชื่อเล่น: ",F.guarantorNickname||"-"]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(As,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.guarantorPhone||"-"})]}),i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx(v0,{className:"w-4 h-4 text-gray-400 mt-0.5"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.guarantorAddress||"-"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[i.jsx(Qr,{className:"w-4 h-4 mr-2 text-green-600"}),"รายละเอียดสัญญา"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Qr,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.productType})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(fl,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["ราคารวม: ฿",F.totalPrice.toLocaleString()]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(nl,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["ดาวน์: ฿",F.downPayment.toLocaleString()]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(ca,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["ผ่อน: ฿",F.installmentAmount.toLocaleString()," x ",F.months," เดือน"]})]})]})]})]})})]})}),i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 px-6 py-4",children:i.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[i.jsx(ur,{className:"w-5 h-5 mr-2"}),"บันทึกการชำระเงิน"]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"วันที่ชำระ"}),i.jsx("input",{type:"date",placeholder:"เลือกวันที่",value:n,onChange:Q=>s(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"เลขที่ใบเสร็จ"}),i.jsx("input",{type:"text",placeholder:"เลขที่ใบเสร็จ",value:a,onChange:Q=>o(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"จำนวนเงิน"}),i.jsx("input",{type:"number",placeholder:"จำนวนเงิน",value:l,onChange:Q=>c(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"พนักงานเก็บเงิน"}),A?i.jsxs("div",{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",children:[i.jsx(Ut,{className:"w-4 h-4 animate-spin mr-2"}),"โหลด..."]}):i.jsxs("select",{value:f,onChange:Q=>h(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",children:[i.jsx("option",{value:"",children:"เลือกพนักงาน"}),D.map(Q=>i.jsxs("option",{value:Q.id,children:[Q.name," ",Q.surname," (",Q.position,")"]},Q.id))]})]}),i.jsx("div",{className:"flex items-end",children:i.jsx(oe,{onClick:B,disabled:b,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white transition-all duration-200",children:b?i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"บันทึก..."]}):i.jsxs("div",{className:"flex items-center",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"บันทึก"]})})})]}),i.jsx("div",{className:"border-t border-gray-200 pt-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"สถานะ :"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentStatus",value:"รับคืนสินค้า",checked:m==="รับคืนสินค้า",onChange:Q=>g(Q.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"รับคืนสินค้า"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentStatus",value:"เร่งรัด",checked:m==="เร่งรัด",onChange:Q=>g(Q.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"เร่งรัด"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentStatus",value:"ปกติ",checked:m==="ปกติ",onChange:Q=>g(Q.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"ปกติ"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"สถานะ :"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"discountStatus",value:"ไม่มีส่วนลด",checked:p==="ไม่มีส่วนลด",onChange:Q=>v(Q.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"ไม่มีส่วนลด"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"discountStatus",value:"ส่วนลด",checked:p==="ส่วนลด",onChange:Q=>v(Q.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"ส่วนลด"})]})]})]})]})})]})]})}),i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-4",children:i.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[i.jsx(gr,{className:"w-5 h-5 mr-2"}),"รายการผ่อนชำระ (งวดที่ชำระแล้ว)"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"งวด"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันที่"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เลขที่ใบเสร็จ"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จำนวนเงิน"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ยอดคงเหลือ"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ส่วนลด"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ce.length>0?ce.map((Q,he)=>{const{receiptNumber:Fe,status:Le,discount:Oe}=Q.isDownPayment?me():ee(Q.notes);let Ve="";return Q.isDownPayment?Ve="เงินดาวน์/งวดแรก":Ve=`งวดที่ ${he+1}`,i.jsxs(Me.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:he*.1},className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ve}),Q.isDownPayment&&i.jsx("div",{className:"text-xs text-blue-600",children:"เงินดาวน์"}),!Q.isDownPayment&&i.jsxs("div",{className:"text-xs text-gray-500",children:["งวดที่ ",he+1]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:G===Q.id?i.jsx("input",{type:"date",value:Z.paymentDate,onChange:Ye=>j(vt=>({...vt,paymentDate:Ye.target.value})),className:"w-32 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-900",children:le(Q.paymentDate)}),i.jsx("div",{className:"text-xs text-green-600",children:"ชำระแล้ว"})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:G===Q.id?i.jsx("input",{type:"text",value:Z.receiptNumber,onChange:Ye=>j(vt=>({...vt,receiptNumber:Ye.target.value})),placeholder:"เลขที่ใบเสร็จ",className:"w-28 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-900",children:Fe}),Fe!=="-"&&i.jsx("div",{className:"text-xs text-blue-600",children:"ใบเสร็จ"})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:G===Q.id?i.jsx("input",{type:"number",value:Z.amount,onChange:Ye=>j(vt=>({...vt,amount:Ye.target.value})),className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01"}):i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm font-medium text-green-600",children:["฿",parseFloat(Q.amount||0).toLocaleString()]}),i.jsx("div",{className:"text-xs text-green-600",children:"ชำระแล้ว"})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm text-gray-900",children:["฿",J(he).toLocaleString()]}),he<ce.length-1&&i.jsxs("div",{className:"text-xs text-gray-500",children:["งวดที่เหลือ: ",ce.length-he-1]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:G===Q.id?i.jsxs("select",{value:Z.status,onChange:Ye=>j(vt=>({...vt,status:Ye.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"ปกติ",children:"ปกติ"}),i.jsx("option",{value:"เร่งรัด",children:"เร่งรัด"}),i.jsx("option",{value:"รับคืนสินค้า",children:"รับคืนสินค้า"})]}):i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Le==="ปกติ"?"bg-gray-100 text-gray-800":Le==="เร่งรัด"?"bg-yellow-100 text-yellow-800":Le==="รับคืนสินค้า"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:Le})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:G===Q.id?i.jsxs("select",{value:Z.discount,onChange:Ye=>j(vt=>({...vt,discount:Ye.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"ไม่มีส่วนลด",children:"ไม่มีส่วนลด"}),i.jsx("option",{value:"ส่วนลด",children:"ส่วนลด"})]}):i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Oe==="มี"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:Oe})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:G===Q.id?i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(oe,{size:"sm",onClick:()=>_e(Q.id),className:"bg-green-600 hover:bg-green-700 text-white",children:"บันทึก"}),i.jsx(oe,{size:"sm",variant:"outline",onClick:()=>{I(null),j({paymentDate:"",receiptNumber:"",amount:"",status:"ปกติ",discount:"ไม่มีส่วนลด",notes:""})},children:"ยกเลิก"})]}):i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(oe,{size:"sm",variant:"outline",onClick:()=>Re(Q),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Bs,{className:"w-3 h-3"})}),!Q.isDownPayment&&Q.id!=="down-payment"&&i.jsx(oe,{size:"sm",variant:"outline",onClick:()=>je(Q.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ha,{className:"w-3 h-3"})})]}),Q.id==="down-payment"&&i.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"แก้ไขเงินดาวน์"})]})})]},Q.id)}):i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-gray-500",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx(gr,{className:"w-8 h-8 mb-2 text-gray-400"}),i.jsx("p",{children:"ไม่พบรายการผ่อนชำระ"})]})})})})]})})]})}),i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.35},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-red-600 px-6 py-4",children:i.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[i.jsx(Vc,{className:"w-5 h-5 mr-2"}),"งวดที่รอชำระ (",Se.length," งวด)"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"งวด"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันครบกำหนด"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จำนวนเงิน"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Se.length>0?Se.map((Q,he)=>i.jsxs(Me.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:he*.1},className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"text-sm font-medium text-gray-900",children:Q.notes})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"text-sm text-gray-900",children:le(Q.dueDate)})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("span",{className:"text-sm font-medium text-orange-600",children:["฿",parseFloat(Q.amount||0).toLocaleString()]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:pe(Q.status)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs(oe,{size:"sm",variant:"outline",className:"text-green-600 border-green-200 hover:bg-green-50 hover:border-green-300",onClick:()=>{c(Q.amount),s(new Date().toISOString().split("T")[0]),o("")},children:[i.jsx(ur,{className:"w-3 h-3"}),"ชำระ"]})})})]},Q.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:"5",className:"px-6 py-8 text-center text-gray-500",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx(Xn,{className:"w-8 h-8 mb-2 text-green-400"}),i.jsx("p",{children:"ไม่มีงวดที่รอชำระ"})]})})})})]})})]})}),i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[i.jsx(hl,{className:"w-5 h-5 mr-2 text-blue-600"}),"ความคืบหน้าการชำระเงิน"]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["฿",U.toLocaleString()]}),i.jsxs("p",{className:"text-sm text-gray-500",children:["ชำระแล้วจาก ฿",F.totalPrice.toLocaleString()]})]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 h-3 rounded-full transition-all duration-500",style:{width:`${Math.min(H,100)}%`}})}),i.jsxs("div",{className:"flex justify-between mt-2 text-sm text-gray-600",children:[i.jsx("span",{children:"0%"}),i.jsxs("span",{children:[Math.round(H),"%"]}),i.jsx("span",{children:"100%"})]}),i.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-blue-800",children:"ยอดคงเหลือ:"}),i.jsxs("span",{className:"text-lg font-bold text-blue-900",children:["฿",X.toLocaleString()]})]})})]})})]})]})})},eO=e=>{if(!e||isNaN(e.getTime()))return"-";const t=e.getDate(),r=e.getMonth()+1,n=e.getFullYear(),a=n>2500?n:n+543;return`${t.toString().padStart(2,"0")}/${r.toString().padStart(2,"0")}/${a}`},tO=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(null),[c,u]=E.useState(""),[d,f]=E.useState(""),[h,m]=E.useState(new Date().getFullYear()),[g,p]=E.useState(200),v=[{value:"01",label:"มกราคม"},{value:"02",label:"กุมภาพันธ์"},{value:"03",label:"มีนาคม"},{value:"04",label:"เมษายน"},{value:"05",label:"พฤษภาคม"},{value:"06",label:"มิถุนายน"},{value:"07",label:"กรกฎาคม"},{value:"08",label:"สิงหาคม"},{value:"09",label:"กันยายน"},{value:"10",label:"ตุลาคม"},{value:"11",label:"พฤศจิกายน"},{value:"12",label:"ธันวาคม"}],b=E.useMemo(()=>{const k=new Date().getFullYear(),w=[];for(let C=k;C>=k-5;C--)w.push(C);return w},[]),y=async()=>{var k;try{a(!0),l(null);let w="/installments";const C=new URLSearchParams;d&&C.append("month",d),h&&C.append("year",h),c&&C.append("search",c),e&&C.append("branchId",e),C.toString()&&(w+=`?${C.toString()}`),console.log("🔍 Calling API:",w);const D=await ye.get(w);if(console.log("🔍 API Response:",D.data),(k=D.data)!=null&&k.success){const z=D.data.data||[];console.log("🔍 API Response Data:",z);const A=await Promise.all(z.map(async(R,G)=>{var Y;let I=null,Z=0,j=0;try{const q=await ye.get(`/installments/${R.id}/payments`);(Y=q.data)!=null&&Y.success&&(I=q.data.data,Z=I.reduce((F,L)=>F+(L.status==="paid"?parseFloat(L.amount):0),0),j=(parseFloat(R.totalAmount)||0)-Z)}catch{console.log("No payment data for installment:",R.id)}return{id:R.id,sequence:G+1,contractDate:R.contractDate?eO(new Date(R.contractDate)):"-",contractNumber:R.contractNumber||`F${R.id.toString().padStart(4,"0")}`,customerFullName:R.customerFullName||`${R.customerName||""} ${R.customerSurname||""}`.trim()||"-",line:R.line||R.inspectorId||"-",amount:Z,employee:R.salespersonFullName||R.salespersonName||"-",receiptNumber:(I==null?void 0:I.length)>0?`${I[0].id}/${new Date().getFullYear()+543-2500}`:"0",remainingDebt:j,totalAmount:parseFloat(R.totalAmount)||0}}));console.log("🔍 Processed Data:",A),n(A)}else l("ไม่สามารถดึงข้อมูลได้")}catch(w){console.error("Error fetching installment data:",w),l("เกิดข้อผิดพลาดในการดึงข้อมูล"),ge({title:"ข้อผิดพลาด",description:"ไม่สามารถดึงข้อมูลค่างวดได้",variant:"destructive"})}finally{a(!1)}};E.useEffect(()=>{console.log("🔍 useEffect triggered - fetching installment data"),y()},[d,h]);const x=E.useMemo(()=>c?r.filter(k=>k.contractNumber.toLowerCase().includes(c.toLowerCase())||k.customerFullName.toLowerCase().includes(c.toLowerCase())||k.employee.toLowerCase().includes(c.toLowerCase())):r,[r,c]),N=()=>{var C;const k=window.open("","_blank"),w=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>รายงานสารบัญค่างวด</title>
          <style>
            body { font-family: 'Sarabun', sans-serif; margin: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; font-weight: bold; }
            .header { text-align: center; margin-bottom: 20px; }
            .text-right { text-align: right; }
            .text-center { text-align: center; }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>รายงานสารบัญค่างวด</h1>
            <p>เดือน: ${d?(C=v.find(D=>D.value===d))==null?void 0:C.label:"ทั้งหมด"} ${h}</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>ว.ด.ป.</th>
                <th>สัญญา</th>
                <th>ชื่อ-สกุล</th>
                <th>สาย</th>
                <th>จำนวนเงิน</th>
                <th>พนักงาน</th>
                <th>เลขที่ใบเสร็จ</th>
                <th>คงเหลือ</th>
              </tr>
            </thead>
            <tbody>
              ${x.map(D=>`
                <tr>
                  <td>${D.contractDate}</td>
                  <td>${D.contractNumber}</td>
                  <td>${D.customerFullName}</td>
                  <td class="text-center">${D.line}</td>
                  <td class="text-right">฿${D.amount.toLocaleString()}</td>
                  <td>${D.employee}</td>
                  <td class="text-center">${D.receiptNumber}</td>
                  <td class="text-right">฿${D.remainingDebt.toLocaleString()}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </body>
      </html>
    `;k.document.write(w),k.document.close(),k.print()},_=()=>{const w=[["ว.ด.ป.","สัญญา","ชื่อ-สกุล","สาย","จำนวนเงิน","พนักงาน","เลขที่ใบเสร็จ","คงเหลือ"].join(","),...x.map(A=>[A.contractDate,A.contractNumber,A.customerFullName,A.line,A.amount,A.employee,A.receiptNumber,A.remainingDebt].join(","))].join(`
`),C=new Blob([w],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),z=URL.createObjectURL(C);D.setAttribute("href",z),D.setAttribute("download",`สารบัญค่างวด_${d||"ทั้งหมด"}_${h}.csv`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D),ge({title:"ส่งออกสำเร็จ",description:"ไฟล์ Excel ถูกดาวน์โหลดแล้ว",variant:"default"})};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:i.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[i.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-lg",children:i.jsx(gr,{className:"h-8 w-8 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"สารบัญค่างวด"}),i.jsxs("p",{className:"text-gray-600 mt-1",children:["แสดงข้อมูลค่างวดของสาขา ",t==null?void 0:t.name]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("button",{onClick:N,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-xl hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[i.jsx(hu,{className:"h-5 w-5"}),i.jsx("span",{className:"font-semibold",children:"พิมพ์"})]}),i.jsxs("button",{onClick:_,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[i.jsx(ua,{className:"h-5 w-5"}),i.jsx("span",{className:"font-semibold",children:"บันทึกเป็น Excel"})]})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx("div",{className:"relative",children:i.jsxs("select",{value:d,onChange:k=>f(k.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 hover:bg-white transition-all duration-200",children:[i.jsx("option",{value:"",children:"ทุกเดือน"}),v.map(k=>i.jsx("option",{value:k.value,children:k.label},k.value))]})}),i.jsx("div",{className:"relative",children:i.jsx("select",{value:h,onChange:k=>m(k.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 hover:bg-white transition-all duration-200",children:b.map(k=>i.jsx("option",{value:k,children:k},k))})}),i.jsxs("button",{onClick:y,className:"flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[i.jsx(xn,{className:"h-5 w-5"}),i.jsx("span",{className:"font-semibold",children:"ค้นหา"})]}),i.jsxs("div",{className:"flex items-center space-x-3 bg-gray-50 rounded-xl px-4 py-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show"}),i.jsxs("select",{value:g,onChange:k=>p(k.target.value),className:"px-3 py-1 border border-gray-200 rounded-lg text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:50,children:"50"}),i.jsx("option",{value:100,children:"100"}),i.jsx("option",{value:200,children:"200"}),i.jsx("option",{value:500,children:"500"})]}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"entries"})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("span",{className:"text-lg font-semibold text-gray-700",children:"Search:"}),i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(xn,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหาสัญญา, ลูกค้า, พนักงาน...",value:c,onChange:k=>u(k.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 hover:bg-white transition-all duration-200 text-lg"})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-purple-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"ว.ด.ป. ↕"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"สัญญา ↕"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"ชื่อ-สกุล ↕"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"สาย ↕"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"จำนวนเงิน ↕"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"พนักงาน ↕"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"เลขที่ใบเสร็จ ↕"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"คงเหลือ ↕"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center",children:i.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[i.jsx(Ut,{className:"h-6 w-6 animate-spin text-blue-600"}),i.jsx("span",{className:"text-gray-600 text-lg",children:"กำลังโหลดข้อมูล..."})]})})}):o?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-red-600 text-lg",children:o})}):x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-gray-500 text-lg",children:"ไม่พบข้อมูลค่างวด"})}):x.slice(0,g).map((k,w)=>i.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all duration-200",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:k.contractDate}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-red-600 cursor-pointer hover:text-red-800 hover:underline transition-colors duration-200",children:k.contractNumber}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.customerFullName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center text-gray-900 font-medium",children:k.line}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-semibold",children:["฿",k.amount.toLocaleString()]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.employee}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center text-gray-900 font-medium",children:k.receiptNumber}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-semibold",children:["฿",k.remainingDebt.toLocaleString()]})]},k.id))})]})})})]})})},mr=xt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Cr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));mr.displayName="Card";const Wn=xt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Cr("flex flex-col space-y-1.5 p-6",e),...t}));Wn.displayName="CardHeader";const Gn=xt.forwardRef(({className:e,...t},r)=>i.jsx("h3",{ref:r,className:Cr("text-2xl font-semibold leading-none tracking-tight",e),...t}));Gn.displayName="CardTitle";const Fs=xt.forwardRef(({className:e,...t},r)=>i.jsx("p",{ref:r,className:Cr("text-sm text-muted-foreground",e),...t}));Fs.displayName="CardDescription";const pr=xt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Cr("p-6 pt-0",e),...t}));pr.displayName="CardContent";const rO=xt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Cr("flex items-center p-6 pt-0",e),...t}));rO.displayName="CardFooter";const pS=xt.forwardRef(({className:e,value:t,...r},n)=>i.jsx("div",{ref:n,className:Cr("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:i.jsx("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));pS.displayName="Progress";const nO=tg("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ld=xt.forwardRef(({className:e,variant:t,...r},n)=>i.jsx("div",{ref:n,role:"alert",className:Cr(nO({variant:t}),e),...r}));Ld.displayName="Alert";const sO=xt.forwardRef(({className:e,...t},r)=>i.jsx("h5",{ref:r,className:Cr("mb-1 font-medium leading-none tracking-tight",e),...t}));sO.displayName="AlertTitle";const Od=xt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Cr("text-sm [&_p]:leading-relaxed",e),...t}));Od.displayName="AlertDescription";/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var F0={};F0.version="0.18.5";var xS=1252,aO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Eg=function(e){aO.indexOf(e)!=-1&&(xS=Sg[0]=e)};function iO(){Eg(1252)}var ds=function(e){Eg(e)};function Cg(){ds(1200),iO()}function hw(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function oO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function gS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Kl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?oO(e.slice(2)):t==254&&r==255?gS(e.slice(2)):t==65279?e.slice(1):e},ad=function(t){return String.fromCharCode(t)},mw=function(t){return String.fromCharCode(t)},ja,Da="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Hc(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,s=e.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=Da.charAt(a)+Da.charAt(o)+Da.charAt(l)+Da.charAt(c);return t}function An(e){var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Da.indexOf(e.charAt(u++)),o=Da.indexOf(e.charAt(u++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=Da.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Da.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Je=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ma=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ya(e){return Je?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function pw(e){return Je?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Nn=function(t){return Je?ma(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Af(e){if(typeof ArrayBuffer>"u")return Nn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ni(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function lO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function jg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return jg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var xr=Je?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ma(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function cO(e){for(var t=[],r=0,n=e.length+250,s=Ya(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Ya(65535),n=65530)}return t.push(s.slice(0,r)),xr(t)}var en=/\u0000/g,Yl=/[\u0001-\u0006]/g;function Ho(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function fs(e,t){var r=""+e;return r.length>=t?r:Ht("0",t-r.length)+r}function Tg(e,t){var r=""+e;return r.length>=t?r:Ht(" ",t-r.length)+r}function P0(e,t){var r=""+e;return r.length>=t?r:r+Ht(" ",t-r.length)}function uO(e,t){var r=""+Math.round(e);return r.length>=t?r:Ht("0",t-r.length)+r}function dO(e,t){var r=""+e;return r.length>=t?r:Ht("0",t-r.length)+r}var xw=Math.pow(2,32);function fo(e,t){if(e>xw||e<-xw)return uO(e,t);var r=Math.round(e);return dO(r,t)}function D0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var gw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Oh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var $e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},vw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function I0(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),l=f*o+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=a):(d=u,l=o)),!r)return[0,n*l,d];var h=Math.floor(n*l/d);return[h,n*l-h*d,d]}function _i(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=yO(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var vS=new Date(1899,11,31,0,0,0),mO=vS.getTime(),pO=new Date(1900,2,1,0,0,0);function yS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=pO&&(r+=24*60*60*1e3),(r-(mO+(e.getTimezoneOffset()-vS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ag(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gO(e){var t=e<0?12:11,r=Ag(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vO(e){var t=Ag(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Wc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=gO(e):t===10?r=e.toFixed(10).substr(0,12):r=vO(e),Ag(xO(r.toUpperCase()))}function Wi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Wc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ts(14,yS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wO(e,t,r,n){var s="",a=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Oh[r.m-1][1];case 5:return Oh[r.m-1][0];default:return Oh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return gw[r.q][0];default:return gw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?fs(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(s=fs(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?fs(c,u):"";return d}function Ia(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var wS=/%/g;function bO(e,t,r){var n=t.replace(wS,""),s=t.length-n.length;return ea(e,n,r*Math.pow(10,2*s))+Ht("%",s)}function NO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ea(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function bS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+bS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var NS=/# (\?+)( ?)\/( ?)(\d+)/;function kO(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),o=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?Ht(" ",e[1].length+1+e[4].length):Tg(o,e[1].length)+e[2]+"/"+e[3]+fs(l,e[4].length))}function _O(e,t,r){return r+(t===0?"":""+t)+Ht(" ",e[1].length+2+e[4].length)}var kS=/^#*0*\.([0#]+)/,_S=/\).*[0#]/,SS=/\(###\) ###\\?-####/;function qr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function yw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ww(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function SO(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function EO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function On(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_S)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?On("n",n,r):"("+On("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return NO(e,t,r);if(t.indexOf("%")!==-1)return bO(e,t,r);if(t.indexOf("E")!==-1)return bS(t,r);if(t.charCodeAt(0)===36)return"$"+On(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+fo(c,t.length);if(t.match(/^[#?]+$/))return s=fo(r,0),s==="0"&&(s=""),s.length>t.length?s:qr(t.substr(0,t.length-s.length))+s;if(a=t.match(NS))return kO(a,c,u);if(t.match(/^#+0+$/))return u+fo(c,t.length-t.indexOf("0"));if(a=t.match(kS))return s=yw(r,a[1].length).replace(/^([^\.]+)$/,"$1."+qr(a[1])).replace(/\.$/,"."+qr(a[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Ht("0",qr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+yw(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Ia(fo(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+On(e,t,-r):Ia(""+(Math.floor(r)+SO(r,a[1].length)))+"."+fs(ww(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return On(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ho(On(e,t.replace(/[\\-]/g,""),r)),o=0,Ho(Ho(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(SS))return s=On(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=I0(c,Math.pow(10,o)-1,!1),s=""+u,d=ea("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=P0(l[2],o),d.length<a[4].length&&(d=qr(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=I0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Tg(l[1],o)+a[2]+"/"+a[3]+P0(l[2],o):Ht(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=fo(r,0),t.length<=s.length?s:qr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return qr(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=ww(r,a[1].length),r<0?"-"+On(e,t,-r):Ia(EO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fs(0,3-g.length):"")+g})+"."+fs(o,a[1].length);switch(t){case"###,##0.00":return On(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ia(fo(c,0));return m!=="0"?u+m:"";case"###,###.00":return On(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return On(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function CO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ea(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function jO(e,t,r){var n=t.replace(wS,""),s=t.length-n.length;return ea(e,n,r*Math.pow(10,2*s))+Ht("%",s)}function ES(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ES(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _s(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_S)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_s("n",n,r):"("+_s("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CO(e,t,r);if(t.indexOf("%")!==-1)return jO(e,t,r);if(t.indexOf("E")!==-1)return ES(t,r);if(t.charCodeAt(0)===36)return"$"+_s(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+fs(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:qr(t.substr(0,t.length-s.length))+s;if(a=t.match(NS))return _O(a,c,u);if(t.match(/^#+0+$/))return u+fs(c,t.length-t.indexOf("0"));if(a=t.match(kS))return s=(""+r).replace(/^([^\.]+)$/,"$1."+qr(a[1])).replace(/\.$/,"."+qr(a[1])),s=s.replace(/\.(\d*)$/,function(g,p){return"."+p+Ht("0",qr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Ia(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_s(e,t,-r):Ia(""+r)+"."+Ht("0",a[1].length);if(a=t.match(/^#,#*,#0/))return _s(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ho(_s(e,t.replace(/[\\-]/g,""),r)),o=0,Ho(Ho(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(SS))return s=_s(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=I0(c,Math.pow(10,o)-1,!1),s=""+u,d=ea("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=P0(l[2],o),d.length<a[4].length&&(d=qr(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=I0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Tg(l[1],o)+a[2]+"/"+a[3]+P0(l[2],o):Ht(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:qr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return qr(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_s(e,t,-r):Ia(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fs(0,3-g.length):"")+g})+"."+fs(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Ia(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return _s(e,t.slice(0,t.lastIndexOf(".")),r)+qr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ea(e,t,r){return(r|0)===r?_s(e,t,r):On(e,t,r)}function TO(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var CS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function wl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":D0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(CS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function AO(e,t,r,n){for(var s=[],a="",o=0,l="",c="t",u,d,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!D0(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(f=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++o;break;case"\\":var m=e.charAt(++o),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=_i(t,r,e.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=_i(t,r),u==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"上":var p={t:l,v:l};if(u==null&&(u=_i(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(p.v=u.H>=12?"下午":"上午"),p.t="T",o+=5,h="h"):(p.t="t",++o),u==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(CS)){if(u==null&&(u=_i(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",wl(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var v=0,b=0,y;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,c="h",v<1&&(v=1);break;case"s":(y=s[o].v.match(/\.0+$/))&&(b=Math.max(b,y[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[o].v.match(/[Hh]/)&&(v=1),v<2&&s[o].v.match(/[Mm]/)&&(v=2),v<3&&s[o].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var x="",N;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=wO(s[o].t.charCodeAt(0),s[o].v,u,b),s[o].t="t";break;case"n":case"?":for(N=o+1;s[N]!=null&&((l=s[N].t)==="?"||l==="D"||(l===" "||l==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[o].v+=s[N].v,s[N]={v:"",t:";"},++N;x+=s[o].v,o=N-1;break;case"G":s[o].t="t",s[o].v=Wi(t,r);break}var _="",k,w;if(x.length>0){x.charCodeAt(0)==40?(k=t<0&&x.charCodeAt(0)===45?-t:t,w=ea("n",x,k)):(k=t<0&&n>1?-t:t,w=ea("n",x,k),k<0&&s[0]&&s[0].t=="t"&&(w=w.substr(1),s[0].v="-"+s[0].v)),N=w.length-1;var C=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){C=o;break}var D=s.length;if(C===s.length&&w.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(N>=s[o].v.length-1?(N-=s[o].v.length,s[o].v=w.substr(N+1,s[o].v.length)):N<0?s[o].v="":(s[o].v=w.substr(0,N+1),N=-1),s[o].t="t",D=o);N>=0&&D<s.length&&(s[D].v=w.substr(0,N+1)+s[D].v)}else if(C!==s.length&&w.indexOf("E")===-1){for(N=w.indexOf(".")-1,o=C;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")-1:s[o].v.length-1,_=s[o].v.substr(d+1);d>=0;--d)N>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(_=w.charAt(N--)+_);s[o].v=_,s[o].t="t",D=o}for(N>=0&&D<s.length&&(s[D].v=w.substr(0,N+1)+s[D].v),N=w.indexOf(".")+1,o=C;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==C)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")+1:0,_=s[o].v.substr(0,d);d<s[o].v.length;++d)N<w.length&&(_+=w.charAt(N++));s[o].v=_,s[o].t="t",D=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(k=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=ea(s[o].t,s[o].v,k),s[o].t="t");var z="";for(o=0;o!==s.length;++o)s[o]!=null&&(z+=s[o].v);return z}var bw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function FO(e,t){var r=TO(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(bw),l=r[1].match(bw);return Nw(t,o)?[n,r[0]]:Nw(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function ts(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:$e)[e],n==null&&(n=r.table&&r.table[vw[e]]||$e[vw[e]]),n==null&&(n=hO[e]||"General");break}if(D0(n,0))return Wi(t,r);t instanceof Date&&(t=yS(t,r.date1904));var s=FO(n,t);if(D0(s[1]))return Wi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return AO(s[1],t,r,s[0])}function ta(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if($e[r]==null){t<0&&(t=r);continue}if($e[r]==e){t=r;break}}t<0&&(t=391)}return $e[t]=e,t}function Ff(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ta(e[t],t)}function bl(){$e=fO()}var PO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},jS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function DO(e){var t=typeof e=="number"?$e[e]:e;return t=t.replace(jS,"(\\d+)"),new RegExp("^"+t+"$")}function IO(e,t,r){var n=-1,s=-1,a=-1,o=-1,l=-1,c=-1;(t.match(jS)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":a=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:s=m;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var RO=function(){var e={};e.version="1.2.0";function t(){for(var w=0,C=new Array(256),D=0;D!=256;++D)w=D,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,C[D]=w;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(w){var C=0,D=0,z=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)A[z]=w[z];for(z=0;z!=256;++z)for(D=w[z],C=256+z;C<4096;C+=256)D=A[C]=D>>>8^w[D&255];var R=[];for(z=1;z!=16;++z)R[z-1]=typeof Int32Array<"u"?A.subarray(z*256,z*256+256):A.slice(z*256,z*256+256);return R}var s=n(r),a=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],f=s[6],h=s[7],m=s[8],g=s[9],p=s[10],v=s[11],b=s[12],y=s[13],x=s[14];function N(w,C){for(var D=C^-1,z=0,A=w.length;z<A;)D=D>>>8^r[(D^w.charCodeAt(z++))&255];return~D}function _(w,C){for(var D=C^-1,z=w.length-15,A=0;A<z;)D=x[w[A++]^D&255]^y[w[A++]^D>>8&255]^b[w[A++]^D>>16&255]^v[w[A++]^D>>>24]^p[w[A++]]^g[w[A++]]^m[w[A++]]^h[w[A++]]^f[w[A++]]^d[w[A++]]^u[w[A++]]^c[w[A++]]^l[w[A++]]^o[w[A++]]^a[w[A++]]^r[w[A++]];for(z+=15;A<z;)D=D>>>8^r[(D^w[A++])&255];return~D}function k(w,C){for(var D=C^-1,z=0,A=w.length,R=0,G=0;z<A;)R=w.charCodeAt(z++),R<128?D=D>>>8^r[(D^R)&255]:R<2048?(D=D>>>8^r[(D^(192|R>>6&31))&255],D=D>>>8^r[(D^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,G=w.charCodeAt(z++)&1023,D=D>>>8^r[(D^(240|R>>8&7))&255],D=D>>>8^r[(D^(128|R>>2&63))&255],D=D>>>8^r[(D^(128|G>>6&15|(R&3)<<4))&255],D=D>>>8^r[(D^(128|G&63))&255]):(D=D>>>8^r[(D^(224|R>>12&15))&255],D=D>>>8^r[(D^(128|R>>6&63))&255],D=D>>>8^r[(D^(128|R&63))&255]);return~D}return e.table=r,e.bstr=N,e.buf=_,e.str=k,e}(),Be=function(){var t={};t.version="1.2.1";function r(P,V){for(var O=P.split("/"),M=V.split("/"),W=0,K=0,re=Math.min(O.length,M.length);W<re;++W){if(K=O[W].length-M[W].length)return K;if(O[W]!=M[W])return O[W]<M[W]?-1:1}return O.length-M.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var V=P.lastIndexOf("/");return V===-1?P:P.slice(0,V+1)}function s(P){if(P.charAt(P.length-1)=="/")return s(P.slice(0,-1));var V=P.lastIndexOf("/");return V===-1?P:P.slice(V+1)}function a(P,V){typeof V=="string"&&(V=new Date(V));var O=V.getHours();O=O<<6|V.getMinutes(),O=O<<5|V.getSeconds()>>>1,P.write_shift(2,O);var M=V.getFullYear()-1980;M=M<<4|V.getMonth()+1,M=M<<5|V.getDate(),P.write_shift(2,M)}function o(P){var V=P.read_shift(2)&65535,O=P.read_shift(2)&65535,M=new Date,W=O&31;O>>>=5;var K=O&15;O>>>=4,M.setMilliseconds(0),M.setFullYear(O+1980),M.setMonth(K-1),M.setDate(W);var re=V&31;V>>>=5;var fe=V&63;return V>>>=6,M.setHours(V),M.setMinutes(fe),M.setSeconds(re<<1),M}function l(P){kr(P,0);for(var V={},O=0;P.l<=P.length-4;){var M=P.read_shift(2),W=P.read_shift(2),K=P.l+W,re={};switch(M){case 21589:O=P.read_shift(1),O&1&&(re.mtime=P.read_shift(4)),W>5&&(O&2&&(re.atime=P.read_shift(4)),O&4&&(re.ctime=P.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}P.l=K,V[M]=re}return V}var c;function u(){return c||(c={})}function d(P,V){if(P[0]==80&&P[1]==75)return ss(P,V);if((P[0]|32)==109&&(P[1]|32)==105)return DC(P,V);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var O=3,M=512,W=0,K=0,re=0,fe=0,te=0,ne=[],ae=P.slice(0,512);kr(ae,0);var ve=f(ae);switch(O=ve[0],O){case 3:M=512;break;case 4:M=4096;break;case 0:if(ve[1]==0)return ss(P,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}M!==512&&(ae=P.slice(0,M),kr(ae,28));var Ee=P.slice(0,M);h(ae,O);var Pe=ae.read_shift(4,"i");if(O===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);ae.l+=4,re=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),fe=ae.read_shift(4,"i"),W=ae.read_shift(4,"i"),te=ae.read_shift(4,"i"),K=ae.read_shift(4,"i");for(var be=-1,Ce=0;Ce<109&&(be=ae.read_shift(4,"i"),!(be<0));++Ce)ne[Ce]=be;var Ge=m(P,M);v(te,K,Ge,M,ne);var Pt=y(Ge,re,ne,M);Pt[re].name="!Directory",W>0&&fe!==G&&(Pt[fe].name="!MiniFAT"),Pt[ne[0]].name="!FAT",Pt.fat_addrs=ne,Pt.ssz=M;var Dt={},jr=[],Sl=[],El=[];x(re,Pt,Ge,jr,W,Dt,Sl,fe),g(Sl,El,jr),jr.shift();var Cl={FileIndex:Sl,FullPaths:El};return V&&V.raw&&(Cl.raw={header:Ee,sectors:Ge}),Cl}function f(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(I,"Header Signature: "),P.l+=16;var V=P.read_shift(2,"u");return[P.read_shift(2,"u"),V]}function h(P,V){var O=9;switch(P.l+=2,O=P.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function m(P,V){for(var O=Math.ceil(P.length/V)-1,M=[],W=1;W<O;++W)M[W-1]=P.slice(W*V,(W+1)*V);return M[O-1]=P.slice(O*V),M}function g(P,V,O){for(var M=0,W=0,K=0,re=0,fe=0,te=O.length,ne=[],ae=[];M<te;++M)ne[M]=ae[M]=M,V[M]=O[M];for(;fe<ae.length;++fe)M=ae[fe],W=P[M].L,K=P[M].R,re=P[M].C,ne[M]===M&&(W!==-1&&ne[W]!==W&&(ne[M]=ne[W]),K!==-1&&ne[K]!==K&&(ne[M]=ne[K])),re!==-1&&(ne[re]=M),W!==-1&&M!=ne[M]&&(ne[W]=ne[M],ae.lastIndexOf(W)<fe&&ae.push(W)),K!==-1&&M!=ne[M]&&(ne[K]=ne[M],ae.lastIndexOf(K)<fe&&ae.push(K));for(M=1;M<te;++M)ne[M]===M&&(K!==-1&&ne[K]!==K?ne[M]=ne[K]:W!==-1&&ne[W]!==W&&(ne[M]=ne[W]));for(M=1;M<te;++M)if(P[M].type!==0){if(fe=M,fe!=ne[fe])do fe=ne[fe],V[M]=V[fe]+"/"+V[M];while(fe!==0&&ne[fe]!==-1&&fe!=ne[fe]);ne[M]=-1}for(V[0]+="/",M=1;M<te;++M)P[M].type!==2&&(V[M]+="/")}function p(P,V,O){for(var M=P.start,W=P.size,K=[],re=M;O&&W>0&&re>=0;)K.push(V.slice(re*R,re*R+R)),W-=R,re=pi(O,re*4);return K.length===0?de(0):xr(K).slice(0,P.size)}function v(P,V,O,M,W){var K=G;if(P===G){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var re=O[P],fe=(M>>>2)-1;if(!re)return;for(var te=0;te<fe&&(K=pi(re,te*4))!==G;++te)W.push(K);v(pi(re,M-4),V-1,O,M,W)}}function b(P,V,O,M,W){var K=[],re=[];W||(W=[]);var fe=M-1,te=0,ne=0;for(te=V;te>=0;){W[te]=!0,K[K.length]=te,re.push(P[te]);var ae=O[Math.floor(te*4/M)];if(ne=te*4&fe,M<4+ne)throw new Error("FAT boundary crossed: "+te+" 4 "+M);if(!P[ae])break;te=pi(P[ae],ne)}return{nodes:K,data:Iw([re])}}function y(P,V,O,M){var W=P.length,K=[],re=[],fe=[],te=[],ne=M-1,ae=0,ve=0,Ee=0,Pe=0;for(ae=0;ae<W;++ae)if(fe=[],Ee=ae+V,Ee>=W&&(Ee-=W),!re[Ee]){te=[];var be=[];for(ve=Ee;ve>=0;){be[ve]=!0,re[ve]=!0,fe[fe.length]=ve,te.push(P[ve]);var Ce=O[Math.floor(ve*4/M)];if(Pe=ve*4&ne,M<4+Pe)throw new Error("FAT boundary crossed: "+ve+" 4 "+M);if(!P[Ce]||(ve=pi(P[Ce],Pe),be[ve]))break}K[Ee]={nodes:fe,data:Iw([te])}}return K}function x(P,V,O,M,W,K,re,fe){for(var te=0,ne=M.length?2:0,ae=V[P].data,ve=0,Ee=0,Pe;ve<ae.length;ve+=128){var be=ae.slice(ve,ve+128);kr(be,64),Ee=be.read_shift(2),Pe=Og(be,0,Ee-ne),M.push(Pe);var Ce={name:Pe,type:be.read_shift(1),color:be.read_shift(1),L:be.read_shift(4,"i"),R:be.read_shift(4,"i"),C:be.read_shift(4,"i"),clsid:be.read_shift(16),state:be.read_shift(4,"i"),start:0,size:0},Ge=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Ge!==0&&(Ce.ct=N(be,be.l-8));var Pt=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Pt!==0&&(Ce.mt=N(be,be.l-8)),Ce.start=be.read_shift(4,"i"),Ce.size=be.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=G,Ce.name=""),Ce.type===5?(te=Ce.start,W>0&&te!==G&&(V[te].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",V[Ce.start]===void 0&&(V[Ce.start]=b(O,Ce.start,V.fat_addrs,V.ssz)),V[Ce.start].name=Ce.name,Ce.content=V[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:te!==G&&Ce.start!==G&&V[te]&&(Ce.content=p(Ce,V[te].data,(V[fe]||{}).data))),Ce.content&&kr(Ce.content,0),K[Pe]=Ce,re.push(Ce)}}function N(P,V){return new Date((wn(P,V+4)/1e7*Math.pow(2,32)+wn(P,V)/1e7-11644473600)*1e3)}function _(P,V){return u(),d(c.readFileSync(P),V)}function k(P,V){var O=V&&V.type;switch(O||Je&&Buffer.isBuffer(P)&&(O="buffer"),O||"base64"){case"file":return _(P,V);case"base64":return d(Nn(An(P)),V);case"binary":return d(Nn(P),V)}return d(P,V)}function w(P,V){var O=V||{},M=O.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=M+"/",P.FileIndex[0]={name:M,type:5}),O.CLSID&&(P.FileIndex[0].clsid=O.CLSID),C(P)}function C(P){var V="Sh33tJ5";if(!Be.find(P,"/"+V)){var O=de(4);O[0]=55,O[1]=O[3]=50,O[2]=54,P.FileIndex.push({name:V,type:2,content:O,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+V),D(P)}}function D(P,V){w(P);for(var O=!1,M=!1,W=P.FullPaths.length-1;W>=0;--W){var K=P.FileIndex[W];switch(K.type){case 0:M?O=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(K.R*K.L*K.C)&&(O=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!V)){var re=new Date(1987,1,19),fe=0,te=Object.create?Object.create(null):{},ne=[];for(W=0;W<P.FullPaths.length;++W)te[P.FullPaths[W]]=!0,P.FileIndex[W].type!==0&&ne.push([P.FullPaths[W],P.FileIndex[W]]);for(W=0;W<ne.length;++W){var ae=n(ne[W][0]);M=te[ae],M||(ne.push([ae,{name:s(ae).replace("/",""),type:1,clsid:j,ct:re,mt:re,content:null}]),te[ae]=!0)}for(ne.sort(function(Pe,be){return r(Pe[0],be[0])}),P.FullPaths=[],P.FileIndex=[],W=0;W<ne.length;++W)P.FullPaths[W]=ne[W][0],P.FileIndex[W]=ne[W][1];for(W=0;W<ne.length;++W){var ve=P.FileIndex[W],Ee=P.FullPaths[W];if(ve.name=s(Ee).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||j,W===0)ve.C=ne.length>1?1:-1,ve.size=0,ve.type=5;else if(Ee.slice(-1)=="/"){for(fe=W+1;fe<ne.length&&n(P.FullPaths[fe])!=Ee;++fe);for(ve.C=fe>=ne.length?-1:fe,fe=W+1;fe<ne.length&&n(P.FullPaths[fe])!=n(Ee);++fe);ve.R=fe>=ne.length?-1:fe,ve.type=1}else n(P.FullPaths[W+1]||"")==n(Ee)&&(ve.R=W+1),ve.type=2}}}function z(P,V){var O=V||{};if(O.fileType=="mad")return IC(P,O);switch(D(P),O.fileType){case"zip":return CC(P,O)}var M=function(Pe){for(var be=0,Ce=0,Ge=0;Ge<Pe.FileIndex.length;++Ge){var Pt=Pe.FileIndex[Ge];if(Pt.content){var Dt=Pt.content.length;Dt>0&&(Dt<4096?be+=Dt+63>>6:Ce+=Dt+511>>9)}}for(var jr=Pe.FullPaths.length+3>>2,Sl=be+7>>3,El=be+127>>7,Cl=Sl+Ce+jr+El,ii=Cl+127>>7,Uf=ii<=109?0:Math.ceil((ii-109)/127);Cl+ii+Uf+127>>7>ii;)Uf=++ii<=109?0:Math.ceil((ii-109)/127);var $s=[1,Uf,ii,El,jr,Ce,be,0];return Pe.FileIndex[0].size=be<<6,$s[7]=(Pe.FileIndex[0].start=$s[0]+$s[1]+$s[2]+$s[3]+$s[4]+$s[5])+($s[6]+7>>3),$s}(P),W=de(M[7]<<9),K=0,re=0;{for(K=0;K<8;++K)W.write_shift(1,Z[K]);for(K=0;K<8;++K)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),K=0;K<3;++K)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,M[2]),W.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:G),W.write_shift(4,M[3]),W.write_shift(-4,M[1]?M[0]-1:G),W.write_shift(4,M[1]),K=0;K<109;++K)W.write_shift(-4,K<M[2]?M[1]+K:-1)}if(M[1])for(re=0;re<M[1];++re){for(;K<236+re*127;++K)W.write_shift(-4,K<M[2]?M[1]+K:-1);W.write_shift(-4,re===M[1]-1?G:re+1)}var fe=function(Pe){for(re+=Pe;K<re-1;++K)W.write_shift(-4,K+1);Pe&&(++K,W.write_shift(-4,G))};for(re=K=0,re+=M[1];K<re;++K)W.write_shift(-4,Y.DIFSECT);for(re+=M[2];K<re;++K)W.write_shift(-4,Y.FATSECT);fe(M[3]),fe(M[4]);for(var te=0,ne=0,ae=P.FileIndex[0];te<P.FileIndex.length;++te)ae=P.FileIndex[te],ae.content&&(ne=ae.content.length,!(ne<4096)&&(ae.start=re,fe(ne+511>>9)));for(fe(M[6]+7>>3);W.l&511;)W.write_shift(-4,Y.ENDOFCHAIN);for(re=K=0,te=0;te<P.FileIndex.length;++te)ae=P.FileIndex[te],ae.content&&(ne=ae.content.length,!(!ne||ne>=4096)&&(ae.start=re,fe(ne+63>>6)));for(;W.l&511;)W.write_shift(-4,Y.ENDOFCHAIN);for(K=0;K<M[4]<<2;++K){var ve=P.FullPaths[K];if(!ve||ve.length===0){for(te=0;te<17;++te)W.write_shift(4,0);for(te=0;te<3;++te)W.write_shift(4,-1);for(te=0;te<12;++te)W.write_shift(4,0);continue}ae=P.FileIndex[K],K===0&&(ae.start=ae.size?ae.start-1:G);var Ee=K===0&&O.root||ae.name;if(ne=2*(Ee.length+1),W.write_shift(64,Ee,"utf16le"),W.write_shift(2,ne),W.write_shift(1,ae.type),W.write_shift(1,ae.color),W.write_shift(-4,ae.L),W.write_shift(-4,ae.R),W.write_shift(-4,ae.C),ae.clsid)W.write_shift(16,ae.clsid,"hex");else for(te=0;te<4;++te)W.write_shift(4,0);W.write_shift(4,ae.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ae.start),W.write_shift(4,ae.size),W.write_shift(4,0)}for(K=1;K<P.FileIndex.length;++K)if(ae=P.FileIndex[K],ae.size>=4096)if(W.l=ae.start+1<<9,Je&&Buffer.isBuffer(ae.content))ae.content.copy(W,W.l,0,ae.size),W.l+=ae.size+511&-512;else{for(te=0;te<ae.size;++te)W.write_shift(1,ae.content[te]);for(;te&511;++te)W.write_shift(1,0)}for(K=1;K<P.FileIndex.length;++K)if(ae=P.FileIndex[K],ae.size>0&&ae.size<4096)if(Je&&Buffer.isBuffer(ae.content))ae.content.copy(W,W.l,0,ae.size),W.l+=ae.size+63&-64;else{for(te=0;te<ae.size;++te)W.write_shift(1,ae.content[te]);for(;te&63;++te)W.write_shift(1,0)}if(Je)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function A(P,V){var O=P.FullPaths.map(function(te){return te.toUpperCase()}),M=O.map(function(te){var ne=te.split("/");return ne[ne.length-(te.slice(-1)=="/"?2:1)]}),W=!1;V.charCodeAt(0)===47?(W=!0,V=O[0].slice(0,-1)+V):W=V.indexOf("/")!==-1;var K=V.toUpperCase(),re=W===!0?O.indexOf(K):M.indexOf(K);if(re!==-1)return P.FileIndex[re];var fe=!K.match(Yl);for(K=K.replace(en,""),fe&&(K=K.replace(Yl,"!")),re=0;re<O.length;++re)if((fe?O[re].replace(Yl,"!"):O[re]).replace(en,"")==K||(fe?M[re].replace(Yl,"!"):M[re]).replace(en,"")==K)return P.FileIndex[re];return null}var R=64,G=-2,I="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],j="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:I,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:j,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(P,V,O){u();var M=z(P,O);c.writeFileSync(V,M)}function S(P){for(var V=new Array(P.length),O=0;O<P.length;++O)V[O]=String.fromCharCode(P[O]);return V.join("")}function F(P,V){var O=z(P,V);switch(V&&V.type||"buffer"){case"file":return u(),c.writeFileSync(V.filename,O),O;case"binary":return typeof O=="string"?O:S(O);case"base64":return Hc(typeof O=="string"?O:S(O));case"buffer":if(Je)return Buffer.isBuffer(O)?O:ma(O);case"array":return typeof O=="string"?Nn(O):O}return O}var L;function T(P){try{var V=P.InflateRaw,O=new V;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)L=P;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function U(P,V){if(!L)return ns(P,V);var O=L.InflateRaw,M=new O,W=M._processChunk(P.slice(P.l),M._finishFlushFlag);return P.l+=M.bytesRead,W}function X(P){return L?L.deflateRawSync(P):qe(P)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(P){var V=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(V>>16|V>>8|V)&255}for(var ce=typeof Uint8Array<"u",J=ce?new Uint8Array(256):[],Se=0;Se<256;++Se)J[Se]=le(Se);function B(P,V){var O=J[P&255];return V<=8?O>>>8-V:(O=O<<8|J[P>>8&255],V<=16?O>>>16-V:(O=O<<8|J[P>>16&255],O>>>24-V))}function je(P,V){var O=V&7,M=V>>>3;return(P[M]|(O<=6?0:P[M+1]<<8))>>>O&3}function _e(P,V){var O=V&7,M=V>>>3;return(P[M]|(O<=5?0:P[M+1]<<8))>>>O&7}function Re(P,V){var O=V&7,M=V>>>3;return(P[M]|(O<=4?0:P[M+1]<<8))>>>O&15}function Te(P,V){var O=V&7,M=V>>>3;return(P[M]|(O<=3?0:P[M+1]<<8))>>>O&31}function pe(P,V){var O=V&7,M=V>>>3;return(P[M]|(O<=1?0:P[M+1]<<8))>>>O&127}function Ae(P,V,O){var M=V&7,W=V>>>3,K=(1<<O)-1,re=P[W]>>>M;return O<8-M||(re|=P[W+1]<<8-M,O<16-M)||(re|=P[W+2]<<16-M,O<24-M)||(re|=P[W+3]<<24-M),re&K}function et(P,V,O){var M=V&7,W=V>>>3;return M<=5?P[W]|=(O&7)<<M:(P[W]|=O<<M&255,P[W+1]=(O&7)>>8-M),V+3}function Q(P,V,O){var M=V&7,W=V>>>3;return O=(O&1)<<M,P[W]|=O,V+1}function he(P,V,O){var M=V&7,W=V>>>3;return O<<=M,P[W]|=O&255,O>>>=8,P[W+1]=O,V+8}function Fe(P,V,O){var M=V&7,W=V>>>3;return O<<=M,P[W]|=O&255,O>>>=8,P[W+1]=O&255,P[W+2]=O>>>8,V+16}function Le(P,V){var O=P.length,M=2*O>V?2*O:V+5,W=0;if(O>=V)return P;if(Je){var K=pw(M);if(P.copy)P.copy(K);else for(;W<P.length;++W)K[W]=P[W];return K}else if(ce){var re=new Uint8Array(M);if(re.set)re.set(P);else for(;W<O;++W)re[W]=P[W];return re}return P.length=M,P}function Oe(P){for(var V=new Array(P),O=0;O<P;++O)V[O]=0;return V}function Ve(P,V,O){var M=1,W=0,K=0,re=0,fe=0,te=P.length,ne=ce?new Uint16Array(32):Oe(32);for(K=0;K<32;++K)ne[K]=0;for(K=te;K<O;++K)P[K]=0;te=P.length;var ae=ce?new Uint16Array(te):Oe(te);for(K=0;K<te;++K)ne[W=P[K]]++,M<W&&(M=W),ae[K]=0;for(ne[0]=0,K=1;K<=M;++K)ne[K+16]=fe=fe+ne[K-1]<<1;for(K=0;K<te;++K)fe=P[K],fe!=0&&(ae[K]=ne[fe+16]++);var ve=0;for(K=0;K<te;++K)if(ve=P[K],ve!=0)for(fe=B(ae[K],M)>>M-ve,re=(1<<M+4-ve)-1;re>=0;--re)V[fe|re<<ve]=ve&15|K<<4;return M}var Ye=ce?new Uint16Array(512):Oe(512),vt=ce?new Uint16Array(32):Oe(32);if(!ce){for(var yt=0;yt<512;++yt)Ye[yt]=0;for(yt=0;yt<32;++yt)vt[yt]=0}(function(){for(var P=[],V=0;V<32;V++)P.push(5);Ve(P,vt,32);var O=[];for(V=0;V<=143;V++)O.push(8);for(;V<=255;V++)O.push(9);for(;V<=279;V++)O.push(7);for(;V<=287;V++)O.push(8);Ve(O,Ye,288)})();var Tt=function(){for(var V=ce?new Uint8Array(32768):[],O=0,M=0;O<me.length-1;++O)for(;M<me[O+1];++M)V[M]=O;for(;M<32768;++M)V[M]=29;var W=ce?new Uint8Array(259):[];for(O=0,M=0;O<ee.length-1;++O)for(;M<ee[O+1];++M)W[M]=O;function K(fe,te){for(var ne=0;ne<fe.length;){var ae=Math.min(65535,fe.length-ne),ve=ne+ae==fe.length;for(te.write_shift(1,+ve),te.write_shift(2,ae),te.write_shift(2,~ae&65535);ae-- >0;)te[te.l++]=fe[ne++]}return te.l}function re(fe,te){for(var ne=0,ae=0,ve=ce?new Uint16Array(32768):[];ae<fe.length;){var Ee=Math.min(65535,fe.length-ae);if(Ee<10){for(ne=et(te,ne,+(ae+Ee==fe.length)),ne&7&&(ne+=8-(ne&7)),te.l=ne/8|0,te.write_shift(2,Ee),te.write_shift(2,~Ee&65535);Ee-- >0;)te[te.l++]=fe[ae++];ne=te.l*8;continue}ne=et(te,ne,+(ae+Ee==fe.length)+2);for(var Pe=0;Ee-- >0;){var be=fe[ae];Pe=(Pe<<5^be)&32767;var Ce=-1,Ge=0;if((Ce=ve[Pe])&&(Ce|=ae&-32768,Ce>ae&&(Ce-=32768),Ce<ae))for(;fe[Ce+Ge]==fe[ae+Ge]&&Ge<250;)++Ge;if(Ge>2){be=W[Ge],be<=22?ne=he(te,ne,J[be+1]>>1)-1:(he(te,ne,3),ne+=5,he(te,ne,J[be-23]>>5),ne+=3);var Pt=be<8?0:be-4>>2;Pt>0&&(Fe(te,ne,Ge-ee[be]),ne+=Pt),be=V[ae-Ce],ne=he(te,ne,J[be]>>3),ne-=3;var Dt=be<4?0:be-2>>1;Dt>0&&(Fe(te,ne,ae-Ce-me[be]),ne+=Dt);for(var jr=0;jr<Ge;++jr)ve[Pe]=ae&32767,Pe=(Pe<<5^fe[ae])&32767,++ae;Ee-=Ge-1}else be<=143?be=be+48:ne=Q(te,ne,1),ne=he(te,ne,J[be]),ve[Pe]=ae&32767,++ae}ne=he(te,ne,0)-1}return te.l=(ne+7)/8|0,te.l}return function(te,ne){return te.length<8?K(te,ne):re(te,ne)}}();function qe(P){var V=de(50+Math.floor(P.length*1.1)),O=Tt(P,V);return V.slice(0,O)}var At=ce?new Uint16Array(32768):Oe(32768),Gr=ce?new Uint16Array(32768):Oe(32768),Vt=ce?new Uint16Array(128):Oe(128),ws=1,_l=1;function Fu(P,V){var O=Te(P,V)+257;V+=5;var M=Te(P,V)+1;V+=5;var W=Re(P,V)+4;V+=4;for(var K=0,re=ce?new Uint8Array(19):Oe(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ne=ce?new Uint8Array(8):Oe(8),ae=ce?new Uint8Array(8):Oe(8),ve=re.length,Ee=0;Ee<W;++Ee)re[H[Ee]]=K=_e(P,V),te<K&&(te=K),ne[K]++,V+=3;var Pe=0;for(ne[0]=0,Ee=1;Ee<=te;++Ee)ae[Ee]=Pe=Pe+ne[Ee-1]<<1;for(Ee=0;Ee<ve;++Ee)(Pe=re[Ee])!=0&&(fe[Ee]=ae[Pe]++);var be=0;for(Ee=0;Ee<ve;++Ee)if(be=re[Ee],be!=0){Pe=J[fe[Ee]]>>8-be;for(var Ce=(1<<7-be)-1;Ce>=0;--Ce)Vt[Pe|Ce<<be]=be&7|Ee<<3}var Ge=[];for(te=1;Ge.length<O+M;)switch(Pe=Vt[pe(P,V)],V+=Pe&7,Pe>>>=3){case 16:for(K=3+je(P,V),V+=2,Pe=Ge[Ge.length-1];K-- >0;)Ge.push(Pe);break;case 17:for(K=3+_e(P,V),V+=3;K-- >0;)Ge.push(0);break;case 18:for(K=11+pe(P,V),V+=7;K-- >0;)Ge.push(0);break;default:Ge.push(Pe),te<Pe&&(te=Pe);break}var Pt=Ge.slice(0,O),Dt=Ge.slice(O);for(Ee=O;Ee<286;++Ee)Pt[Ee]=0;for(Ee=M;Ee<30;++Ee)Dt[Ee]=0;return ws=Ve(Pt,At,286),_l=Ve(Dt,Gr,30),V}function Pu(P,V){if(P[0]==3&&!(P[1]&3))return[Ya(V),2];for(var O=0,M=0,W=pw(V||1<<18),K=0,re=W.length>>>0,fe=0,te=0;!(M&1);){if(M=_e(P,O),O+=3,M>>>1)M>>1==1?(fe=9,te=5):(O=Fu(P,O),fe=ws,te=_l);else{O&7&&(O+=8-(O&7));var ne=P[O>>>3]|P[(O>>>3)+1]<<8;if(O+=32,ne>0)for(!V&&re<K+ne&&(W=Le(W,K+ne),re=W.length);ne-- >0;)W[K++]=P[O>>>3],O+=8;continue}for(;;){!V&&re<K+32767&&(W=Le(W,K+32767),re=W.length);var ae=Ae(P,O,fe),ve=M>>>1==1?Ye[ae]:At[ae];if(O+=ve&15,ve>>>=4,!(ve>>>8&255))W[K++]=ve;else{if(ve==256)break;ve-=257;var Ee=ve<8?0:ve-4>>2;Ee>5&&(Ee=0);var Pe=K+ee[ve];Ee>0&&(Pe+=Ae(P,O,Ee),O+=Ee),ae=Ae(P,O,te),ve=M>>>1==1?vt[ae]:Gr[ae],O+=ve&15,ve>>>=4;var be=ve<4?0:ve-2>>1,Ce=me[ve];for(be>0&&(Ce+=Ae(P,O,be),O+=be),!V&&re<Pe&&(W=Le(W,Pe+100),re=W.length);K<Pe;)W[K]=W[K-Ce],++K}}}return V?[W,O+7>>>3]:[W.slice(0,K),O+7>>>3]}function ns(P,V){var O=P.slice(P.l||0),M=Pu(O,V);return P.l+=M[1],M[0]}function se(P,V){if(P)typeof console<"u"&&console.error(V);else throw new Error(V)}function ss(P,V){var O=P;kr(O,0);var M=[],W=[],K={FileIndex:M,FullPaths:W};w(K,{root:V.root});for(var re=O.length-4;(O[re]!=80||O[re+1]!=75||O[re+2]!=5||O[re+3]!=6)&&re>=0;)--re;O.l=re+4,O.l+=4;var fe=O.read_shift(2);O.l+=6;var te=O.read_shift(4);for(O.l=te,re=0;re<fe;++re){O.l+=20;var ne=O.read_shift(4),ae=O.read_shift(4),ve=O.read_shift(2),Ee=O.read_shift(2),Pe=O.read_shift(2);O.l+=8;var be=O.read_shift(4),Ce=l(O.slice(O.l+ve,O.l+ve+Ee));O.l+=ve+Ee+Pe;var Ge=O.l;O.l=be+4,EC(O,ne,ae,K,Ce),O.l=Ge}return K}function EC(P,V,O,M,W){P.l+=2;var K=P.read_shift(2),re=P.read_shift(2),fe=o(P);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var te=P.read_shift(4),ne=P.read_shift(4),ae=P.read_shift(4),ve=P.read_shift(2),Ee=P.read_shift(2),Pe="",be=0;be<ve;++be)Pe+=String.fromCharCode(P[P.l++]);if(Ee){var Ce=l(P.slice(P.l,P.l+Ee));(Ce[21589]||{}).mt&&(fe=Ce[21589].mt),((W||{})[21589]||{}).mt&&(fe=W[21589].mt)}P.l+=Ee;var Ge=P.slice(P.l,P.l+ne);switch(re){case 8:Ge=U(P,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var Pt=!1;K&8&&(te=P.read_shift(4),te==134695760&&(te=P.read_shift(4),Pt=!0),ne=P.read_shift(4),ae=P.read_shift(4)),ne!=V&&se(Pt,"Bad compressed size: "+V+" != "+ne),ae!=O&&se(Pt,"Bad uncompressed size: "+O+" != "+ae),Bf(M,Pe,Ge,{unsafe:!0,mt:fe})}function CC(P,V){var O=V||{},M=[],W=[],K=de(1),re=O.compression?8:0,fe=0,te=0,ne=0,ae=0,ve=0,Ee=P.FullPaths[0],Pe=Ee,be=P.FileIndex[0],Ce=[],Ge=0;for(te=1;te<P.FullPaths.length;++te)if(Pe=P.FullPaths[te].slice(Ee.length),be=P.FileIndex[te],!(!be.size||!be.content||Pe=="Sh33tJ5")){var Pt=ae,Dt=de(Pe.length);for(ne=0;ne<Pe.length;++ne)Dt.write_shift(1,Pe.charCodeAt(ne)&127);Dt=Dt.slice(0,Dt.l),Ce[ve]=RO.buf(be.content,0);var jr=be.content;re==8&&(jr=X(jr)),K=de(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,fe),K.write_shift(2,re),be.mt?a(K,be.mt):K.write_shift(4,0),K.write_shift(-4,Ce[ve]),K.write_shift(4,jr.length),K.write_shift(4,be.content.length),K.write_shift(2,Dt.length),K.write_shift(2,0),ae+=K.length,M.push(K),ae+=Dt.length,M.push(Dt),ae+=jr.length,M.push(jr),K=de(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,fe),K.write_shift(2,re),K.write_shift(4,0),K.write_shift(-4,Ce[ve]),K.write_shift(4,jr.length),K.write_shift(4,be.content.length),K.write_shift(2,Dt.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,Pt),Ge+=K.l,W.push(K),Ge+=Dt.length,W.push(Dt),++ve}return K=de(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,ve),K.write_shift(2,ve),K.write_shift(4,Ge),K.write_shift(4,ae),K.write_shift(2,0),xr([xr(M),xr(W),K])}var Du={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jC(P,V){if(P.ctype)return P.ctype;var O=P.name||"",M=O.match(/\.([^\.]+)$/);return M&&Du[M[1]]||V&&(M=(O=V).match(/[\.\\]([^\.\\])+$/),M&&Du[M[1]])?Du[M[1]]:"application/octet-stream"}function TC(P){for(var V=Hc(P),O=[],M=0;M<V.length;M+=76)O.push(V.slice(M,M+76));return O.join(`\r
`)+`\r
`}function AC(P){var V=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var ae=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],M=V.split(`\r
`),W=0;W<M.length;++W){var K=M[W];if(K.length==0){O.push("");continue}for(var re=0;re<K.length;){var fe=76,te=K.slice(re,re+fe);te.charAt(fe-1)=="="?fe--:te.charAt(fe-2)=="="?fe-=2:te.charAt(fe-3)=="="&&(fe-=3),te=K.slice(re,re+fe),re+=fe,re<K.length&&(te+="="),O.push(te)}}return O.join(`\r
`)}function FC(P){for(var V=[],O=0;O<P.length;++O){for(var M=P[O];O<=P.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+P[++O];V.push(M)}for(var W=0;W<V.length;++W)V[W]=V[W].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return Nn(V.join(`\r
`))}function PC(P,V,O){for(var M="",W="",K="",re,fe=0;fe<10;++fe){var te=V[fe];if(!te||te.match(/^\s*$/))break;var ne=te.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":M=ne[2].trim();break;case"content-type":K=ne[2].trim();break;case"content-transfer-encoding":W=ne[2].trim();break}}switch(++fe,W.toLowerCase()){case"base64":re=Nn(An(V.slice(fe).join("")));break;case"quoted-printable":re=FC(V.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ae=Bf(P,M.slice(O.length),re,{unsafe:!0});K&&(ae.ctype=K)}function DC(P,V){if(S(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=V&&V.root||"",M=(Je&&Buffer.isBuffer(P)?P.toString("binary"):S(P)).split(`\r
`),W=0,K="";for(W=0;W<M.length;++W)if(K=M[W],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),O||(O=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),K.slice(0,O.length)!=O););var re=(M[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var fe="--"+(re[1]||""),te=[],ne=[],ae={FileIndex:te,FullPaths:ne};w(ae);var ve,Ee=0;for(W=0;W<M.length;++W){var Pe=M[W];Pe!==fe&&Pe!==fe+"--"||(Ee++&&PC(ae,M.slice(ve,W),O),ve=W)}return ae}function IC(P,V){var O=V||{},M=O.boundary||"SheetJS";M="------="+M;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],K=P.FullPaths[0],re=K,fe=P.FileIndex[0],te=1;te<P.FullPaths.length;++te)if(re=P.FullPaths[te].slice(K.length),fe=P.FileIndex[te],!(!fe.size||!fe.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var ne=fe.content,ae=Je&&Buffer.isBuffer(ne)?ne.toString("binary"):S(ne),ve=0,Ee=Math.min(1024,ae.length),Pe=0,be=0;be<=Ee;++be)(Pe=ae.charCodeAt(be))>=32&&Pe<128&&++ve;var Ce=ve>=Ee*4/5;W.push(M),W.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+re),W.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),W.push("Content-Type: "+jC(fe,re)),W.push(""),W.push(Ce?AC(ae):TC(ae))}return W.push(M+`--\r
`),W.join(`\r
`)}function RC(P){var V={};return w(V,P),V}function Bf(P,V,O,M){var W=M&&M.unsafe;W||w(P);var K=!W&&Be.find(P,V);if(!K){var re=P.FullPaths[0];V.slice(0,re.length)==re?re=V:(re.slice(-1)!="/"&&(re+="/"),re=(re+V).replace("//","/")),K={name:s(V),type:2},P.FileIndex.push(K),P.FullPaths.push(re),W||Be.utils.cfb_gc(P)}return K.content=O,K.size=O?O.length:0,M&&(M.CLSID&&(K.clsid=M.CLSID),M.mt&&(K.mt=M.mt),M.ct&&(K.ct=M.ct)),K}function LC(P,V){w(P);var O=Be.find(P,V);if(O){for(var M=0;M<P.FileIndex.length;++M)if(P.FileIndex[M]==O)return P.FileIndex.splice(M,1),P.FullPaths.splice(M,1),!0}return!1}function OC(P,V,O){w(P);var M=Be.find(P,V);if(M){for(var W=0;W<P.FileIndex.length;++W)if(P.FileIndex[W]==M)return P.FileIndex[W].name=s(O),P.FullPaths[W]=O,!0}return!1}function MC(P){D(P,!0)}return t.find=A,t.read=k,t.parse=d,t.write=F,t.writeFile=q,t.utils={cfb_new:RC,cfb_add:Bf,cfb_del:LC,cfb_mov:OC,cfb_gc:MC,ReadShift:fc,CheckField:ZS,prep_blob:kr,bconcat:xr,use_zlib:T,_deflateRaw:qe,_inflateRaw:ns,consts:Y},t}();function LO(e){return typeof e=="string"?Af(e):Array.isArray(e)?lO(e):e}function ku(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Af(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ps(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([LO(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=ni(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function OO(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Xt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function kw(e,t){for(var r=[],n=Xt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function Pf(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Df(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function MO(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var R0=new Date(1899,11,30,0,0,0);function dr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=R0.getTime()+(e.getTimezoneOffset()-R0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var TS=new Date,BO=R0.getTime()+(TS.getTimezoneOffset()-R0.getTimezoneOffset())*6e4,_w=TS.getTimezoneOffset();function If(e){var t=new Date;return t.setTime(e*24*60*60*1e3+BO),t.getTimezoneOffset()!==_w&&t.setTime(t.getTime()+(t.getTimezoneOffset()-_w)*6e4),t}function UO(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var Sw=new Date("2017-02-19T19:06:09.000Z"),AS=isNaN(Sw.getFullYear())?new Date("2/19/17"):Sw,VO=AS.getFullYear()==2017;function Ct(e,t){var r=new Date(e);if(VO)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(AS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Gi(e,t){if(Je&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ps(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ps(gS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ps(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ps(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function jt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=jt(e[r]));return t}function Ht(e,t){for(var r="";r.length<t;)r+=e;return r}function xs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var $O=["january","february","march","april","may","june","july","august","september","october","november","december"];function il(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&$O.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var zO=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(s),o.push(a[l]);return o}}();function FS(e){return e?e.content&&e.type?Gi(e.content,!0):e.data?Kl(e.data):e.asNodeBuffer&&Je?Kl(e.asNodeBuffer().toString("binary")):e.asBinary?Kl(e.asBinary()):e._data&&e._data.getContent?Kl(Gi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function PS(e){if(!e)return null;if(e.data)return hw(e.data);if(e.asNodeBuffer&&Je)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?hw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function HO(e){return e&&e.name.slice(-4)===".bin"?PS(e):FS(e)}function Vn(e,t){for(var r=e.FullPaths||Xt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Fg(e,t){var r=Vn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function nr(e,t,r){if(!r)return HO(Fg(e,t));if(!t)return null;try{return nr(e,t)}catch{return null}}function kn(e,t,r){if(!r)return FS(Fg(e,t));if(!t)return null;try{return kn(e,t)}catch{return null}}function DS(e,t,r){if(!r)return PS(Fg(e,t));if(!t)return null;try{return DS(e,t)}catch{return null}}function Ew(e){for(var t=e.FullPaths||Xt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ze(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Je?n=ma(r):n=cO(r),Be.utils.cfb_add(e,t,n)}Be.utils.cfb_add(e,t,r)}else e.file(t,r)}function Pg(){return Be.utils.cfb_new()}function IS(e,t){switch(t.type){case"base64":return Be.read(e,{type:"base64"});case"binary":return Be.read(e,{type:"binary"});case"buffer":case"array":return Be.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ql(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var er=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,WO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Cw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,GO=/<[^>]*>/g,Wr=er.match(Cw)?Cw:GO,XO=/<\w*:/,KO=/<(\/?)\w+:/;function We(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(WO),l=0,c="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,r||(n[d.toLowerCase()]=c);else{var m=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[m]&&d.slice(l-3,l)=="ext")continue;n[m]=c,r||(n[m.toLowerCase()]=c)}}return n}function Us(e){return e.replace(KO,"<$1")}var RS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dg=Pf(RS),ot=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(l,c){return RS[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,o)+r(s.slice(o+3))}}(),Ig=/[&<>'"]/g,YO=/[\u0000-\u0008\u000b-\u001f]/g;function mt(e){var t=e+"";return t.replace(Ig,function(r){return Dg[r]}).replace(YO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jw(e){return mt(e).replace(/ /g,"_x0020_")}var LS=/[\u0000-\u001f]/g;function Rg(e){var t=e+"";return t.replace(Ig,function(r){return Dg[r]}).replace(/\n/g,"<br/>").replace(LS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function qO(e){var t=e+"";return t.replace(Ig,function(r){return Dg[r]}).replace(LS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Tw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function ZO(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function St(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Mh(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Aw(e){var t=Ya(2*e.length),r,n,s=1,a=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Fw(e){return ma(e,"binary").toString("utf8")}var id="foo bar bazâð£",gt=Je&&(Fw(id)==Mh(id)&&Fw||Aw(id)==Mh(id)&&Aw)||Mh,Ps=Je?function(e){return ma(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Gc=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),OS=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),JO=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),QO=/<\/?(?:vt:)?variant>/g,e7=/<(?:vt:)([^>]*)>([\s\S]*)</;function Pw(e,t){var r=We(e),n=e.match(JO(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var o=a.replace(QO,"").match(e7);o&&s.push({v:gt(o[2]),t:o[1]})}),s}var MS=/(^\s|\s$|\n)/;function _r(e,t){return"<"+e+(t.match(MS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Xc(e){return Xt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ne(e,t,r){return"<"+e+(r!=null?Xc(r):"")+(t!=null?(t.match(MS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Np(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function t7(e,t){switch(typeof e){case"string":var r=Ne("vt:lpwstr",mt(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Ne((e|0)==e?"vt:i4":"vt:r8",mt(String(e)));case"boolean":return Ne("vt:bool",e?"true":"false")}if(e instanceof Date)return Ne("vt:filetime",Np(e));throw new Error("Unable to serialize "+e)}function Lg(e){if(Je&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return gt(ni(jg(e)));throw new Error("Bad input format: expected Buffer or string")}var Kc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,lr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},so=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],yn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function r7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function n7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,o=n?-t:t;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var Dw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Iw=Je?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ma(t)})):Dw(e)}:Dw,Rw=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Ys(e,s)));return n.join("").replace(en,"")},Og=Je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(en,""):Rw(e,t,r)}:Rw,Lw=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},BS=Je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Lw(e,t,r)}:Lw,Ow=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(go(e,s)));return n.join("")},_u=Je?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Ow(t,r,n)}:Ow,US=function(e,t){var r=wn(e,t);return r>0?_u(e,t+4,t+4+r-1):""},VS=US,$S=function(e,t){var r=wn(e,t);return r>0?_u(e,t+4,t+4+r-1):""},zS=$S,HS=function(e,t){var r=2*wn(e,t);return r>0?_u(e,t+4,t+4+r-1):""},WS=HS,GS=function(t,r){var n=wn(t,r);return n>0?Og(t,r+4,r+4+n):""},XS=GS,KS=function(e,t){var r=wn(e,t);return r>0?_u(e,t+4,t+4+r):""},YS=KS,qS=function(e,t){return r7(e,t)},L0=qS,Mg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Je&&(VS=function(t,r){if(!Buffer.isBuffer(t))return US(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},zS=function(t,r){if(!Buffer.isBuffer(t))return $S(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},WS=function(t,r){if(!Buffer.isBuffer(t))return HS(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},XS=function(t,r){if(!Buffer.isBuffer(t))return GS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},YS=function(t,r){if(!Buffer.isBuffer(t))return KS(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},L0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):qS(t,r)},Mg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var go=function(e,t){return e[t]},Ys=function(e,t){return e[t+1]*256+e[t]},s7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},wn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},pi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},a7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function fc(e,t){var r="",n,s,a=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,Je&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ys(this,u)),u+=2;e*=2;break;case"utf8":r=_u(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Og(this,this.l,this.l+e);break;case"wstr":return fc.call(this,e,"dbcs");case"lpstr-ansi":r=VS(this,this.l),e=4+wn(this,this.l);break;case"lpstr-cp":r=zS(this,this.l),e=4+wn(this,this.l);break;case"lpwstr":r=WS(this,this.l),e=4+2*wn(this,this.l);break;case"lpp4":e=4+wn(this,this.l),r=XS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+wn(this,this.l),r=YS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=go(this,this.l+e++))!==0;)a.push(ad(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=Ys(this,this.l+e))!==0;)a.push(ad(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=go(this,u),this.l=u+1,l=fc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(ad(Ys(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=go(this,u),this.l=u+1,l=fc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(ad(go(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=go(this,this.l),this.l++,n;case 2:return n=(t==="i"?s7:Ys)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?pi:a7)(this,this.l),this.l+=4,n):(s=wn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=L0(this,this.l):s=L0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=BS(this,this.l,e);break}}return this.l+=e,r}var i7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},o7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},l7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function c7(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)l7(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,i7(this,t,this.l);break;case 8:if(n=8,r==="f"){n7(this,t,this.l);break}case 16:break;case-4:n=4,o7(this,t,this.l);break}return this.l+=n,this}function ZS(e,t){var r=BS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function kr(e,t){e.l=t,e.read_shift=fc,e.chk=ZS,e.write_shift=c7}function Hr(e,t){e.l+=t}function de(e){var t=Ya(e);return kr(t,0),t}function pa(e,t,r){if(e){var n,s,a;kr(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=eu[l]||eu[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,l))return}}}function mn(){var e=[],t=Je?256:2048,r=function(u){var d=de(u);return kr(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},o=function(){return s(),xr(e)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function xe(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=eu[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=e.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Mg(r)&&e.push(r)}}function hc(e,t,r){var n=jt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Mw(e,t,r){var n=jt(e);return n.s=hc(n.s,t.s,r),n.e=hc(n.e,t.s,r),n}function mc(e,t){if(e.cRel&&e.c<0)for(e=jt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=jt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=He(e);return!e.cRel&&e.cRel!=null&&(r=f7(r)),!e.rRel&&e.rRel!=null&&(r=u7(r)),r}function Bh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Lt(e.s.c)+":"+(e.e.cRel?"":"$")+Lt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Jt(e.s.r)+":"+(e.e.rRel?"":"$")+Jt(e.e.r):mc(e.s,t.biff)+":"+mc(e.e,t.biff)}function Bg(e){return parseInt(d7(e),10)-1}function Jt(e){return""+(e+1)}function u7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function d7(e){return e.replace(/\$(\d+)$/,"$1")}function Ug(e){for(var t=h7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Lt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function f7(e){return e.replace(/^([A-Z])/,"$$$1")}function h7(e){return e.replace(/^\$([A-Z])/,"$1")}function m7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ot(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function He(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function gn(e){var t=e.indexOf(":");return t==-1?{s:Ot(e),e:Ot(e)}:{s:Ot(e.slice(0,t)),e:Ot(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=He(e)),typeof t!="string"&&(t=He(t)),e==t?e:e+":"+t)}function lt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Bw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ts(e.z,r?dr(t):t)}catch{}try{return e.w=ts((e.XF||{}).numFmtId||(r?14:0),r?dr(t):t)}catch{return""+t}}function da(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xa[e.v]||e.v:t==null?Bw(e,e.v):Bw(e,t))}function si(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function JS(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ot(n.origin):n.origin;o=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=lt(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},g=o+f,p=l+h;if(u.s.r>g&&(u.s.r=g),u.s.c>p&&(u.s.c=p),u.e.r<g&&(u.e.r=g),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||$e[14],n.cellDates?(m.t="d",m.w=ts(m.z,dr(m.v))):(m.t="n",m.v=dr(m.v),m.w=ts(m.z,m.v))):m.t="s";if(s)a[g]||(a[g]=[]),a[g][p]&&a[g][p].z&&(m.z=a[g][p].z),a[g][p]=m;else{var v=He({c:p,r:g});a[v]&&a[v].z&&(m.z=a[v].z),a[v]=m}}}return u.s.c<1e7&&(a["!ref"]=Ke(u)),a}function Nl(e,t){return JS(null,e,t)}function p7(e){return e.read_shift(4,"i")}function gs(e,t){return t||(t=de(4)),t.write_shift(4,e),t}function Vr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function vr(e,t){var r=!1;return t==null&&(r=!0,t=de(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function x7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function g7(e,t){return t||(t=de(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function Vg(e,t){var r=e.l,n=e.read_shift(1),s=Vr(e),a=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push(x7(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function v7(e,t){var r=!1;return t==null&&(r=!0,t=de(15+4*e.t.length)),t.write_shift(1,0),vr(e.t,t),r?t.slice(0,t.l):t}var y7=Vg;function w7(e,t){var r=!1;return t==null&&(r=!0,t=de(23+4*e.t.length)),t.write_shift(1,1),vr(e.t,t),t.write_shift(4,1),g7({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function rs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ao(e,t){return t==null&&(t=de(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function io(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function oo(e,t){return t==null&&(t=de(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var b7=Vr,QS=vr;function $g(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function O0(e,t){var r=!1;return t==null&&(r=!0,t=de(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var N7=Vr,kp=$g,zg=O0;function Hg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?L0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):pi(t,0)>>2;return r?s/100:s}function eE(e,t){t==null&&(t=de(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function tE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function k7(e,t){return t||(t=de(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var lo=tE,kl=k7;function Ur(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Xi(e,t){return(t||de(8)).write_shift(8,e,"f")}function _7(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Ti[s];u&&(t.rgb=qc(u));break;case 2:t.rgb=qc([o,l,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function M0(e,t){if(t||(t=de(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function S7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function E7(e,t){t||(t=de(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function rE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function C7(e){return rE(e,1)}function j7(e){return rE(e,2)}var Wg=2,an=3,od=11,Uw=12,B0=19,ld=64,T7=65,A7=71,F7=4108,P7=4126,fr=80,nE=81,D7=[fr,nE],_p={1:{n:"CodePage",t:Wg},2:{n:"Category",t:fr},3:{n:"PresentationFormat",t:fr},4:{n:"ByteCount",t:an},5:{n:"LineCount",t:an},6:{n:"ParagraphCount",t:an},7:{n:"SlideCount",t:an},8:{n:"NoteCount",t:an},9:{n:"HiddenCount",t:an},10:{n:"MultimediaClipCount",t:an},11:{n:"ScaleCrop",t:od},12:{n:"HeadingPairs",t:F7},13:{n:"TitlesOfParts",t:P7},14:{n:"Manager",t:fr},15:{n:"Company",t:fr},16:{n:"LinksUpToDate",t:od},17:{n:"CharacterCount",t:an},19:{n:"SharedDoc",t:od},22:{n:"HyperlinksChanged",t:od},23:{n:"AppVersion",t:an,p:"version"},24:{n:"DigSig",t:T7},26:{n:"ContentType",t:fr},27:{n:"ContentStatus",t:fr},28:{n:"Language",t:fr},29:{n:"Version",t:fr},255:{},2147483648:{n:"Locale",t:B0},2147483651:{n:"Behavior",t:B0},1919054434:{}},Sp={1:{n:"CodePage",t:Wg},2:{n:"Title",t:fr},3:{n:"Subject",t:fr},4:{n:"Author",t:fr},5:{n:"Keywords",t:fr},6:{n:"Comments",t:fr},7:{n:"Template",t:fr},8:{n:"LastAuthor",t:fr},9:{n:"RevNumber",t:fr},10:{n:"EditTime",t:ld},11:{n:"LastPrinted",t:ld},12:{n:"CreatedDate",t:ld},13:{n:"ModifiedDate",t:ld},14:{n:"PageCount",t:an},15:{n:"WordCount",t:an},16:{n:"CharCount",t:an},17:{n:"Thumbnail",t:A7},18:{n:"Application",t:fr},19:{n:"DocSecurity",t:an},255:{},2147483648:{n:"Locale",t:B0},2147483651:{n:"Behavior",t:B0},1919054434:{}},Vw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},I7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function R7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var L7=R7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ti=jt(L7),xa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ep={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},cd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function O7(e){var t=Gg();if(!e||!e.match)return t;var r={};if((e.match(Wr)||[]).forEach(function(n){var s=We(n);switch(s[0].replace(XO,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Ep[s.ContentType]]!==void 0&&t[Ep[s.ContentType]].push(s.PartName);break}}),t.xmlns!==lr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function aE(e,t){var r=MO(Ep),n=[],s;n[n.length]=er,n[n.length]=Ne("Types",null,{xmlns:lr.CT,"xmlns:xsd":lr.xsd,"xmlns:xsi":lr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ne("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Ne("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:cd[c][t.bookType]||cd[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Ne("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:cd[c][t.bookType]||cd[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Ne("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Qe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Yc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function pc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Wr)||[]).forEach(function(s){var a=We(s);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:ql(a.Target,t);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}function Wo(e){var t=[er,Ne("Relationships",null,{xmlns:lr.RELS})];return Xt(e["!id"]).forEach(function(r){t[t.length]=Ne("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ht(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,a?s.TargetMode=a:[Qe.HLINK,Qe.XPATH,Qe.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var M7="application/vnd.oasis.opendocument.spreadsheet";function B7(e,t){for(var r=Lg(e),n,s;n=Kc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=We(n[0],!1),s.path=="/"&&s.type!==M7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function U7(e){var t=[er];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function $w(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function V7(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function $7(e){var t=[er];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push($w(e[r][0],e[r][1])),t.push(V7("",e[r][0]));return t.push($w("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function iE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+F0.version+"</meta:generator></office:meta></office:document-meta>"}var qn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],z7=function(){for(var e=new Array(qn.length),t=0;t<qn.length;++t){var r=qn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function oE(e){var t={};e=gt(e);for(var r=0;r<qn.length;++r){var n=qn[r],s=e.match(z7[r]);s!=null&&s.length>0&&(t[n[1]]=ot(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ct(t[n[1]]))}return t}function Uh(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=mt(t),n[n.length]=r?Ne(e,t,r):_r(e,t))}function lE(e,t){var r=t||{},n=[er,Ne("cp:coreProperties",null,{"xmlns:cp":lr.CORE_PROPS,"xmlns:dc":lr.dc,"xmlns:dcterms":lr.dcterms,"xmlns:dcmitype":lr.dcmitype,"xmlns:xsi":lr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Uh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Np(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Uh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Np(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=qn.length;++a){var o=qn[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Uh(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ai=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function uE(e,t,r,n){var s=[];if(typeof e=="string")s=Pw(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var o=typeof t=="string"?Pw(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function H7(e,t,r){var n={};return t||(t={}),e=gt(e),Ai.forEach(function(s){var a=(e.match(Gc(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=ot(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&uE(n.HeadingPairs,n.TitlesOfParts,t,r),t}function dE(e){var t=[],r=Ne;return e||(e={}),e.Application="SheetJS",t[t.length]=er,t[t.length]=Ne("Properties",null,{xmlns:lr.EXT_PROPS,"xmlns:vt":lr.vt}),Ai.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=mt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+mt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var W7=/<[^>]+>[^<]*/g;function G7(e,t){var r={},n="",s=e.match(W7);if(s)for(var a=0;a!=s.length;++a){var o=s[a],l=We(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ot(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=ot(d);break;case"bool":r[n]=St(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Ct(d);break;case"cy":case"error":r[n]=ot(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function fE(e){var t=[er,Ne("Properties",null,{xmlns:lr.CUST_PROPS,"xmlns:vt":lr.vt})];if(!e)return t.join("");var r=1;return Xt(e).forEach(function(s){++r,t[t.length]=Ne("property",t7(e[s],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:mt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Cp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vh;function X7(e,t,r){Vh||(Vh=Pf(Cp)),t=Vh[t]||t,e[t]=r}function K7(e,t){var r=[];return Xt(Cp).map(function(n){for(var s=0;s<qn.length;++s)if(qn[s][1]==n)return qn[s];for(s=0;s<Ai.length;++s)if(Ai[s][1]==n)return Ai[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(_r(Cp[n[1]]||n[1],s))}}),Ne("DocumentProperties",r.join(""),{xmlns:yn.o})}function Y7(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Xt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<qn.length;++o)if(a==qn[o][1])return;for(o=0;o<Ai.length;++o)if(a==Ai[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Ne(jw(a),l,{"dt:dt":c}))}}),t&&Xt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ne(jw(a),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+yn.o+'">'+s.join("")+"</"+n+">"}function Xg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function q7(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=de(8);return o.write_shift(4,n),o.write_shift(4,s),o}function hE(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function mE(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function pE(e,t,r){return t===31?mE(e):hE(e,t,r)}function jp(e,t,r){return pE(e,t,r===!1?0:4)}function Z7(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return pE(e,t,0)}function J7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(en,""),e.l-s&2&&(e.l+=2)}return r}function Q7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(en,"");return r}function eM(e){var t=e.l,r=U0(e,nE);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=U0(e,an);return[r,n]}function tM(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(eM(e));return r}function zw(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(en,"").replace(Yl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function xE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function rM(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function U0(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==Uw&&n!==t&&D7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Uw?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return hE(e,n,4).replace(en,"");case 31:return mE(e);case 64:return Xg(e);case 65:return xE(e);case 71:return rM(e);case 80:return jp(e,n,!a.raw).replace(en,"");case 81:return Z7(e,n).replace(en,"");case 4108:return tM(e);case 4126:case 4127:return n==4127?J7(e):Q7(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Hw(e,t){var r=de(4),n=de(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=de(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=q7(t);break;case 31:case 80:for(n=de(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xr([r,n])}function Ww(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0,l=0,c=-1,u={};for(o=0;o!=s;++o){var d=e.read_shift(4),f=e.read_shift(4);a[o]=[d,f+r]}a.sort(function(y,x){return y[1]-x[1]});var h={};for(o=0;o!=s;++o){if(e.l!==a[o][1]){var m=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],m=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],m=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(m=!1,e.l=a[o][1]),m)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[a[o][0]];if(h[g.n]=U0(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ds(l=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(a[o][0]===1){if(l=h.CodePage=U0(e,Wg),ds(l),c!==-1){var p=e.l;e.l=a[c][1],u=zw(e,l),e.l=p}}else if(a[o][0]===0){if(l===0){c=o,e.l=a[o+1][1];continue}u=zw(e,l)}else{var v=u[a[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=xE(e);break;case 30:e.l+=4,b=jp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=jp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Kt(e,4);break;case 64:e.l+=4,b=Ct(Xg(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=b}}return e.l=r+n,h}var gE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nM(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Gw(e,t,r){var n=de(8),s=[],a=[],o=8,l=0,c=de(8),u=de(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),o+=8+c.length,!t){u=de(8),u.write_shift(4,0),s.unshift(u);var d=[de(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=de(4+4+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=xr(d),a.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(gE.indexOf(e[l][0])>-1||cE.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var g=r[m];if(g.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=Hw(g.t,h)}else{var v=nM(h);v==-1&&(v=31,h=String(h)),c=Hw(v,h)}a.push(c),u=de(8),u.write_shift(4,t?m:2+l),s.push(u),o+=8+c.length}var b=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,b),b+=a[l].length;return n.write_shift(4,o),n.write_shift(4,a.length),xr([n].concat(s).concat(a))}function Xw(e,t,r){var n=e.content;if(!n)return{};kr(n,0);var s,a,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Be.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=Ww(n,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=a,s===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=Ww(n,null)}catch{}for(m in g)h[m]=g[m];return h.FMTID=[a,o],h}function Kw(e,t,r,n,s,a){var o=de(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Be.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=Gw(e,r,n);if(l.push(c),s){var u=Gw(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),l.push(u)}return xr(l)}function wa(e,t){return e.read_shift(t),null}function sM(e,t){t||(t=de(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function aM(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Kt(e,t){return e.read_shift(t)===1}function Zr(e,t){return t||(t=de(2)),t.write_shift(2,+!!e),t}function sr(e){return e.read_shift(2,"u")}function $n(e,t){return t||(t=de(2)),t.write_shift(2,e),t}function vE(e,t){return aM(e,t,sr)}function iM(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function yE(e,t,r){return r||(r=de(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Su(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function oM(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*o),n&&(e.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function lM(e){var t=e.t||"",r=de(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var n=de(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return xr(s)}function Ki(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Eu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ki(e,n,r)}function co(e,t,r){if(r.biff>5)return Eu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function wE(e,t,r){return r||(r=de(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function cM(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function uM(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(en,"");return n&&(e.l+=24),s}function dM(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(en,"");return r+o}function fM(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return uM(e);case"0303000000000000c000000000000046":return dM(e);default:throw new Error("Unsupported Moniker "+r)}}function ud(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(en,""):"";return r}function Yw(e,t){t||(t=de(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function hM(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,o,l,c,u="",d,f;s&16&&(a=ud(e,r-e.l)),s&128&&(o=ud(e,r-e.l)),(s&257)===257&&(l=ud(e,r-e.l)),(s&257)===1&&(c=fM(e,r-e.l)),s&8&&(u=ud(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=Xg(e)),e.l=r;var h=o||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),a&&(m.Tooltip=a),m}function mM(e){var t=de(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)n=n.slice(1),Yw(n,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&Yw(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function bE(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function NE(e,t){var r=bE(e);return r[3]=0,r}function Vs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Yi(e,t,r,n){return n||(n=de(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function pM(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function xM(e,t,r){return t===0?"":co(e,t,r)}function gM(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,a,o]}function kE(e){var t=e.read_shift(2),r=Hg(e);return[t,r]}function vM(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Su(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function Rf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function _E(e,t){return t||(t=de(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function SE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var yM=SE;function EE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function wM(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function bM(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Fr(e){e.l+=2,e.l+=e.read_shift(2)}var NM={0:Fr,4:Fr,5:Fr,6:Fr,7:bM,8:Fr,9:Fr,10:Fr,11:Fr,12:Fr,13:wM,14:Fr,15:Fr,16:Fr,17:Fr,18:Fr,19:Fr,20:Fr,21:EE};function kM(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(NM[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function dd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Kg(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=de(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function _M(e,t){return t===0||e.read_shift(2),1200}function SM(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=co(e,0,r);return e.read_shift(t+n-e.l),s}function EM(e,t){var r=!t||t.biff==8,n=de(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function CM(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function jM(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=Su(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:a,name:o}}function TM(e,t){var r=!t||t.biff>=8?2:1,n=de(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function AM(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0;o!=s&&e.l<r;++o)a.push(oM(e));return a.Count=n,a.Unique=s,a}function FM(e,t){var r=de(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=lM(e[s]);var a=xr([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function PM(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function DM(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function IM(e){var t=pM(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function RM(e){return e.read_shift(2),e.read_shift(4)}function qw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function LM(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function OM(){var e=de(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function MM(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function BM(e){var t=de(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function UM(){}function VM(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Su(e,0,r),n}function $M(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=de(s);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function zM(e){var t=Vs(e);return t.isst=e.read_shift(4),t}function HM(e,t,r,n){var s=de(10);return Yi(e,t,n,s),s.write_shift(4,r),s}function WM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Vs(e);r.biff==2&&e.l++;var a=Eu(e,n-e.l,r);return s.val=a,s}function GM(e,t,r,n,s){var a=!s||s.biff==8,o=de(6+2+ +a+(1+a)*r.length);return Yi(e,t,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function XM(e,t,r){var n=e.read_shift(2),s=co(e,0,r);return[n,s]}function KM(e,t,r,n){var s=r&&r.biff==5;n||(n=de(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var YM=co;function Zw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:l},e:{r:o,c}}}function qM(e,t){var r=t.biff==8||!t.biff?4:2,n=de(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function ZM(e){var t=e.read_shift(2),r=e.read_shift(2),n=kE(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function JM(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(kE(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:a}}function QM(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:a}}function e9(e,t,r,n){var s={},a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=I7[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function t9(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=e9(e,t,n.fStyle,r),n}function Jw(e,t,r,n){var s=r&&r.biff==5;n||(n=de(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function r9(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function n9(e){var t=de(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function Qw(e,t,r){var n=Vs(e);(r.biff==2||t==9)&&++e.l;var s=iM(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function s9(e,t,r,n,s,a){var o=de(8);return Yi(e,t,n,o),yE(r,a,o),o}function a9(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Vs(e),s=Ur(e);return n.val=s,n}function i9(e,t,r,n){var s=de(14);return Yi(e,t,n,s),Xi(r,s),s}var e2=xM;function o9(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Ki(e,a),l=[];n>e.l;)l.push(Eu(e));return[a,s,o,l]}function t2(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=vM(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var l9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function r2(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Ki(e,o,r);s&32&&(u=l9[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:k$(e,d,r,l);return{chKey:a,Name:u,itab:c,rgce:f}}function CE(e,t,r){if(r.biff<8)return c9(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(gM(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function c9(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Su(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function u9(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Ki(e,n,r),o=Ki(e,s,r);return[a,o]}function d9(e,t,r){var n=SE(e);e.l++;var s=e.read_shift(1);return t-=8,[_$(e,t,r),s,n]}function n2(e,t,r){var n=yM(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,b$(e,t,r)]}function f9(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function h9(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=co(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,o,a]}}function m9(e,t,r){return h9(e,t,r)}function p9(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Rf(e));return r}function x9(e){var t=de(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)_E(e[r],t);return t}function g9(e,t,r){if(r&&r.biff<8)return y9(e,t,r);var n=EE(e),s=kM(e,t-22,n[1]);return{cmo:n,ft:s}}var v9={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function y9(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((v9[n]||Hr)(e,t,r)),{cmo:[s,n,a],ft:o}}function w9(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=cM(e,6,r);var l=e.read_shift(2);e.read_shift(2),sr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Ki(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function b9(e,t){var r=Rf(e);e.l+=16;var n=hM(e,t-24);return[r,n]}function N9(e){var t=de(24),r=Ot(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return xr([t,mM(e[1])])}function k9(e,t){e.read_shift(2);var r=Rf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(en,""),[r,n]}function _9(e){var t=e[1].Tooltip,r=de(10+2*(t.length+1));r.write_shift(2,2048);var n=Ot(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function S9(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Vw[r]||r,r=e.read_shift(2),t[1]=Vw[r]||r,t}function E9(e){return e||(e=de(4)),e.write_shift(2,1),e.write_shift(2,1),e}function C9(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(NE(e));return r}function j9(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(NE(e));return r}function T9(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function jE(e,t,r){if(!r.cellStyles)return Hr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function A9(e,t){var r=de(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function F9(e,t){var r={};return t<32||(e.l+=16,r.header=Ur(e),r.footer=Ur(e),e.l+=2),r}function P9(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function D9(e){for(var t=de(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var I9=Vs,R9=vE,L9=Eu;function O9(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function M9(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Vs(e);++e.l;var s=co(e,t-7,r);return n.t="str",n.val=s,n}function B9(e){var t=Vs(e);++e.l;var r=Ur(e);return t.t="n",t.val=r,t}function U9(e,t,r){var n=de(15);return Au(n,e,t),n.write_shift(8,r,"f"),n}function V9(e){var t=Vs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function $9(e,t,r){var n=de(9);return Au(n,e,t),n.write_shift(2,r),n}function z9(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function H9(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function W9(e,t,r){var n=e.l+t,s=Vs(e),a=e.read_shift(2),o=Ki(e,a,r);return e.l=n,s.t="str",s.val=o,s}var G9=[2,3,48,49,131,139,140,245],Tp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Pf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Ya(1);switch(c.type){case"base64":d=Nn(An(l));break;case"binary":d=Nn(l);break;case"buffer":case"array":d=l;break}kr(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,v=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(v=d.read_shift(2));var b=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var x=[],N={},_=Math.min(d.length,f==2?521:v-10-(m?264:0)),k=g?32:11;d.l<_&&d[d.l]!=13;)switch(N={},N.name=ja.utils.decode(y,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,N.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),f==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&x.push(N),f!=2&&(d.l+=g?13:14),N.type){case"B":(!m||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var w=0,C=0;for(u[0]=[],C=0;C!=x.length;++C)u[0][C]=x[C].name;for(;p-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++w]=[],C=0,C=0;C!=x.length;++C){var D=d.slice(d.l,d.l+x[C].len);d.l+=x[C].len,kr(D,0);var z=ja.utils.decode(y,D);switch(x[C].type){case"C":z.trim().length&&(u[w][C]=z.replace(/\s+$/,""));break;case"D":z.length===8?u[w][C]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):u[w][C]=z;break;case"F":u[w][C]=parseFloat(z.trim());break;case"+":case"I":u[w][C]=g?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":u[w][C]=!0;break;case"N":case"F":u[w][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[w][C]="##MEMO##"+(g?parseInt(z.trim(),10):D.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(u[w][C]=+z||0);break;case"@":u[w][C]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":u[w][C]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":u[w][C]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][C]=-D.read_shift(-8,"f");break;case"B":if(m&&x[C].len==8){u[w][C]=D.read_shift(8,"f");break}case"G":case"P":D.l+=x[C].len;break;case"0":if(x[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[C].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=x,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Nl(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(l,c){try{return si(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&ds(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=mn(),f=z0(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),g=l["!cols"]||[],p=0,v=0,b=0,y=1;for(p=0;p<h.length;++p){if(((g[p]||{}).DBF||{}).name){h[p]=g[p].DBF.name,++b;continue}if(h[p]!=null){if(++b,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(v=0;v<1024;++v)if(h.indexOf(h[p]+"_"+v)==-1){h[p]+="_"+v;break}}}}var x=lt(l["!ref"]),N=[],_=[],k=[];for(p=0;p<=x.e.c-x.s.c;++p){var w="",C="",D=0,z=[];for(v=0;v<m.length;++v)m[v][p]!=null&&z.push(m[v][p]);if(z.length==0||h[p]==null){N[p]="?";continue}for(v=0;v<z.length;++v){switch(typeof z[v]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=z[v]instanceof Date?"D":"C";break;default:C="C"}D=Math.max(D,String(z[v]).length),w=w&&w!=C?"C":C}D>250&&(D=250),C=((g[p]||{}).DBF||{}).type,C=="C"&&g[p].DBF.len>D&&(D=g[p].DBF.len),w=="B"&&C=="N"&&(w="N",k[p]=g[p].DBF.dec,D=g[p].DBF.len),_[p]=w=="C"||C=="N"?D:a[w]||0,y+=_[p],N[p]=w}var A=d.next(32);for(A.write_shift(4,318902576),A.write_shift(4,m.length),A.write_shift(2,296+32*b),A.write_shift(2,y),p=0;p<4;++p)A.write_shift(4,0);for(A.write_shift(4,0|(+t[xS]||3)<<8),p=0,v=0;p<h.length;++p)if(h[p]!=null){var R=d.next(32),G=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,G,"sbcs"),R.write_shift(1,N[p]=="?"?"C":N[p],"sbcs"),R.write_shift(4,v),R.write_shift(1,_[p]||a[N[p]]||0),R.write_shift(1,k[p]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),v+=_[p]||a[N[p]]||0}var I=d.next(264);for(I.write_shift(4,13),p=0;p<65;++p)I.write_shift(4,0);for(p=0;p<m.length;++p){var Z=d.next(y);for(Z.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(N[v]){case"L":Z.write_shift(1,m[p][v]==null?63:m[p][v]?84:70);break;case"B":Z.write_shift(8,m[p][v]||0,"f");break;case"N":var j="0";for(typeof m[p][v]=="number"&&(j=m[p][v].toFixed(k[v]||0)),b=0;b<_[v]-j.length;++b)Z.write_shift(1,32);Z.write_shift(1,j,"sbcs");break;case"D":m[p][v]?(Z.write_shift(4,("0000"+m[p][v].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(m[p][v].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+m[p][v].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(m[p][v]!=null?m[p][v]:"").slice(0,_[v]);for(Z.write_shift(1,Y,"sbcs"),b=0;b<_[v]-Y.length;++b)Z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),TE=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Xt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var g=e[m];return typeof g=="number"?mw(g):g},n=function(h,m,g){var p=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?h:mw(p)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return a(An(h),m);case"binary":return a(h,m);case"buffer":return a(Je&&Buffer.isBuffer(h)?h.toString("binary"):ni(h),m);case"array":return a(Gi(h),m)}throw new Error("Unrecognized type "+m.type)}function a(h,m){var g=h.split(/[\n\r]+/),p=-1,v=-1,b=0,y=0,x=[],N=[],_=null,k={},w=[],C=[],D=[],z=0,A;for(+m.codepage>=0&&ds(+m.codepage);b!==g.length;++b){z=0;var R=g[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=R.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),I=G[0],Z;if(R.length>0)switch(I){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&N.push(R.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,Y=!1,q=!1,S=!1,F=-1,L=-1;for(y=1;y<G.length;++y)switch(G[y].charAt(0)){case"A":break;case"X":v=parseInt(G[y].slice(1))-1,Y=!0;break;case"Y":for(p=parseInt(G[y].slice(1))-1,Y||(v=0),A=x.length;A<=p;++A)x[A]=[];break;case"K":Z=G[y].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(xs(Z))?isNaN(il(Z).getDate())||(Z=Ct(Z)):(Z=xs(Z),_!==null&&wl(_)&&(Z=If(Z))),j=!0;break;case"E":S=!0;var T=Go(G[y].slice(1),{r:p,c:v});x[p][v]=[x[p][v],T];break;case"S":q=!0,x[p][v]=[x[p][v],"S5S"];break;case"G":break;case"R":F=parseInt(G[y].slice(1))-1;break;case"C":L=parseInt(G[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}if(j&&(x[p][v]&&x[p][v].length==2?x[p][v][0]=Z:x[p][v]=Z,_=null),q){if(S)throw new Error("SYLK shared formula cannot have own formula");var U=F>-1&&x[F][L];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");x[p][v][1]=XE(U[1],{r:p-F,c:v-L})}break;case"F":var X=0;for(y=1;y<G.length;++y)switch(G[y].charAt(0)){case"X":v=parseInt(G[y].slice(1))-1,++X;break;case"Y":for(p=parseInt(G[y].slice(1))-1,A=x.length;A<=p;++A)x[A]=[];break;case"M":z=parseInt(G[y].slice(1))/20;break;case"F":break;case"G":break;case"P":_=N[parseInt(G[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=G[y].slice(1).split(" "),A=parseInt(D[0],10);A<=parseInt(D[1],10);++A)z=parseInt(D[2],10),C[A-1]=z===0?{hidden:!0}:{wch:z},qa(C[A-1]);break;case"C":v=parseInt(G[y].slice(1))-1,C[v]||(C[v]={});break;case"R":p=parseInt(G[y].slice(1))-1,w[p]||(w[p]={}),z>0?(w[p].hpt=z,w[p].hpx=ll(z)):z===0&&(w[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}X<1&&(_=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}}return w.length>0&&(k["!rows"]=w),C.length>0&&(k["!cols"]=C),m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),[x,k]}function o(h,m){var g=s(h,m),p=g[0],v=g[1],b=Nl(p,m);return Xt(v).forEach(function(y){b[y]=v[y]}),b}function l(h,m){return si(o(h,m),m)}function c(h,m,g,p){var v="C;Y"+(g+1)+";X"+(p+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+e1(h.f,{r:g,c:p}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(h,m){m.forEach(function(g,p){var v="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?v+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Zc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Jc(g.wpx)),typeof g.wch=="number"&&(v+=Math.round(g.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function d(h,m){m.forEach(function(g,p){var v="F;";g.hidden?v+="M0;":g.hpt?v+="M"+20*g.hpt+";":g.hpx&&(v+="M"+20*Qc(g.hpx)+";"),v.length>2&&h.push(v+"R"+(p+1))})}function f(h,m){var g=["ID;PWXL;N;E"],p=[],v=lt(h["!ref"]),b,y=Array.isArray(h),x=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&u(g,h["!cols"]),h["!rows"]&&d(g,h["!rows"]),g.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var N=v.s.r;N<=v.e.r;++N)for(var _=v.s.c;_<=v.e.c;++_){var k=He({r:N,c:_});b=y?(h[N]||[])[_]:h[k],!(!b||b.v==null&&(!b.f||b.F))&&p.push(c(b,h,N,_))}return g.join(x)+x+p.join(x)+x+"E"+x}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),AE=function(){function e(a,o){switch(o.type){case"base64":return t(An(a),o);case"binary":return t(a,o);case"buffer":return t(Je&&Buffer.isBuffer(a)?a.toString("binary"):ni(a),o);case"array":return t(Gi(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),m=h[0],g=h[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(xs(g))?isNaN(il(g).getDate())?f[c][u]=g:f[c][u]=Ct(g):f[c][u]=xs(g),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(a,o){return Nl(e(a,o),o)}function n(a,o){return si(r(a,o),o)}var s=function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=lt(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){o(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var p=He({r:m,c:g});if(f=h?(c[m]||[])[g]:c[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,v,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ts(f.z||$e[14],dr(Ct(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,y=u.join(b);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),FE=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),g=-1,p=-1,v=0,b=[];v!==m.length;++v){var y=m[v].trim().split(":");if(y[0]==="cell"){var x=Ot(y[1]);if(b.length<=x.r)for(g=b.length;g<=x.r;++g)b[g]||(b[g]=[]);switch(g=x.r,p=x.c,y[2]){case"t":b[g][p]=e(y[3]);break;case"v":b[g][p]=+y[3];break;case"vtf":var N=y[y.length-1];case"vtc":switch(y[3]){case"nl":b[g][p]=!!+y[4];break;default:b[g][p]=+y[4];break}y[2]=="vtf"&&(b[g][p]=[b[g][p],N])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(f,h){return Nl(r(f,h),h)}function s(f,h){return si(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],g,p="",v=gn(f["!ref"]),b=Array.isArray(f),y=v.s.r;y<=v.e.r;++y)for(var x=v.s.c;x<=v.e.c;++x)if(p=He({r:y,c:x}),g=b?(f[y]||[])[x]:f[p],!(!g||g.v==null||g.t==="z")){switch(m=["cell",p,"t"],g.t){case"s":case"str":m.push(t(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=t(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var N=dr(Ct(g.v));m[2]="vtc",m[3]="nd",m[4]=""+N,m[5]=g.w||ts(g.z||$e[14],N);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,o,l,o,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),ol=function(){function e(d,f,h,m,g){g.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(xs(d))?isNaN(il(d).getDate())?f[h][m]=d:f[h][m]=Ct(d):f[h][m]=xs(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var g=d.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var v=10,b=0,y=0;y<=p;++y)b=g[y].indexOf(" "),b==-1?b=g[y].length:b++,v=Math.max(v,b);for(y=0;y<=p;++y){m[y]=[];var x=0;for(e(g[y].slice(0,v).trim(),m,y,x,h),x=1;x<=(g[y].length-v)/10+1;++x)e(g[y].slice(v+(x-1)*10,v+x*10).trim(),m,y,x,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},h=!1,m=0,g=0;m<d.length;++m)(g=d.charCodeAt(m))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m]);if(!g.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m])}return g.sort(function(p,v){return p[0]-v[0]||n[p[1]]-n[v[1]]}),r[g.pop()[1]]||44}function a(d,f){var h=f||{},m="",g=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=s(d.slice(0,1024)):h&&h.FS?m=h.FS:m=s(d.slice(0,1024));var v=0,b=0,y=0,x=0,N=0,_=m.charCodeAt(0),k=!1,w=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var D=h.dateNF!=null?DO(h.dateNF):null;function z(){var A=d.slice(x,N),R={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)R.t="z";else if(h.raw)R.t="s",R.v=A;else if(A.trim().length===0)R.t="s",R.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(R.t="s",R.v=A.slice(2,-1).replace(/""/g,'"')):oV(A)?(R.t="n",R.f=A.slice(1)):(R.t="s",R.v=A);else if(A=="TRUE")R.t="b",R.v=!0;else if(A=="FALSE")R.t="b",R.v=!1;else if(!isNaN(y=xs(A)))R.t="n",h.cellText!==!1&&(R.w=A),R.v=y;else if(!isNaN(il(A).getDate())||D&&A.match(D)){R.z=h.dateNF||$e[14];var G=0;D&&A.match(D)&&(A=IO(A,h.dateNF,A.match(D)||[]),G=1),h.cellDates?(R.t="d",R.v=Ct(A,G)):(R.t="n",R.v=dr(Ct(A,G))),h.cellText!==!1&&(R.w=ts(R.z,R.v instanceof Date?dr(R.v):R.v)),h.cellNF||delete R.z}else R.t="s",R.v=A;if(R.t=="z"||(h.dense?(g[v]||(g[v]=[]),g[v][b]=R):g[He({c:b,r:v})]=R),x=N+1,C=d.charCodeAt(x),p.e.c<b&&(p.e.c=b),p.e.r<v&&(p.e.r=v),w==_)++b;else if(b=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;N<d.length;++N)switch(w=d.charCodeAt(N)){case 34:C===34&&(k=!k);break;case _:case 10:case 13:if(!k&&z())break e;break}return N-x>0&&z(),g["!ref"]=Ke(p),g}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Nl(t(d,f),f)}function l(d,f){var h="",m=f.type=="string"?[0,0,0,0]:l1(d,f);switch(f.type){case"base64":h=An(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof ja<"u"?h=ja.utils.decode(f.codepage,d):h=Je&&Buffer.isBuffer(d)?d.toString("binary"):ni(d);break;case"array":h=Gi(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=gt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=gt(h):f.type=="binary"&&typeof ja<"u"&&f.codepage&&(h=ja.utils.decode(f.codepage,ja.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?FE.to_sheet(f.type=="string"?h:gt(h),f):o(h,f)}function c(d,f){return si(l(d,f),f)}function u(d){for(var f=[],h=lt(d["!ref"]),m,g=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var v=[],b=h.s.c;b<=h.e.c;++b){var y=He({r:p,c:b});if(m=g?(d[p]||[])[b]:d[y],!m||m.v==null){v.push("          ");continue}for(var x=(m.w||(da(m),m.w)||"").slice(0,10);x.length<10;)x+=" ";v.push(x+(b===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function X9(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=TE.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return ol.to_workbook(e,t)}}var Fi=function(){function e(T,U,X){if(T){kr(T,T.l||0);for(var H=X.Enum||F;T.l<T.length;){var ee=T.read_shift(2),me=H[ee]||H[65535],le=T.read_shift(2),ce=T.l+le,J=me.f&&me.f(T,le,X);if(T.l=ce,U(J,me,ee))return}}}function t(T,U){switch(U.type){case"base64":return r(Nn(An(T)),U);case"binary":return r(Nn(T),U);case"buffer":case"array":return r(T,U)}throw"Unsupported type "+U.type}function r(T,U){if(!T)return T;var X=U||{},H=X.dense?[]:{},ee="Sheet1",me="",le=0,ce={},J=[],Se=[],B={s:{r:0,c:0},e:{r:0,c:0}},je=X.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)X.Enum=F,e(T,function(pe,Ae,et){switch(et){case 0:X.vers=pe,pe>=4096&&(X.qpro=!0);break;case 6:B=pe;break;case 204:pe&&(me=pe);break;case 222:me=pe;break;case 15:case 51:X.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:et==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=X.dateNF||$e[14],X.cellDates&&(pe[1].t="d",pe[1].v=If(pe[1].v))),X.qpro&&pe[3]>le&&(H["!ref"]=Ke(B),ce[ee]=H,J.push(ee),H=X.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},le=pe[3],ee=me||"Sheet"+(le+1),me="");var Q=X.dense?(H[pe[0].r]||[])[pe[0].c]:H[He(pe[0])];if(Q){Q.t=pe[1].t,Q.v=pe[1].v,pe[1].z!=null&&(Q.z=pe[1].z),pe[1].f!=null&&(Q.f=pe[1].f);break}X.dense?(H[pe[0].r]||(H[pe[0].r]=[]),H[pe[0].r][pe[0].c]=pe[1]):H[He(pe[0])]=pe[1];break}},X);else if(T[2]==26||T[2]==14)X.Enum=L,T[2]==14&&(X.qpro=!0,T.l=0),e(T,function(pe,Ae,et){switch(et){case 204:ee=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>le&&(H["!ref"]=Ke(B),ce[ee]=H,J.push(ee),H=X.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},le=pe[3],ee="Sheet"+(le+1)),je>0&&pe[0].r>=je)break;X.dense?(H[pe[0].r]||(H[pe[0].r]=[]),H[pe[0].r][pe[0].c]=pe[1]):H[He(pe[0])]=pe[1],B.e.c<pe[0].c&&(B.e.c=pe[0].c),B.e.r<pe[0].r&&(B.e.r=pe[0].r);break;case 27:pe[14e3]&&(Se[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Se[pe[0]]=pe[1],pe[0]==le&&(ee=pe[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(H["!ref"]=Ke(B),ce[me||ee]=H,J.push(me||ee),!Se.length)return{SheetNames:J,Sheets:ce};for(var _e={},Re=[],Te=0;Te<Se.length;++Te)ce[J[Te]]?(Re.push(Se[Te]||J[Te]),_e[Se[Te]]=ce[Se[Te]]||ce[J[Te]]):(Re.push(Se[Te]),_e[Se[Te]]={"!ref":"A1"});return{SheetNames:Re,Sheets:_e}}function n(T,U){var X=U||{};if(+X.codepage>=0&&ds(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var H=mn(),ee=lt(T["!ref"]),me=Array.isArray(T),le=[];ke(H,0,a(1030)),ke(H,6,c(ee));for(var ce=Math.min(ee.e.r,8191),J=ee.s.r;J<=ce;++J)for(var Se=Jt(J),B=ee.s.c;B<=ee.e.c;++B){J===ee.s.r&&(le[B]=Lt(B));var je=le[B]+Se,_e=me?(T[J]||[])[B]:T[je];if(!(!_e||_e.t=="z"))if(_e.t=="n")(_e.v|0)==_e.v&&_e.v>=-32768&&_e.v<=32767?ke(H,13,m(J,B,_e.v)):ke(H,14,p(J,B,_e.v));else{var Re=da(_e);ke(H,15,f(J,B,Re.slice(0,239)))}}return ke(H,1),H.end()}function s(T,U){var X=U||{};if(+X.codepage>=0&&ds(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var H=mn();ke(H,0,o(T));for(var ee=0,me=0;ee<T.SheetNames.length;++ee)(T.Sheets[T.SheetNames[ee]]||{})["!ref"]&&ke(H,27,S(T.SheetNames[ee],me++));var le=0;for(ee=0;ee<T.SheetNames.length;++ee){var ce=T.Sheets[T.SheetNames[ee]];if(!(!ce||!ce["!ref"])){for(var J=lt(ce["!ref"]),Se=Array.isArray(ce),B=[],je=Math.min(J.e.r,8191),_e=J.s.r;_e<=je;++_e)for(var Re=Jt(_e),Te=J.s.c;Te<=J.e.c;++Te){_e===J.s.r&&(B[Te]=Lt(Te));var pe=B[Te]+Re,Ae=Se?(ce[_e]||[])[Te]:ce[pe];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")ke(H,23,z(_e,Te,le,Ae.v));else{var et=da(Ae);ke(H,22,w(_e,Te,le,et.slice(0,239)))}}++le}}return ke(H,1),H.end()}function a(T){var U=de(2);return U.write_shift(2,T),U}function o(T){var U=de(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var X=0,H=0,ee=0,me=0;me<T.SheetNames.length;++me){var le=T.SheetNames[me],ce=T.Sheets[le];if(!(!ce||!ce["!ref"])){++ee;var J=gn(ce["!ref"]);X<J.e.r&&(X=J.e.r),H<J.e.c&&(H=J.e.c)}}return X>8191&&(X=8191),U.write_shift(2,X),U.write_shift(1,ee),U.write_shift(1,H),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function l(T,U,X){var H={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&X.qpro?(H.s.c=T.read_shift(1),T.l++,H.s.r=T.read_shift(2),H.e.c=T.read_shift(1),T.l++,H.e.r=T.read_shift(2),H):(H.s.c=T.read_shift(2),H.s.r=T.read_shift(2),U==12&&X.qpro&&(T.l+=2),H.e.c=T.read_shift(2),H.e.r=T.read_shift(2),U==12&&X.qpro&&(T.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(T){var U=de(8);return U.write_shift(2,T.s.c),U.write_shift(2,T.s.r),U.write_shift(2,T.e.c),U.write_shift(2,T.e.r),U}function u(T,U,X){var H=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(H[0].c=T.read_shift(1),H[3]=T.read_shift(1),H[0].r=T.read_shift(2),T.l+=2):(H[2]=T.read_shift(1),H[0].c=T.read_shift(2),H[0].r=T.read_shift(2)),H}function d(T,U,X){var H=T.l+U,ee=u(T,U,X);if(ee[1].t="s",X.vers==20768){T.l++;var me=T.read_shift(1);return ee[1].v=T.read_shift(me,"utf8"),ee}return X.qpro&&T.l++,ee[1].v=T.read_shift(H-T.l,"cstr"),ee}function f(T,U,X){var H=de(7+X.length);H.write_shift(1,255),H.write_shift(2,U),H.write_shift(2,T),H.write_shift(1,39);for(var ee=0;ee<H.length;++ee){var me=X.charCodeAt(ee);H.write_shift(1,me>=128?95:me)}return H.write_shift(1,0),H}function h(T,U,X){var H=u(T,U,X);return H[1].v=T.read_shift(2,"i"),H}function m(T,U,X){var H=de(7);return H.write_shift(1,255),H.write_shift(2,U),H.write_shift(2,T),H.write_shift(2,X,"i"),H}function g(T,U,X){var H=u(T,U,X);return H[1].v=T.read_shift(8,"f"),H}function p(T,U,X){var H=de(13);return H.write_shift(1,255),H.write_shift(2,U),H.write_shift(2,T),H.write_shift(8,X,"f"),H}function v(T,U,X){var H=T.l+U,ee=u(T,U,X);if(ee[1].v=T.read_shift(8,"f"),X.qpro)T.l=H;else{var me=T.read_shift(2);N(T.slice(T.l,T.l+me),ee),T.l+=me}return ee}function b(T,U,X){var H=U&32768;return U&=-32769,U=(H?T:0)+(U>=8192?U-16384:U),(H?"":"$")+(X?Lt(U):Jt(U))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(T,U){kr(T,0);for(var X=[],H=0,ee="",me="",le="",ce="";T.l<T.length;){var J=T[T.l++];switch(J){case 0:X.push(T.read_shift(8,"f"));break;case 1:me=b(U[0].c,T.read_shift(2),!0),ee=b(U[0].r,T.read_shift(2),!1),X.push(me+ee);break;case 2:{var Se=b(U[0].c,T.read_shift(2),!0),B=b(U[0].r,T.read_shift(2),!1);me=b(U[0].c,T.read_shift(2),!0),ee=b(U[0].r,T.read_shift(2),!1),X.push(Se+B+":"+me+ee)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(T.read_shift(2));break;case 6:{for(var je="";J=T[T.l++];)je+=String.fromCharCode(J);X.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:ce=X.pop(),le=X.pop(),X.push(["AND","OR"][J-20]+"("+le+","+ce+")");break;default:if(J<32&&x[J])ce=X.pop(),le=X.pop(),X.push(le+x[J]+ce);else if(y[J]){if(H=y[J][1],H==69&&(H=T[T.l++]),H>X.length){console.error("WK1 bad formula parse 0x"+J.toString(16)+":|"+X.join("|")+"|");return}var _e=X.slice(-H);X.length-=H,X.push(y[J][0]+"("+_e.join(",")+")")}else return J<=7?console.error("WK1 invalid opcode "+J.toString(16)):J<=24?console.error("WK1 unsupported op "+J.toString(16)):J<=30?console.error("WK1 invalid opcode "+J.toString(16)):J<=115?console.error("WK1 unsupported function opcode "+J.toString(16)):console.error("WK1 unrecognized opcode "+J.toString(16))}}X.length==1?U[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function _(T){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=T.read_shift(2),U[3]=T[T.l++],U[0].c=T[T.l++],U}function k(T,U){var X=_(T);return X[1].t="s",X[1].v=T.read_shift(U-4,"cstr"),X}function w(T,U,X,H){var ee=de(6+H.length);ee.write_shift(2,T),ee.write_shift(1,X),ee.write_shift(1,U),ee.write_shift(1,39);for(var me=0;me<H.length;++me){var le=H.charCodeAt(me);ee.write_shift(1,le>=128?95:le)}return ee.write_shift(1,0),ee}function C(T,U){var X=_(T);X[1].v=T.read_shift(2);var H=X[1].v>>1;if(X[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return X[1].v=H,X}function D(T,U){var X=_(T),H=T.read_shift(4),ee=T.read_shift(4),me=T.read_shift(2);if(me==65535)return H===0&&ee===3221225472?(X[1].t="e",X[1].v=15):H===0&&ee===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var le=me&32768;return me=(me&32767)-16446,X[1].v=(1-le*2)*(ee*Math.pow(2,me+32)+H*Math.pow(2,me)),X}function z(T,U,X,H){var ee=de(14);if(ee.write_shift(2,T),ee.write_shift(1,X),ee.write_shift(1,U),H==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var me=0,le=0,ce=0,J=0;return H<0&&(me=1,H=-H),le=Math.log2(H)|0,H/=Math.pow(2,le-31),J=H>>>0,J&2147483648||(H/=2,++le,J=H>>>0),H-=J,J|=2147483648,J>>>=0,H*=Math.pow(2,32),ce=H>>>0,ee.write_shift(4,ce),ee.write_shift(4,J),le+=16383+(me?32768:0),ee.write_shift(2,le),ee}function A(T,U){var X=D(T);return T.l+=U-14,X}function R(T,U){var X=_(T),H=T.read_shift(4);return X[1].v=H>>6,X}function G(T,U){var X=_(T),H=T.read_shift(8,"f");return X[1].v=H,X}function I(T,U){var X=G(T);return T.l+=U-10,X}function Z(T,U){return T[T.l+U-1]==0?T.read_shift(U,"cstr"):""}function j(T,U){var X=T[T.l++];X>U-1&&(X=U-1);for(var H="";H.length<X;)H+=String.fromCharCode(T[T.l++]);return H}function Y(T,U,X){if(!(!X.qpro||U<21)){var H=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var ee=T.read_shift(U-21,"cstr");return[H,ee]}}function q(T,U){for(var X={},H=T.l+U;T.l<H;){var ee=T.read_shift(2);if(ee==14e3){for(X[ee]=[0,""],X[ee][0]=T.read_shift(2);T[T.l];)X[ee][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return X}function S(T,U){var X=de(5+T.length);X.write_shift(2,14e3),X.write_shift(2,U);for(var H=0;H<T.length;++H){var ee=T.charCodeAt(H);X[X.l++]=ee>127?95:ee}return X[X.l++]=0,X}var F={0:{n:"BOF",f:sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:j},65535:{n:""}},L={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:I},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function K9(e){var t={},r=e.match(Wr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=We(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Sg[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var Y9=function(){var e=Gc("t"),t=Gc("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:ot(o[1])},c=a.match(t);return c&&(l.s=K9(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),q9=function(){var t=/(\r\n|\n)/g;function r(s,a,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),o.push("</b>")),s.i&&(a.push("<i>"),o.push("</i>")),s.strike&&(a.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Z9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,J9=/<(?:\w+:)?r>/,Q9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Yg(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ot(gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=gt(e),r&&(n.h=Rg(n.t))):e.match(J9)&&(n.r=gt(e),n.t=ot(gt((e.replace(Q9,"").match(Z9)||[]).join("").replace(Wr,""))),r&&(n.h=q9(Y9(n.r)))),n):{t:""}}var eB=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tB=/<(?:\w+:)?(?:si|sstItem)>/g,rB=/<\/(?:\w+:)?(?:si|sstItem)>/;function nB(e,t){var r=[],n="";if(!e)return r;var s=e.match(eB);if(s){n=s[2].replace(tB,"").split(rB);for(var a=0;a!=n.length;++a){var o=Yg(n[a].trim(),t);o!=null&&(r[r.length]=o)}s=We(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var sB=/^\s|\s$|[\t\n\r]/;function PE(e,t){if(!t.bookSST)return"";var r=[er];r[r.length]=Ne("sst",null,{xmlns:so[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(sB)&&(a+=' xml:space="preserve"'),a+=">"+mt(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function aB(e){return[e.read_shift(4),e.read_shift(4)]}function iB(e,t){var r=[],n=!1;return pa(e,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function oB(e,t){return t||(t=de(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var lB=v7;function cB(e){var t=mn();xe(t,159,oB(e));for(var r=0;r<e.length;++r)xe(t,19,lB(e[r]));return xe(t,160),t.end()}function DE(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ra(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function uB(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ra(e,4),t.U=ra(e,4),t.W=ra(e,4),t}function dB(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function fB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(dB(e));return t}function hB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function mB(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ra(e,4),t.U=ra(e,4),t.W=ra(e,4),t}function pB(e){var t=mB(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function IE(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function RE(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function xB(e){var t=ra(e);switch(t.Minor){case 2:return[t.Minor,gB(e)];case 3:return[t.Minor,vB()];case 4:return[t.Minor,yB(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function gB(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=IE(e,r),s=RE(e,e.length-e.l);return{t:"Std",h:n,v:s}}function vB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yB(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Wr,function(a){var o=We(a);switch(Us(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function wB(e,t){var r={},n=r.EncryptionVersionInfo=ra(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=IE(e,s),t-=s,r.EncryptionVerifier=RE(e,t),r}function bB(e){var t={},r=t.EncryptionVersionInfo=ra(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function qg(e){var t=0,r,n=DE(e),s=n.length+1,a,o,l,c,u;for(r=Ya(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var LE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},a=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=DE(o),c=a(l),u=l.length,d=Ya(16),f=0;f!=16;++f)d[f]=0;var h,m,g;for((u&1)===1&&(h=c>>8,d[u]=s(e[0],h),--u,h=c&255,m=l[l.length-1],d[u]=s(m,h));u>0;)--u,h=c>>8,d[u]=s(l[u],h),--u,h=c&255,d[u]=s(l[u],h);for(u=15,g=15-l.length;g>0;)h=c>>8,d[u]=s(e[g],h),--u,--g,h=c&255,d[u]=s(l[u],h),--u,--g;return d}}(),NB=function(e,t,r,n,s){s||(s=t),n||(n=LE(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,s[a]=o,++r;return[s,r,n]},kB=function(e){var t=0,r=LE(e);return function(n){var s=NB("",n,t,r);return t=s[1],s[0]}};function _B(e,t,r,n){var s={key:sr(e),verificationBytes:sr(e)};return r.password&&(s.verifier=qg(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=kB(r.password)),s}function SB(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=bB(e):n.Data=wB(e,t),n}function EB(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?SB(e,t-2,n):_B(e,r.biff>=8?t:t-2,r,n),n}var OE=function(){function e(s,a){switch(a.type){case"base64":return t(An(s),a);case"binary":return t(s,a);case"buffer":return t(Je&&Buffer.isBuffer(s)?s.toString("binary"):ni(s),a);case"array":return t(Gi(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var o=a||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,g,p=-1;g=h.exec(d);){switch(g[0]){case"\\cell":var v=d.slice(m,h.lastIndex-g[0].length);if(v[0]==" "&&(v=v.slice(1)),++p,v.length){var b={v,t:"s"};Array.isArray(l)?l[f][p]=b:l[He({r:f,c:p})]=b}break}m=h.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Ke(u),l}function r(s,a){return si(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=lt(s["!ref"]),l,c=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=He({r:u,c:d});l=c?(s[u]||[])[d]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(da(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function CB(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function qc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function jB(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),o=s-a;if(o===0)return[0,0,t];var l=0,c=0,u=s+a;switch(c=o/(u>1?2-u:u),s){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function TB(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,o=[a,a,a],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function V0(e,t){if(t===0)return e;var r=jB(CB(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),qc(TB(r))}var ME=6,AB=15,FB=1,Or=ME;function Zc(e){return Math.floor((e+Math.round(128/Or)/256)*Or)}function Jc(e){return Math.floor((e-5)/Or*100+.5)/100}function $0(e){return Math.round((e*Or+5)/Or*256)/256}function $h(e){return $0(Jc(Zc(e)))}function Zg(e){var t=Math.abs(e-$h(e)),r=Or;if(t>.005)for(Or=FB;Or<AB;++Or)Math.abs(e-$h(e))<=t&&(t=Math.abs(e-$h(e)),r=Or);Or=r}function qa(e){e.width?(e.wpx=Zc(e.width),e.wch=Jc(e.wpx),e.MDW=Or):e.wpx?(e.wch=Jc(e.wpx),e.width=$0(e.wch),e.MDW=Or):typeof e.wch=="number"&&(e.width=$0(e.wch),e.wpx=Zc(e.width),e.MDW=Or),e.customWidth&&delete e.customWidth}var PB=96,BE=PB;function Qc(e){return e*96/BE}function ll(e){return e*BE/96}var DB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IB(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Wr)||[]).forEach(function(o){var l=We(o);switch(Us(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=St(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=St(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function RB(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Wr)||[]).forEach(function(o){var l=We(o);switch(Us(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function LB(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Wr)||[]).forEach(function(o){var l=We(o);switch(Us(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=gt(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?St(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?St(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?St(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?St(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?St(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?St(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?St(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Sg[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=St(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Ti[s.color.index];s.color.index==81&&(c=Ti[1]),c||(c=Ti[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=V0(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function OB(e,t,r){t.NumberFmt=[];for(var n=Xt($e),s=0;s<n.length;++s)t.NumberFmt[n[s]]=$e[n[s]];var a=e[0].match(Wr);if(a)for(s=0;s<a.length;++s){var o=We(a[s]);switch(Us(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ot(gt(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}ta(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function MB(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ne("numFmt",null,{numFmtId:n,formatCode:mt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ne("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var fd=["numFmtId","fillId","fontId","borderId","xfId"],hd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BB(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Wr)||[]).forEach(function(a){var o=We(a),l=0;switch(Us(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<fd.length;++l)n[fd[l]]&&(n[fd[l]]=parseInt(n[fd[l]],10));for(l=0;l<hd.length;++l)n[hd[l]]&&(n[hd[l]]=St(n[hd[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=St(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function UB(e){var t=[];return t[t.length]=Ne("cellXfs",null),e.forEach(function(r){t[t.length]=Ne("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ne("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var VB=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&OB(f,d,u),(f=l.match(s))&&LB(f,d,c,u),(f=l.match(n))&&RB(f,d,c,u),(f=l.match(a))&&IB(f,d,c,u),(f=l.match(r))&&BB(f,d,u),d}}();function UE(e,t){var r=[er,Ne("styleSheet",null,{xmlns:so[0],"xmlns:vt":lr.vt})],n;return e.SSF&&(n=MB(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=UB(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function $B(e,t){var r=e.read_shift(2),n=Vr(e);return[r,n]}function zB(e,t,r){r||(r=de(6+4*t.length)),r.write_shift(2,e),vr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function HB(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=S7(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=_7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vr(e),n}function WB(e,t){t||(t=de(25+4*32)),t.write_shift(2,e.sz*20),E7(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),M0(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),vr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var GB=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zh,XB=Hr;function s2(e,t){t||(t=de(4*3+8*7+16*1)),zh||(zh=Pf(GB));var r=zh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(M0({auto:1},t),M0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function KB(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function VE(e,t,r){r||(r=de(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Vl(e,t){return t||(t=de(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var YB=Hr;function qB(e,t){return t||(t=de(51)),t.write_shift(1,0),Vl(null,t),Vl(null,t),Vl(null,t),Vl(null,t),Vl(null,t),t.length>t.l?t.slice(0,t.l):t}function ZB(e,t){return t||(t=de(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),O0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function JB(e,t,r){var n=de(2052);return n.write_shift(4,e),O0(t,n),O0(r,n),n.length>n.l?n.slice(0,n.l):n}function QB(e,t,r){var n={};n.NumberFmt=[];for(var s in $e)n.NumberFmt[s]=$e[s];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return pa(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],ta(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=V0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d),o=!0;break;case 38:a.pop(),o=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function eU(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(xe(e,615,gs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&xe(e,44,zB(s,t[s]))}),xe(e,616))}}function tU(e){var t=1;xe(e,611,gs(t)),xe(e,43,WB({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),xe(e,612)}function rU(e){var t=2;xe(e,603,gs(t)),xe(e,45,s2({patternType:"none"})),xe(e,45,s2({patternType:"gray125"})),xe(e,604)}function nU(e){var t=1;xe(e,613,gs(t)),xe(e,46,qB()),xe(e,614)}function sU(e){var t=1;xe(e,626,gs(t)),xe(e,47,VE({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),xe(e,627)}function aU(e,t){xe(e,617,gs(t.length)),t.forEach(function(r){xe(e,47,VE(r,0))}),xe(e,618)}function iU(e){var t=1;xe(e,619,gs(t)),xe(e,48,ZB({xfId:0,builtinId:0,name:"Normal"})),xe(e,620)}function oU(e){var t=0;xe(e,505,gs(t)),xe(e,506)}function lU(e){var t=0;xe(e,508,JB(t,"TableStyleMedium9","PivotStyleMedium4")),xe(e,509)}function cU(e,t){var r=mn();return xe(r,278),eU(r,e.SSF),tU(r),rU(r),nU(r),sU(r),aU(r,t.cellXfs),iU(r),oU(r),lU(r),xe(r,279),r.end()}var uU=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dU(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Wr)||[]).forEach(function(s){var a=We(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[uU.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function fU(){}function hU(){}var mU=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pU=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,xU=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function gU(e,t,r){t.themeElements={};var n;[["clrScheme",mU,dU],["fontScheme",pU,fU],["fmtScheme",xU,hU]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var vU=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $E(e,t){(!e||e.length===0)&&(e=Jg());var r,n={};if(!(r=e.match(vU)))throw new Error("themeElements not found in theme");return gU(r[0],n,t),n.raw=e,n}function Jg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[er];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yU(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=IS(a,{type:"array"})}catch{return}var l=kn(o,"theme/theme/theme1.xml",!0);if(l)return $E(l,r)}}function wU(e){return e.read_shift(4)}function bU(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=NU(e,4);break;case 2:t.xclrValue=bE(e);break;case 3:t.xclrValue=wU(e);break;case 4:e.l+=4;break}return e.l+=8,t}function NU(e,t){return Hr(e,t)}function kU(e,t){return Hr(e,t)}function _U(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=bU(e);break;case 6:n[1]=kU(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function SU(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(_U(e,r-e.l));return{ixfe:n,ext:a}}function EU(e,t){t.forEach(function(r){switch(r[0]){}})}function CU(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Vr(e)}}function jU(e){var t=de(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),vr(e.name,t),t.slice(0,t.l)}function TU(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function AU(e){var t=de(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function FU(e,t){var r=de(8+2*t.length);return r.write_shift(4,e),vr(t,r),r.slice(0,r.l)}function PU(e){return e.l+=4,e.read_shift(4)!=0}function DU(e,t){var r=de(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function IU(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],o=!1,l=2;return pa(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(d),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!u.T){if(!o||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function RU(){var e=mn();return xe(e,332),xe(e,334,gs(1)),xe(e,335,jU({name:"XLDAPR",version:12e4,flags:3496657072})),xe(e,336),xe(e,339,FU(1,"XLDAPR")),xe(e,52),xe(e,35,gs(514)),xe(e,4096,gs(0)),xe(e,4097,$n(1)),xe(e,36),xe(e,53),xe(e,340),xe(e,337,DU(1,!0)),xe(e,51,AU([[1,0]])),xe(e,338),xe(e,333),e.end()}function LU(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,o;return e.replace(Wr,function(l){var c=We(l);switch(Us(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function zE(){var e=[er];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function OU(e){var t=[];if(!e)return t;var r=1;return(e.match(Wr)||[]).forEach(function(n){var s=We(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function MU(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=He(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function BU(e,t,r){var n=[];return pa(e,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function UU(e,t,r,n){if(!e)return e;var s=n||{},a=!1;pa(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function VU(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ro=1024;function HE(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ne("xml",null,{"xmlns:v":yn.v,"xmlns:o":yn.o,"xmlns:x":yn.x,"xmlns:mv":yn.mv}).replace(/\/>/,">"),Ne("o:shapelayout",Ne("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ne("v:shapetype",[Ne("v:stroke",null,{joinstyle:"miter"}),Ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ro<e*1e3;)Ro+=1e3;return t.forEach(function(a){var o=Ot(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ne("v:fill",c,l),d={on:"t",obscured:"t"};++Ro,s=s.concat(["<v:shape"+Xc({id:"_x0000_s"+Ro,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ne("v:shadow",null,d),Ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_r("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),_r("x:AutoFill","False"),_r("x:Row",String(o.r)),_r("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function a2(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(o){var l=Ot(o.ref);if(s?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[o.ref],!a){a={t:"z"},s?e[l.r][l.c]=a:e[o.ref]=a;var c=lt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Ke(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function $U(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=We(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Ot(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Yg(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function WE(e){var t=[er,Ne("comments",null,{xmlns:so[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=mt(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(mt(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(_r("t",mt(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(_r("t",mt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function zU(e,t){var r=[],n=!1,s={},a=0;return e.replace(Wr,function(l,c){var u=We(l);switch(Us(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function HU(e,t,r){var n=[er,Ne("ThreadedComments",null,{xmlns:lr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Ne("threadedComment",_r("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function WU(e,t){var r=[],n=!1;return e.replace(Wr,function(a){var o=We(a);switch(Us(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function GU(e){var t=[er,Ne("personList",null,{xmlns:lr.TCMNT,"xmlns:x":so[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ne("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function XU(e){var t={};t.iauthor=e.read_shift(4);var r=lo(e);return t.rfx=r.s,t.ref=He(r.s),e.l+=16,t}function KU(e,t){return t==null&&(t=de(36)),t.write_shift(4,e[1].iauthor),kl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var YU=Vr;function qU(e){return vr(e.slice(0,54))}function ZU(e,t){var r=[],n=[],s={},a=!1;return pa(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function JU(e){var t=mn(),r=[];return xe(t,628),xe(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),xe(t,632,qU(s.a)))})}),xe(t,631),xe(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Ot(n[0]),e:Ot(n[0])};xe(t,635,KU([a,s])),s.t&&s.t.length>0&&xe(t,637,w7(s)),xe(t,636),delete s.iauthor})}),xe(t,634),xe(t,629),t.end()}var QU="application/vnd.ms-office.vbaProject";function eV(e){var t=Be.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Be.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Be.write(t)}function tV(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Be.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var GE=["xlsb","xlsm","xlam","biff8","xla"];function rV(){return{"!type":"dialog"}}function nV(){return{"!type":"dialog"}}function sV(){return{"!type":"macro"}}function aV(){return{"!type":"macro"}}var Go=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,o){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,s+(l?"":"$")+Lt(d)+(c?"":"$")+Jt(u)}return function(s,a){return t=a,s.replace(e,r)}}(),Qg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,e1=function(){return function(t,r){return t.replace(Qg,function(n,s,a,o,l,c){var u=Ug(o)-(a?0:r.c),d=Bg(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+h})}}();function XE(e,t){return e.replace(Qg,function(r,n,s,a,o,l){return n+(s=="$"?s+a:Lt(Ug(a)+t.c))+(o=="$"?o+l:Jt(Bg(l)+t.r))})}function iV(e,t,r){var n=gn(t),s=n.s,a=Ot(r),o={r:a.r-s.r,c:a.c-s.c};return XE(e,o)}function oV(e){return e.length!=1}function i2(e){return e.replace(/_xlfn\./g,"")}function tr(e){e.l+=1}function Za(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function KE(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return YE(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),o=Za(e,2),l=Za(e,2);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function YE(e){var t=Za(e,2),r=Za(e,2),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function lV(e,t,r){if(r.biff<8)return YE(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Za(e,2),o=Za(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function qE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return cV(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Za(e,2);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function cV(e){var t=Za(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function uV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function dV(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return fV(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function fV(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function hV(e,t,r){var n=(e[e.l++]&96)>>5,s=KE(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function mV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=KE(e,a,r);return[n,s,o]}function pV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function xV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function gV(e,t,r){var n=(e[e.l++]&96)>>5,s=lV(e,t-1,r);return[n,s]}function vV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function o2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function yV(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function wV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function bV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function NV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function ZE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function _V(e){return e.read_shift(2),ZE(e)}function SV(e){return e.read_shift(2),ZE(e)}function EV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=qE(e,0,r);return[n,s]}function CV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=dV(e,0,r);return[n,s]}function jV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=qE(e,0,r);return[n,s,a]}function TV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[P$[s],eC[s],n]}function AV(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:FV(e);return[s,(a[0]===0?eC:F$)[a[1]]]}function FV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function PV(e,t,r){e.l+=r&&r.biff==2?3:4}function DV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function IV(e){return e.l++,xa[e.read_shift(1)]}function RV(e){return e.l++,e.read_shift(2)}function LV(e){return e.l++,e.read_shift(1)!==0}function OV(e){return e.l++,Ur(e)}function MV(e,t,r){return e.l++,Su(e,t-1,r)}function BV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Kt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ur(e);break;case 2:r[1]=co(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function UV(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?lo:Rf)(e));return s}function VV(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=BV(e,r.biff);return o}function $V(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function zV(e,t,r){if(r.biff==5)return HV(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function HV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function WV(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function GV(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function XV(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function KV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var YV=Hr,qV=Hr,ZV=Hr;function Cu(e,t,r){return e.l+=2,[uV(e)]}function t1(e){return e.l+=6,[]}var JV=Cu,QV=t1,e$=t1,t$=Cu;function JE(e){return e.l+=2,[sr(e),e.read_shift(2)&1]}var r$=Cu,n$=JE,s$=t1,a$=Cu,i$=Cu,o$=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function l$(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),o=o$[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:a}}function c$(e){return e.l+=2,[e.read_shift(4)]}function u$(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function d$(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function f$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function h$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function m$(e){return e.l+=4,[0,0]}var l2={1:{n:"PtgExp",f:DV},2:{n:"PtgTbl",f:ZV},3:{n:"PtgAdd",f:tr},4:{n:"PtgSub",f:tr},5:{n:"PtgMul",f:tr},6:{n:"PtgDiv",f:tr},7:{n:"PtgPower",f:tr},8:{n:"PtgConcat",f:tr},9:{n:"PtgLt",f:tr},10:{n:"PtgLe",f:tr},11:{n:"PtgEq",f:tr},12:{n:"PtgGe",f:tr},13:{n:"PtgGt",f:tr},14:{n:"PtgNe",f:tr},15:{n:"PtgIsect",f:tr},16:{n:"PtgUnion",f:tr},17:{n:"PtgRange",f:tr},18:{n:"PtgUplus",f:tr},19:{n:"PtgUminus",f:tr},20:{n:"PtgPercent",f:tr},21:{n:"PtgParen",f:tr},22:{n:"PtgMissArg",f:tr},23:{n:"PtgStr",f:MV},26:{n:"PtgSheet",f:u$},27:{n:"PtgEndSheet",f:d$},28:{n:"PtgErr",f:IV},29:{n:"PtgBool",f:LV},30:{n:"PtgInt",f:RV},31:{n:"PtgNum",f:OV},32:{n:"PtgArray",f:vV},33:{n:"PtgFunc",f:TV},34:{n:"PtgFuncVar",f:AV},35:{n:"PtgName",f:$V},36:{n:"PtgRef",f:EV},37:{n:"PtgArea",f:hV},38:{n:"PtgMemArea",f:WV},39:{n:"PtgMemErr",f:YV},40:{n:"PtgMemNoMem",f:qV},41:{n:"PtgMemFunc",f:GV},42:{n:"PtgRefErr",f:XV},43:{n:"PtgAreaErr",f:pV},44:{n:"PtgRefN",f:CV},45:{n:"PtgAreaN",f:gV},46:{n:"PtgMemAreaN",f:f$},47:{n:"PtgMemNoMemN",f:h$},57:{n:"PtgNameX",f:zV},58:{n:"PtgRef3d",f:jV},59:{n:"PtgArea3d",f:mV},60:{n:"PtgRefErr3d",f:KV},61:{n:"PtgAreaErr3d",f:xV},255:{}},p$={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},x$={1:{n:"PtgElfLel",f:JE},2:{n:"PtgElfRw",f:a$},3:{n:"PtgElfCol",f:JV},6:{n:"PtgElfRwV",f:i$},7:{n:"PtgElfColV",f:t$},10:{n:"PtgElfRadical",f:r$},11:{n:"PtgElfRadicalS",f:s$},13:{n:"PtgElfColS",f:QV},15:{n:"PtgElfColSV",f:e$},16:{n:"PtgElfRadicalLel",f:n$},25:{n:"PtgList",f:l$},29:{n:"PtgSxName",f:c$},255:{}},g$={0:{n:"PtgAttrNoop",f:m$},1:{n:"PtgAttrSemi",f:kV},2:{n:"PtgAttrIf",f:bV},4:{n:"PtgAttrChoose",f:yV},8:{n:"PtgAttrGoto",f:wV},16:{n:"PtgAttrSum",f:PV},32:{n:"PtgAttrBaxcel",f:o2},33:{n:"PtgAttrBaxcel",f:o2},64:{n:"PtgAttrSpace",f:_V},65:{n:"PtgAttrSpaceSemi",f:SV},128:{n:"PtgAttrIfError",f:NV},255:{}};function ju(e,t,r,n){if(n.biff<8)return Hr(e,t);for(var s=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=VV(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=UV(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&a.push(Hr(e,t)),a}function Tu(e,t,r){for(var n=e.l+t,s,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],s=l2[a]||l2[p$[a]],(a===24||a===25)&&(s=(a===24?x$:g$)[e[e.l+1]]),!s||!s.f?Hr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function v$(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var y$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function w$(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function QE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function c2(e,t,r){var n=QE(e,t,r);return n=="#REF"?n:w$(n,r)}function Rr(e,t,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,u,d,f=0,h=0,m,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,v="",b=0,y=e[0].length;b<y;++b){var x=e[0][b];switch(x[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:v=Ht(" ",e[0][p][1][1]);break;case 1:v=Ht("\r",e[0][p][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+v,p=-1}l.push(u+y$[x[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=hc(x[1][1],o,s),l.push(mc(d,a));break;case"PtgRefN":d=r?hc(x[1][1],r,s):x[1][1],l.push(mc(d,a));break;case"PtgRef3d":f=x[1][1],d=hc(x[1][2],o,s),g=c2(n,f,s),l.push(g+"!"+mc(d,a));break;case"PtgFunc":case"PtgFuncVar":var N=x[1][0],_=x[1][1];N||(N=0),N&=127;var k=N==0?[]:l.slice(-N);l.length-=N,_==="User"&&(_=k.shift()),l.push(_+"("+k.join(",")+")");break;case"PtgBool":l.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(x[1]);break;case"PtgNum":l.push(String(x[1]));break;case"PtgStr":l.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(x[1]);break;case"PtgAreaN":m=Mw(x[1][1],r?{s:r}:o,s),l.push(Bh(m,s));break;case"PtgArea":m=Mw(x[1][1],o,s),l.push(Bh(m,s));break;case"PtgArea3d":f=x[1][1],m=x[1][2],g=c2(n,f,s),l.push(g+"!"+Bh(m,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var w=(n.names||[])[h-1]||(n[0]||[])[h],C=w?w.Name:"SH33TJSNAME"+String(h);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),l.push(C);break;case"PtgNameX":var D=x[1][1];h=x[1][2];var z;if(s.biff<=5)D<0&&(D=-D),n[D]&&(z=n[D][h]);else{var A="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][h]&&n[D][h].itab>0&&(A=n.SheetNames[n[D][h].itab-1]+"!"):A=n.SheetNames[h-1]+"!"),n[D]&&n[D][h])A+=n[D][h].Name;else if(n[0]&&n[0][h])A+=n[0][h].Name;else{var R=(QE(n,D,s)||"").split(";;");R[h-1]?A=R[h-1]:A+="SH33TJSERRX"}l.push(A);break}z||(z={Name:"SH33TJSERRY"}),l.push(z.Name);break;case"PtgParen":var G="(",I=")";if(p>=0){switch(v="",e[0][p][1][0]){case 2:G=Ht(" ",e[0][p][1][1])+G;break;case 3:G=Ht("\r",e[0][p][1][1])+G;break;case 4:I=Ht(" ",e[0][p][1][1])+I;break;case 5:I=Ht("\r",e[0][p][1][1])+I;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(G+l.pop()+I);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[He(d)]){var j=n.sharedf[He(d)];l.push(Rr(j,o,Z,n,s))}else{var Y=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Rr(u[1],o,Z,n,s)),Y=!0;break}Y||l.push(x[1])}break;case"PtgArray":l.push("{"+v$(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&q.indexOf(e[0][b][0])==-1){x=e[0][p];var S=!0;switch(x[1][0]){case 4:S=!1;case 0:v=Ht(" ",x[1][1]);break;case 5:S=!1;case 1:v=Ht("\r",x[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}l.push((S?v:"")+l.pop()+(S?"":v)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function b$(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],Hr(e,t-2)];var l=Tu(e,o,r);return t!==o+s&&(a=ju(e,t-o-s,l,r)),e.l=n,[l,a]}function N$(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],Hr(e,t-2)];var l=Tu(e,o,r);return t!==o+s&&(a=ju(e,t-o-s,l,r)),e.l=n,[l,a]}function k$(e,t,r,n){var s=e.l+t,a=Tu(e,n,r),o;return s!==e.l&&(o=ju(e,s-e.l,a,r)),[a,o]}function _$(e,t,r){var n=e.l+t,s,a=e.read_shift(2),o=Tu(e,a,r);return a==65535?[[],Hr(e,t-2)]:(t!==a+2&&(s=ju(e,n-a-2,o,r)),[o,s])}function S$(e){var t;if(Ys(e,e.l+6)!==65535)return[Ur(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function E$(e){if(e==null){var t=de(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Xi(e);return Xi(0)}function Hh(e,t,r){var n=e.l+t,s=Vs(e);r.biff==2&&++e.l;var a=S$(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=N$(e,n-e.l,r);return{cell:s,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function C$(e,t,r,n,s){var a=Yi(t,r,s),o=E$(e.v),l=de(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=de(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=xr([a,o,l,u]);return f}function Lf(e,t,r){var n=e.read_shift(4),s=Tu(e,n,r),a=e.read_shift(4),o=a>0?ju(e,a,s,r):null;return[s,o]}var j$=Lf,Of=Lf,T$=Lf,A$=Lf,F$={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},eC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},P$={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function u2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function D$(e){var t="of:="+e.replace(Qg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Wh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function I$(e){return e.replace(/\./,"!")}var xc={},Xo={},gc=typeof Map<"u";function r1(e,t,r){var n=0,s=e.length;if(r){if(gc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=gc?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(gc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Mf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Or=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Jc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=$0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Pi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ai(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){ta(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function tC(e,t,r,n,s,a){try{n.cellNF&&(e.z=$e[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ct(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if($e[t]==null&&ta(PO[t]||"General",t),e.t==="e")e.w=e.w||xa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v);else if(e.t==="d"){var o=dr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Wc(o)}else{if(e.v===void 0)return"";e.w=Wi(e.v,Xo)}else e.t==="d"?e.w=ts(t,dr(e.v),Xo):e.w=ts(t,e.v,Xo)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=V0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=V0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function R$(e,t,r){if(e&&e["!ref"]){var n=lt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function L$(e,t){var r=lt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var O$=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,M$=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,B$=/<(?:\w:)?hyperlink [^>]*>/mg,U$=/"(\w*:\w*)"/,V$=/<(?:\w:)?col\b[^>]*[\/]?>/g,$$=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,z$=/<(?:\w:)?pageMargins[^>]*\/>/g,rC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,H$=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,W$=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function G$(e,t,r,n,s,a,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(M$);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(rC);h?n1(h[0],l,s,r):(h=u.match(H$))&&K$(h[0],h[1]||"",l,s,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=u.slice(m,m+50).match(U$);g&&L$(l,g[1])}var p=u.match(W$);p&&p[1]&&oz(p[1],s);var v=[];if(t.cellStyles){var b=u.match(V$);b&&rz(v,b)}f&&uz(f[1],l,t,c,a,o);var y=d.match($$);y&&(l["!autofilter"]=sz(y[0]));var x=[],N=d.match(O$);if(N)for(m=0;m!=N.length;++m)x[m]=lt(N[m].slice(N[m].indexOf('"')+1));var _=d.match(B$);_&&Q$(l,_,n);var k=d.match(z$);if(k&&(l["!margins"]=ez(We(k[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Ke(c)),t.sheetRows>0&&l["!ref"]){var w=lt(l["!ref"]);t.sheetRows<=+w.e.r&&(w.e.r=t.sheetRows-1,w.e.r>c.e.r&&(w.e.r=c.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>c.e.c&&(w.e.c=c.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ke(w))}return v.length>0&&(l["!cols"]=v),x.length>0&&(l["!merges"]=x),l}function X$(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ke(e[r])+'"/>';return t+"</mergeCells>"}function n1(e,t,r,n){var s=We(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ot(gt(s.codeName)))}function K$(e,t,r,n,s){n1(e.slice(0,e.indexOf(">")),r,n,s)}function Y$(e,t,r,n,s){var a=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,o.codeName=Ps(mt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Ne("outlinePr",null,u)}!a&&!l||(s[s.length]=Ne("sheetPr",l,o))}var q$=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Z$=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function J$(e){var t={sheet:1};return q$.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Z$.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=qg(e.password).toString(16).toUpperCase()),Ne("sheetProtection",null,t)}function Q$(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=We(gt(t[s]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+ot(a.location))):(a.Target="#"+ot(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=lt(a.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=He({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function ez(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function tz(e){return Pi(e),Ne("pageMargins",null,e)}function rz(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=We(t[n],!0);s.hidden&&(s.hidden=St(s.hidden));var a=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Zg(s.width)),qa(s);a<=o;)e[a++]=jt(s)}}function nz(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Ne("col",null,Mf(s,n)));return r[r.length]="</cols>",r.join("")}function sz(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function az(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=gn(s);o.s.r==o.e.r&&(o.e.r=gn(t["!ref"]).e.r,s=Ke(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ne("autoFilter",null,{ref:s})}var iz=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oz(e,t){t.Views||(t.Views=[{}]),(e.match(iz)||[]).forEach(function(r,n){var s=We(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),St(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function lz(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ne("sheetViews",Ne("sheetView",null,s),{})}function cz(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=xa[e.v];break;case"d":n&&n.cellDates?s=Ct(e.v,-1).toISOString():(e=jt(e),e.t="n",s=""+(e.v=dr(Ct(e.v)))),typeof e.z>"u"&&(e.z=$e[14]);break;default:s=e.v;break}var l=_r("v",mt(s)),c={r:t},u=ai(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=_r("v",""+r1(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ne("f",mt(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ne("c",l,c)}var uz=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Gc("v"),o=Gc("f");return function(c,u,d,f,h,m){for(var g=0,p="",v=[],b=[],y=0,x=0,N=0,_="",k,w,C=0,D=0,z,A,R=0,G=0,I=Array.isArray(m.CellXf),Z,j=[],Y=[],q=Array.isArray(u),S=[],F={},L=!1,T=!!d.sheetStubs,U=c.split(t),X=0,H=U.length;X!=H;++X){p=U[X].trim();var ee=p.length;if(ee!==0){var me=0;e:for(g=0;g<ee;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(w=We(p.slice(me,g),!0),C=w.r!=null?parseInt(w.r,10):C+1,D=-1,d.sheetRows&&d.sheetRows<C)continue;F={},L=!1,w.ht&&(L=!0,F.hpt=parseFloat(w.ht),F.hpx=ll(F.hpt)),w.hidden=="1"&&(L=!0,F.hidden=!0),w.outlineLevel!=null&&(L=!0,F.level=+w.outlineLevel),L&&(S[C-1]=F)}break;case"<":me=g;break}if(me>=g)break;if(w=We(p.slice(me,g),!0),C=w.r!=null?parseInt(w.r,10):C+1,D=-1,!(d.sheetRows&&d.sheetRows<C)){f.s.r>C-1&&(f.s.r=C-1),f.e.r<C-1&&(f.e.r=C-1),d&&d.cellStyles&&(F={},L=!1,w.ht&&(L=!0,F.hpt=parseFloat(w.ht),F.hpx=ll(F.hpt)),w.hidden=="1"&&(L=!0,F.hidden=!0),w.outlineLevel!=null&&(L=!0,F.level=+w.outlineLevel),L&&(S[C-1]=F)),v=p.slice(g).split(e);for(var le=0;le!=v.length&&v[le].trim().charAt(0)=="<";++le);for(v=v.slice(le),g=0;g!=v.length;++g)if(p=v[g].trim(),p.length!==0){if(b=p.match(r),y=g,x=0,N=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,b!=null&&b.length===2){for(y=0,_=b[1],x=0;x!=_.length&&!((N=_.charCodeAt(x)-64)<1||N>26);++x)y=26*y+N;--y,D=y}else++D;for(x=0;x!=p.length&&p.charCodeAt(x)!==62;++x);if(++x,w=We(p.slice(0,x),!0),w.r||(w.r=He({r:C-1,c:D})),_=p.slice(x),k={t:""},(b=_.match(a))!=null&&b[1]!==""&&(k.v=ot(b[1])),d.cellFormula){if((b=_.match(o))!=null&&b[1]!==""){if(k.f=ot(gt(b[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=i2(k.f)),b[0].indexOf('t="array"')>-1)k.F=(_.match(s)||[])[1],k.F.indexOf(":")>-1&&j.push([lt(k.F),k.F]);else if(b[0].indexOf('t="shared"')>-1){A=We(b[0]);var ce=ot(gt(b[1]));d.xlfn||(ce=i2(ce)),Y[parseInt(A.si,10)]=[A,ce,w.r]}}else(b=_.match(/<f[^>]*\/>/))&&(A=We(b[0]),Y[A.si]&&(k.f=iV(Y[A.si][1],Y[A.si][2],w.r)));var J=Ot(w.r);for(x=0;x<j.length;++x)J.r>=j[x][0].s.r&&J.r<=j[x][0].e.r&&J.c>=j[x][0].s.c&&J.c<=j[x][0].e.c&&(k.F=j[x][1])}if(w.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(T)k.t="z";else continue;else k.t=w.t||"n";switch(f.s.c>D&&(f.s.c=D),f.e.c<D&&(f.e.c=D),k.t){case"n":if(k.v==""||k.v==null){if(!T)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!T)continue;k.t="z"}else z=xc[parseInt(k.v,10)],k.v=z.t,k.r=z.r,d.cellHTML&&(k.h=z.h);break;case"str":k.t="s",k.v=k.v!=null?gt(k.v):"",d.cellHTML&&(k.h=Rg(k.v));break;case"inlineStr":b=_.match(n),k.t="s",b!=null&&(z=Yg(b[1]))?(k.v=z.t,d.cellHTML&&(k.h=z.h)):k.v="";break;case"b":k.v=St(k.v);break;case"d":d.cellDates?k.v=Ct(k.v,1):(k.v=dr(Ct(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=sE[k.v];break}if(R=G=0,Z=null,I&&w.s!==void 0&&(Z=m.CellXf[w.s],Z!=null&&(Z.numFmtId!=null&&(R=Z.numFmtId),d.cellStyles&&Z.fillId!=null&&(G=Z.fillId))),tC(k,R,G,d,h,m),d.cellDates&&I&&k.t=="n"&&wl($e[R])&&(k.t="d",k.v=If(k.v)),w.cm&&d.xlmeta){var Se=(d.xlmeta.Cell||[])[+w.cm-1];Se&&Se.type=="XLDAPR"&&(k.D=!0)}if(q){var B=Ot(w.r);u[B.r]||(u[B.r]=[]),u[B.r][B.c]=k}else u[w.r]=k}}}}S.length>0&&(u["!rows"]=S)}}();function dz(e,t,r,n){var s=[],a=[],o=lt(e["!ref"]),l="",c,u="",d=[],f=0,h=0,m=e["!rows"],g=Array.isArray(e),p={r:u},v,b=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=Lt(h);for(f=o.s.r;f<=o.e.r;++f){for(a=[],u=Jt(f),h=o.s.c;h<=o.e.c;++h){c=d[h]+u;var y=g?(e[f]||[])[h]:e[c];y!==void 0&&(l=cz(y,c,e,t))!=null&&a.push(l)}(a.length>0||m&&m[f])&&(p={r:u},m&&m[f]&&(v=m[f],v.hidden&&(p.hidden=1),b=-1,v.hpx?b=Qc(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(p.ht=b,p.customHeight=1),v.level&&(p.outlineLevel=v.level)),s[s.length]=Ne("row",a.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},v=m[f],v.hidden&&(p.hidden=1),b=-1,v.hpx?b=Qc(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(p.ht=b,p.customHeight=1),v.level&&(p.outlineLevel=v.level),s[s.length]=Ne("row","",p));return s.join("")}function nC(e,t,r,n){var s=[er,Ne("worksheet",null,{xmlns:so[0],"xmlns:r":lr.r})],a=r.SheetNames[e],o=0,l="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=lt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Ke(d)}n||(n={}),c["!comments"]=[];var f=[];Y$(c,r,e,t,s),s[s.length]=Ne("dimension",null,{ref:u}),s[s.length]=lz(c,t,e,r),t.sheetFormat&&(s[s.length]=Ne("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=nz(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=dz(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=J$(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=az(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=X$(c["!merges"]));var h=-1,m,g=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=ht(n,-1,mt(p[1].Target).replace(/#.*$/,""),Qe.HLINK),m["r:id"]="rId"+g),(h=p[1].Target.indexOf("#"))>-1&&(m.location=mt(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=mt(p[1].Tooltip)),s[s.length]=Ne("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=tz(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=_r("ignoredErrors",Ne("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=ht(n,-1,"../drawings/drawing"+(e+1)+".xml",Qe.DRAW),s[s.length]=Ne("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=ht(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Qe.VML),s[s.length]=Ne("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function fz(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function hz(e,t,r){var n=de(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=Qc(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[He(u)];g&&(f<0&&(f=m),h=m)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function mz(e,t,r,n){var s=hz(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&xe(e,0,s)}var pz=lo,xz=kl;function gz(){}function vz(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=b7(e),r}function yz(e,t,r){r==null&&(r=de(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return M0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),QS(e,r),r.slice(0,r.l)}function wz(e){var t=rs(e);return[t]}function bz(e,t,r){return r==null&&(r=de(8)),ao(t,r)}function Nz(e){var t=io(e);return[t]}function kz(e,t,r){return r==null&&(r=de(4)),oo(t,r)}function _z(e){var t=rs(e),r=e.read_shift(1);return[t,r,"b"]}function Sz(e,t,r){return r==null&&(r=de(9)),ao(t,r),r.write_shift(1,e.v?1:0),r}function Ez(e){var t=io(e),r=e.read_shift(1);return[t,r,"b"]}function Cz(e,t,r){return r==null&&(r=de(5)),oo(t,r),r.write_shift(1,e.v?1:0),r}function jz(e){var t=rs(e),r=e.read_shift(1);return[t,r,"e"]}function Tz(e,t,r){return r==null&&(r=de(9)),ao(t,r),r.write_shift(1,e.v),r}function Az(e){var t=io(e),r=e.read_shift(1);return[t,r,"e"]}function Fz(e,t,r){return r==null&&(r=de(8)),oo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Pz(e){var t=rs(e),r=e.read_shift(4);return[t,r,"s"]}function Dz(e,t,r){return r==null&&(r=de(12)),ao(t,r),r.write_shift(4,t.v),r}function Iz(e){var t=io(e),r=e.read_shift(4);return[t,r,"s"]}function Rz(e,t,r){return r==null&&(r=de(8)),oo(t,r),r.write_shift(4,t.v),r}function Lz(e){var t=rs(e),r=Ur(e);return[t,r,"n"]}function Oz(e,t,r){return r==null&&(r=de(16)),ao(t,r),Xi(e.v,r),r}function sC(e){var t=io(e),r=Ur(e);return[t,r,"n"]}function Mz(e,t,r){return r==null&&(r=de(12)),oo(t,r),Xi(e.v,r),r}function Bz(e){var t=rs(e),r=Hg(e);return[t,r,"n"]}function Uz(e,t,r){return r==null&&(r=de(12)),ao(t,r),eE(e.v,r),r}function Vz(e){var t=io(e),r=Hg(e);return[t,r,"n"]}function $z(e,t,r){return r==null&&(r=de(8)),oo(t,r),eE(e.v,r),r}function zz(e){var t=rs(e),r=Vg(e);return[t,r,"is"]}function Hz(e){var t=rs(e),r=Vr(e);return[t,r,"str"]}function Wz(e,t,r){return r==null&&(r=de(12+4*e.v.length)),ao(t,r),vr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Gz(e){var t=io(e),r=Vr(e);return[t,r,"str"]}function Xz(e,t,r){return r==null&&(r=de(8+4*e.v.length)),oo(t,r),vr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Kz(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"b"];if(r.cellFormula){e.l+=2;var l=Of(e,n-e.l,r);o[3]=Rr(l,null,s,r.supbooks,r)}else e.l=n;return o}function Yz(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"e"];if(r.cellFormula){e.l+=2;var l=Of(e,n-e.l,r);o[3]=Rr(l,null,s,r.supbooks,r)}else e.l=n;return o}function qz(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=Ur(e),o=[s,a,"n"];if(r.cellFormula){e.l+=2;var l=Of(e,n-e.l,r);o[3]=Rr(l,null,s,r.supbooks,r)}else e.l=n;return o}function Zz(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=Vr(e),o=[s,a,"str"];if(r.cellFormula){e.l+=2;var l=Of(e,n-e.l,r);o[3]=Rr(l,null,s,r.supbooks,r)}else e.l=n;return o}var Jz=lo,Qz=kl;function eH(e,t){return t==null&&(t=de(4)),t.write_shift(4,e),t}function tH(e,t){var r=e.l+t,n=lo(e),s=$g(e),a=Vr(e),o=Vr(e),l=Vr(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:l};return o&&(c.Tooltip=o),c}function rH(e,t){var r=de(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));kl({s:Ot(e[0]),e:Ot(e[0])},r),zg("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return vr(s||"",r),vr(e[1].Tooltip||"",r),vr("",r),r.slice(0,r.l)}function nH(){}function sH(e,t,r){var n=e.l+t,s=tE(e),a=e.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=j$(e,n-e.l,r);o[1]=l}else e.l=n;return o}function aH(e,t,r){var n=e.l+t,s=lo(e),a=[s];if(r.cellFormula){var o=A$(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}function iH(e,t,r){r==null&&(r=de(18));var n=Mf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var aC=["left","right","top","bottom","header","footer"];function oH(e){var t={};return aC.forEach(function(r){t[r]=Ur(e)}),t}function lH(e,t){return t==null&&(t=de(6*8)),Pi(e),aC.forEach(function(r){Xi(e[r],t)}),t}function cH(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function uH(e,t,r){r==null&&(r=de(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function dH(e){var t=de(24);return t.write_shift(4,4),t.write_shift(4,1),kl(e,t),t}function fH(e,t){return t==null&&(t=de(16*4+2)),t.write_shift(2,e.password?qg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function hH(){}function mH(){}function pH(e,t,r,n,s,a,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,g,p,v,b,y,x,N,_,k=[];l.biff=12,l["!row"]=0;var w=0,C=!1,D=[],z={},A=l.supbooks||s.supbooks||[[]];if(A.sharedf=z,A.arrayf=D,A.SheetNames=s.SheetNames||s.Sheets.map(function(q){return q.name}),!l.supbooks&&(l.supbooks=A,s.Names))for(var R=0;R<s.Names.length;++R)A[0][R+1]=s.Names[R];var G=[],I=[],Z=!1;eu[16]={n:"BrtShortReal",f:sC};var j;if(pa(e,function(S,F,L){if(!h)switch(L){case 148:u=S;break;case 0:m=S,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),N=Jt(v=m.r),l["!row"]=m.r,(S.hidden||S.hpt||S.level!=null)&&(S.hpt&&(S.hpx=ll(S.hpt)),I[S.r]=S);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:S[2]},S[2]){case"n":g.v=S[1];break;case"s":x=xc[S[1]],g.v=x.t,g.r=x.r;break;case"b":g.v=!!S[1];break;case"e":g.v=S[1],l.cellText!==!1&&(g.w=xa[g.v]);break;case"str":g.t="s",g.v=S[1];break;case"is":g.t="s",g.v=S[1].t;break}if((p=o.CellXf[S[0].iStyleRef])&&tC(g,p.numFmtId,null,l,a,o),b=S[0].c==-1?b+1:S[0].c,l.dense?(c[v]||(c[v]=[]),c[v][b]=g):c[Lt(b)+N]=g,l.cellFormula){for(C=!1,w=0;w<D.length;++w){var T=D[w];m.r>=T[0].s.r&&m.r<=T[0].e.r&&b>=T[0].s.c&&b<=T[0].e.c&&(g.F=Ke(T[0]),C=!0)}!C&&S.length>3&&(g.f=S[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>b&&(d.s.c=b),d.e.r<m.r&&(d.e.r=m.r),d.e.c<b&&(d.e.c=b),l.cellDates&&p&&g.t=="n"&&wl($e[p.numFmtId])){var U=_i(g.v);U&&(g.t="d",g.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}j&&(j.type=="XLDAPR"&&(g.D=!0),j=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;g={t:"z",v:void 0},b=S[0].c==-1?b+1:S[0].c,l.dense?(c[v]||(c[v]=[]),c[v][b]=g):c[Lt(b)+N]=g,d.s.r>m.r&&(d.s.r=m.r),d.s.c>b&&(d.s.c=b),d.e.r<m.r&&(d.e.r=m.r),d.e.c<b&&(d.e.c=b),j&&(j.type=="XLDAPR"&&(g.D=!0),j=void 0);break;case 176:k.push(S);break;case 49:j=((l.xlmeta||{}).Cell||[])[S-1];break;case 494:var X=n["!id"][S.relId];for(X?(S.Target=X.Target,S.loc&&(S.Target+="#"+S.loc),S.Rel=X):S.relId==""&&(S.Target="#"+S.loc),v=S.rfx.s.r;v<=S.rfx.e.r;++v)for(b=S.rfx.s.c;b<=S.rfx.e.c;++b)l.dense?(c[v]||(c[v]=[]),c[v][b]||(c[v][b]={t:"z",v:void 0}),c[v][b].l=S):(y=He({c:b,r:v}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=S);break;case 426:if(!l.cellFormula)break;D.push(S),_=l.dense?c[v][b]:c[Lt(b)+N],_.f=Rr(S[1],d,{r:m.r,c:b},A,l),_.F=Ke(S[0]);break;case 427:if(!l.cellFormula)break;z[He(S[0].s)]=S[1],_=l.dense?c[v][b]:c[Lt(b)+N],_.f=Rr(S[1],d,{r:m.r,c:b},A,l);break;case 60:if(!l.cellStyles)break;for(;S.e>=S.s;)G[S.e--]={width:S.w/256,hidden:!!(S.flags&1),level:S.level},Z||(Z=!0,Zg(S.w/256)),qa(G[S.e+1]);break;case 161:c["!autofilter"]={ref:Ke(S)};break;case 476:c["!margins"]=S;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),S.name&&(s.Sheets[r].CodeName=S.name),(S.above||S.left)&&(c["!outline"]={above:S.above,left:S.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),S.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!F.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+L.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ke(u||d)),l.sheetRows&&c["!ref"]){var Y=lt(c["!ref"]);l.sheetRows<=+Y.e.r&&(Y.e.r=l.sheetRows-1,Y.e.r>d.e.r&&(Y.e.r=d.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>d.e.c&&(Y.e.c=d.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ke(Y))}return k.length>0&&(c["!merges"]=k),G.length>0&&(c["!cols"]=G),I.length>0&&(c["!rows"]=I),c}function xH(e,t,r,n,s,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=jt(t),t.z=t.z||$e[14],t.v=dr(Ct(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=ai(s.cellXfs,t,s),t.l&&a["!links"].push([He(c),t.l]),t.c&&a["!comments"].push([He(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=r1(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?xe(e,18,Rz(t,c)):xe(e,7,Dz(t,c))):(c.t="str",o?xe(e,17,Xz(t,c)):xe(e,6,Wz(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?xe(e,13,$z(t,c)):xe(e,2,Uz(t,c)):o?xe(e,16,Mz(t,c)):xe(e,5,Oz(t,c)),!0;case"b":return c.t="b",o?xe(e,15,Cz(t,c)):xe(e,4,Sz(t,c)),!0;case"e":return c.t="e",o?xe(e,14,Fz(t,c)):xe(e,3,Tz(t,c)),!0}return o?xe(e,12,kz(t,c)):xe(e,1,bz(t,c)),!0}function gH(e,t,r,n){var s=lt(t["!ref"]||"A1"),a,o="",l=[];xe(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){o=Jt(d),mz(e,t,s,d);var f=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(l[h]=Lt(h)),a=l[h]+o;var m=c?(t[d]||[])[h]:t[a];if(!m){f=!1;continue}f=xH(e,m,d,h,n,t,f)}}xe(e,146)}function vH(e,t){!t||!t["!merges"]||(xe(e,177,eH(t["!merges"].length)),t["!merges"].forEach(function(r){xe(e,176,Qz(r))}),xe(e,178))}function yH(e,t){!t||!t["!cols"]||(xe(e,390),t["!cols"].forEach(function(r,n){r&&xe(e,60,iH(n,r))}),xe(e,391))}function wH(e,t){!t||!t["!ref"]||(xe(e,648),xe(e,649,dH(lt(t["!ref"]))),xe(e,650))}function bH(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=ht(r,-1,n[1].Target.replace(/#.*$/,""),Qe.HLINK);xe(e,494,rH(n,s))}}),delete t["!links"]}function NH(e,t,r,n){if(t["!comments"].length>0){var s=ht(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Qe.VML);xe(e,551,zg("rId"+s)),t["!legacy"]=s}}function kH(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Ke(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=gn(a);l.s.r==l.e.r&&(l.e.r=gn(t["!ref"]).e.r,a=Ke(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),xe(e,161,kl(lt(a))),xe(e,162)}}function _H(e,t,r){xe(e,133),xe(e,137,uH(t,r)),xe(e,138),xe(e,134)}function SH(e,t){t["!protect"]&&xe(e,535,fH(t["!protect"]))}function EH(e,t,r,n){var s=mn(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=lt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],xe(s,129),(r.vbaraw||o["!outline"])&&xe(s,147,yz(l,o["!outline"])),xe(s,148,xz(c)),_H(s,o,r.Workbook),yH(s,o),gH(s,o,e,t),SH(s,o),kH(s,o,r,e),vH(s,o),bH(s,o,n),o["!margins"]&&xe(s,476,lH(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&wH(s,o),NH(s,o,e,n),xe(s,130),s.end()}function CH(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=ot((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function jH(e,t,r,n,s,a){var o=a||{"!type":"chart"};if(!e)return a;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=CH(f);d.s.r=d.s.c=0,d.e.c=l,u=Lt(l),h[0].forEach(function(m,g){o[u+Jt(g)]={t:"n",v:m,z:h[1]},c=g}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=Ke(d)),o}function TH(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(rC);return l&&n1(l[0],a,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function AH(e,t){e.l+=10;var r=Vr(e);return{name:r}}function FH(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return pa(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var s1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],PH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],DH=[],IH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function d2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=St(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function f2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=St(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function iC(e){f2(e.WBProps,s1),f2(e.CalcPr,IH),d2(e.WBView,PH),d2(e.Sheets,DH),Xo.date1904=St(e.WBProps.date1904)}function RH(e){return!e.Workbook||!e.Workbook.WBProps?"false":St(e.Workbook.WBProps.date1904)?"true":"false"}var LH="][*?/\\".split("");function oC(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return LH.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function OH(e,t,r){e.forEach(function(n,s){oC(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function MH(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];OH(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)R$(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var BH=/<\w+:workbook/;function UH(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},o=0;if(e.replace(Wr,function(c,u){var d=We(c);switch(Us(d[0])){case"<?xml":break;case"<workbook":c.match(BH)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":s1.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=St(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=gt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=ot(gt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=gt(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),St(d.hidden||"0")&&(a.Hidden=!0),o=u+c.length;break;case"</definedName>":a.Ref=ot(gt(e.slice(o,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),so.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return iC(r),r}function lC(e){var t=[er];t[t.length]=Ne("workbook",null,{xmlns:so[0],"xmlns:r":lr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(s1.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ne("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:mt(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ne("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Ne("definedName",mt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function VH(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=kp(e),r.name=Vr(e),r}function $H(e,t){return t||(t=de(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),zg(e.strRelID,t),vr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function zH(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Vr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function HH(e,t){t||(t=de(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),QS(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function WH(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function GH(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=N7(e),o=T$(e,0,r),l=$g(e);e.l=n;var c={Name:a,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function XH(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],eu[16]={n:"BrtFRTArchID$",f:WH},pa(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Rr(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),iC(r),r.Names=a,r.supbooks=o,r}function KH(e,t){xe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xe(e,156,$H(s))}xe(e,144)}function YH(e,t){t||(t=de(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return vr("SheetJS",t),vr(F0.version,t),vr(F0.version,t),vr("7262",t),t.length>t.l?t.slice(0,t.l):t}function qH(e,t){t||(t=de(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ZH(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(xe(e,135),xe(e,158,qH(s)),xe(e,136))}}function JH(e,t){var r=mn();return xe(r,131),xe(r,128,YH()),xe(r,153,HH(e.Workbook&&e.Workbook.WBProps||null)),ZH(r,e),KH(r,e),xe(r,132),r.end()}function QH(e,t,r){return t.slice(-4)===".bin"?XH(e,r):UH(e,r)}function eW(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?pH(e,n,r,s,a,o,l):G$(e,n,r,s,a,o,l)}function tW(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?FH(e,n,r,s,a):TH(e,n,r,s,a)}function rW(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?sV():aV()}function nW(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?rV():nV()}function sW(e,t,r,n){return t.slice(-4)===".bin"?QB(e,r,n):VB(e,r,n)}function aW(e,t,r){return $E(e,r)}function iW(e,t,r){return t.slice(-4)===".bin"?iB(e,r):nB(e,r)}function oW(e,t,r){return t.slice(-4)===".bin"?ZU(e,r):$U(e,r)}function lW(e,t,r){return t.slice(-4)===".bin"?BU(e):OU(e)}function cW(e,t,r,n){return r.slice(-4)===".bin"?UU(e,t,r,n):void 0}function uW(e,t,r){return t.slice(-4)===".bin"?IU(e,t,r):LU(e,t,r)}function dW(e,t,r){return(t.slice(-4)===".bin"?JH:lC)(e)}function fW(e,t,r,n,s){return(t.slice(-4)===".bin"?EH:nC)(e,r,n,s)}function hW(e,t,r){return(t.slice(-4)===".bin"?cU:UE)(e,r)}function mW(e,t,r){return(t.slice(-4)===".bin"?cB:PE)(e,r)}function pW(e,t,r){return(t.slice(-4)===".bin"?JU:WE)(e)}function xW(e){return(e.slice(-4)===".bin"?RU:zE)()}var cC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,uC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function os(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var s=e.match(cC),a,o,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(uC),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function gW(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(cC),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(uC),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}var vc;function vW(e,t){var r=vc[e]||ot(e);return r==="General"?Wi(t):ts(r,t)}function yW(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=St(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Ct(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ot(t)]=s}function wW(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=Wi(e.v):e.w=vW(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=vc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&wl(n)){var s=_i(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function bW(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=DB[n.Pattern]||n.Pattern)}e[t.ID]=t}function NW(e,t,r,n,s,a,o,l,c,u){var d="General",f=n.StyleID,h={};u=u||{};var m=[],g=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&m.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=St(e);break;case"String":n.t="s",n.r=Tw(ot(e)),n.v=e.indexOf("<")>-1?ot(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ct(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ot(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=sE[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Tw(t||e));break}if(wW(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=ot(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Go(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Go("RC:RC",s):n.ArrayRange&&(n.F=Go(n.ArrayRange,s),c.push([lt(n.F),n.F]))}else for(g=0;g<c.length;++g)s.r>=c[g][0].s.r&&s.r<=c[g][0].e.r&&s.c>=c[g][0].s.c&&s.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(m.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function kW(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Gh(e,t){var r=t||{};bl();var n=Kl(Lg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=gt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=jt(r);return o.type="string",ol.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ae){s.indexOf("<"+Ae)>=0&&(a=!0)}),a)return lG(n,r);vc={"General Number":"General","General Date":$e[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$e[15],"Short Date":$e[14],"Long Time":$e[19],"Medium Time":$e[18],"Short Time":$e[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$e[2],Standard:$e[4],Percent:$e[10],Scientific:$e[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},m="",g={},p={},v=os('<Data ss:Type="String">'),b=0,y=0,x=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},k={},w="",C=0,D=[],z={},A={},R=0,G=[],I=[],Z={},j=[],Y,q=!1,S=[],F=[],L={},T=0,U=0,X={Sheets:[],WBProps:{date1904:!1}},H={};Kc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";l=Kc.exec(n);)switch(l[3]=(ee=l[3]).toLowerCase()){case"data":if(ee=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?NW(n.slice(b,l.index),w,v,c[c.length-1][0]=="comment"?Z:g,{c:y,r:x},_,j[y],p,S,r):(w="",v=os(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(I.length>0&&(g.c=I),(!r.sheetRows||r.sheetRows>x)&&g.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][y]=g):h[Lt(y)+Jt(x)]=g),g.HRef&&(g.l={Target:ot(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(T=y+(parseInt(g.MergeAcross,10)|0),U=x+(parseInt(g.MergeDown,10)|0),D.push({s:{c:y,r:x},e:{c:T,r:U}})),!r.sheetStubs)g.MergeAcross?y=T+1:++y;else if(g.MergeAcross||g.MergeDown){for(var me=y;me<=T;++me)for(var le=x;le<=U;++le)(me>y||le>x)&&(r.dense?(h[le]||(h[le]=[]),h[le][me]={t:"z"}):h[Lt(me)+Jt(le)]={t:"z"});y=T+1}else++y;else g=gW(l[0]),g.Index&&(y=+g.Index-1),y<N.s.c&&(N.s.c=y),y>N.e.c&&(N.e.c=y),l[0].slice(-2)==="/>"&&++y,I=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(x<N.s.r&&(N.s.r=x),x>N.e.r&&(N.e.r=x),l[0].slice(-2)==="/>"&&(p=os(l[0]),p.Index&&(x=+p.Index-1)),y=0,++x):(p=os(l[0]),p.Index&&(x=+p.Index-1),L={},(p.AutoFitHeight=="0"||p.Height)&&(L.hpx=parseInt(p.Height,10),L.hpt=Qc(L.hpx),F[x]=L),p.Hidden=="1"&&(L.hidden=!0,F[x]=L));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(m),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(h["!ref"]=Ke(N),r.sheetRows&&r.sheetRows<=N.e.r&&(h["!fullref"]=h["!ref"],N.e.r=r.sheetRows-1,h["!ref"]=Ke(N))),D.length&&(h["!merges"]=D),j.length>0&&(h["!cols"]=j),F.length>0&&(h["!rows"]=F),d[m]=h}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,c.push([l[3],!1]),u=os(l[0]),m=ot(u.Name),h=r.dense?[]:{},D=[],S=[],F=[],H={name:m,Hidden:0},X.Sheets.push(H);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),j=[],q=!1}break;case"style":l[1]==="/"?bW(_,k,r):k=os(l[0]);break;case"numberformat":k.nf=ot(os(l[0]).Format||"General"),vc[k.nf]&&(k.nf=vc[k.nf]);for(var ce=0;ce!=392&&$e[ce]!=k.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if($e[ce]==null){ta(k.nf,ce);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Y=os(l[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!q&&Y.wpx>10){q=!0,Or=ME;for(var J=0;J<j.length;++J)j[J]&&qa(j[J])}q&&qa(Y),j[Y.Index-1||j.length]=Y;for(var Se=0;Se<+Y.Span;++Se)j[j.length]=jt(Y);break;case"namedrange":if(l[1]==="/")break;X.Names||(X.Names=[]);var B=We(l[0]),je={Name:B.Name,Ref:Go(B.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(je.Sheet=X.Sheets.length-1),X.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?w+=n.slice(C,l.index):C=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=os(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?X7(z,ee,n.slice(R,l.index)):R=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));kW(Z),I.push(Z)}else c.push([l[3],!1]),u=os(l[0]),Z={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var _e=os(l[0]);h["!autofilter"]={ref:Go(_e.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return g2(n,r);var Re=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Re=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Re=!1}break;case"excelworkbook":switch(l[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Re=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Re=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(R,l.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else R=l.index+l[0].length;break;case"header":h["!margins"]||Pi(h["!margins"]={},"xlml"),isNaN(+We(l[0]).Margin)||(h["!margins"].header=+We(l[0]).Margin);break;case"footer":h["!margins"]||Pi(h["!margins"]={},"xlml"),isNaN(+We(l[0]).Margin)||(h["!margins"].footer=+We(l[0]).Margin);break;case"pagemargins":var Te=We(l[0]);h["!margins"]||Pi(h["!margins"]={},"xlml"),isNaN(+Te.Top)||(h["!margins"].top=+Te.Top),isNaN(+Te.Left)||(h["!margins"].left=+Te.Left),isNaN(+Te.Right)||(h["!margins"].right=+Te.Right),isNaN(+Te.Bottom)||(h["!margins"].bottom=+Te.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Re=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Re=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Re=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Re=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Re=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Re=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Re=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Re=!1}break;case"smarttags":break;default:Re=!1;break}if(Re||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?yW(A,ee,G,n.slice(R,l.index)):(G=l,R=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var pe={};return!r.bookSheets&&!r.bookProps&&(pe.Sheets=d),pe.SheetNames=f,pe.Workbook=X,pe.SSF=jt($e),pe.Props=z,pe.Custprops=A,pe}function Ap(e,t){switch(i1(t=t||{}),t.type||"base64"){case"base64":return Gh(An(e),t);case"binary":case"buffer":case"file":return Gh(e,t);case"array":return Gh(ni(e),t)}}function _W(e,t){var r=[];return e.Props&&r.push(K7(e.Props,t)),e.Custprops&&r.push(Y7(e.Props,e.Custprops)),r.join("")}function SW(){return""}function EW(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Ne("NumberFormat",null,{"ss:Format":mt($e[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Ne("Style",a.join(""),o))}),Ne("Styles",r.join(""))}function dC(e){return Ne("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+e1(e.Ref,{r:0,c:0})})}function CW(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(dC(s)))}return Ne("Names",r.join(""))}function jW(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(dC(l)))}return a.join("")}function TW(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ne("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ne("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ne("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Ne("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(_r("ProtectContents","True")),e["!protect"].objects&&s.push(_r("ProtectObjects","True")),e["!protect"].scenarios&&s.push(_r("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(_r("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(_r("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ne("WorksheetOptions",s.join(""),{xmlns:yn.x})}function AW(e){return e.map(function(t){var r=ZO(t.t||""),n=Ne("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ne("Comment",n,{"ss:Author":t.a})}).join("")}function FW(e,t,r,n,s,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+mt(e1(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Ot(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=mt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=mt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=xa[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||$e[14]);break;case"s":f="String",h=qO(e.v||"");break}var m=ai(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var g=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=AW(e.c)),Ne("Cell",p,l)}function PW(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ll(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function DW(e,t,r,n){if(!e["!ref"])return"";var s=lt(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(v,b){qa(v);var y=!!v.width,x=Mf(b,v),N={"ss:Index":b+1};y&&(N["ss:Width"]=Zc(x.width)),v.hidden&&(N["ss:Hidden"]="1"),l.push(Ne("Column",null,N))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[PW(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>f)&&!(a[o].s.r>u)&&!(a[o].e.c<f)&&!(a[o].e.r<u)){(a[o].s.c!=f||a[o].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},g=He(m),p=c?(e[u]||[])[f]:e[g];d.push(FW(p,g,e,t,r,n,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function IW(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],o=a?jW(a,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?DW(a,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(TW(a,t,e,r)),n.join("")}function RW(e,t){t||(t={}),e.SSF||(e.SSF=jt($e)),e.SSF&&(bl(),Ff(e.SSF),t.revssf=Df(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ai(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(_W(e,t)),r.push(SW()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ne("Worksheet",IW(n,t,e),{"ss:Name":mt(e.SheetNames[n])}));return r[2]=EW(e,t),r[3]=CW(e),er+Ne("Workbook",r.join(""),{xmlns:yn.ss,"xmlns:o":yn.o,"xmlns:x":yn.x,"xmlns:ss":yn.ss,"xmlns:dt":yn.dt,"xmlns:html":yn.html})}function LW(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=C7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=j7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var OW=[60,1084,2066,2165,2175];function MW(e,t,r,n,s){var a=n,o=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=a;for(var c=Ys(r,r.l),u=Fp[c],d=0;u!=null&&OW.indexOf(c)>-1;)a=Ys(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+a),o.push(l),r.l+=4+a,u=Fp[c=Ys(r,r.l)];var f=xr(o);kr(f,0);var h=0;f.lens=[];for(var m=0;m<o.length;++m)f.lens.push(h),h+=o[m].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function ks(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=$e[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=Wi(e.v):e.w=ts(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&wl($e[n]||String(n))){var s=_i(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function md(e,t,r){return{v:e,ixfe:t,t:r}}function BW(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},o={},l=null,c=[],u="",d={},f,h="",m,g,p,v,b={},y=[],x,N,_=[],k=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},D=function(qe){return qe<8?Ti[qe]:qe<64&&k[qe-8]||Ti[qe]},z=function(qe,At,Gr){var Vt=At.XF.data;if(!(!Vt||!Vt.patternType||!Gr||!Gr.cellStyles)){At.s={},At.s.patternType=Vt.patternType;var ws;(ws=qc(D(Vt.icvFore)))&&(At.s.fgColor={rgb:ws}),(ws=qc(D(Vt.icvBack)))&&(At.s.bgColor={rgb:ws})}},A=function(qe,At,Gr){if(!(L>1)&&!(Gr.sheetRows&&qe.r>=Gr.sheetRows)){if(Gr.cellStyles&&At.XF&&At.XF.data&&z(qe,At,Gr),delete At.ixfe,delete At.XF,f=qe,h=He(qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),qe.r<o.s.r&&(o.s.r=qe.r),qe.c<o.s.c&&(o.s.c=qe.c),qe.r+1>o.e.r&&(o.e.r=qe.r+1),qe.c+1>o.e.c&&(o.e.c=qe.c+1),Gr.cellFormula&&At.f){for(var Vt=0;Vt<y.length;++Vt)if(!(y[Vt][0].s.c>qe.c||y[Vt][0].s.r>qe.r)&&!(y[Vt][0].e.c<qe.c||y[Vt][0].e.r<qe.r)){At.F=Ke(y[Vt][0]),(y[Vt][0].s.c!=qe.c||y[Vt][0].s.r!=qe.r)&&delete At.f,At.f&&(At.f=""+Rr(y[Vt][1],o,qe,S,R));break}}Gr.dense?(s[qe.r]||(s[qe.r]=[]),s[qe.r][qe.c]=At):s[h]=At}},R={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(R.password=t.password);var G,I=[],Z=[],j=[],Y=[],q=!1,S=[];S.SheetNames=R.snames,S.sharedf=R.sharedf,S.arrayf=R.arrayf,S.names=[],S.XTI=[];var F=0,L=0,T=0,U=[],X=[],H;R.codepage=1200,ds(1200);for(var ee=!1;e.l<e.length-1;){var me=e.l,le=e.read_shift(2);if(le===0&&F===10)break;var ce=e.l===e.length?0:e.read_shift(2),J=Fp[le];if(J&&J.f){if(t.bookSheets&&F===133&&le!==133)break;if(F=le,J.r===2||J.r==12){var Se=e.read_shift(2);if(ce-=2,!R.enc&&Se!==le&&((Se&255)<<8|Se>>8)!==le)throw new Error("rt mismatch: "+Se+"!="+le);J.r==12&&(e.l+=10,ce-=10)}var B={};if(le===10?B=J.f(e,ce,R):B=MW(le,J,e,ce,R),L==0&&[9,521,1033,2057].indexOf(F)===-1)continue;switch(le){case 34:r.opts.Date1904=w.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(e.l=0),R.enc=B,!t.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=B;break;case 66:var je=Number(B);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}ds(R.codepage=je),ee=!0;break;case 317:R.rrtabid=B;break;case 25:R.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:R.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(s["!type"]="dialog"),B.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),B.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:_.push(B);break;case 430:S.push([B]),S[S.length-1].XTI=[];break;case 35:case 547:S[S.length-1].push(B);break;case 24:case 536:H={Name:B.Name,Ref:Rr(B.rgce,o,null,S,R)},B.itab>0&&(H.Sheet=B.itab-1),S.names.push(H),S[0]||(S[0]=[],S[0].XTI=[]),S[S.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(X[B.itab-1]={ref:Ke(B.rgce[0][0][1][2])});break;case 22:R.ExternCount=B;break;case 23:S.length==0&&(S[0]=[],S[0].XTI=[]),S[S.length-1].XTI=S[S.length-1].XTI.concat(B),S.XTI=S.XTI.concat(B);break;case 2196:if(R.biff<8)break;H!=null&&(H.Comment=B[1]);break;case 18:s["!protect"]=B;break;case 19:B!==0&&R.WTF&&console.error("Password verifier: "+B);break;case 133:a[B.pos]=B,R.snames.push(B.name);break;case 10:{if(--L)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Ke(o),t.sheetRows&&t.sheetRows<=o.e.r){var _e=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ke(o),o.e.r=_e}o.e.r++,o.e.c++}I.length>0&&(s["!merges"]=I),Z.length>0&&(s["!objects"]=Z),j.length>0&&(s["!cols"]=j),Y.length>0&&(s["!rows"]=Y),w.Sheets.push(C)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),R.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(R.biff=5,ee=!0,ds(R.codepage=28591)),R.biff==8&&B.BIFFVer==0&&B.dt==16&&(R.biff=2),L++)break;if(s=t.dense?[]:{},R.biff<8&&!ee&&(ee=!0,ds(R.codepage=t.codepage||1252)),R.biff<5||B.BIFFVer==0&&B.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Re={pos:e.l-ce,name:u};a[Re.pos]=Re,R.snames.push(u)}else u=(a[me]||{name:""}).name;B.dt==32&&(s["!type"]="chart"),B.dt==64&&(s["!type"]="macro"),I=[],Z=[],R.arrayf=y=[],j=[],Y=[],q=!1,C={Hidden:(a[me]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[B.r]||[])[B.c]:s[He({c:B.c,r:B.r})])&&++B.c,x={ixfe:B.ixfe,XF:_[B.ixfe]||{},v:B.val,t:"n"},T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:B.c,r:B.r},x,t);break;case 5:case 517:x={ixfe:B.ixfe,XF:_[B.ixfe],v:B.val,t:B.t},T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:B.c,r:B.r},x,t);break;case 638:x={ixfe:B.ixfe,XF:_[B.ixfe],v:B.rknum,t:"n"},T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:B.c,r:B.r},x,t);break;case 189:for(var Te=B.c;Te<=B.C;++Te){var pe=B.rkrec[Te-B.c][0];x={ixfe:pe,XF:_[pe],v:B.rkrec[Te-B.c][1],t:"n"},T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:Te,r:B.r},x,t)}break;case 6:case 518:case 1030:{if(B.val=="String"){l=B;break}if(x=md(B.val,B.cell.ixfe,B.tt),x.XF=_[x.ixfe],t.cellFormula){var Ae=B.formula;if(Ae&&Ae[0]&&Ae[0][0]&&Ae[0][0][0]=="PtgExp"){var et=Ae[0][0][1][0],Q=Ae[0][0][1][1],he=He({r:et,c:Q});b[he]?x.f=""+Rr(B.formula,o,B.cell,S,R):x.F=((t.dense?(s[et]||[])[Q]:s[he])||{}).F}else x.f=""+Rr(B.formula,o,B.cell,S,R)}T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A(B.cell,x,t),l=B}break;case 7:case 519:if(l)l.val=B,x=md(B,l.cell.ixfe,"s"),x.XF=_[x.ixfe],t.cellFormula&&(x.f=""+Rr(l.formula,o,l.cell,S,R)),T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A(l.cell,x,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(B);var Fe=He(B[0].s);if(m=t.dense?(s[B[0].s.r]||[])[B[0].s.c]:s[Fe],t.cellFormula&&m){if(!l||!Fe||!m)break;m.f=""+Rr(B[1],o,B[0],S,R),m.F=Ke(B[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;b[He(l.cell)]=B[0],m=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[He(l.cell)],(m||{}).f=""+Rr(B[0],o,f,S,R)}}break;case 253:x=md(c[B.isst].t,B.ixfe,"s"),c[B.isst].h&&(x.h=c[B.isst].h),x.XF=_[x.ixfe],T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:B.c,r:B.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:B.ixfe,XF:_[B.ixfe],t:"z"},T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:B.c,r:B.r},x,t));break;case 190:if(t.sheetStubs)for(var Le=B.c;Le<=B.C;++Le){var Oe=B.ixfe[Le-B.c];x={ixfe:Oe,XF:_[Oe],t:"z"},T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:Le,r:B.r},x,t)}break;case 214:case 516:case 4:x=md(B.val,B.ixfe,"s"),x.XF=_[x.ixfe],T>0&&(x.z=U[x.ixfe>>8&63]),ks(x,t,r.opts.Date1904),A({c:B.c,r:B.r},x,t);break;case 0:case 512:L===1&&(o=B);break;case 252:c=B;break;case 1054:if(R.biff==4){U[T++]=B[1];for(var Ve=0;Ve<T+163&&$e[Ve]!=B[1];++Ve);Ve>=163&&ta(B[1],T+163)}else ta(B[1],B[0]);break;case 30:{U[T++]=B;for(var Ye=0;Ye<T+163&&$e[Ye]!=B;++Ye);Ye>=163&&ta(B,T+163)}break;case 229:I=I.concat(B);break;case 93:Z[B.cmo[0]]=R.lastobj=B;break;case 438:R.lastobj.TxO=B;break;case 127:R.lastobj.ImData=B;break;case 440:for(v=B[0].s.r;v<=B[0].e.r;++v)for(p=B[0].s.c;p<=B[0].e.c;++p)m=t.dense?(s[v]||[])[p]:s[He({c:p,r:v})],m&&(m.l=B[1]);break;case 2048:for(v=B[0].s.r;v<=B[0].e.r;++v)for(p=B[0].s.c;p<=B[0].e.c;++p)m=t.dense?(s[v]||[])[p]:s[He({c:p,r:v})],m&&m.l&&(m.l.Tooltip=B[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;m=t.dense?(s[B[0].r]||[])[B[0].c]:s[He(B[0])];var vt=Z[B[2]];m||(t.dense?(s[B[0].r]||(s[B[0].r]=[]),m=s[B[0].r][B[0].c]={t:"z"}):m=s[He(B[0])]={t:"z"},o.e.r=Math.max(o.e.r,B[0].r),o.s.r=Math.min(o.s.r,B[0].r),o.e.c=Math.max(o.e.c,B[0].c),o.s.c=Math.min(o.s.c,B[0].c)),m.c||(m.c=[]),g={a:B[1],t:vt.TxO.t},m.c.push(g)}break;case 2173:EU(_[B.ixfe],B.ext);break;case 125:{if(!R.cellStyles)break;for(;B.e>=B.s;)j[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},q||(q=!0,Zg(B.w/256)),qa(j[B.e+1])}break;case 520:{var yt={};B.level!=null&&(Y[B.r]=yt,yt.level=B.level),B.hidden&&(Y[B.r]=yt,yt.hidden=!0),B.hpt&&(Y[B.r]=yt,yt.hpt=B.hpt,yt.hpx=ll(B.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Pi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=B;break;case 161:s["!margins"]||Pi(s["!margins"]={}),s["!margins"].header=B.header,s["!margins"].footer=B.footer;break;case 574:B.RTL&&(w.Views[0].RTL=!0);break;case 146:k=B;break;case 2198:G=B;break;case 140:N=B;break;case 442:u?C.CodeName=B||C.name:w.WBProps.CodeName=B||"ThisWorkbook";break}}else J||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=ce}return r.SheetNames=Xt(a).sort(function(Tt,qe){return Number(Tt)-Number(qe)}).map(function(Tt){return a[Tt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&X.forEach(function(Tt,qe){r.Sheets[r.SheetNames[qe]]["!autofilter"]=Tt}),r.Strings=c,r.SSF=jt($e),R.enc&&(r.Encryption=R.enc),G&&(r.Themes=G),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),S.names.length>0&&(w.Names=S.names),r.Workbook=w,r}var yc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function UW(e,t,r){var n=Be.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Xw(n,_p,yc.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var o=Be.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=Xw(o,Sp,yc.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(uE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function VW(e,t){var r=[],n=[],s=[],a=0,o,l=kw(_p,"n"),c=kw(Sp,"n");if(e.Props)for(o=Xt(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=Xt(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Custprops[o[a]]]);var u=[];for(a=0;a<s.length;++a)gE.indexOf(s[a][0])>-1||cE.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Be.utils.cfb_add(t,"/SummaryInformation",Kw(n,yc.SI,c,Sp)),(r.length||u.length)&&Be.utils.cfb_add(t,"/DocumentSummaryInformation",Kw(r,yc.DSI,l,_p,u.length?u:null,yc.UDI))}function fC(e,t){t||(t={}),i1(t),Cg(),t.codepage&&Eg(t.codepage);var r,n;if(e.FullPaths){if(Be.find(e,"/encryption"))throw new Error("File is password-protected");r=Be.find(e,"!CompObj"),n=Be.find(e,"/Workbook")||Be.find(e,"/Book")}else{switch(t.type){case"base64":e=Nn(An(e));break;case"binary":e=Nn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}kr(e,0),n={content:e}}var s,a;if(r&&LW(r),t.bookProps&&!t.bookSheets)s={};else{var o=Je?"buffer":"array";if(n&&n.content)s=BW(n.content,t);else if((a=Be.find(e,"PerfectOffice_MAIN"))&&a.content)s=Fi.to_workbook(a.content,(t.type=o,t));else if((a=Be.find(e,"NativeContent_MAIN"))&&a.content)s=Fi.to_workbook(a.content,(t.type=o,t));else throw(a=Be.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Be.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=eV(e))}var l={};return e.FullPaths&&UW(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function $W(e,t){var r=t||{},n=Be.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Be.utils.cfb_add(n,s,hC(e,r)),r.biff==8&&(e.Props||e.Custprops)&&VW(e,n),r.biff==8&&e.vbaraw&&tV(n,Be.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var eu={0:{f:fz},1:{f:wz},2:{f:Bz},3:{f:jz},4:{f:_z},5:{f:Lz},6:{f:Hz},7:{f:Pz},8:{f:Zz},9:{f:qz},10:{f:Kz},11:{f:Yz},12:{f:Nz},13:{f:Vz},14:{f:Az},15:{f:Ez},16:{f:sC},17:{f:Gz},18:{f:Iz},19:{f:Vg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:GH},40:{},42:{},43:{f:HB},44:{f:$B},45:{f:XB},46:{f:YB},47:{f:KB},48:{},49:{f:p7},50:{},51:{f:TU},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jE},62:{f:zz},63:{f:MU},64:{f:hH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:vz},148:{f:pz,p:16},151:{f:nH},152:{},153:{f:zH},154:{},155:{},156:{f:VH},157:{},158:{},159:{T:1,f:aB},160:{T:-1},161:{T:1,f:lo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Jz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:CU},336:{T:-1},337:{f:PU,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:kp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:CE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:sH},427:{f:aH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gz},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:kp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:YU},633:{T:1},634:{T:-1},635:{T:1,f:XU},636:{T:-1},637:{f:y7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:AH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:mH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fp={6:{f:Hh},10:{f:wa},12:{f:sr},13:{f:sr},14:{f:Kt},15:{f:Kt},16:{f:Ur},17:{f:Kt},18:{f:Kt},19:{f:sr},20:{f:e2},21:{f:e2},23:{f:CE},24:{f:r2},25:{f:Kt},26:{},27:{},28:{f:m9},29:{},34:{f:Kt},35:{f:t2},38:{f:Ur},39:{f:Ur},40:{f:Ur},41:{f:Ur},42:{f:Kt},43:{f:Kt},47:{f:EB},49:{f:VM},51:{f:sr},60:{},61:{f:LM},64:{f:Kt},65:{f:UM},66:{f:sr},77:{},80:{},81:{},82:{},85:{f:sr},89:{},90:{},91:{},92:{f:SM},93:{f:g9},94:{},95:{f:Kt},96:{},97:{},99:{f:Kt},125:{f:jE},128:{f:r9},129:{f:CM},130:{f:sr},131:{f:Kt},132:{f:Kt},133:{f:jM},134:{},140:{f:S9},141:{f:sr},144:{},146:{f:j9},151:{},152:{},153:{},154:{},155:{},156:{f:sr},157:{},158:{},160:{f:R9},161:{f:F9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:JM},190:{f:QM},193:{f:wa},197:{},198:{},199:{},200:{},201:{},202:{f:Kt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:sr},220:{},221:{f:Kt},222:{},224:{f:t9},225:{f:_M},226:{f:wa},227:{},229:{f:p9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:AM},253:{f:zM},255:{f:PM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:vE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Kt},353:{f:wa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:o9},431:{f:Kt},432:{},433:{},434:{},437:{},438:{f:w9},439:{f:Kt},440:{f:b9},441:{},442:{f:Eu},443:{},444:{f:sr},445:{},446:{},448:{f:wa},449:{f:RM,r:2},450:{f:wa},512:{f:Zw},513:{f:I9},515:{f:a9},516:{f:WM},517:{f:Qw},519:{f:L9},520:{f:DM},523:{},545:{f:n2},549:{f:qw},566:{},574:{f:MM},638:{f:ZM},659:{},1048:{},1054:{f:XM},1084:{},1212:{f:d9},2048:{f:k9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:dd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:T9,r:12},2173:{f:SU,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Kt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:u9,r:12},2197:{},2198:{f:yU,r:12},2199:{},2200:{},2201:{},2202:{f:f9,r:12},2203:{f:wa},2204:{},2205:{},2206:{},2207:{},2211:{f:IM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:P9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:C9},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zw},1:{},2:{f:V9},3:{f:B9},4:{f:M9},5:{f:Qw},7:{f:z9},8:{},9:{f:dd},11:{},22:{f:sr},30:{f:YM},31:{},32:{},33:{f:n2},36:{},37:{f:qw},50:{f:H9},62:{},52:{},67:{},68:{f:sr},69:{},86:{},126:{},127:{f:O9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:W9},223:{},234:{},354:{},421:{},518:{f:Hh},521:{f:dd},536:{f:r2},547:{f:t2},561:{},579:{},1030:{f:Hh},1033:{f:dd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ke(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&Mg(r)&&e.push(r)}}function zW(e,t,r,n){var s=n||(r||[]).length||0;if(s<=8224)return ke(e,t,r,s);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Au(e,t,r){return e||(e=de(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function HW(e,t,r,n){var s=de(9);return Au(s,e,t),yE(r,n||"b",s),s}function WW(e,t,r){var n=de(8+2*r.length);return Au(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function GW(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?dr(Ct(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?ke(e,2,$9(r,n,s)):ke(e,3,U9(r,n,s));return;case"b":case"e":ke(e,5,HW(r,n,t.v,t.t));return;case"s":case"str":ke(e,4,WW(r,n,(t.v||"").slice(0,255)));return}ke(e,1,Au(null,r,n))}function XW(e,t,r,n){var s=Array.isArray(t),a=lt(t["!ref"]||"A1"),o,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Ke(a)}for(var u=a.s.r;u<=a.e.r;++u){l=Jt(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Lt(d)),o=c[d]+l;var f=s?(t[u]||[])[d]:t[o];f&&GW(e,f,u,d)}}}function KW(e,t){for(var r=t||{},n=mn(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ke(n,r.biff==4?1033:r.biff==3?521:9,Kg(e,16,r)),XW(n,e.Sheets[e.SheetNames[s]],s,r),ke(n,10),n.end()}function YW(e,t,r){ke(e,49,$M({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function qW(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ke(e,1054,KM(s,t[s],r))})}function ZW(e,t){var r=de(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ke(e,2151,r),r=de(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_E(lt(t["!ref"]||"A1"),r),r.write_shift(4,4),ke(e,2152,r)}function JW(e,t){for(var r=0;r<16;++r)ke(e,224,Jw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ke(e,224,Jw(n,0,t))})}function QW(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ke(e,440,N9(n)),n[1].Tooltip&&ke(e,2048,_9(n))}delete t["!links"]}function eG(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&ke(e,125,A9(Mf(s,n),s))})}}function tG(e,t,r,n,s){var a=16+ai(s.cellXfs,t,s);if(t.v==null&&!t.bf){ke(e,513,Yi(r,n,a));return}if(t.bf)ke(e,6,C$(t,r,n,s,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?dr(Ct(t.v)):t.v;ke(e,515,i9(r,n,o,a));break;case"b":case"e":ke(e,517,s9(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var l=r1(s.Strings,t.v,s.revStrings);ke(e,253,HM(r,n,l,a))}else ke(e,516,GM(r,n,(t.v||"").slice(0,255),a,s));break;default:ke(e,513,Yi(r,n,a))}}function rG(e,t,r){var n=mn(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],m=lt(a["!ref"]||"A1"),g=u?65536:16384;if(m.e.c>255||m.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}ke(n,2057,Kg(r,16,t)),ke(n,13,$n(1)),ke(n,12,$n(100)),ke(n,15,Zr(!0)),ke(n,17,Zr(!1)),ke(n,16,Xi(.001)),ke(n,95,Zr(!0)),ke(n,42,Zr(!1)),ke(n,43,Zr(!1)),ke(n,130,$n(1)),ke(n,128,n9([0,0])),ke(n,131,Zr(!1)),ke(n,132,Zr(!1)),u&&eG(n,a["!cols"]),ke(n,512,qM(m,t)),u&&(a["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=Jt(p);for(var v=m.s.c;v<=m.e.c;++v){p===m.s.r&&(h[v]=Lt(v)),d=h[v]+f;var b=c?(a[p]||[])[v]:a[d];b&&(tG(n,b,p,v,t),u&&b.l&&a["!links"].push([d,b.l]))}}var y=l.CodeName||l.name||s;return u&&ke(n,574,BM((o.Views||[])[0])),u&&(a["!merges"]||[]).length&&ke(n,229,x9(a["!merges"])),u&&QW(n,a),ke(n,442,wE(y)),u&&ZW(n,a),ke(n,10),n.end()}function nG(e,t,r){var n=mn(),s=(e||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(ke(n,2057,Kg(e,5,r)),r.bookType=="xla"&&ke(n,135),ke(n,225,l?$n(1200):null),ke(n,193,sM(2)),c&&ke(n,191),c&&ke(n,192),ke(n,226),ke(n,92,EM("SheetJS",r)),ke(n,66,$n(l?1200:1252)),l&&ke(n,353,$n(0)),l&&ke(n,448),ke(n,317,D9(e.SheetNames.length)),l&&e.vbaraw&&ke(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";ke(n,442,wE(u))}ke(n,156,$n(17)),ke(n,25,Zr(!1)),ke(n,18,Zr(!1)),ke(n,19,$n(0)),l&&ke(n,431,Zr(!1)),l&&ke(n,444,$n(0)),ke(n,61,OM()),ke(n,64,Zr(!1)),ke(n,141,$n(0)),ke(n,34,Zr(RH(e)=="true")),ke(n,14,Zr(!0)),l&&ke(n,439,Zr(!1)),ke(n,218,$n(0)),YW(n,e,r),qW(n,e.SSF,r),JW(n,r),l&&ke(n,352,Zr(!1));var d=n.end(),f=mn();l&&ke(f,140,E9()),l&&r.Strings&&zW(f,252,FM(r.Strings)),ke(f,10);var h=f.end(),m=mn(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var v=d.length+g+h.length;for(p=0;p<e.SheetNames.length;++p){var b=a[p]||{};ke(m,133,TM({pos:v,hs:b.Hidden||0,dt:0,name:e.SheetNames[p]},r)),v+=t[p].length}var y=m.end();if(g!=y.length)throw new Error("BS8 "+g+" != "+y.length);var x=[];return d.length&&x.push(d),y.length&&x.push(y),h.length&&x.push(h),xr(x)}function sG(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=jt($e)),e&&e.SSF&&(bl(),Ff(e.SSF),r.revssf=Df(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,o1(r),r.cellXfs=[],ai(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=rG(s,r,e);return n.unshift(nG(e,n,r)),xr(n)}function hC(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=gn(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return sG(e,t);case 4:case 3:case 2:return KW(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function h2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=s.index,l=a&&a.index||e.length,c=zO(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<c.length;++o){var p=c[o].trim(),v=p.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var b=p.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var y=b[l].trim();if(y.match(/<t[dh]/i)){for(var x=y,N=0;x.charAt(0)=="<"&&(N=x.indexOf(">"))>-1;)x=x.slice(N+1);for(var _=0;_<g.length;++_){var k=g[_];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,_=-1)}var w=We(y.slice(0,y.indexOf(">")));h=w.colspan?+w.colspan:1,((f=+w.rowspan)>1||h>1)&&g.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var C=w.t||w["data-t"]||"";if(!x.length){d+=h;continue}if(x=OS(x),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!x.length){d+=h;continue}var D={t:"s",v:x};r.raw||!x.trim().length||C=="s"||(x==="TRUE"?D={t:"b",v:!0}:x==="FALSE"?D={t:"b",v:!1}:isNaN(xs(x))?isNaN(il(x).getDate())||(D={t:"d",v:Ct(x)},r.cellDates||(D={t:"n",v:dr(D.v)}),D.z=r.dateNF||$e[14]):D={t:"n",v:xs(x)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=D):n[He({r:u,c:d})]=D,d+=h}}}}return n["!ref"]=Ke(m),g.length&&(n["!merges"]=g),n}function aG(e,t,r,n){for(var s=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>o)&&!(s[u].e.r<r||s[u].e.c<o)){if(s[u].s.r<r||s[u].s.c<o){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=He({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||Rg(f.w||(da(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+d,a.push(Ne("td",h,m))}}var g="<tr>";return g+a.join("")+"</tr>"}var iG='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',oG="</body></html>";function lG(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return si(h2(r[0],t),t);var n=u1();return r.forEach(function(s,a){d1(n,h2(s,t),"Sheet"+(a+1))}),n}function cG(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function mC(e,t){var r=t||{},n=r.header!=null?r.header:iG,s=r.footer!=null?r.footer:oG,a=[n],o=gn(e["!ref"]);r.dense=Array.isArray(e),a.push(cG(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(aG(e,o,l,r));return a.push("</table>"+s),a.join("")}function pC(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?Ot(n.origin):n.origin;s=o.r,a=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=gn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),g=0,p=0,v=0,b=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&p<c;++g){var N=l[g];if(m2(N)){if(n.display)continue;m[p]={hidden:!0}}var _=N.children;for(v=b=0;v<_.length;++v){var k=_[v];if(!(n.display&&m2(k))){var w=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):OS(k.innerHTML),C=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var D=f[h];D.s.c==b+a&&D.s.r<p+s&&p+s<=D.e.r&&(b=D.e.c+1-a,h=-1)}x=+k.getAttribute("colspan")||1,((y=+k.getAttribute("rowspan")||1)>1||x>1)&&f.push({s:{r:p+s,c:b+a},e:{r:p+s+(y||1)-1,c:b+a+(x||1)-1}});var z={t:"s",v:w},A=k.getAttribute("data-t")||k.getAttribute("t")||"";w!=null&&(w.length==0?z.t=A||"z":n.raw||w.trim().length==0||A=="s"||(w==="TRUE"?z={t:"b",v:!0}:w==="FALSE"?z={t:"b",v:!1}:isNaN(xs(w))?isNaN(il(w).getDate())||(z={t:"d",v:Ct(w)},n.cellDates||(z={t:"n",v:dr(z.v)}),z.z=n.dateNF||$e[14]):z={t:"n",v:xs(w)})),z.z===void 0&&C!=null&&(z.z=C);var R="",G=k.getElementsByTagName("A");if(G&&G.length)for(var I=0;I<G.length&&!(G[I].hasAttribute("href")&&(R=G[I].getAttribute("href"),R.charAt(0)!="#"));++I);R&&R.charAt(0)!="#"&&(z.l={Target:R}),n.dense?(e[p+s]||(e[p+s]=[]),e[p+s][b+a]=z):e[He({c:b+a,r:p+s})]=z,u.e.c<b+a&&(u.e.c=b+a),b+=x}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+s),e["!ref"]=Ke(u),p>=c&&(e["!fullref"]=Ke((u.e.r=l.length-g+p-1+s,u))),e}function xC(e,t){var r=t||{},n=r.dense?[]:{};return pC(n,e,t)}function uG(e,t){return si(xC(e,t),t)}function m2(e){var t="",r=dG(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function dG(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function fG(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ot(t.replace(/<[^>]*>/g,""));return[r]}var p2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gC(e,t){var r=t||{},n=Lg(e),s=[],a,o,l={name:""},c="",u=0,d,f,h={},m=[],g=r.dense?[]:{},p,v,b={value:""},y="",x=0,N=[],_=-1,k=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,D={},z=[],A={},R=0,G=0,I=[],Z=1,j=1,Y=[],q={Names:[]},S={},F=["",""],L=[],T={},U="",X=0,H=!1,ee=!1,me=0;for(Kc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Kc.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?g["!ref"]=Ke(w):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(g["!fullref"]=g["!ref"],w.e.r=r.sheetRows-1,g["!ref"]=Ke(w)),z.length&&(g["!merges"]=z),I.length&&(g["!rows"]=I),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=g,ee=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=We(p[0],!1),_=k=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,g=r.dense?[]:{},z=[],I=[],ee=!0);break;case"table-row-group":p[1]==="/"?--C:++C;break;case"table-row":case"行":if(p[1]==="/"){_+=Z,Z=1;break}if(f=We(p[0],!1),f.行号?_=f.行号-1:_==-1&&(_=0),Z=+f["number-rows-repeated"]||1,Z<10)for(me=0;me<Z;++me)C>0&&(I[_+me]={level:C});k=-1;break;case"covered-table-cell":p[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(g[_]||(g[_]=[]),g[_][k]={t:"z"}):g[He({r:_,c:k})]={t:"z"}),y="",N=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++k,b=We(p[0],!1),j=parseInt(b["number-columns-repeated"]||"1",10),v={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(v.f=u2(ot(b.formula))),(b.数据类型||b["value-type"])=="string"&&(v.t="s",v.v=ot(b["string-value"]||""),r.dense?(g[_]||(g[_]=[]),g[_][k]=v):g[He({r:_,c:k})]=v),k+=j-1;else if(p[1]!=="/"){++k,y="",x=0,N=[],j=1;var le=Z?_+Z-1:_;if(k>w.e.c&&(w.e.c=k),k<w.s.c&&(w.s.c=k),_<w.s.r&&(w.s.r=_),le>w.e.r&&(w.e.r=le),b=We(p[0],!1),L=[],T={},v={t:b.数据类型||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=ot(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(R=parseInt(b["number-matrix-rows-spanned"],10)||0,G=parseInt(b["number-matrix-columns-spanned"],10)||0,A={s:{r:_,c:k},e:{r:_+R-1,c:k+G-1}},v.F=Ke(A),Y.push([A,v.F])),b.formula)v.f=u2(b.formula);else for(me=0;me<Y.length;++me)_>=Y[me][0].s.r&&_<=Y[me][0].e.r&&k>=Y[me][0].s.c&&k<=Y[me][0].e.c&&(v.F=Y[me][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(R=parseInt(b["number-rows-spanned"],10)||0,G=parseInt(b["number-columns-spanned"],10)||0,A={s:{r:_,c:k},e:{r:_+R-1,c:k+G-1}},z.push(A)),b["number-columns-repeated"]&&(j=parseInt(b["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=St(b["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(b.value);break;case"percentage":v.t="n",v.v=parseFloat(b.value);break;case"currency":v.t="n",v.v=parseFloat(b.value);break;case"date":v.t="d",v.v=Ct(b["date-value"]),r.cellDates||(v.t="n",v.v=dr(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=UO(b["time-value"])/86400,r.cellDates&&(v.t="d",v.v=If(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(b.数据数值);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",b["string-value"]!=null&&(y=ot(b["string-value"]),N=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(H=!1,v.t==="s"&&(v.v=y||"",N.length&&(v.R=N),H=x==0),S.Target&&(v.l=S),L.length>0&&(v.c=L,L=[]),y&&r.cellText!==!1&&(v.w=y),H&&(v.t="z",delete v.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var ce=0;ce<Z;++ce){if(j=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(g[_+ce]||(g[_+ce]=[]),g[_+ce][k]=ce==0?v:jt(v);--j>0;)g[_+ce][k+j]=jt(v);else for(g[He({r:_+ce,c:k})]=v;--j>0;)g[He({r:_+ce,c:k+j})]=jt(v);w.e.c<=k&&(w.e.c=k)}j=parseInt(b["number-columns-repeated"]||"1",10),k+=j-1,j=0,v={},y="",N=[]}S={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a;T.t=y,N.length&&(T.R=N),T.a=U,L.push(T)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);U="",X=0,y="",x=0,N=[];break;case"creator":p[1]==="/"?U=n.slice(X,p.index):X=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);y="",x=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(D[l.name]=c,(a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=We(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=We(p[0],!1),c+=p2[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=We(p[0],!1),c+=p2[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=We(p[0],!1),F=Wh(o["cell-range-address"]);var J={Name:o.name,Ref:F[0]+"!"+F[1]};ee&&(J.Sheet=m.length),q.Names.push(J);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!b||!b["string-value"])){var Se=fG(n.slice(x,p.index));y=(y.length>0?y+`
`:"")+Se[0]}else We(p[0],!1),x=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{F=Wh(We(p[0])["target-range-address"]),h[F[0]]["!autofilter"]={ref:F[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(S=We(p[0],!1),!S.href)break;S.Target=ot(S.href),delete S.href,S.Target.charAt(0)=="#"&&S.Target.indexOf(".")>-1?(F=Wh(S.Target.slice(1)),S.Target="#"+F[0]+"!"+F[1]):S.Target.match(/^\.\.[\\\/]/)&&(S.Target=S.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var B={Sheets:h,SheetNames:m,Workbook:q};return r.bookSheets&&delete B.Sheets,B}function x2(e,t){t=t||{},Vn(e,"META-INF/manifest.xml")&&B7(nr(e,"META-INF/manifest.xml"),t);var r=kn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=gC(gt(r),t);return Vn(e,"meta.xml")&&(n.Props=oE(nr(e,"meta.xml"))),n}function g2(e,t){return gC(e,t)}var hG=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Xc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return er+t}}(),v2=function(){var e=function(a){return mt(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,l){var c=[];c.push('      <table:table table:name="'+mt(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=gn(a["!ref"]||"A1"),h=a["!merges"]||[],m=0,g=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",v=a["!rows"]||[];for(u=0;u<f.s.r;++u)p=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var b=!1,y={},x="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(b=!0),y["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,y["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(b){c.push(r);continue}var N=He({r:u,c:d}),_=g?(a[u]||[])[d]:a[N];if(_&&_.f&&(y["table:formula"]=mt(D$(_.f)),_.F&&_.F.slice(0,N.length)==N)){var k=gn(_.F);y["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,y["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!_){c.push(t);continue}switch(_.t){case"b":x=_.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=_.v?"true":"false";break;case"n":x=_.w||String(_.v||0),y["office:value-type"]="float",y["office:value"]=_.v||0;break;case"s":case"str":x=_.v==null?"":_.v,y["office:value-type"]="string";break;case"d":x=_.w||Ct(_.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Ct(_.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(t);continue}var w=e(x);if(_.l&&_.l.Target){var C=_.l.Target;C=C.charAt(0)=="#"?"#"+I$(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),w=Ne("text:a",w,{"xlink:href":C.replace(/&/g,"&amp;")})}c.push("          "+Ne("table:table-cell",Ne("text:p",w,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;qa(f),f.ods=l;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var c=[er],u=Xc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Xc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(iE().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function vC(e,t){if(t.bookType=="fods")return v2(e,t);var r=Pg(),n="",s=[],a=[];return n="mimetype",Ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ze(r,n,v2(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Ze(r,n,hG(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Ze(r,n,er+iE()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Ze(r,n,$7(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ze(r,n,U7(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function qi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):gt(ni(e))}function mG(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Nn(Ps(e))}function pG(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ja(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function y2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function xG(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function gG(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function tu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ft(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Gt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ct(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=tu(e,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=tu(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function br(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(ft(n*8+s.type)),s.type==2&&t.push(ft(s.data.length)),t.push(s.data))})}),Ja(t)}function a1(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Mn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=tu(e,n),a=ct(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Gt(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=ct(l.data),u=Gt(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(o.merge=Gt(a[3][0].data)>>>0>0),r.push(o)}return r}function ho(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ft(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ft(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:ft(o.data.length)}],n[2].push({data:br(o.meta),type:2})});var a=br(n);t.push(ft(a.length)),t.push(a),s.forEach(function(o){return t.push(o)})}),Ja(t)}function vG(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=tu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Ja(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Ja(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Bn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(vG(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ja(t)}function mo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=ft(n),o=a.length;t.push(a),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return Ja(t)}function yG(e,t,r,n){var s=qi(e),a=s.getUint32(4,!0),o=(n>1?12:8)+y2(a&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(l=s.getUint32(o,!0),o+=4),o+=y2(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(o,!0),o+=4),a&32&&(u=s.getFloat64(o,!0),o+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function wG(e,t,r){var n=qi(e),s=n.getUint32(8,!0),a=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=xG(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(o=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Xh(e,t){var r=new Uint8Array(32),n=qi(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,gG(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Kh(e,t){var r=new Uint8Array(32),n=qi(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function bG(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return yG(e,t,r,e[0]);case 5:return wG(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ir(e){var t=ct(e);return tu(t[1][0].data)}function w2(e,t){var r=ct(t.data),n=Gt(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(o){var l=ct(o.data),c=Gt(l[1][0].data)>>>0;switch(n){case 1:a[c]=Pp(l[3][0].data);break;case 8:{var u=e[Ir(l[9][0].data)][0],d=ct(u.data),f=e[Ir(d[1][0].data)][0],h=Gt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=ct(f.data);a[c]=m[3].map(function(g){return Pp(g.data)}).join("")}break}}),a}function NG(e,t){var r,n,s,a,o,l,c,u,d,f,h,m,g,p,v=ct(e),b=Gt(v[1][0].data)>>>0,y=Gt(v[2][0].data)>>>0,x=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&Gt(v[8][0].data)>0||!1,N,_;if((a=(s=v[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(l=(o=v[7])==null?void 0:o[0])==null?void 0:l.data,_=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=v[4])==null?void 0:d[0])!=null&&f.data&&t!=1)N=(m=(h=v[4])==null?void 0:h[0])==null?void 0:m.data,_=(p=(g=v[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=x?4:1,w=qi(N),C=[],D=0;D<N.length/2;++D){var z=w.getUint16(D*2,!0);z<65535&&C.push([D,z])}if(C.length!=y)throw"Expected ".concat(y," cells, found ").concat(C.length);var A=[];for(D=0;D<C.length-1;++D)A[C[D][0]]=_.subarray(C[D][1]*k,C[D+1][1]*k);return C.length>=1&&(A[C[C.length-1][0]]=_.subarray(C[C.length-1][1]*k)),{R:b,cells:A}}function kG(e,t){var r,n=ct(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Gt(n[7][0].data)>>>0>0?1:0:-1,a=a1(n[5],function(o){return NG(o,s)});return{nrows:Gt(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function _G(e,t,r){var n,s=ct(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Gt(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Gt(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ke(a);var o=ct(s[4][0].data),l=w2(e,e[Ir(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?w2(e,e[Ir(o[17][0].data)][0]):[],u=ct(o[3][0].data),d=0;u[1].forEach(function(f){var h=ct(f.data),m=e[Ir(h[2][0].data)][0],g=Gt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=kG(e,m);p.data.forEach(function(v,b){v.forEach(function(y,x){var N=He({r:d+b,c:x}),_=bG(y,l,c);_&&(r[N]=_)})}),d+=p.nrows})}function SG(e,t){var r=ct(t.data),n={"!ref":"A1"},s=e[Ir(r[2][0].data)],a=Gt(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return _G(e,s[0],n),n}function EG(e,t){var r,n=ct(t.data),s={name:(r=n[1])!=null&&r[0]?Pp(n[1][0].data):"",sheets:[]},a=a1(n[2],Ir);return a.forEach(function(o){e[o].forEach(function(l){var c=Gt(l.meta[1][0].data);c==6e3&&s.sheets.push(SG(e,l))})}),s}function CG(e,t){var r=u1(),n=ct(t.data),s=a1(n[1],Ir);if(s.forEach(function(a){e[a].forEach(function(o){var l=Gt(o.meta[1][0].data);if(l==2){var c=EG(e,o);c.sheets.forEach(function(u,d){d1(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Yh(e){var t,r,n,s,a={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Bn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Mn(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Gt(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(c){a[c].forEach(function(u){var d=Gt(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return CG(a,l)}function jG(e,t,r){var n,s,a,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&Gt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=qi(e[7][0].data),d=0,f=[],h=qi(e[4][0].data),m=0,g=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),h.setUint16(p*2,m,!0);var v,b;switch(typeof t[p]){case"string":v=Xh({t:"s",v:t[p]},r),b=Kh({t:"s",v:t[p]},r);break;case"number":v=Xh({t:"n",v:t[p]},r),b=Kh({t:"n",v:t[p]},r);break;case"boolean":v=Xh({t:"b",v:t[p]},r),b=Kh({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(v),d+=v.length,g.push(b),m+=b.length,++c}for(e[2][0].data=ft(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=Ja(f),e[3][0].data=Ja(g),c}function TG(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=gn(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ke(n)));var a=z0(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(U){return U.forEach(function(X){typeof X=="string"&&o.push(X)})});var l={},c=[],u=Be.read(t.numbers,{type:"base64"});u.FileIndex.map(function(U,X){return[U,u.FullPaths[X]]}).forEach(function(U){var X=U[0],H=U[1];if(X.type==2&&X.name.match(/\.iwa/)){var ee=X.content,me=Bn(ee),le=Mn(me);le.forEach(function(ce){c.push(ce.id),l[ce.id]={deps:[],location:H,type:Gt(ce.messages[0].meta[1][0].data)}})}}),c.sort(function(U,X){return U-X});var d=c.filter(function(U){return U>1}).map(function(U){return[U,ft(U)]});u.FileIndex.map(function(U,X){return[U,u.FullPaths[X]]}).forEach(function(U){var X=U[0];if(U[1],!!X.name.match(/\.iwa/)){var H=Mn(Bn(X.content));H.forEach(function(ee){ee.messages.forEach(function(me){d.forEach(function(le){ee.messages.some(function(ce){return Gt(ce.meta[1][0].data)!=11006&&pG(ce.data,le[1])})&&l[le[0]].deps.push(ee.id)})})})}});for(var f=Be.find(u,l[1].location),h=Mn(Bn(f.content)),m,g=0;g<h.length;++g){var p=h[g];p.id==1&&(m=p)}var v=Ir(ct(m.messages[0].data)[1][0].data);for(f=Be.find(u,l[v].location),h=Mn(Bn(f.content)),g=0;g<h.length;++g)p=h[g],p.id==v&&(m=p);for(v=Ir(ct(m.messages[0].data)[2][0].data),f=Be.find(u,l[v].location),h=Mn(Bn(f.content)),g=0;g<h.length;++g)p=h[g],p.id==v&&(m=p);for(v=Ir(ct(m.messages[0].data)[2][0].data),f=Be.find(u,l[v].location),h=Mn(Bn(f.content)),g=0;g<h.length;++g)p=h[g],p.id==v&&(m=p);var b=ct(m.messages[0].data);{b[6][0].data=ft(n.e.r+1),b[7][0].data=ft(n.e.c+1);var y=Ir(b[46][0].data),x=Be.find(u,l[y].location),N=Mn(Bn(x.content));{for(var _=0;_<N.length&&N[_].id!=y;++_);if(N[_].id!=y)throw"Bad ColumnRowUIDMapArchive";var k=ct(N[_].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var w=0;w<=n.e.c;++w){var C=[];C[1]=C[2]=[{type:0,data:ft(w+420690)}],k[1].push({type:2,data:br(C)}),k[2].push({type:0,data:ft(w)}),k[3].push({type:0,data:ft(w)})}k[4]=[],k[5]=[],k[6]=[];for(var D=0;D<=n.e.r;++D)C=[],C[1]=C[2]=[{type:0,data:ft(D+726270)}],k[4].push({type:2,data:br(C)}),k[5].push({type:0,data:ft(D)}),k[6].push({type:0,data:ft(D)});N[_].messages[0].data=br(k)}x.content=mo(ho(N)),x.size=x.content.length,delete b[46];var z=ct(b[4][0].data);{z[7][0].data=ft(n.e.r+1);var A=ct(z[1][0].data),R=Ir(A[2][0].data);x=Be.find(u,l[R].location),N=Mn(Bn(x.content));{if(N[0].id!=R)throw"Bad HeaderStorageBucket";var G=ct(N[0].messages[0].data);for(D=0;D<a.length;++D){var I=ct(G[2][0].data);I[1][0].data=ft(D),I[4][0].data=ft(a[D].length),G[2][D]={type:G[2][0].type,data:br(I)}}N[0].messages[0].data=br(G)}x.content=mo(ho(N)),x.size=x.content.length;var Z=Ir(z[2][0].data);x=Be.find(u,l[Z].location),N=Mn(Bn(x.content));{if(N[0].id!=Z)throw"Bad HeaderStorageBucket";for(G=ct(N[0].messages[0].data),w=0;w<=n.e.c;++w)I=ct(G[2][0].data),I[1][0].data=ft(w),I[4][0].data=ft(n.e.r+1),G[2][w]={type:G[2][0].type,data:br(I)};N[0].messages[0].data=br(G)}x.content=mo(ho(N)),x.size=x.content.length;var j=Ir(z[4][0].data);(function(){for(var U=Be.find(u,l[j].location),X=Mn(Bn(U.content)),H,ee=0;ee<X.length;++ee){var me=X[ee];me.id==j&&(H=me)}var le=ct(H.messages[0].data);{le[3]=[];var ce=[];o.forEach(function(B,je){ce[1]=[{type:0,data:ft(je)}],ce[2]=[{type:0,data:ft(1)}],ce[3]=[{type:2,data:mG(B)}],le[3].push({type:2,data:br(ce)})})}H.messages[0].data=br(le);var J=ho(X),Se=mo(J);U.content=Se,U.size=U.content.length})();var Y=ct(z[3][0].data);{var q=Y[1][0];delete Y[2];var S=ct(q.data);{var F=Ir(S[2][0].data);(function(){for(var U=Be.find(u,l[F].location),X=Mn(Bn(U.content)),H,ee=0;ee<X.length;++ee){var me=X[ee];me.id==F&&(H=me)}var le=ct(H.messages[0].data);{delete le[6],delete Y[7];var ce=new Uint8Array(le[5][0].data);le[5]=[];for(var J=0,Se=0;Se<=n.e.r;++Se){var B=ct(ce);J+=jG(B,a[Se],o),B[1][0].data=ft(Se),le[5].push({data:br(B),type:2})}le[1]=[{type:0,data:ft(n.e.c+1)}],le[2]=[{type:0,data:ft(n.e.r+1)}],le[3]=[{type:0,data:ft(J)}],le[4]=[{type:0,data:ft(n.e.r+1)}]}H.messages[0].data=br(le);var je=ho(X),_e=mo(je);U.content=_e,U.size=U.content.length})()}q.data=br(S)}z[3][0].data=br(Y)}b[4][0].data=br(z)}m.messages[0].data=br(b);var L=ho(h),T=mo(L);return f.content=T,f.size=f.content.length,u}function yC(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function i1(e){yC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function o1(e){yC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function AG(e){return Qe.WS.indexOf(e)>-1?"sheet":e==Qe.CS?"chart":e==Qe.DS?"dialog":e==Qe.MS?"macro":e&&e.length?e:"sheet"}function FG(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,AG(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function PG(e,t,r,n,s,a,o,l,c,u,d,f){try{a[n]=pc(kn(e,r,!0),t);var h=nr(e,t),m;switch(l){case"sheet":m=eW(h,t,s,c,a[n],u,d,f);break;case"chart":if(m=tW(h,t,s,c,a[n],u,d,f),!m||!m["!drawel"])break;var g=ql(m["!drawel"].Target,t),p=Yc(g),v=VU(kn(e,g,!0),pc(kn(e,p,!0),g)),b=ql(v,g),y=Yc(b);m=jH(kn(e,b,!0),b,c,pc(kn(e,y,!0),b),u,m);break;case"macro":m=rW(h,t,s,c,a[n],u,d,f);break;case"dialog":m=nW(h,t,s,c,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=m;var x=[];a&&a[n]&&Xt(a[n]).forEach(function(N){var _="";if(a[n][N].Type==Qe.CMNT){_=ql(a[n][N].Target,t);var k=oW(nr(e,_,!0),_,c);if(!k||!k.length)return;a2(m,k,!1)}a[n][N].Type==Qe.TCMNT&&(_=ql(a[n][N].Target,t),x=x.concat(zU(nr(e,_,!0),c)))}),x&&x.length&&a2(m,x,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function Ln(e){return e.charAt(0)=="/"?e.slice(1):e}function DG(e,t){if(bl(),t=t||{},i1(t),Vn(e,"META-INF/manifest.xml")||Vn(e,"objectdata.xml"))return x2(e,t);if(Vn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Yh<"u"){if(e.FileIndex)return Yh(e);var r=Be.utils.cfb_new();return Ew(e).forEach(function(I){Ze(r,I,DS(e,I))}),Yh(r)}throw new Error("Unsupported NUMBERS file")}if(!Vn(e,"[Content_Types].xml"))throw Vn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ew(e),s=O7(kn(e,"[Content_Types].xml")),a=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",nr(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!nr(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(xc=[],s.sst)try{xc=iW(nr(e,Ln(s.sst)),s.sst,t)}catch(I){if(t.WTF)throw I}t.cellStyles&&s.themes.length&&(c=aW(kn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=sW(nr(e,Ln(s.style)),s.style,c,t))}s.links.map(function(I){try{var Z=pc(kn(e,Yc(Ln(I))),I);return cW(nr(e,Ln(I)),Z,I,t)}catch{}});var d=QH(nr(e,Ln(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=nr(e,Ln(s.coreprops[0]),!0),h&&(f=oE(h)),s.extprops.length!==0&&(h=nr(e,Ln(s.extprops[0]),!0),h&&H7(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=kn(e,Ln(s.custprops[0]),!0),h&&(m=G7(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Z){return Z.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=m),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var p={};t.bookDeps&&s.calcchain&&(p=lW(nr(e,Ln(s.calcchain)),s.calcchain));var v=0,b={},y,x;{var N=d.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var _=0;_!=N.length;++_)f.SheetNames[_]=N[_].name}var k=a?"bin":"xml",w=s.workbooks[0].lastIndexOf("/"),C=(s.workbooks[0].slice(0,w+1)+"_rels/"+s.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");Vn(e,C)||(C="xl/_rels/workbook."+k+".rels");var D=pc(kn(e,C,!0),C.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=uW(nr(e,Ln(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=WU(nr(e,Ln(s.people[0])),t)),D&&(D=FG(D,d.Sheets));var z=nr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var A="sheet";if(D&&D[v]?(y="xl/"+D[v][1].replace(/[\/]?xl\//,""),Vn(e,y)||(y=D[v][1]),Vn(e,y)||(y=C.replace(/_rels\/.*$/,"")+D[v][1]),A=D[v][2]):(y="xl/worksheets/sheet"+(v+1-z)+"."+k,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var R=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==v&&(R=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==f.SheetNames[v].toLowerCase()&&(R=1);if(!R)continue e}}PG(e,y,x,f.SheetNames[v],v,b,o,A,t,d,c,u)}return g={Directory:s,Workbook:d,Props:f,Custprops:m,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:xc,Styles:u,Themes:c,SSF:jt($e)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(I,Z){I=I.replace(/^Root Entry[\/]/,""),g.keys.push(I),g.files[I]=e.FileIndex[Z]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=nr(e,Ln(s.vba[0]),!0):s.defaults&&s.defaults.bin===QU&&(g.vbaraw=nr(e,"xl/vbaProject.bin",!0))),g}function IG(e,t){var r=t||{},n="Workbook",s=Be.find(e,n);try{if(n="/!DataSpaces/Version",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(uB(s.content),n="/!DataSpaces/DataSpaceMap",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=fB(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=hB(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);pB(s.content)}catch{}if(n="/EncryptionInfo",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=xB(s.content);if(n="/EncryptedPackage",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function RG(e,t){return t.bookType=="ods"?vC(e,t):t.bookType=="numbers"?TG(e,t):t.bookType=="xlsb"?LG(e,t):OG(e,t)}function LG(e,t){Ro=1024,e&&!e.SSF&&(e.SSF=jt($e)),e&&e.SSF&&(bl(),Ff(e.SSF),t.revssf=Df(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,gc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=GE.indexOf(t.bookType)>-1,s=Gg();o1(t=t||{});var a=Pg(),o="",l=0;if(t.cellXfs=[],ai(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ze(a,o,lE(e.Props,t)),s.coreprops.push(o),ht(t.rels,2,o,Qe.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ze(a,o,dE(e.Props)),s.extprops.push(o),ht(t.rels,3,o,Qe.EXT_PROPS),e.Custprops!==e.Props&&Xt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ze(a,o,fE(e.Custprops)),s.custprops.push(o),ht(t.rels,4,o,Qe.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ze(a,o,fW(l-1,o,t,e,d)),s.sheets.push(o),ht(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Qe.WS[0])}if(f){var m=f["!comments"],g=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,Ze(a,p,pW(m,p)),s.comments.push(p),ht(d,-1,"../comments"+l+"."+r,Qe.CMNT),g=!0),f["!legacy"]&&g&&Ze(a,"xl/drawings/vmlDrawing"+l+".vml",HE(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Ze(a,Yc(o),Wo(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ze(a,o,mW(t.Strings,o,t)),s.strs.push(o),ht(t.wbrels,-1,"sharedStrings."+r,Qe.SST)),o="xl/workbook."+r,Ze(a,o,dW(e,o)),s.workbooks.push(o),ht(t.rels,1,o,Qe.WB),o="xl/theme/theme1.xml",Ze(a,o,Jg(e.Themes,t)),s.themes.push(o),ht(t.wbrels,-1,"theme/theme1.xml",Qe.THEME),o="xl/styles."+r,Ze(a,o,hW(e,o,t)),s.styles.push(o),ht(t.wbrels,-1,"styles."+r,Qe.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Ze(a,o,e.vbaraw),s.vba.push(o),ht(t.wbrels,-1,"vbaProject.bin",Qe.VBA)),o="xl/metadata."+r,Ze(a,o,xW(o)),s.metadata.push(o),ht(t.wbrels,-1,"metadata."+r,Qe.XLMETA),Ze(a,"[Content_Types].xml",aE(s,t)),Ze(a,"_rels/.rels",Wo(t.rels)),Ze(a,"xl/_rels/workbook."+r+".rels",Wo(t.wbrels)),delete t.revssf,delete t.ssf,a}function OG(e,t){Ro=1024,e&&!e.SSF&&(e.SSF=jt($e)),e&&e.SSF&&(bl(),Ff(e.SSF),t.revssf=Df(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,gc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=GE.indexOf(t.bookType)>-1,s=Gg();o1(t=t||{});var a=Pg(),o="",l=0;if(t.cellXfs=[],ai(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ze(a,o,lE(e.Props,t)),s.coreprops.push(o),ht(t.rels,2,o,Qe.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ze(a,o,dE(e.Props)),s.extprops.push(o),ht(t.rels,3,o,Qe.EXT_PROPS),e.Custprops!==e.Props&&Xt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ze(a,o,fE(e.Custprops)),s.custprops.push(o),ht(t.rels,4,o,Qe.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ze(a,o,nC(l-1,t,e,f)),s.sheets.push(o),ht(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Qe.WS[0])}if(h){var g=h["!comments"],p=!1,v="";if(g&&g.length>0){var b=!1;g.forEach(function(y){y[1].forEach(function(x){x.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+l+"."+r,Ze(a,v,HU(g,d,t)),s.threadedcomments.push(v),ht(f,-1,"../threadedComments/threadedComment"+l+"."+r,Qe.TCMNT)),v="xl/comments"+l+"."+r,Ze(a,v,WE(g)),s.comments.push(v),ht(f,-1,"../comments"+l+"."+r,Qe.CMNT),p=!0}h["!legacy"]&&p&&Ze(a,"xl/drawings/vmlDrawing"+l+".vml",HE(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ze(a,Yc(o),Wo(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ze(a,o,PE(t.Strings,t)),s.strs.push(o),ht(t.wbrels,-1,"sharedStrings."+r,Qe.SST)),o="xl/workbook."+r,Ze(a,o,lC(e)),s.workbooks.push(o),ht(t.rels,1,o,Qe.WB),o="xl/theme/theme1.xml",Ze(a,o,Jg(e.Themes,t)),s.themes.push(o),ht(t.wbrels,-1,"theme/theme1.xml",Qe.THEME),o="xl/styles."+r,Ze(a,o,UE(e,t)),s.styles.push(o),ht(t.wbrels,-1,"styles."+r,Qe.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Ze(a,o,e.vbaraw),s.vba.push(o),ht(t.wbrels,-1,"vbaProject.bin",Qe.VBA)),o="xl/metadata."+r,Ze(a,o,zE()),s.metadata.push(o),ht(t.wbrels,-1,"metadata."+r,Qe.XLMETA),d.length>1&&(o="xl/persons/person.xml",Ze(a,o,GU(d)),s.people.push(o),ht(t.wbrels,-1,"persons/person.xml",Qe.PEOPLE)),Ze(a,"[Content_Types].xml",aE(s,t)),Ze(a,"_rels/.rels",Wo(t.rels)),Ze(a,"xl/_rels/workbook."+r+".rels",Wo(t.wbrels)),delete t.revssf,delete t.ssf,a}function l1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function MG(e,t){return Be.find(e,"EncryptedPackage")?IG(e,t):fC(e,t)}function BG(e,t){var r,n=e,s=t||{};return s.type||(s.type=Je&&Buffer.isBuffer(e)?"buffer":"base64"),r=IS(n,s),DG(r,s)}function wC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ap(e.slice(r),t);default:break e}return ol.to_workbook(e,t)}function UG(e,t){var r="",n=l1(e,t);switch(t.type){case"base64":r=An(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Gi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=gt(r)),t.type="binary",wC(r,t)}function VG(e,t){var r=e;return t.type=="base64"&&(r=An(r)),r=ja.utils.decode(1200,r.slice(2),"str"),t.type="binary",wC(r,t)}function $G(e){return e.match(/[^\x00-\x7F]/)?Ps(e):e}function qh(e,t,r,n){return n?(r.type="string",ol.to_workbook(e,r)):ol.to_workbook(t,r)}function Dp(e,t){Cg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Dp(new Uint8Array(e),(r=jt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xo={},r.dateNF&&(Xo.dateNF=r.dateNF),r.type||(r.type=Je&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Je?"buffer":"binary",n=OO(e),typeof Uint8Array<"u"&&!Je&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=$G(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=jt(r),r.type="array",Dp(jg(n),r)}switch((s=l1(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return MG(Be.read(n,r),r);break;case 9:if(s[1]<=8)return fC(n,r);break;case 60:return Ap(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return X9(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return AE.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?BG(n,r):qh(e,n,r,a);case 239:return s[3]===60?Ap(n,r):qh(e,n,r,a);case 255:if(s[1]===254)return VG(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Fi.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Fi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Tp.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return OE.to_workbook(n,r);break;case 10:case 13:case 32:return UG(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return G9.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Tp.to_workbook(n,r):qh(e,n,r,a)}function bC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ku(t.file,Be.write(e,{type:Je?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Be.write(e,t)}function zG(e,t){var r=jt(t||{}),n=RG(e,r);return HG(n,r)}function HG(e,t){var r={},n=Je?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Be.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Af(s))}return t.password&&typeof encrypt_agile<"u"?bC(encrypt_agile(s,t.password),t):t.type==="file"?ku(t.file,s):t.type=="string"?gt(s):s}function WG(e,t){var r=t||{},n=$W(e,r);return bC(n,r)}function Ss(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Hc(Ps(n));case"binary":return Ps(n);case"string":return e;case"file":return ku(t.file,n,"utf8");case"buffer":return Je?ma(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ss(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function GG(e,t){switch(t.type){case"base64":return Hc(e);case"binary":return e;case"string":return e;case"file":return ku(t.file,e,"binary");case"buffer":return Je?ma(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function pd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Hc(r):t.type=="string"?gt(r):r;case"file":return ku(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function NC(e,t){Cg(),MH(e);var r=jt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=NC(e,r);return r.type="array",Af(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ss(RW(e,r),r);case"slk":case"sylk":return Ss(TE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ss(mC(e.Sheets[e.SheetNames[s]],r),r);case"txt":return GG(kC(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ss(c1(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ss(AE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return pd(Tp.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ss(ol.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ss(OE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ss(FE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ss(vC(e,r),r);case"wk1":return pd(Fi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return pd(Fi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),pd(hC(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),WG(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return zG(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function XG(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function KG(e,t,r){var n=r||{};return n.type="file",n.file=t,XG(n),NC(e,n)}function YG(e,t,r,n,s,a,o,l){var c=Jt(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var g=o?e[r][m]:e[n[m]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;a[m]!=null&&(h[a[m]]=u);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[m]!=null){if(p==null)if(g.t=="e"&&p===null)h[a[m]]=null;else if(u!==void 0)h[a[m]]=u;else if(d&&p===null)h[a[m]]=null;else continue;else h[a[m]]=d&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?p:da(g,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function z0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=lt(d);break;case"number":c=lt(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=Jt(c.s.r),h=[],m=[],g=0,p=0,v=Array.isArray(e),b=c.s.r,y=0,x={};v&&!e[b]&&(e[b]=[]);var N=u.skipHidden&&e["!cols"]||[],_=u.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(N[y]||{}).hidden)switch(h[y]=Lt(y),r=v?e[b][y]:e[h[y]+f],n){case 1:a[y]=y-c.s.c;break;case 2:a[y]=h[y];break;case 3:a[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=da(r,null,u),p=x[o]||0,!p)x[o]=1;else{do l=o+"_"+p++;while(x[l]);x[o]=p,x[l]=1}a[y]=l}for(b=c.s.r+s;b<=c.e.r;++b)if(!(_[b]||{}).hidden){var k=YG(e,c,b,h,n,a,v,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[g++]=k.row)}return m.length=g,m}var b2=/"/g;function qG(e,t,r,n,s,a,o,l){for(var c=!0,u=[],d="",f=Jt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=l.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:da(m,null,l));for(var g=0,p=0;g!==d.length;++g)if((p=d.charCodeAt(g))===s||p===a||p===34||l.forceQuotes){d='"'+d.replace(b2,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(b2,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function c1(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=lt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(f[g]=Lt(g));for(var p=0,v=s.s.r;v<=s.e.r;++v)(m[v]||{}).hidden||(d=qG(e,s,v,f,o,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function kC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=c1(e,t);return r}function ZG(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=lt(e["!ref"]),a="",o=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=Lt(l);for(var d=s.s.r;d<=s.e.r;++d)for(a=Jt(d),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+a,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function _C(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ot(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(a["!ref"]){var f=lt(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+s)}else o==-1&&(o=0,d.e.r=t.length-1+s);var h=n.header||[],m=0;t.forEach(function(p,v){Xt(p).forEach(function(b){(m=h.indexOf(b))==-1&&(h[m=h.length]=b);var y=p[b],x="z",N="",_=He({c:l+m,r:o+v+s});u=ru(a,_),y&&typeof y=="object"&&!(y instanceof Date)?a[_]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",n.cellDates||(x="n",y=dr(y)),N=n.dateNF||$e[14]):y===null&&n.nullError&&(x="e",y=0),u?(u.t=x,u.v=y,delete u.w,delete u.R,N&&(u.z=N)):a[_]=u={t:x,v:y},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var g=Jt(o);if(s)for(m=0;m<h.length;++m)a[Lt(m+l)+g]={t:"s",v:h[m]};return a["!ref"]=Ke(d),a}function JG(e,t){return _C(null,e,t)}function ru(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ot(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ru(e,He(t)):ru(e,He({r:t,c:r||0}))}function QG(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function u1(){return{SheetNames:[],Sheets:{}}}function d1(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(oC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function eX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=QG(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function tX(e,t){return e.z=t,e}function SC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function rX(e,t,r){return SC(e,"#"+t,r)}function nX(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sX(e,t,r,n){for(var s=typeof t!="string"?t:lt(t),a=typeof t=="string"?t:Ke(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=ru(e,o,l);c.t="n",c.F=a,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Pr={encode_col:Lt,encode_row:Jt,encode_cell:He,encode_range:Ke,decode_col:Ug,decode_row:Bg,split_cell:m7,decode_cell:Ot,decode_range:gn,format_cell:da,sheet_add_aoa:JS,sheet_add_json:_C,sheet_add_dom:pC,aoa_to_sheet:Nl,json_to_sheet:JG,table_to_sheet:xC,table_to_book:uG,sheet_to_csv:c1,sheet_to_txt:kC,sheet_to_json:z0,sheet_to_html:mC,sheet_to_formulae:ZG,sheet_to_row_object_array:z0,sheet_get_cell:ru,book_new:u1,book_append_sheet:d1,book_set_sheet_visibility:eX,cell_set_number_format:tX,cell_set_hyperlink:SC,cell_set_internal_link:rX,cell_add_comment:nX,sheet_set_array_formula:sX,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class aX{constructor(){this.requiredSheets=["Branches","Checkers","Customers","Products","Installments","Payments","Collections"]}async readExcelFile(t){return new Promise((r,n)=>{const s=new FileReader;s.onload=a=>{try{const o=new Uint8Array(a.target.result),l=Dp(o,{type:"array"}),c={};this.requiredSheets.forEach(u=>{if(l.SheetNames.includes(u)){const d=l.Sheets[u],f=Pr.sheet_to_json(d,{header:1,defval:""});if(f.length>1){const h=f[0],m=f.slice(1);c[u]=m.map(g=>{const p={};return h.forEach((v,b)=>{p[v]=g[b]||""}),p}).filter(g=>{const p=Object.keys(g)[0];return g[p]&&g[p].toString().trim()!==""})}else c[u]=[]}else c[u]=[]}),r(c)}catch(o){n(new Error(`ไม่สามารถอ่านไฟล์ Excel ได้: ${o.message}`))}},s.onerror=()=>{n(new Error("เกิดข้อผิดพลาดในการอ่านไฟล์"))},s.readAsArrayBuffer(t)})}validateData(t){const r=[];if(this.requiredSheets.forEach(n=>{(!t[n]||t[n].length===0)&&["Installments","Customers"].includes(n)&&r.push(`Sheet "${n}" จำเป็นต้องมีข้อมูล`)}),t.Branches&&t.Branches.length>0&&t.Branches.forEach((n,s)=>{(!n.branch_code||!n.branch_name)&&r.push(`Branches แถวที่ ${s+2}: ต้องมี branch_code และ branch_name`)}),t.Customers&&t.Customers.length>0){const n=new Set,s=new Set;t.Customers.forEach((a,o)=>{const l=o+2;(!a.customer_code||!a.name||!a.id_card)&&r.push(`Customers แถวที่ ${l}: ต้องมี customer_code, name และ id_card`),a.customer_code&&(n.has(a.customer_code)&&r.push(`Customers แถวที่ ${l}: customer_code "${a.customer_code}" ซ้ำ`),n.add(a.customer_code)),a.id_card&&(s.has(a.id_card)&&r.push(`Customers แถวที่ ${l}: id_card "${a.id_card}" ซ้ำ`),s.add(a.id_card)),a.id_card&&a.id_card.length!==13&&r.push(`Customers แถวที่ ${l}: id_card ต้องเป็น 13 หลัก`)})}if(t.Installments&&t.Installments.length>0){const n=new Set;t.Installments.forEach((s,a)=>{const o=a+2;(!s.contract_number||!s.customer_code||!s.total_amount)&&r.push(`Installments แถวที่ ${o}: ต้องมี contract_number, customer_code และ total_amount`),s.contract_number&&(n.has(s.contract_number)&&r.push(`Installments แถวที่ ${o}: contract_number "${s.contract_number}" ซ้ำ`),n.add(s.contract_number)),s.total_amount&&isNaN(parseFloat(s.total_amount))&&r.push(`Installments แถวที่ ${o}: total_amount ต้องเป็นตัวเลข`),s.installment_amount&&isNaN(parseFloat(s.installment_amount))&&r.push(`Installments แถวที่ ${o}: installment_amount ต้องเป็นตัวเลข`),s.start_date&&!this.isValidDate(s.start_date)&&r.push(`Installments แถวที่ ${o}: start_date รูปแบบไม่ถูกต้อง (ใช้ YYYY-MM-DD)`),s.end_date&&!this.isValidDate(s.end_date)&&r.push(`Installments แถวที่ ${o}: end_date รูปแบบไม่ถูกต้อง (ใช้ YYYY-MM-DD)`)})}return t.Payments&&t.Payments.length>0&&t.Payments.forEach((n,s)=>{const a=s+2;(!n.contract_number||!n.amount||!n.due_date)&&r.push(`Payments แถวที่ ${a}: ต้องมี contract_number, amount และ due_date`),n.amount&&isNaN(parseFloat(n.amount))&&r.push(`Payments แถวที่ ${a}: amount ต้องเป็นตัวเลข`),n.due_date&&!this.isValidDate(n.due_date)&&r.push(`Payments แถวที่ ${a}: due_date รูปแบบไม่ถูกต้อง (ใช้ YYYY-MM-DD)`),n.payment_date&&n.payment_date!==""&&!this.isValidDate(n.payment_date)&&r.push(`Payments แถวที่ ${a}: payment_date รูปแบบไม่ถูกต้อง (ใช้ YYYY-MM-DD)`)}),r}isValidDate(t){if(!t)return!1;const r=new Date(t);return r instanceof Date&&!isNaN(r)&&t.match(/^\d{4}-\d{2}-\d{2}$/)}async importData(t,r){const n={success:0,errors:[],summary:{}};try{if(t.Branches&&t.Branches.length>0){r==null||r("กำลัง import ข้อมูลสาขา...");const s=await this.importBranches(t.Branches);n.summary.branches=s}if(t.Checkers&&t.Checkers.length>0){r==null||r("กำลัง import ข้อมูลเช็คเกอร์...");const s=await this.importCheckers(t.Checkers);n.summary.checkers=s}if(t.Customers&&t.Customers.length>0){r==null||r("กำลัง import ข้อมูลลูกค้า...");const s=await this.importCustomers(t.Customers);n.summary.customers=s}if(t.Products&&t.Products.length>0){r==null||r("กำลัง import ข้อมูลสินค้า...");const s=await this.importProducts(t.Products);n.summary.products=s}if(t.Installments&&t.Installments.length>0){r==null||r("กำลัง import ข้อมูลสัญญา...");const s=await this.importInstallments(t.Installments);n.summary.installments=s}if(t.Payments&&t.Payments.length>0){r==null||r("กำลัง import ข้อมูลการชำระเงิน...");const s=await this.importPayments(t.Payments);n.summary.payments=s}if(t.Collections&&t.Collections.length>0){r==null||r("กำลัง import ข้อมูลการเก็บเงิน...");const s=await this.importCollections(t.Collections);n.summary.collections=s}r==null||r("Import เสร็จสิ้น!"),n.success=1}catch(s){n.errors.push(`เกิดข้อผิดพลาดในการ import: ${s.message}`)}return n}async importBranches(t){const r={success:0,errors:[]};for(const n of t)try{const s=await ye.post("/branches",{name:n.branch_name,address:n.address||"",phone:n.phone||"",manager:n.manager||""});s.data.success?r.success++:r.errors.push(`สาขา ${n.branch_code}: ${s.data.message}`)}catch(s){r.errors.push(`สาขา ${n.branch_code}: ${s.message}`)}return r}async importCustomers(t){const r={success:0,errors:[]};for(const n of t)try{const s=await ye.post("/customers",{code:n.customer_code,name:n.name,surname:n.surname||"",full_name:`${n.name} ${n.surname||""}`.trim(),id_card:n.id_card,nickname:n.nickname||"",phone:n.phone||"",email:n.email||"",address:n.address||"",guarantor_name:n.guarantor_name||"",guarantor_id_card:n.guarantor_id_card||"",guarantor_phone:n.guarantor_phone||"",guarantor_address:n.guarantor_address||""});s.data.success?r.success++:r.errors.push(`ลูกค้า ${n.customer_code}: ${s.data.message}`)}catch(s){r.errors.push(`ลูกค้า ${n.customer_code}: ${s.message}`)}return r}async importInstallments(t){const r={success:0,errors:[]};for(const n of t)try{const s=await ye.post("/installments",{contract_number:n.contract_number,customer_code:n.customer_code,product_name:n.product_name,total_amount:parseFloat(n.total_amount),installment_amount:parseFloat(n.installment_amount),installment_period:parseInt(n.installment_period),start_date:n.start_date,end_date:n.end_date,status:n.status||"active"});s.data.success?r.success++:r.errors.push(`สัญญา ${n.contract_number}: ${s.data.message}`)}catch(s){r.errors.push(`สัญญา ${n.contract_number}: ${s.message}`)}return r}async importPayments(t){const r={success:0,errors:[]};for(const n of t)try{const s=await ye.post("/payments",{contract_number:n.contract_number,amount:parseFloat(n.amount),due_date:n.due_date,payment_date:n.payment_date||null,status:n.status||"pending",notes:n.notes||""});s.data.success?r.success++:r.errors.push(`การชำระ ${n.contract_number}: ${s.data.message}`)}catch(s){r.errors.push(`การชำระ ${n.contract_number}: ${s.message}`)}return r}async importCollections(t){const r={success:0,errors:[]};for(const n of t)try{const s=await ye.post("/payment-collections",{contract_number:n.contract_number,checker_code:n.checker_code,amount:parseFloat(n.amount_collected),payment_date:n.collection_date,notes:n.notes||""});s.data.success?r.success++:r.errors.push(`การเก็บเงิน ${n.contract_number}: ${s.data.message}`)}catch(s){r.errors.push(`การเก็บเงิน ${n.contract_number}: ${s.message}`)}return r}generateTemplate(){const t=Pr.book_new(),r=[["branch_code*","branch_name*","address","phone","manager"],["BR001","สาขาหลัก","123 ถนนสุขุมวิท กรุงเทพฯ 10110","02-123-4567","คุณสมชาย ใจดี"],["BR002","สาขารามคำแหง","456 ถนนรามคำแหง กรุงเทพฯ 10240","02-234-5678","คุณสมหญิง รักดี"]],n=Pr.aoa_to_sheet(r);Pr.book_append_sheet(t,n,"Branches");const s=[["checker_code*","name*","surname","phone","email","branch_code*"],["CHK001","อนุชิต","","081-111-1111","anuchit@example.com","BR001"],["CHK002","อุดมศักดิ์","ประถมทอง","081-222-2222","udomsak@example.com","BR001"]],a=Pr.aoa_to_sheet(s);Pr.book_append_sheet(t,a,"Checkers");const o=[["customer_code*","name*","surname","id_card*","nickname","phone","email","address","guarantor_name","guarantor_id_card","guarantor_phone","guarantor_address","branch_code*","checker_code*"],["CUST001","สมชาย","ใจดี","1234567890123","สมชาย","082-111-1111","customer1@example.com","123 ถนนสุขุมวิท กรุงเทพฯ","สมหญิง รักดี","9876543210987","082-222-2222","456 ถนนรามคำแหง กรุงเทพฯ","BR001","CHK001"]],l=Pr.aoa_to_sheet(o);Pr.book_append_sheet(t,l,"Customers");const c=[["product_code*","product_name*","description","price*","branch_code*"],["PROD001","โทรศัพท์มือถือ Samsung Galaxy S21","สมาร์ทโฟนรุ่นใหม่จาก Samsung","25000.00","BR001"]],u=Pr.aoa_to_sheet(c);Pr.book_append_sheet(t,u,"Products");const d=[["contract_number*","customer_code*","product_code","product_name*","total_amount*","installment_amount*","installment_period*","start_date*","end_date*","status*","branch_code*","salesperson_name"],["CT2401001","CUST001","PROD001","โทรศัพท์มือถือ Samsung Galaxy S21","25000.00","2500.00","10","2024-01-01","2024-10-01","active","BR001","คุณสมชาย"]],f=Pr.aoa_to_sheet(d);Pr.book_append_sheet(t,f,"Installments");const h=[["contract_number*","payment_sequence*","amount*","due_date*","payment_date","status*","notes"],["CT2401001","1","2500.00","2024-01-01","2024-01-01","paid","เก็บเงินงวดที่ 1"],["CT2401001","2","2500.00","2024-02-01","2024-02-01","paid","เก็บเงินงวดที่ 2"],["CT2401001","3","2500.00","2024-03-01","","pending",""],["CT2401001","4","2500.00","2024-04-01","","pending",""]],m=Pr.aoa_to_sheet(h);Pr.book_append_sheet(t,m,"Payments");const g=[["contract_number*","payment_sequence*","checker_code*","amount_collected*","collection_date*","notes"],["CT2401001","1","CHK001","2500.00","2024-01-01","เก็บเงินงวดที่ 1"],["CT2401001","2","CHK001","2500.00","2024-02-01","เก็บเงินงวดที่ 2"]],p=Pr.aoa_to_sheet(g);return Pr.book_append_sheet(t,p,"Collections"),t}downloadTemplate(){const t=this.generateTemplate();KG(t,"import_template.xlsx")}}const $l=new aX,iX=({onBack:e})=>{const[t,r]=E.useState(null),[n,s]=E.useState(!1),[a,o]=E.useState(0),[l,c]=E.useState(""),[u,d]=E.useState([]),[f,h]=E.useState(null),[m,g]=E.useState("select"),p=E.useRef(null),v=_=>{const k=_.target.files[0];k&&(k.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||k.type==="application/vnd.ms-excel"?(r(k),d([]),h(null),g("validate"),b(k)):ge({title:"ไฟล์ไม่ถูกต้อง",description:"กรุณาเลือกไฟล์ Excel (.xlsx หรือ .xls)",variant:"destructive"}))},b=async _=>{try{s(!0),c("กำลังตรวจสอบไฟล์..."),o(20);const k=await $l.readExcelFile(_);o(50),c("กำลังตรวจสอบข้อมูล...");const w=$l.validateData(k);o(100),c("ตรวจสอบเสร็จสิ้น"),w.length>0?(d(w),g("validate")):(d([]),g("ready"))}catch(k){ge({title:"เกิดข้อผิดพลาด",description:k.message,variant:"destructive"}),g("select")}finally{s(!1),o(0),c("")}},y=async()=>{if(t)try{s(!0),g("import"),o(0);const _=await $l.readExcelFile(t),k=await $l.importData(_,w=>{c(w),o(C=>Math.min(C+10,90))});o(100),c("Import เสร็จสิ้น!"),h(k),g("complete"),k.success&&ge({title:"Import สำเร็จ",description:"ข้อมูลถูก import เข้าระบบเรียบร้อยแล้ว",variant:"default"})}catch(_){ge({title:"เกิดข้อผิดพลาดในการ Import",description:_.message,variant:"destructive"}),g("ready")}finally{s(!1)}},x=()=>{$l.downloadTemplate(),ge({title:"ดาวน์โหลดสำเร็จ",description:"ไฟล์ template ถูกดาวน์โหลดแล้ว",variant:"default"})},N=()=>{r(null),s(!1),o(0),c(""),d([]),h(null),g("select"),p.current&&(p.current.value="")};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[i.jsxs(oe,{variant:"ghost",size:"sm",onClick:e,className:"flex items-center gap-2",children:[i.jsx(Vi,{className:"h-4 w-4"}),"กลับ"]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import ข้อมูลจากระบบเก่า"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"นำเข้าข้อมูลลูกค้าและสัญญาผ่อนจากไฟล์ Excel"})]})]}),i.jsxs(mr,{className:"mb-6",children:[i.jsxs(Wn,{children:[i.jsxs(Gn,{className:"flex items-center gap-2",children:[i.jsx(ua,{className:"h-5 w-5 text-blue-600"}),"ขั้นตอนที่ 1: ดาวน์โหลด Template"]}),i.jsx(Fs,{children:"ดาวน์โหลดไฟล์ template Excel และกรอกข้อมูลตามรูปแบบที่กำหนด"})]}),i.jsx(pr,{children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(oe,{onClick:x,className:"flex items-center gap-2",variant:"outline",children:[i.jsx(Th,{className:"h-4 w-4"}),"ดาวน์โหลด Template Excel"]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("p",{children:"• ไฟล์ template มี 7 sheets: Branches, Checkers, Customers, Products, Installments, Payments, Collections"}),i.jsx("p",{children:"• กรอกข้อมูลที่มีเครื่องหมาย * ให้ครบถ้วน"}),i.jsx("p",{children:"• ใช้รูปแบบวันที่: YYYY-MM-DD"})]})]})})]}),i.jsxs(mr,{className:"mb-6",children:[i.jsxs(Wn,{children:[i.jsxs(Gn,{className:"flex items-center gap-2",children:[i.jsx(fp,{className:"h-5 w-5 text-green-600"}),"ขั้นตอนที่ 2: อัปโหลดไฟล์"]}),i.jsx(Fs,{children:"เลือกไฟล์ Excel ที่กรอกข้อมูลแล้วเพื่อตรวจสอบและ import"})]}),i.jsx(pr,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[i.jsx("input",{ref:p,type:"file",accept:".xlsx,.xls",onChange:v,className:"hidden",id:"file-upload"}),i.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center gap-4",children:[i.jsx(Th,{className:"h-12 w-12 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-medium text-gray-900",children:"คลิกเพื่อเลือกไฟล์ Excel"}),i.jsx("p",{className:"text-sm text-gray-500",children:"รองรับไฟล์ .xlsx และ .xls เท่านั้น"})]})]})]}),t&&i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg",children:[i.jsx(Th,{className:"h-5 w-5 text-blue-600"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium text-blue-900",children:t.name}),i.jsxs("p",{className:"text-sm text-blue-600",children:["ขนาด: ",(t.size/1024/1024).toFixed(2)," MB"]})]}),i.jsx(oe,{variant:"ghost",size:"sm",onClick:N,className:"text-blue-600 hover:text-blue-800",children:"เปลี่ยนไฟล์"})]})]})})]}),n&&i.jsx(mr,{className:"mb-6",children:i.jsx(pr,{className:"pt-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Ut,{className:"h-5 w-5 animate-spin text-blue-600"}),i.jsx("span",{className:"font-medium",children:l})]}),i.jsx(pS,{value:a,className:"w-full"})]})})}),u.length>0&&i.jsxs(mr,{className:"mb-6 border-red-200",children:[i.jsxs(Wn,{children:[i.jsxs(Gn,{className:"flex items-center gap-2 text-red-600",children:[i.jsx(gf,{className:"h-5 w-5"}),"พบข้อผิดพลาดในข้อมูล"]}),i.jsx(Fs,{children:"กรุณาแก้ไขข้อผิดพลาดต่อไปนี้ก่อนทำการ import"})]}),i.jsx(pr,{children:i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:u.map((_,k)=>i.jsxs(Ld,{variant:"destructive",children:[i.jsx(ZP,{className:"h-4 w-4"}),i.jsx(Od,{children:_})]},k))})})]}),m==="ready"&&i.jsxs(mr,{className:"mb-6 border-green-200",children:[i.jsxs(Wn,{children:[i.jsxs(Gn,{className:"flex items-center gap-2 text-green-600",children:[i.jsx(Xn,{className:"h-5 w-5"}),"ข้อมูลถูกต้อง พร้อม Import"]}),i.jsx(Fs,{children:"ข้อมูลในไฟล์ผ่านการตรวจสอบแล้ว สามารถทำการ import ได้"})]}),i.jsx(pr,{children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(oe,{onClick:y,disabled:n,className:"flex items-center gap-2",children:[n?i.jsx(Ut,{className:"h-4 w-4 animate-spin"}):i.jsx(fp,{className:"h-4 w-4"}),"เริ่ม Import ข้อมูล"]}),i.jsxs(Ld,{children:[i.jsx(Oy,{className:"h-4 w-4"}),i.jsx(Od,{children:"การ import อาจใช้เวลาสักครู่ กรุณารอจนกว่าจะเสร็จสิ้น"})]})]})})]}),f&&i.jsxs(mr,{className:"mb-6",children:[i.jsx(Wn,{children:i.jsxs(Gn,{className:"flex items-center gap-2",children:[i.jsx(Xn,{className:"h-5 w-5 text-green-600"}),"ผลการ Import"]})}),i.jsx(pr,{children:i.jsxs("div",{className:"space-y-4",children:[f.summary&&i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(f.summary).map(([_,k])=>i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:_}),i.jsxs("p",{className:"text-lg font-bold text-green-600",children:[k.success," รายการ"]}),k.errors&&k.errors.length>0&&i.jsxs("p",{className:"text-sm text-red-600",children:[k.errors.length," ข้อผิดพลาด"]})]},_))}),f.errors&&f.errors.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"font-medium text-red-600",children:"ข้อผิดพลาด:"}),i.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:f.errors.map((_,k)=>i.jsx(Ld,{variant:"destructive",children:i.jsx(Od,{className:"text-sm",children:_})},k))})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx(oe,{onClick:N,variant:"outline",children:"Import ไฟล์ใหม่"}),i.jsx(oe,{onClick:e,children:"กลับสู่หน้าหลัก"})]})]})})]}),i.jsxs(mr,{children:[i.jsx(Wn,{children:i.jsxs(Gn,{className:"flex items-center gap-2",children:[i.jsx(Oy,{className:"h-5 w-5 text-blue-600"}),"คำแนะนำการใช้งาน"]})}),i.jsx(pr,{children:i.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"สำหรับข้อมูลที่มีการผ่อนอยู่แล้ว:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[i.jsx("li",{children:'กรอกข้อมูลใน Sheet "Installments" สำหรับข้อมูลสัญญาพื้นฐาน'}),i.jsx("li",{children:'กรอกข้อมูลใน Sheet "Payments" ทุกงวด (ทั้งที่ชำระแล้วและยังไม่ชำระ)'}),i.jsx("li",{children:'กรอกข้อมูลใน Sheet "Collections" เฉพาะงวดที่ชำระแล้ว'})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"รูปแบบข้อมูล:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[i.jsx("li",{children:"วันที่: YYYY-MM-DD (เช่น 2024-01-15)"}),i.jsx("li",{children:"ตัวเลข: ไม่ใส่เครื่องหมายคอมมา (เช่น 25000.50)"}),i.jsx("li",{children:"สถานะการชำระ: paid, pending, overdue, cancelled"}),i.jsx("li",{children:"สถานะสัญญา: active, completed, cancelled, overdue"})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ข้อควรระวัง:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[i.jsx("li",{children:"ห้ามเปลี่ยนชื่อคอลัมน์ในไฟล์ template"}),i.jsx("li",{children:"ข้อมูลที่มีเครื่องหมาย * จำเป็นต้องกรอก"}),i.jsx("li",{children:"รหัสต่างๆ (customer_code, contract_number) ต้องไม่ซ้ำกัน"}),i.jsx("li",{children:"เลขบัตรประชาชนต้องเป็น 13 หลักและไม่ซ้ำกัน"})]})]})]})})]})]})})};class oX{async getAll(t=null){try{const r=t?{branch_id:t}:{},n=await ye.get("/admin-users",{params:r});return n.data.success&&n.data.data?{data:n.data.data,total:n.data.total}:{data:[],total:0}}catch(r){throw console.error("Error fetching admin users:",r),new Error("ไม่สามารถดึงข้อมูลผู้ใช้งานได้")}}async getById(t){try{return(await ye.get(`/admin-users/${t}`)).data}catch(r){throw console.error("Error fetching admin user:",r),new Error("ไม่สามารถดึงข้อมูลผู้ใช้งานได้")}}async create(t){var r,n;try{return(await ye.post("/admin-users",{username:t.username,email:t.email,password:t.password,full_name:t.full_name,role:t.role,branch_id:t.branch_id,permissions:t.permissions||[],is_active:t.is_active!==void 0?t.is_active:!0})).data}catch(s){throw console.error("Error creating admin user:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("ไม่สามารถสร้างผู้ใช้งานได้")}}async update(t,r){var n,s;try{return(await ye.put(`/admin-users/${t}`,{username:r.username,email:r.email,full_name:r.full_name,role:r.role,branch_id:r.branch_id,permissions:r.permissions||[],is_active:r.is_active})).data}catch(a){throw console.error("Error updating admin user:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("ไม่สามารถอัปเดตข้อมูลผู้ใช้งานได้")}}async delete(t){var r,n;try{return(await ye.delete(`/admin-users/${t}`)).data}catch(s){throw console.error("Error deleting admin user:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("ไม่สามารถลบผู้ใช้งานได้")}}async toggleStatus(t,r){try{return(await ye.patch(`/admin-users/${t}/status`,{is_active:r})).data}catch(n){throw console.error("Error toggling user status:",n),new Error("ไม่สามารถเปลี่ยนสถานะผู้ใช้งานได้")}}async resetPassword(t){try{return(await ye.post(`/admin-users/${t}/reset-password`)).data.new_password}catch(r){throw console.error("Error resetting password:",r),new Error("ไม่สามารถรีเซ็ตรหัสผ่านได้")}}async changePassword(t,r,n){var s,a;try{return(await ye.post(`/admin-users/${t}/change-password`,{current_password:r,new_password:n})).data}catch(o){throw console.error("Error changing password:",o),(a=(s=o.response)==null?void 0:s.data)!=null&&a.message?new Error(o.response.data.message):new Error("ไม่สามารถเปลี่ยนรหัสผ่านได้")}}async getAvailablePermissions(){try{return(await ye.get("/admin-users/permissions")).data}catch(t){return console.error("Error fetching permissions:",t),{data:[{id:"dashboard.view",name:"ดูแดชบอร์ด",category:"dashboard"},{id:"branches.view",name:"ดูข้อมูลสาขา",category:"branches"},{id:"branches.create",name:"เพิ่มสาขา",category:"branches"},{id:"branches.edit",name:"แก้ไขสาขา",category:"branches"},{id:"branches.delete",name:"ลบสาขา",category:"branches"},{id:"customers.view",name:"ดูข้อมูลลูกค้า",category:"customers"},{id:"customers.create",name:"เพิ่มลูกค้า",category:"customers"},{id:"customers.edit",name:"แก้ไขลูกค้า",category:"customers"},{id:"customers.delete",name:"ลบลูกค้า",category:"customers"},{id:"products.view",name:"ดูข้อมูลสินค้า",category:"products"},{id:"products.create",name:"เพิ่มสินค้า",category:"products"},{id:"products.edit",name:"แก้ไขสินค้า",category:"products"},{id:"products.delete",name:"ลบสินค้า",category:"products"},{id:"contracts.view",name:"ดูสัญญา",category:"contracts"},{id:"contracts.create",name:"สร้างสัญญา",category:"contracts"},{id:"contracts.edit",name:"แก้ไขสัญญา",category:"contracts"},{id:"contracts.delete",name:"ลบสัญญา",category:"contracts"},{id:"payments.view",name:"ดูการชำระเงิน",category:"payments"},{id:"payments.create",name:"บันทึกการชำระ",category:"payments"},{id:"payments.edit",name:"แก้ไขการชำระ",category:"payments"},{id:"reports.view",name:"ดูรายงาน",category:"reports"},{id:"reports.export",name:"ส่งออกรายงาน",category:"reports"},{id:"settings.view",name:"ดูการตั้งค่า",category:"settings"},{id:"settings.edit",name:"แก้ไขการตั้งค่า",category:"settings"},{id:"users.view",name:"ดูผู้ใช้งาน",category:"users"},{id:"users.create",name:"เพิ่มผู้ใช้งาน",category:"users"},{id:"users.edit",name:"แก้ไขผู้ใช้งาน",category:"users"},{id:"users.delete",name:"ลบผู้ใช้งาน",category:"users"}]}}}getRoles(){return[{id:"super_admin",name:"Super Admin",description:"สิทธิ์เต็มทุกอย่าง"},{id:"admin",name:"Admin",description:"จัดการระบบและข้อมูล"},{id:"manager",name:"Manager",description:"จัดการสาขาและพนักงาน"},{id:"user",name:"User",description:"ใช้งานระบบพื้นฐาน"}]}async checkPermission(t,r){try{return(await ye.get(`/admin-users/${t}/permissions/${r}`)).data.has_permission}catch(n){return console.error("Error checking permission:",n),!1}}async getCurrentUser(){try{return(await ye.get("/admin-users/me")).data}catch(t){throw console.error("Error fetching current user:",t),new Error("ไม่สามารถดึงข้อมูลผู้ใช้งานปัจจุบันได้")}}async updateProfile(t){var r,n;try{return(await ye.put("/admin-users/me",t)).data}catch(s){throw console.error("Error updating profile:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("ไม่สามารถอัปเดตโปรไฟล์ได้")}}}const Sa=new oX,xi={getAll:async(e={})=>{try{return(await ye.get("/branches",{params:e})).data}catch(t){throw t}},getById:async e=>{try{return(await ye.get(`/branches/${e}`)).data}catch(t){throw t}},create:async e=>{try{return(await ye.post("/branches",e)).data}catch(t){throw t}},update:async(e,t)=>{try{return(await ye.put(`/branches/${e}`,t)).data}catch(r){throw r}},delete:async e=>{try{return(await ye.delete(`/branches/${e}`)).data}catch(t){throw t}},getStatistics:async e=>{try{return(await ye.get(`/branches/${e}/statistics`)).data}catch(t){throw t}},getCheckers:async(e,t={})=>{try{return(await ye.get(`/branches/${e}/checkers`,{params:t})).data}catch(r){throw r}},getCustomers:async(e,t={})=>{try{return(await ye.get(`/branches/${e}/customers`,{params:t})).data}catch(r){throw r}},getInstallments:async(e,t={})=>{try{return(await ye.get(`/branches/${e}/installments`,{params:t})).data}catch(r){throw r}},getCollections:async(e,t={})=>{try{return(await ye.get(`/branches/${e}/collections`,{params:t})).data}catch(r){throw r}}},lX=({user:e,onSubmit:t,onCancel:r,currentBranch:n})=>{const[s,a]=E.useState({username:"",email:"",password:"",confirmPassword:"",full_name:"",role:"user",branch_id:"",permissions:[],is_active:!0}),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,f]=E.useState(!1),[h,m]=E.useState([]),[g,p]=E.useState([]),[v,b]=E.useState({}),y=Sa.getRoles();E.useEffect(()=>{x(),N(),e&&a({username:e.username||"",email:e.email||"",password:"",confirmPassword:"",full_name:e.full_name||"",role:e.role||"user",branch_id:e.branch_id||"",permissions:e.permissions||[],is_active:e.is_active!==void 0?e.is_active:!0})},[e]);const x=async()=>{try{const A=await xi.getAll();m(A.data||[])}catch(A){console.error("Error loading branches:",A)}},N=async()=>{try{const A=await Sa.getAvailablePermissions();p(A.data||[])}catch(A){console.error("Error loading permissions:",A)}},_=A=>{const{name:R,value:G,type:I,checked:Z}=A.target;a(j=>({...j,[R]:I==="checkbox"?Z:G})),v[R]&&b(j=>({...j,[R]:""}))},k=(A,R)=>{a(G=>({...G,permissions:R?[...G.permissions,A]:G.permissions.filter(I=>I!==A)}))},w=()=>{const A={};return s.username.trim()?s.username.length<3&&(A.username="ชื่อผู้ใช้งานต้องมีอย่างน้อย 3 ตัวอักษร"):A.username="กรุณากรอกชื่อผู้ใช้งาน",s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(A.email="รูปแบบอีเมลไม่ถูกต้อง"):A.email="กรุณากรอกอีเมล",e||(s.password?s.password.length<6&&(A.password="รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร"):A.password="กรุณากรอกรหัสผ่าน",s.password!==s.confirmPassword&&(A.confirmPassword="รหัสผ่านไม่ตรงกัน")),s.full_name.trim()||(A.full_name="กรุณากรอกชื่อ-นามสกุล"),b(A),Object.keys(A).length===0},C=async A=>{if(A.preventDefault(),!!w()){f(!0);try{await t(s)}catch(R){console.error("Error submitting form:",R)}finally{f(!1)}}},D=g.reduce((A,R)=>(A[R.category]||(A[R.category]=[]),A[R.category].push(R),A),{}),z=A=>({dashboard:"แดชบอร์ด",branches:"สาขา",customers:"ลูกค้า",products:"สินค้า",contracts:"สัญญา",payments:"การชำระเงิน",reports:"รายงาน",settings:"การตั้งค่า",users:"ผู้ใช้งาน"})[A]||A;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(oe,{variant:"ghost",size:"sm",onClick:r,className:"flex items-center gap-2",children:[i.jsx(Vi,{className:"h-4 w-4"}),"กลับ"]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"แก้ไขผู้ใช้งาน":"เพิ่มผู้ใช้งานใหม่"}),i.jsx("p",{className:"text-gray-600 mt-2",children:e?"แก้ไขข้อมูลและสิทธิ์การเข้าถึง":"สร้างบัญชีผู้ใช้งานใหม่และกำหนดสิทธิ์"})]})]}),i.jsxs("form",{onSubmit:C,className:"space-y-6",children:[i.jsxs(mr,{children:[i.jsxs(Wn,{children:[i.jsxs(Gn,{className:"flex items-center gap-2",children:[i.jsx(Mr,{className:"h-5 w-5"}),"ข้อมูลพื้นฐาน"]}),i.jsx(Fs,{children:"ข้อมูลส่วนตัวและการเข้าสู่ระบบ"})]}),i.jsxs(pr,{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ชื่อผู้ใช้งาน *"}),i.jsx("input",{type:"text",name:"username",value:s.username,onChange:_,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.username?"border-red-500":"border-gray-300"}`,placeholder:"กรอกชื่อผู้ใช้งาน"}),v.username&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.username})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"อีเมล *"}),i.jsx("input",{type:"email",name:"email",value:s.email,onChange:_,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.email?"border-red-500":"border-gray-300"}`,placeholder:"กรอกอีเมล"}),v.email&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.email})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ชื่อ-นามสกุล *"}),i.jsx("input",{type:"text",name:"full_name",value:s.full_name,onChange:_,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.full_name?"border-red-500":"border-gray-300"}`,placeholder:"กรอกชื่อ-นามสกุล"}),v.full_name&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.full_name})]}),!e&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"รหัสผ่าน *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:o?"text":"password",name:"password",value:s.password,onChange:_,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.password?"border-red-500":"border-gray-300"}`,placeholder:"กรอกรหัสผ่าน"}),i.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?i.jsx(cp,{className:"h-4 w-4"}):i.jsx(g0,{className:"h-4 w-4"})})]}),v.password&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.password})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ยืนยันรหัสผ่าน *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:c?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:_,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"ยืนยันรหัสผ่าน"}),i.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?i.jsx(cp,{className:"h-4 w-4"}):i.jsx(g0,{className:"h-4 w-4"})})]}),v.confirmPassword&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.confirmPassword})]})]})]})]}),i.jsxs(mr,{children:[i.jsxs(Wn,{children:[i.jsxs(Gn,{className:"flex items-center gap-2",children:[i.jsx(jn,{className:"h-5 w-5"}),"บทบาทและสาขา"]}),i.jsx(Fs,{children:"กำหนดบทบาทและสาขาที่รับผิดชอบ"})]}),i.jsxs(pr,{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"บทบาท *"}),i.jsx("select",{name:"role",value:s.role,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:y.map(A=>i.jsxs("option",{value:A.id,children:[A.name," - ",A.description]},A.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"สาขา"}),i.jsxs("select",{name:"branch_id",value:s.branch_id,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"ทุกสาขา"}),h.map(A=>i.jsx("option",{value:A.id,children:A.name},A.id))]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:"is_active",name:"is_active",checked:s.is_active,onChange:_,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"เปิดใช้งานบัญชี"})]})]})]}),i.jsxs(mr,{children:[i.jsxs(Wn,{children:[i.jsxs(Gn,{className:"flex items-center gap-2",children:[i.jsx($i,{className:"h-5 w-5"}),"สิทธิ์การเข้าถึง"]}),i.jsx(Fs,{children:"กำหนดสิทธิ์การเข้าถึงฟีเจอร์ต่างๆ ในระบบ"})]}),i.jsx(pr,{children:i.jsx("div",{className:"space-y-6",children:Object.entries(D).map(([A,R])=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:z(A)}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:R.map(G=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:G.id,checked:s.permissions.includes(G.id),onChange:I=>k(G.id,I.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("label",{htmlFor:G.id,className:"text-sm text-gray-700",children:G.name})]},G.id))})]},A))})})]}),i.jsxs("div",{className:"flex items-center justify-end gap-4",children:[i.jsx(oe,{type:"button",variant:"outline",onClick:r,children:"ยกเลิก"}),i.jsxs(oe,{type:"submit",disabled:d,className:"flex items-center gap-2",children:[d?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):i.jsx(iD,{className:"h-4 w-4"}),e?"อัปเดต":"สร้าง","ผู้ใช้งาน"]})]})]})]})},cX=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(""),[c,u]=E.useState(!1),[d,f]=E.useState(null);E.useState([]),E.useEffect(()=>{h()},[e]);const h=async()=>{try{a(!0);const C=(await Sa.getAll(e)).data||[];n(C)}catch(w){console.error("Error loading admin users:",w),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลผู้ใช้งานได้",variant:"destructive"})}finally{a(!1)}},m=()=>{f(null),u(!0)},g=w=>{f(w),u(!0)},p=async w=>{if(window.confirm("คุณต้องการลบผู้ใช้งานนี้หรือไม่?"))try{await Sa.delete(w),ge({title:"สำเร็จ",description:"ลบผู้ใช้งานเรียบร้อยแล้ว",variant:"default"}),h()}catch{ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบผู้ใช้งานได้",variant:"destructive"})}},v=async(w,C)=>{try{await Sa.toggleStatus(w,!C),ge({title:"สำเร็จ",description:`${C?"ปิดใช้งาน":"เปิดใช้งาน"}ผู้ใช้งานเรียบร้อยแล้ว`,variant:"default"}),h()}catch{ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถเปลี่ยนสถานะผู้ใช้งานได้",variant:"destructive"})}},b=async w=>{if(window.confirm("คุณต้องการรีเซ็ตรหัสผ่านของผู้ใช้งานนี้หรือไม่?"))try{const C=await Sa.resetPassword(w);ge({title:"สำเร็จ",description:`รีเซ็ตรหัสผ่านเรียบร้อยแล้ว รหัสผ่านใหม่: ${C}`,variant:"default"})}catch{ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถรีเซ็ตรหัสผ่านได้",variant:"destructive"})}},y=async w=>{try{d?(await Sa.update(d.id,w),ge({title:"สำเร็จ",description:"อัปเดตข้อมูลผู้ใช้งานเรียบร้อยแล้ว",variant:"default"})):(await Sa.create(w),ge({title:"สำเร็จ",description:"เพิ่มผู้ใช้งานใหม่เรียบร้อยแล้ว",variant:"default"})),u(!1),f(null),h()}catch(C){ge({title:"เกิดข้อผิดพลาด",description:C.message||"ไม่สามารถบันทึกข้อมูลได้",variant:"destructive"})}},x=r.filter(w=>{var C,D,z,A;return((C=w.username)==null?void 0:C.toLowerCase().includes(o.toLowerCase()))||((D=w.email)==null?void 0:D.toLowerCase().includes(o.toLowerCase()))||((z=w.full_name)==null?void 0:z.toLowerCase().includes(o.toLowerCase()))||((A=w.role)==null?void 0:A.toLowerCase().includes(o.toLowerCase()))}),N=w=>{switch(w){case"super_admin":return i.jsx(Ry,{className:"h-4 w-4 text-yellow-600"});case"admin":return i.jsx(oD,{className:"h-4 w-4 text-blue-600"});case"manager":return i.jsx(jn,{className:"h-4 w-4 text-green-600"});case"user":return i.jsx(Mr,{className:"h-4 w-4 text-gray-600"});default:return i.jsx(Mr,{className:"h-4 w-4 text-gray-600"})}},_=w=>{switch(w){case"super_admin":return"Super Admin";case"admin":return"Admin";case"manager":return"Manager";case"user":return"User";default:return"User"}},k=w=>{switch(w){case"super_admin":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"admin":return"bg-blue-100 text-blue-800 border-blue-200";case"manager":return"bg-green-100 text-green-800 border-green-200";case"user":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return c?i.jsx(lX,{user:d,onSubmit:y,onCancel:()=>{u(!1),f(null)},currentBranch:t}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"จัดการผู้ใช้งาน Admin"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"จัดการบัญชีผู้ใช้งาน สิทธิ์การเข้าถึง และการตั้งค่าระบบ"})]}),i.jsxs(oe,{onClick:m,className:"flex items-center gap-2",children:[i.jsx(dD,{className:"h-4 w-4"}),"เพิ่มผู้ใช้งานใหม่"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx(mr,{children:i.jsx(pr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:i.jsx(Qn,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ผู้ใช้งานทั้งหมด"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})})}),i.jsx(mr,{children:i.jsx(pr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:i.jsx(My,{className:"h-6 w-6 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ใช้งานได้"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(w=>w.is_active).length})]})]})})}),i.jsx(mr,{children:i.jsx(pr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:i.jsx(up,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ปิดใช้งาน"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(w=>!w.is_active).length})]})]})})}),i.jsx(mr,{children:i.jsx(pr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:i.jsx(Ry,{className:"h-6 w-6 text-yellow-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Admin"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(w=>["admin","super_admin"].includes(w.role)).length})]})]})})})]}),i.jsx(mr,{children:i.jsx(pr,{className:"p-6",children:i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs("div",{className:"relative flex-1",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),i.jsx("input",{type:"text",placeholder:"ค้นหาผู้ใช้งาน...",value:o,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})})}),i.jsxs(mr,{children:[i.jsxs(Wn,{children:[i.jsx(Gn,{children:"รายการผู้ใช้งาน"}),i.jsxs(Fs,{children:["จำนวนผู้ใช้งานทั้งหมด ",x.length," คน"]})]}),i.jsx(pr,{children:s?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):x.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Qn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-500",children:"ไม่พบข้อมูลผู้ใช้งาน"})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"ผู้ใช้งาน"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"บทบาท"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"สาขา"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"สถานะ"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"เข้าใช้งานล่าสุด"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"จัดการ"})]})}),i.jsx("tbody",{children:x.map(w=>{var C,D;return i.jsxs(Me.tr,{initial:{opacity:0},animate:{opacity:1},className:"border-b border-gray-100 hover:bg-gray-50",children:[i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-medium",children:((C=w.full_name)==null?void 0:C.charAt(0))||((D=w.username)==null?void 0:D.charAt(0))||"U"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:w.full_name||w.username}),i.jsx("p",{className:"text-sm text-gray-500",children:w.email}),i.jsxs("p",{className:"text-xs text-gray-400",children:["@",w.username]})]})]})}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[N(w.role),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${k(w.role)}`,children:_(w.role)})]})}),i.jsx("td",{className:"py-4 px-4",children:i.jsx("span",{className:"text-sm text-gray-900",children:w.branch_name||"ทุกสาขา"})}),i.jsx("td",{className:"py-4 px-4",children:i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.is_active?"ใช้งานได้":"ปิดใช้งาน"})}),i.jsx("td",{className:"py-4 px-4",children:i.jsx("span",{className:"text-sm text-gray-500",children:w.last_login?new Date(w.last_login).toLocaleDateString("th-TH"):"ยังไม่เคยเข้าใช้งาน"})}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>g(w),className:"text-blue-600 hover:text-blue-800",children:i.jsx(Bs,{className:"h-4 w-4"})}),i.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>v(w.id,w.is_active),className:w.is_active?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800",children:w.is_active?i.jsx(up,{className:"h-4 w-4"}):i.jsx(My,{className:"h-4 w-4"})}),i.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>b(w.id),className:"text-orange-600 hover:text-orange-800",children:i.jsx($i,{className:"h-4 w-4"})}),i.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>p(w.id),className:"text-red-600 hover:text-red-800",children:i.jsx(ha,{className:"h-4 w-4"})})]})})]},w.id)})})]})})})]})]})},xd=({title:e,icon:t,children:r})=>{const n=t;return i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(n,{className:"w-5 h-5 text-purple-600"}),e]}),r]})},st=({label:e,value:t,onChange:r,placeholder:n,type:s="text",required:a=!1})=>i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsx("input",{type:s,value:t,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:n,required:a})]}),po=({label:e,value:t,onChange:r,options:n,placeholder:s,required:a=!1})=>{const[o,l]=E.useState(""),[c,u]=E.useState(!1),[d,f]=E.useState(n);console.log(`SearchableSelectField [${e}]:`,{optionsCount:(n==null?void 0:n.length)||0,options:n,value:t,isOpen:c,searchTerm:o}),E.useEffect(()=>{const m=n.filter(g=>{var p,v,b,y,x,N,_,k;return((p=g.name)==null?void 0:p.toLowerCase().includes(o.toLowerCase()))||((v=g.product_name)==null?void 0:v.toLowerCase().includes(o.toLowerCase()))||((b=g.full_name)==null?void 0:b.toLowerCase().includes(o.toLowerCase()))||((y=g.fullName)==null?void 0:y.toLowerCase().includes(o.toLowerCase()))||((x=g.phone)==null?void 0:x.toLowerCase().includes(o.toLowerCase()))||((N=g.nickname)==null?void 0:N.toLowerCase().includes(o.toLowerCase()))||((_=g.product_code)==null?void 0:_.toLowerCase().includes(o.toLowerCase()))||((k=g.surname)==null?void 0:k.toLowerCase().includes(o.toLowerCase()))});f(m)},[o,n]);const h=n.find(m=>m.id===t);return i.jsxs("div",{className:"relative",children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:c?o:(h==null?void 0:h.name)||(h==null?void 0:h.product_name)||(h==null?void 0:h.full_name)||(h==null?void 0:h.fullName)||(h==null?void 0:h.nickname)||"",onChange:m=>{c&&l(m.target.value)},onFocus:()=>{u(!0),l("")},onBlur:()=>{setTimeout(()=>u(!1),200)},placeholder:s,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",required:a}),i.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:i.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),c&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:d.length>0?d.map(m=>i.jsxs("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",onClick:()=>{r({target:{value:m.id}}),u(!1),l("")},children:[i.jsx("div",{className:"font-medium",children:m.name||m.product_name||m.full_name||m.fullName||m.nickname}),m.phone&&i.jsx("div",{className:"text-xs text-gray-500",children:m.phone}),m.product_code&&i.jsx("div",{className:"text-xs text-gray-500",children:m.product_code}),m.surname&&i.jsx("div",{className:"text-xs text-gray-500",children:m.surname}),m.position&&i.jsx("div",{className:"text-xs text-gray-400",children:m.position})]},m.id)):i.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"ไม่พบข้อมูล"})})]})]})},N2=({label:e,value:t,onChange:r,options:n})=>i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:e}),i.jsx("div",{className:"flex gap-4",children:n.map(s=>i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"radio",name:e,value:s,checked:t===s,onChange:a=>r(a.target.value)}),s]},s))})]}),uX=({customers:e=[],products:t=[],employees:r=[],onSubmit:n,selectedBranch:s,currentBranch:a,submitting:o=!1})=>{const[l,c]=E.useState([]),[u,d]=E.useState(!1),[f,h]=E.useState([]),[m,g]=E.useState(!1),[p,v]=E.useState([]),[b,y]=E.useState(!1),[x,N]=E.useState([]),[_,k]=E.useState(!1),[w,C]=E.useState([]),[D,z]=E.useState(!1);console.log("ContractForm props:",{customersCount:(e==null?void 0:e.length)||0,inventoryCount:(t==null?void 0:t.length)||0,employeesCount:(r==null?void 0:r.length)||0,selectedBranch:s,currentBranch:a,customers:e}),console.log("🔍 ContractForm selectedBranch check:",{selectedBranch:s,hasSelectedBranch:!!s,type:typeof s}),console.log("ContractForm state:",{allCustomersCount:(l==null?void 0:l.length)||0,allInventoryCount:(f==null?void 0:f.length)||0,allEmployeesCount:(p==null?void 0:p.length)||0,allCheckersCount:(x==null?void 0:x.length)||0,allCollectorsCount:(w==null?void 0:w.length)||0,loadingCustomers:u,loadingInventory:m,loadingEmployees:b,loadingCheckers:_,loadingCollectors:D}),console.log("ContractForm allCheckers data:",x),E.useEffect(()=>{(async()=>{var Y;if(s)try{d(!0),console.log("Loading customers from API for branch:",s);const q=await ki.getAll(s);console.log("Customers API response:",q);let S=[];(Y=q.data)!=null&&Y.success&&Array.isArray(q.data.data)?S=q.data.data:(Array.isArray(q.data)||q.data&&Array.isArray(q.data))&&(S=q.data),console.log("Processed customers data:",S),c(S)}catch(q){console.error("Error loading customers:",q),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลลูกค้าได้",variant:"destructive"}),c([])}finally{d(!1)}})()},[s]),E.useEffect(()=>{(async()=>{var Y;if(s)try{g(!0),console.log("Loading inventory from API for branch:",s);const q=await Cs.getAll({branchId:s});console.log("Inventory API response:",q);let S=[];(Y=q.data)!=null&&Y.success&&Array.isArray(q.data.data)?S=q.data.data:(Array.isArray(q.data)||q.data&&Array.isArray(q.data))&&(S=q.data),console.log("Processed inventory data:",S),h(S)}catch(q){console.error("Error loading inventory:",q),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลสินค้าได้",variant:"destructive"}),h([])}finally{g(!1)}})()},[s]),E.useEffect(()=>{(async()=>{var Y;if(s)try{y(!0),console.log("Loading employees from API for branch:",s);const q=await Ks.getAll(s);console.log("Employees API response:",q);let S=[];(Y=q.data)!=null&&Y.success&&Array.isArray(q.data.data)?S=q.data.data:(Array.isArray(q.data)||q.data&&Array.isArray(q.data))&&(S=q.data),console.log("Processed employees data:",S),v(S)}catch(q){console.error("Error loading employees:",q),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลพนักงานได้",variant:"destructive"}),v([])}finally{y(!1)}})()},[s]),E.useEffect(()=>{console.log("🚀 Checkers useEffect triggered with selectedBranch:",s);const j=async()=>{var Y;if(console.log("🔍 loadCheckers called with selectedBranch:",s),!s){console.log("❌ No selectedBranch, skipping loadCheckers");return}try{k(!0),console.log("🔄 Loading checkers from API for branch:",s);const q=await Io.getAll(s);console.log("✅ Checkers API response:",q);let S=[];(Y=q.data)!=null&&Y.success&&Array.isArray(q.data.data)?(S=q.data.data,console.log("📊 Using response.data.data format")):Array.isArray(q.data)?(S=q.data,console.log("📊 Using response.data array format")):q.data&&Array.isArray(q.data)?(S=q.data,console.log("📊 Using response.data array format (fallback)")):console.log("⚠️ Unknown response format:",q),console.log("📋 Processed checkers data:",S),console.log("📋 Sample checker item:",S[0]),N(S)}catch(q){console.error("❌ Error loading checkers:",q),console.error("❌ Error details:",{message:q.message,stack:q.stack,response:q.response}),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลผู้ตรวจสอบได้",variant:"destructive"}),N([])}finally{k(!1),console.log("🏁 loadCheckers completed")}};console.log("🚀 Setting up loadCheckers useEffect for selectedBranch:",s),j()},[s]),E.useEffect(()=>{(async()=>{var Y;if(s)try{z(!0),console.log("Loading collectors from API for branch:",s);const q=await Ks.getAll(s);console.log("Collectors API response:",q);let S=[];(Y=q.data)!=null&&Y.success&&Array.isArray(q.data.data)?S=q.data.data:(Array.isArray(q.data)||q.data&&Array.isArray(q.data))&&(S=q.data);const F=S.filter(L=>L.position==="collector"||L.position==="พนักงานเก็บเงิน");console.log("Processed collectors data:",F),C(F)}catch(q){console.error("Error loading collectors:",q),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลพนักงานเก็บเงินได้",variant:"destructive"}),C([])}finally{z(!1)}})()},[s]);const[A,R]=E.useState({contractNumber:"",customerId:"",customerDetails:{title:"นาย",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},guarantorId:"",guarantorDetails:{title:"นาย",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},productId:"",productDetails:{name:"",description:"",price:"",category:"",model:"",serialNumber:""},plan:{downPayment:"",monthlyPayment:"",months:"",collectionDate:""},salespersonId:"",inspectorId:"",collectorId:"",contractDate:new Date().toISOString().split("T")[0]});E.useEffect(()=>{if(A.customerId){const j=l.find(Y=>Y.id===A.customerId);j&&(console.log("Auto-filling customer details:",j),R(Y=>({...Y,customerDetails:{...Y.customerDetails,title:j.title||"นาย",name:j.name||"",surname:j.surname||"",nickname:j.nickname||"",age:j.age||"",idCard:j.id_card||j.idCard||"",address:j.address||"",moo:j.moo||"",road:j.road||"",subdistrict:j.subdistrict||"",district:j.district||"",province:j.province||"",phone1:j.phone1||j.phone||"",phone2:j.phone2||"",phone3:j.phone3||"",email:j.email||""}})),ge({title:"ข้อมูลลูกค้าถูกกรอกอัตโนมัติ",description:`ข้อมูลของ ${j.name||j.full_name} ถูกกรอกเรียบร้อยแล้ว`}))}},[A.customerId,l]),E.useEffect(()=>{if(A.guarantorId){console.log("🔍 Guarantor useEffect triggered with guarantorId:",A.guarantorId);const j=l.find(Y=>Y.id===A.guarantorId);console.log("🔍 Found guarantor:",j),j&&(console.log("Auto-filling guarantor details:",j),R(Y=>{console.log("🔍 Previous contractForm state:",Y);const q={...Y,guarantorDetails:{...Y.guarantorDetails,title:j.title||"นาย",name:j.name||"",surname:j.surname||"",nickname:j.nickname||"",age:j.age||"",idCard:j.id_card||j.idCard||"",address:j.address||"",moo:j.moo||"",road:j.road||"",subdistrict:j.subdistrict||"",district:j.district||"",province:j.province||"",phone1:j.phone1||j.phone||"",phone2:j.phone2||"",phone3:j.phone3||"",email:j.email||""}};return console.log("🔍 New contractForm state:",q),q}),ge({title:"ข้อมูลผู้ค้ำประกันถูกกรอกอัตโนมัติ",description:`ข้อมูลของ ${j.name||j.full_name} ถูกกรอกเรียบร้อยแล้ว`}))}},[A.guarantorId,l]),E.useEffect(()=>{if(A.productId){const j=f.find(Y=>Y.id===A.productId);j&&(console.log("Auto-filling inventory details:",j),R(Y=>({...Y,productDetails:{...Y.productDetails,name:j.product_name||"",description:j.remarks||"",price:"",category:j.product_code||"",model:j.product_code||"",serialNumber:j.sequence||""}})),ge({title:"ข้อมูลสินค้าถูกกรอกอัตโนมัติ",description:`ข้อมูลของ ${j.product_name} ถูกกรอกเรียบร้อยแล้ว`}))}},[A.productId,f]);const G=(j,Y,q)=>{R(S=>({...S,[j]:{...S[j],[Y]:q}}))},I=(j,Y)=>{console.log("🔍 handleSelectChange called:",{field:j,value:Y}),console.log("🔍 Previous contractForm state:",A),R(q=>{const S={...q,[j]:Y};return console.log("🔍 New contractForm state after handleSelectChange:",S),S})},Z=j=>{if(j.preventDefault(),console.log("🔍 ContractForm handleSubmit - contractForm:",A),console.log("🔍 Product ID in form:",A.productId),console.log("🔍 Product ID type:",typeof A.productId),console.log("🔍 Product ID in form:",A.productId),console.log("🔍 Product ID type:",typeof A.productId),!A.customerId||!A.productId||!A.salespersonId||!A.inspectorId||!A.collectorId){tt.fire({icon:"error",title:"กรุณากรอกข้อมูลให้ครบถ้วน",text:"ลูกค้า, สินค้า, พนักงานขาย, ผู้ตรวจสอบ และพนักงานเก็บเงินเป็นข้อมูลที่จำเป็น",confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"});return}if(!A.plan.monthlyPayment||!A.plan.months){tt.fire({icon:"error",title:"กรุณากรอกข้อมูลการผ่อนชำระ",text:"ผ่อนต่อเดือนและจำนวนงวดเป็นข้อมูลที่จำเป็น",confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"});return}const Y=parseFloat(A.plan.downPayment)||0,q=parseFloat(A.plan.monthlyPayment)||0,S=parseInt(A.plan.months)||0,F=q*S,L=Y+F;if(L<=0){tt.fire({icon:"error",title:"กรุณากรอกข้อมูลการผ่อนชำระให้ถูกต้อง",text:"ไม่สามารถคำนวณราคาขายจริงได้",confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"});return}const T=f.find(J=>J.id===A.productId);console.log("🔍 Selected inventory:",T),console.log("🔍 All inventory:",f),console.log("🔍 ราคาต้นทุนจากสินค้า:",(T==null?void 0:T.cost_price)||0);const U=l.find(J=>J.id===A.customerId),X=w.find(J=>J.id===A.collectorId),H=q,ee=L-Y,me=new Date(A.contractDate),le=new Date(me);le.setMonth(le.getMonth()+S);const ce={contractNumber:A.contractNumber||void 0,contractDate:A.contractDate,customerId:A.customerId,productId:A.productId,productName:(T==null?void 0:T.product_name)||"",totalAmount:L,installmentAmount:H,remainingAmount:ee,installmentPeriod:S,startDate:me.toISOString().split("T")[0],endDate:le.toISOString().split("T")[0],branchId:s,salespersonId:A.salespersonId,inspectorId:A.inspectorId,line:(X==null?void 0:X.code)||(X==null?void 0:X.name)||"",customerTitle:A.customerDetails.title,customerAge:parseInt(A.customerDetails.age)||null,customerMoo:A.customerDetails.moo,customerRoad:A.customerDetails.road,customerSubdistrict:A.customerDetails.subdistrict,customerDistrict:A.customerDetails.district,customerProvince:A.customerDetails.province,customerPhone1:A.customerDetails.phone1,customerPhone2:A.customerDetails.phone2,customerPhone3:A.customerDetails.phone3,customerEmail:A.customerDetails.email,customerIdCard:A.customerDetails.idCard,customerName:A.customerDetails.name,customerSurname:A.customerDetails.surname,customerNickname:A.customerDetails.nickname,customerAddress:A.customerDetails.address,guarantorId:A.guarantorId,guarantorTitle:A.guarantorDetails.title,guarantorName:A.guarantorDetails.name,guarantorSurname:A.guarantorDetails.surname,guarantorNickname:A.guarantorDetails.nickname,guarantorAge:parseInt(A.guarantorDetails.age)||null,guarantorIdCard:A.guarantorDetails.idCard,guarantorAddress:A.guarantorDetails.address,guarantorMoo:A.guarantorDetails.moo,guarantorRoad:A.guarantorDetails.road,guarantorSubdistrict:A.guarantorDetails.subdistrict,guarantorDistrict:A.guarantorDetails.district,guarantorProvince:A.guarantorDetails.province,guarantorPhone1:A.guarantorDetails.phone1,guarantorPhone2:A.guarantorDetails.phone2,guarantorPhone3:A.guarantorDetails.phone3,guarantorEmail:A.guarantorDetails.email,productDescription:A.productDetails.description,productCategory:A.productDetails.category,productModel:A.productDetails.model,productSerialNumber:A.productDetails.serialNumber,productName:A.productDetails.name||(T==null?void 0:T.product_name)||"",costPrice:(T==null?void 0:T.cost_price)||0,downPayment:Y,monthlyPayment:q,months:S,collectionDate:A.plan.collectionDate,status:"active"};console.log("🔍 ContractForm handleSubmit - prepared contractData:",ce),tt.fire({title:"ยืนยันการสร้างสัญญา",html:`
        <div class="text-left">
          <p><strong>ลูกค้า:</strong> ${(U==null?void 0:U.name)||"ไม่ระบุ"}</p>
          <p><strong>สินค้า:</strong> ${(T==null?void 0:T.product_name)||"ไม่ระบุ"}</p>
          <p><strong>ราคาขายจริง:</strong> ${L.toLocaleString()} บาท</p>
          <p><strong>เงินดาวน์:</strong> ${Y.toLocaleString()} บาท</p>
          <p><strong>ผ่อนต่อเดือน:</strong> ${q.toLocaleString()} บาท</p>
          <p><strong>จำนวนงวด:</strong> ${S} งวด</p>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"สร้างสัญญา",cancelButtonText:"ยกเลิก",confirmButtonColor:"#7c3aed",cancelButtonColor:"#6b7280",reverseButtons:!0}).then(J=>{J.isConfirmed&&(tt.fire({title:"กำลังสร้างสัญญา...",text:"กรุณารอสักครู่",allowOutsideClick:!1,didOpen:()=>{tt.showLoading()}}),n(ce))})};return i.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[i.jsx(gr,{className:"w-6 h-6 text-blue-600"}),"สร้างสัญญาใหม่"]}),i.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[i.jsxs(xd,{title:"รายละเอียดลูกค้า",icon:Mr,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(po,{label:"ค้นหาลูกค้า",value:A.customerId,onChange:j=>I("customerId",j.target.value),options:l,placeholder:u?"กำลังโหลดข้อมูล...":"--พิมพ์ค้นหาลูกค้า--",required:!0}),i.jsx(po,{label:"ค้นหาผู้ค้ำ",value:A.guarantorId,onChange:j=>I("guarantorId",j.target.value),options:l,placeholder:u?"กำลังโหลดข้อมูล...":"--พิมพ์ค้นหาผู้ค้ำ--"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"flex-1",children:i.jsx(st,{label:"เลขสัญญา (ไม่บังคับ)",value:A.contractNumber,onChange:j=>I("contractNumber",j.target.value),placeholder:"พิมพ์เลขสัญญาเอง หรือปล่อยว่างให้ระบบสร้างอัตโนมัติ"})}),i.jsx("div",{className:"flex items-end",children:i.jsx(oe,{type:"button",onClick:()=>{const j=new Date,Y=j.getFullYear().toString().slice(-2),q=(j.getMonth()+1).toString().padStart(2,"0"),S=j.getDate().toString().padStart(2,"0"),F=Math.floor(Math.random()*1e3).toString().padStart(3,"0"),L=`CT${Y}${q}${S}${F}`;I("contractNumber",L)},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm",children:"สร้างอัตโนมัติ"})})]}),i.jsx(st,{label:"วันที่",type:"date",value:A.contractDate,onChange:j=>I("contractDate",j.target.value)})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(N2,{label:"คำนำหน้าชื่อ",value:A.customerDetails.title,onChange:j=>G("customerDetails","title",j),options:["นาย","นาง","นางสาว"]}),i.jsx(st,{label:"ชื่อ-สกุล",value:A.customerDetails.name,onChange:j=>G("customerDetails","name",j.target.value),placeholder:"ชื่อ-สกุล",required:!0}),i.jsx(st,{label:"ชื่อเล่น",value:A.customerDetails.nickname,onChange:j=>G("customerDetails","nickname",j.target.value),placeholder:"ชื่อเล่น"}),i.jsx(st,{label:"อายุ",value:A.customerDetails.age,onChange:j=>G("customerDetails","age",j.target.value),placeholder:"อายุ",type:"number"}),i.jsx(st,{label:"เลขบัตรประชาชน",value:A.customerDetails.idCard,onChange:j=>G("customerDetails","idCard",j.target.value),placeholder:"เลขบัตรประชาชน"}),i.jsx(st,{label:"บ้านเลขที่",value:A.customerDetails.address,onChange:j=>G("customerDetails","address",j.target.value),placeholder:"บ้านเลขที่"}),i.jsx(st,{label:"หมู่ที่",value:A.customerDetails.moo,onChange:j=>G("customerDetails","moo",j.target.value),placeholder:"หมู่ที่"}),i.jsx(st,{label:"ถนน",value:A.customerDetails.road,onChange:j=>G("customerDetails","road",j.target.value),placeholder:"ถนน"}),i.jsx(st,{label:"ตำบล/แขวง",value:A.customerDetails.subdistrict,onChange:j=>G("customerDetails","subdistrict",j.target.value),placeholder:"ตำบล/แขวง"}),i.jsx(st,{label:"อำเภอ/เขต",value:A.customerDetails.district,onChange:j=>G("customerDetails","district",j.target.value),placeholder:"อำเภอ/เขต"}),i.jsx(st,{label:"จังหวัด",value:A.customerDetails.province,onChange:j=>G("customerDetails","province",j.target.value),placeholder:"จังหวัด"}),i.jsx(st,{label:"โทรศัพท์ 1",value:A.customerDetails.phone1,onChange:j=>G("customerDetails","phone1",j.target.value),placeholder:"เบอร์โทรศัพท์",required:!0}),i.jsx(st,{label:"โทรศัพท์ 2",value:A.customerDetails.phone2,onChange:j=>G("customerDetails","phone2",j.target.value),placeholder:"เบอร์โทรศัพท์สำรอง"}),i.jsx(st,{label:"โทรศัพท์ 3",value:A.customerDetails.phone3,onChange:j=>G("customerDetails","phone3",j.target.value),placeholder:"เบอร์โทรศัพท์บ้าน"})]})]}),i.jsx(xd,{title:"รายละเอียดผู้ค้ำ",icon:jn,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(N2,{label:"คำนำหน้าชื่อ",value:A.guarantorDetails.title,onChange:j=>G("guarantorDetails","title",j),options:["นาย","นาง","นางสาว"]}),i.jsx(st,{label:"ชื่อ-สกุล",value:A.guarantorDetails.name,onChange:j=>G("guarantorDetails","name",j.target.value),placeholder:"ชื่อ-สกุล"}),i.jsx(st,{label:"ชื่อเล่น",value:A.guarantorDetails.nickname,onChange:j=>G("guarantorDetails","nickname",j.target.value),placeholder:"ชื่อเล่น"}),i.jsx(st,{label:"อายุ",value:A.guarantorDetails.age,onChange:j=>G("guarantorDetails","age",j.target.value),placeholder:"อายุ",type:"number"}),i.jsx(st,{label:"เลขบัตรประชาชน",value:A.guarantorDetails.idCard,onChange:j=>G("guarantorDetails","idCard",j.target.value),placeholder:"เลขบัตรประชาชน"}),i.jsx(st,{label:"บ้านเลขที่",value:A.guarantorDetails.address,onChange:j=>G("guarantorDetails","address",j.target.value),placeholder:"บ้านเลขที่"}),i.jsx(st,{label:"หมู่ที่",value:A.guarantorDetails.moo,onChange:j=>G("guarantorDetails","moo",j.target.value),placeholder:"หมู่ที่"}),i.jsx(st,{label:"ถนน",value:A.guarantorDetails.road,onChange:j=>G("guarantorDetails","road",j.target.value),placeholder:"ถนน"}),i.jsx(st,{label:"ตำบล/แขวง",value:A.guarantorDetails.subdistrict,onChange:j=>G("guarantorDetails","subdistrict",j.target.value),placeholder:"ตำบล/แขวง"}),i.jsx(st,{label:"อำเภอ/เขต",value:A.guarantorDetails.district,onChange:j=>G("guarantorDetails","district",j.target.value),placeholder:"อำเภอ/เขต"}),i.jsx(st,{label:"จังหวัด",value:A.guarantorDetails.province,onChange:j=>G("guarantorDetails","province",j.target.value),placeholder:"จังหวัด"}),i.jsx(st,{label:"โทรศัพท์ 1",value:A.guarantorDetails.phone1,onChange:j=>G("guarantorDetails","phone1",j.target.value),placeholder:"เบอร์โทรศัพท์"}),i.jsx(st,{label:"โทรศัพท์ 2",value:A.guarantorDetails.phone2,onChange:j=>G("guarantorDetails","phone2",j.target.value),placeholder:"เบอร์โทรศัพท์สำรอง"}),i.jsx(st,{label:"โทรศัพท์ 3",value:A.guarantorDetails.phone3,onChange:j=>G("guarantorDetails","phone3",j.target.value),placeholder:"เบอร์โทรศัพท์บ้าน"})]})}),i.jsx(xd,{title:"รายละเอียดสินค้าและแผนการผ่อน",icon:Qr,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(po,{label:"ชนิดสินค้า",value:A.productId,onChange:j=>I("productId",j.target.value),options:f.filter(j=>j.status==="active"&&Number(j.remaining_quantity1)>0).map(j=>({...j,displayName:j.product_name||j.name||"",searchText:`${j.product_name||""} ${j.product_code||""}`.trim()})),placeholder:m?"กำลังโหลดข้อมูล...":"--พิมพ์ค้นหาสินค้า--",required:!0}),i.jsx(st,{label:"ราคาขายจริง",value:(()=>{const j=parseFloat(A.plan.downPayment)||0,Y=parseFloat(A.plan.monthlyPayment)||0,q=parseInt(A.plan.months)||0,S=Y*q,F=j+S;return F>0?F.toString():""})(),onChange:j=>G("productDetails","price",j.target.value),placeholder:"คำนวณอัตโนมัติ",type:"number",required:!0,disabled:!0}),i.jsx(st,{label:"รุ่น",value:A.productDetails.model,onChange:j=>G("productDetails","model",j.target.value),placeholder:"รุ่น"}),i.jsx(st,{label:"S/N",value:A.productDetails.serialNumber,onChange:j=>G("productDetails","serialNumber",j.target.value),placeholder:"Serial Number"}),i.jsx(st,{label:"ดาวน์",value:A.plan.downPayment,onChange:j=>G("plan","downPayment",j.target.value),placeholder:"เงินดาวน์",type:"number"}),i.jsx(st,{label:"ผ่อน/เดือน",value:A.plan.monthlyPayment,onChange:j=>G("plan","monthlyPayment",j.target.value),placeholder:"ผ่อนต่อเดือน",type:"number",required:!0}),i.jsx(st,{label:"จำนวนงวด",value:A.plan.months,onChange:j=>G("plan","months",j.target.value),placeholder:"จำนวนเดือน",type:"number",required:!0}),i.jsx(st,{label:"เก็บทุกวันที่",value:A.plan.collectionDate,onChange:j=>G("plan","collectionDate",j.target.value),placeholder:"ว-ด-ป เช่น 31-12-2564"})]})}),i.jsx(xd,{title:"พนักงาน",icon:Ls,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(po,{label:"พนักงานขาย",value:A.salespersonId,onChange:j=>I("salespersonId",j.target.value),options:p,placeholder:b?"กำลังโหลดข้อมูล...":"--เลือกพนักงานขาย--",required:!0}),i.jsx(po,{label:"ผู้ตรวจสอบ",value:A.inspectorId,onChange:j=>I("inspectorId",j.target.value),options:x,placeholder:_?"กำลังโหลดข้อมูล...":"--เลือกผู้ตรวจสอบ--",required:!0}),i.jsx(po,{label:"สาย (พนักงานเก็บเงิน)",value:A.collectorId,onChange:j=>I("collectorId",j.target.value),options:w,placeholder:D?"กำลังโหลดข้อมูล...":"--เลือกพนักงานเก็บเงิน--"})]})}),i.jsx("div",{className:"flex justify-end gap-3 pt-4",children:i.jsx(oe,{type:"submit",disabled:o,className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"กำลังสร้างสัญญา..."]}):i.jsxs(i.Fragment,{children:[i.jsx(U4,{className:"w-4 h-4 mr-2"}),"สร้างสัญญา"]})})})]})]})},gd=({title:e,icon:t,children:r})=>{const n=t;return i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(n,{className:"w-5 h-5 text-purple-600"}),e]}),r]})},at=({label:e,value:t,onChange:r,placeholder:n,type:s="text",required:a=!1})=>i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsx("input",{type:s,value:t,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:n,required:a})]}),xo=({label:e,value:t,onChange:r,options:n,placeholder:s,required:a=!1})=>{const[o,l]=E.useState(""),[c,u]=E.useState(!1),[d,f]=E.useState(n);E.useEffect(()=>{const m=n.filter(g=>(g.searchText||`${g.name||""} ${g.full_name||""} ${g.fullName||""} ${g.code||""} ${g.nickname||""} ${g.phone||""} ${g.surname||""} ${g.product_name||""}`.toLowerCase()).includes(o.toLowerCase()));f(m)},[o,n]);const h=n.find(m=>m.id===t);return i.jsxs("div",{className:"relative",children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:c?o:(h==null?void 0:h.displayName)||(h==null?void 0:h.name)||(h==null?void 0:h.full_name)||(h==null?void 0:h.fullName)||(h==null?void 0:h.nickname)||(h==null?void 0:h.product_name)||"",onChange:m=>{c&&l(m.target.value)},onFocus:()=>u(!0),onBlur:()=>setTimeout(()=>u(!1),200),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:s}),i.jsx(xn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]}),c&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:d.map(m=>i.jsxs("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",onClick:()=>{r({target:{value:m.id}}),u(!1),l("")},children:[m.displayName||m.name||m.full_name||m.fullName||m.nickname||m.product_name,m.phone&&i.jsxs("span",{className:"text-gray-500 ml-2",children:["(",m.phone,")"]})]},m.id))})]})},k2=({label:e,value:t,onChange:r,options:n})=>i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:e}),i.jsx("div",{className:"flex gap-4",children:n.map(s=>i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:s,checked:t===s,onChange:a=>r(a.target.value),className:"mr-2"}),i.jsx("span",{className:"text-sm",children:s})]},s))})]}),dX=({contractId:e,selectedBranch:t,onBack:r,onSuccess:n})=>{console.log("🔍 ContractEditForm rendered with props:",{contractId:e,selectedBranch:t});const[s,a]=E.useState([]),[o,l]=E.useState(!1),[c,u]=E.useState([]),[d,f]=E.useState(!1),[h,m]=E.useState([]),[g,p]=E.useState(!1),[v,b]=E.useState([]),[y,x]=E.useState(!1),[N,_]=E.useState([]),[k,w]=E.useState(!1),[C,D]=E.useState(!0),[z,A]=E.useState(!1),[R,G]=E.useState([]),[I,Z]=E.useState({contractNumber:"",contractDate:"",customerId:"",customerDetails:{title:"นาย",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},guarantorId:"",guarantorDetails:{title:"นาย",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},productId:"",productDetails:{name:"",description:"",price:"",category:"",model:"",serialNumber:""},plan:{downPayment:"",monthlyPayment:"",months:"",collectionDate:""},salespersonId:"",inspectorId:"",collectorId:"",line:"",totalAmount:0,installmentPeriod:12,startDate:"",endDate:""});E.useEffect(()=>{console.log("🔍 contractForm state changed:",I),console.log("🔍 contractForm.contractNumber:",I.contractNumber),console.log("🔍 contractForm.contractDate:",I.contractDate),console.log("🔍 contractForm.productId:",I.productId),console.log("🔍 contractForm.customerDetails.name:",I.customerDetails.name),console.log("🔍 contractForm.productDetails.name:",I.productDetails.name),console.log("🔍 contractForm.totalAmount:",I.totalAmount)},[I]),E.useEffect(()=>{if(I.productId&&c.length>0){const S=c.find(F=>F.id===parseInt(I.productId));S&&(console.log("🔍 Auto-filling product details for:",S),Z(F=>({...F,productDetails:{...F.productDetails,name:S.product_name||"",price:S.cost_price?S.cost_price.toString():""}})))}},[I.productId,c]),E.useEffect(()=>{(async()=>{var F,L,T,U,X,H,ee,me,le,ce,J,Se,B,je,_e,Re,Te,pe,Ae,et,Q,he,Fe,Le,Oe,Ve,Ye,vt,yt,Tt,qe,At,Gr,Vt,ws,_l,Fu,Pu;if(e)try{D(!0),console.log("🔍 Loading contract with ID:",e);const ns=await Ci.getById(e);console.log("🔍 API Response:",ns);let se;if((F=ns.data)!=null&&F.success?se=ns.data.data:ns.data?se=ns.data:se=ns,console.log("🔍 Contract data:",se),console.log("🔍 Contract data keys:",Object.keys(se||{})),console.log("🔍 Contract contractNumber:",se==null?void 0:se.contractNumber),console.log("🔍 Contract customerName:",se==null?void 0:se.customerName),console.log("🔍 Contract customerFullName:",se==null?void 0:se.customerFullName),console.log("🔍 Contract productName:",se==null?void 0:se.productName),console.log("🔍 Contract totalAmount:",se==null?void 0:se.totalAmount),console.log("🔍 Contract customerDetails:",se==null?void 0:se.customerDetails),console.log("🔍 Contract customerIdCard:",se==null?void 0:se.customerIdCard),console.log("🔍 Contract customerNickname:",se==null?void 0:se.customerNickname),console.log("🔍 Contract guarantorIdCard:",se==null?void 0:se.guarantorIdCard),console.log("🔍 Contract guarantorNickname:",se==null?void 0:se.guarantorNickname),console.log("🔍 Contract productDetails:",se==null?void 0:se.productDetails),console.log("🔍 Contract plan:",se==null?void 0:se.plan),se){const ss={contractNumber:se.contractNumber||"",contractDate:se.contractDate?se.contractDate.split("T")[0]:se.startDate?se.startDate.split("T")[0]:"",customerId:se.customerId||"",customerDetails:{title:((L=se.customerDetails)==null?void 0:L.title)||se.customerTitle||"นาย",name:se.customerName||"",surname:se.customerSurname||"",nickname:((T=se.customerDetails)==null?void 0:T.nickname)||se.customerNickname||"",age:((U=se.customerDetails)==null?void 0:U.age)||se.customerAge||"",idCard:((X=se.customerDetails)==null?void 0:X.idCard)||se.customerIdCard||"",address:se.customerAddress||"",moo:((H=se.customerDetails)==null?void 0:H.moo)||se.customerMoo||"",road:((ee=se.customerDetails)==null?void 0:ee.road)||se.customerRoad||"",subdistrict:((me=se.customerDetails)==null?void 0:me.subdistrict)||se.customerSubdistrict||"",district:((le=se.customerDetails)==null?void 0:le.district)||se.customerDistrict||"",province:((ce=se.customerDetails)==null?void 0:ce.province)||se.customerProvince||"",phone1:((J=se.customerDetails)==null?void 0:J.phone1)||se.customerPhone1||se.customerPhone||"",phone2:((Se=se.customerDetails)==null?void 0:Se.phone2)||se.customerPhone2||"",phone3:((B=se.customerDetails)==null?void 0:B.phone3)||se.customerPhone3||"",email:((je=se.customerDetails)==null?void 0:je.email)||se.customerEmail||""},guarantorId:se.guarantorId||"",guarantorDetails:{title:((_e=se.guarantorDetails)==null?void 0:_e.title)||se.guarantorTitle||"นาย",name:((Re=se.guarantorDetails)==null?void 0:Re.name)||se.guarantorName||"",surname:((Te=se.guarantorDetails)==null?void 0:Te.surname)||se.guarantorSurname||"",nickname:((pe=se.guarantorDetails)==null?void 0:pe.nickname)||se.guarantorNickname||"",age:((Ae=se.guarantorDetails)==null?void 0:Ae.age)||se.guarantorAge||"",idCard:((et=se.guarantorDetails)==null?void 0:et.idCard)||se.guarantorIdCard||"",address:((Q=se.guarantorDetails)==null?void 0:Q.address)||se.guarantorAddress||"",moo:((he=se.guarantorDetails)==null?void 0:he.moo)||se.guarantorMoo||"",road:((Fe=se.guarantorDetails)==null?void 0:Fe.road)||se.guarantorRoad||"",subdistrict:((Le=se.guarantorDetails)==null?void 0:Le.subdistrict)||se.guarantorSubdistrict||"",district:((Oe=se.guarantorDetails)==null?void 0:Oe.district)||se.guarantorDistrict||"",province:((Ve=se.guarantorDetails)==null?void 0:Ve.province)||se.guarantorProvince||"",phone1:((Ye=se.guarantorDetails)==null?void 0:Ye.phone1)||se.guarantorPhone1||"",phone2:((vt=se.guarantorDetails)==null?void 0:vt.phone2)||se.guarantorPhone2||"",phone3:((yt=se.guarantorDetails)==null?void 0:yt.phone3)||se.guarantorPhone3||"",email:((Tt=se.guarantorDetails)==null?void 0:Tt.email)||se.guarantorEmail||""},productId:se.productId||"",productDetails:{name:se.productName||"",description:((qe=se.productDetails)==null?void 0:qe.description)||se.productDescription||"",price:se.productPrice||se.totalAmount||"",category:((At=se.productDetails)==null?void 0:At.category)||se.productCategory||"",model:((Gr=se.productDetails)==null?void 0:Gr.model)||se.productModel||"",serialNumber:((Vt=se.productDetails)==null?void 0:Vt.serialNumber)||se.productSerialNumber||""},plan:{downPayment:((ws=se.plan)==null?void 0:ws.downPayment)||se.downPayment||"",monthlyPayment:((_l=se.plan)==null?void 0:_l.monthlyPayment)||se.monthlyPayment||se.installmentAmount||"",months:((Fu=se.plan)==null?void 0:Fu.months)||se.months||se.installmentPeriod||"",collectionDate:((Pu=se.plan)==null?void 0:Pu.collectionDate)||se.collectionDate||""},salespersonId:se.salespersonId||"",inspectorId:se.inspectorId||"",collectorId:se.collectorId||"",line:se.line||"",totalAmount:se.totalAmount||0,installmentPeriod:se.installmentPeriod||se.months||12,startDate:se.startDate||"",endDate:se.endDate||""};console.log("🔍 Mapped form data:",ss),console.log("🔍 Mapped customerDetails:",ss.customerDetails),console.log("🔍 Mapped productDetails:",ss.productDetails),console.log("🔍 Mapped plan:",ss.plan),console.log("🔍 Contract productId:",se.productId),console.log("🔍 Form productId:",ss.productId),console.log("🔍 Contract contractDate:",se.contractDate),console.log("🔍 Form contractDate:",ss.contractDate),console.log("🔍 Setting contractForm with:",ss),Z(ss),console.log("✅ setContractForm called")}}catch(ns){console.error("Error loading contract:",ns),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลสัญญาได้",variant:"destructive"})}finally{D(!1)}})()},[e]),E.useEffect(()=>{console.log("🔍 contractForm state changed:",I),console.log("🔍 contractForm.contractNumber:",I.contractNumber),console.log("🔍 contractForm.contractDate:",I.contractDate),console.log("🔍 contractForm.productId:",I.productId),console.log("🔍 contractForm.customerDetails.name:",I.customerDetails.name),console.log("🔍 contractForm.productDetails.name:",I.productDetails.name),console.log("🔍 contractForm.totalAmount:",I.totalAmount)},[I]),E.useEffect(()=>{if(I.productId&&c.length>0){const S=c.find(F=>F.id===parseInt(I.productId));S&&(console.log("🔍 Auto-filling product details for:",S),Z(F=>({...F,productDetails:{...F.productDetails,name:S.product_name||"",price:S.cost_price?S.cost_price.toString():""}})))}},[I.productId,c]),E.useEffect(()=>{(async()=>{var F;if(t)try{l(!0),console.log("🔍 Loading customers for branch:",t);const L=await ki.getAll(t);console.log("🔍 Customers response:",L);let T=[];(F=L.data)!=null&&F.success&&Array.isArray(L.data.data)?T=L.data.data:Array.isArray(L.data)&&(T=L.data),console.log("🔍 Processed customers data:",T),a(T)}catch(L){console.error("Error loading customers:",L),console.warn("⚠️ Customers loading failed, continuing without customers data"),a([])}finally{l(!1)}})()},[t]),E.useEffect(()=>{(async()=>{var F;if(t)try{f(!0),console.log("🔍 Loading inventory for branch:",t);const L=await Cs.getAll({branchId:t});console.log("🔍 Inventory response:",L);let T=[];(F=L.data)!=null&&F.success&&Array.isArray(L.data.data)?T=L.data.data:Array.isArray(L.data)&&(T=L.data),console.log("🔍 Processed inventory data:",T),console.log("🔍 All inventory items:",T.length),console.log("🔍 Active inventory items:",T.filter(U=>U.status==="active"&&Number(U.remaining_quantity1)>0).length),u(T)}catch(L){console.error("Error loading inventory:",L),console.warn("⚠️ Inventory loading failed, continuing without inventory data"),u([])}finally{f(!1)}})()},[t]),E.useEffect(()=>{(async()=>{var F;if(t)try{p(!0),console.log("🔍 Loading employees for branch:",t);const L=await Ks.getAll(t);console.log("🔍 Employees response:",L);let T=[];(F=L.data)!=null&&F.success&&Array.isArray(L.data.data)?T=L.data.data:Array.isArray(L.data)&&(T=L.data),console.log("🔍 Processed employees data:",T),m(T)}catch(L){console.error("Error loading employees:",L),console.warn("⚠️ Employees loading failed, continuing without employees data"),m([])}finally{p(!1)}})()},[t]),E.useEffect(()=>{(async()=>{var F;if(t)try{x(!0),console.log("🔍 Loading checkers for branch:",t);const L=await Io.getAll(t);console.log("🔍 Checkers response:",L);let T=[];(F=L.data)!=null&&F.success&&Array.isArray(L.data.data)?T=L.data.data:Array.isArray(L.data)&&(T=L.data),console.log("🔍 Processed checkers data:",T),b(T)}catch(L){console.error("Error loading checkers:",L),console.warn("⚠️ Checkers loading failed, continuing without checkers data"),b([])}finally{x(!1)}})()},[t]),E.useEffect(()=>{(async()=>{var F;if(t)try{w(!0),console.log("🔍 Loading collectors for branch:",t);const L=await Ks.getAll(t);console.log("🔍 Collectors response:",L);let T=[];(F=L.data)!=null&&F.success&&Array.isArray(L.data.data)?T=L.data.data:Array.isArray(L.data)&&(T=L.data);const U=T.filter(X=>X.position==="collector"||X.position==="พนักงานเก็บเงิน");console.log("🔍 Processed collectors data:",U),_(U)}catch(L){console.error("Error loading collectors:",L),console.warn("⚠️ Collectors loading failed, continuing without collectors data"),_([])}finally{w(!1)}})()},[t]),E.useEffect(()=>{(async()=>{var F;if(t)try{D(!0),console.log("🔍 Loading contracts for branch:",t);const L=await Ci.getAll(t);console.log("🔍 Contracts response:",L);let T=[];(F=L.data)!=null&&F.success&&Array.isArray(L.data.data)?T=L.data.data:Array.isArray(L.data)&&(T=L.data),console.log("🔍 Processed contracts data:",T),console.log("🔍 Contracts with product_id:",T.filter(U=>U.product_id)),G(T)}catch(L){console.error("Error loading contracts:",L),console.warn("⚠️ Contracts loading failed, continuing without contracts data"),G([])}finally{D(!1)}})()},[t]),E.useEffect(()=>{if(N.length>0&&I.line&&!I.collectorId){const S=N.find(F=>F.code===I.line||F.name===I.line||F.full_name===I.line);S&&(console.log("🔍 Mapping collectorId from line:",I.line,"to collectorId:",S.id),Z(F=>({...F,collectorId:S.id})))}},[N,I.line,I.collectorId]);const j=(S,F,L)=>{Z(T=>({...T,[S]:{...T[S],[F]:L}}))},Y=(S,F)=>{Z(L=>({...L,[S]:F}))},q=async S=>{var U,X;if(S.preventDefault(),console.log("🔍 ContractEditForm handleSubmit - contractForm:",I),!I.customerId||!I.productId||!I.salespersonId||!I.inspectorId||!I.collectorId){ge({title:"กรุณากรอกข้อมูลให้ครบถ้วน",description:"ลูกค้า, สินค้า, พนักงานขาย, ผู้ตรวจสอบ และพนักงานเก็บเงินเป็นข้อมูลที่จำเป็น",variant:"destructive"});return}const F=c.find(H=>H.id===I.productId),L=N.find(H=>H.id===I.collectorId),T={...I,productName:(F==null?void 0:F.name)||I.productDetails.name,line:(L==null?void 0:L.code)||(L==null?void 0:L.name)||I.line||"",totalAmount:parseFloat(I.productDetails.price)||I.totalAmount,installmentPeriod:parseInt(I.plan.months)||I.installmentPeriod,startDate:I.contractDate,endDate:(()=>{const H=new Date(I.contractDate),ee=parseInt(I.plan.months)||I.installmentPeriod;return H.setMonth(H.getMonth()+ee),H.toISOString().split("T")[0]})(),plan:{...I.plan,monthlyPayment:parseFloat(I.plan.monthlyPayment)||0}};console.log("🔍 ContractEditForm handleSubmit - prepared contractData:",T);try{A(!0);const H=await Ci.update(e,T);if((U=H.data)!=null&&U.success)ge({title:"สำเร็จ",description:"แก้ไขสัญญาเรียบร้อยแล้ว"}),n&&n(H.data.data);else throw new Error(((X=H.data)==null?void 0:X.message)||"เกิดข้อผิดพลาด")}catch(H){console.error("Error updating contract:",H),ge({title:"เกิดข้อผิดพลาด",description:H.message||"ไม่สามารถแก้ไขสัญญาได้",variant:"destructive"})}finally{A(!1)}};return C?i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-8 h-8 border-4 border-orange-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"กำลังโหลดข้อมูลสัญญา..."}),i.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Contract ID: ",e]})]})})}):i.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(gr,{className:"w-6 h-6 text-blue-600"}),"แก้ไขสัญญา"]}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["เลขสัญญา: ",I.contractNumber]})]}),i.jsxs(oe,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[i.jsx(Vi,{className:"w-4 h-4"}),"กลับ"]})]}),i.jsxs("form",{onSubmit:q,className:"space-y-6",children:[i.jsxs(gd,{title:"รายละเอียดลูกค้า",icon:Mr,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(xo,{label:"ค้นหาลูกค้า",value:I.customerId,onChange:S=>Y("customerId",S.target.value),options:s,placeholder:o?"กำลังโหลดข้อมูล...":"--พิมพ์ค้นหาลูกค้า--",required:!0}),i.jsx(xo,{label:"ค้นหาผู้ค้ำ",value:I.guarantorId,onChange:S=>Y("guarantorId",S.target.value),options:s,placeholder:o?"กำลังโหลดข้อมูล...":"--พิมพ์ค้นหาผู้ค้ำ--"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(at,{label:"เลขสัญญา",value:I.contractNumber,onChange:S=>Y("contractNumber",S.target.value),placeholder:"เลขสัญญา",required:!0}),i.jsx(at,{label:"วันที่",type:"date",value:I.contractDate,onChange:S=>Y("contractDate",S.target.value),required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(k2,{label:"คำนำหน้าชื่อ",value:I.customerDetails.title,onChange:S=>j("customerDetails","title",S),options:["นาย","นาง","นางสาว"]}),i.jsx(at,{label:"ชื่อ-สกุล",value:`${I.customerDetails.name} ${I.customerDetails.surname}`.trim(),onChange:S=>{const L=S.target.value.split(" "),T=L[0]||"",U=L.slice(1).join(" ")||"";j("customerDetails","name",T),j("customerDetails","surname",U)},placeholder:"ชื่อ-สกุล",required:!0}),i.jsx(at,{label:"ชื่อเล่น",value:I.customerDetails.nickname,onChange:S=>j("customerDetails","nickname",S.target.value),placeholder:"ชื่อเล่น"}),i.jsx(at,{label:"อายุ",value:I.customerDetails.age,onChange:S=>j("customerDetails","age",S.target.value),placeholder:"อายุ",type:"number"}),i.jsx(at,{label:"เลขบัตรประชาชน",value:I.customerDetails.idCard,onChange:S=>j("customerDetails","idCard",S.target.value),placeholder:"เลขบัตรประชาชน"}),i.jsx(at,{label:"บ้านเลขที่",value:I.customerDetails.address,onChange:S=>j("customerDetails","address",S.target.value),placeholder:"บ้านเลขที่"}),i.jsx(at,{label:"หมู่ที่",value:I.customerDetails.moo,onChange:S=>j("customerDetails","moo",S.target.value),placeholder:"หมู่ที่"}),i.jsx(at,{label:"ถนน",value:I.customerDetails.road,onChange:S=>j("customerDetails","road",S.target.value),placeholder:"ถนน"}),i.jsx(at,{label:"ตำบล/แขวง",value:I.customerDetails.subdistrict,onChange:S=>j("customerDetails","subdistrict",S.target.value),placeholder:"ตำบล/แขวง"}),i.jsx(at,{label:"อำเภอ/เขต",value:I.customerDetails.district,onChange:S=>j("customerDetails","district",S.target.value),placeholder:"อำเภอ/เขต"}),i.jsx(at,{label:"จังหวัด",value:I.customerDetails.province,onChange:S=>j("customerDetails","province",S.target.value),placeholder:"จังหวัด"}),i.jsx(at,{label:"โทรศัพท์ 1",value:I.customerDetails.phone1,onChange:S=>j("customerDetails","phone1",S.target.value),placeholder:"เบอร์โทรศัพท์",required:!0}),i.jsx(at,{label:"โทรศัพท์ 2",value:I.customerDetails.phone2,onChange:S=>j("customerDetails","phone2",S.target.value),placeholder:"เบอร์โทรศัพท์สำรอง"}),i.jsx(at,{label:"โทรศัพท์ 3",value:I.customerDetails.phone3,onChange:S=>j("customerDetails","phone3",S.target.value),placeholder:"เบอร์โทรศัพท์บ้าน"})]})]}),i.jsx(gd,{title:"รายละเอียดผู้ค้ำ",icon:jn,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(k2,{label:"คำนำหน้าชื่อ",value:I.guarantorDetails.title,onChange:S=>j("guarantorDetails","title",S),options:["นาย","นาง","นางสาว"]}),i.jsx(at,{label:"ชื่อ-สกุล",value:`${I.guarantorDetails.name} ${I.guarantorDetails.surname}`.trim(),onChange:S=>{const L=S.target.value.split(" "),T=L[0]||"",U=L.slice(1).join(" ")||"";j("guarantorDetails","name",T),j("guarantorDetails","surname",U)},placeholder:"ชื่อ-สกุล"}),i.jsx(at,{label:"ชื่อเล่น",value:I.guarantorDetails.nickname,onChange:S=>j("guarantorDetails","nickname",S.target.value),placeholder:"ชื่อเล่น"}),i.jsx(at,{label:"อายุ",value:I.guarantorDetails.age,onChange:S=>j("guarantorDetails","age",S.target.value),placeholder:"อายุ",type:"number"}),i.jsx(at,{label:"เลขบัตรประชาชน",value:I.guarantorDetails.idCard,onChange:S=>j("guarantorDetails","idCard",S.target.value),placeholder:"เลขบัตรประชาชน"}),i.jsx(at,{label:"บ้านเลขที่",value:I.guarantorDetails.address,onChange:S=>j("guarantorDetails","address",S.target.value),placeholder:"บ้านเลขที่"}),i.jsx(at,{label:"หมู่ที่",value:I.guarantorDetails.moo,onChange:S=>j("guarantorDetails","moo",S.target.value),placeholder:"หมู่ที่"}),i.jsx(at,{label:"ถนน",value:I.guarantorDetails.road,onChange:S=>j("guarantorDetails","road",S.target.value),placeholder:"ถนน"}),i.jsx(at,{label:"ตำบล/แขวง",value:I.guarantorDetails.subdistrict,onChange:S=>j("guarantorDetails","subdistrict",S.target.value),placeholder:"ตำบล/แขวง"}),i.jsx(at,{label:"อำเภอ/เขต",value:I.guarantorDetails.district,onChange:S=>j("guarantorDetails","district",S.target.value),placeholder:"อำเภอ/เขต"}),i.jsx(at,{label:"จังหวัด",value:I.guarantorDetails.province,onChange:S=>j("guarantorDetails","province",S.target.value),placeholder:"จังหวัด"}),i.jsx(at,{label:"โทรศัพท์ 1",value:I.guarantorDetails.phone1,onChange:S=>j("guarantorDetails","phone1",S.target.value),placeholder:"เบอร์โทรศัพท์"}),i.jsx(at,{label:"โทรศัพท์ 2",value:I.guarantorDetails.phone2,onChange:S=>j("guarantorDetails","phone2",S.target.value),placeholder:"เบอร์โทรศัพท์สำรอง"}),i.jsx(at,{label:"โทรศัพท์ 3",value:I.guarantorDetails.phone3,onChange:S=>j("guarantorDetails","phone3",S.target.value),placeholder:"เบอร์โทรศัพท์บ้าน"})]})}),i.jsx(gd,{title:"รายละเอียดสินค้าและแผนการผ่อน",icon:Qr,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(xo,{label:"ชนิดสินค้า",value:I.productId,onChange:S=>Y("productId",S.target.value),options:c.filter(S=>S.status==="active"&&Number(S.remaining_quantity1)>0).map(S=>(console.log("🔍 Inventory item:",S.id,"product_name:",S.product_name),{...S,displayName:S.product_name||S.name||"",searchText:`${S.product_name||""} ${S.product_code||""}`.trim()})),placeholder:d?"กำลังโหลดข้อมูล...":"--พิมพ์ค้นหาสินค้า--",required:!0}),i.jsx(at,{label:"ราคารวม",value:I.productDetails.price,onChange:S=>j("productDetails","price",S.target.value),placeholder:"ราคารวม",type:"number"}),i.jsx(at,{label:"รุ่น",value:I.productDetails.model,onChange:S=>j("productDetails","model",S.target.value),placeholder:"รุ่น"}),i.jsx(at,{label:"S/N",value:I.productDetails.serialNumber,onChange:S=>j("productDetails","serialNumber",S.target.value),placeholder:"Serial Number"}),i.jsx(at,{label:"ดาวน์",value:I.plan.downPayment,onChange:S=>j("plan","downPayment",S.target.value),placeholder:"เงินดาวน์",type:"number"}),i.jsx(at,{label:"ผ่อน/เดือน",value:I.plan.monthlyPayment,onChange:S=>j("plan","monthlyPayment",S.target.value),placeholder:"ผ่อนต่อเดือน",type:"number",required:!0}),i.jsx(at,{label:"จำนวนงวด",value:I.plan.months,onChange:S=>j("plan","months",S.target.value),placeholder:"จำนวนเดือน",type:"number",required:!0}),i.jsx(at,{label:"เก็บทุกวันที่",value:I.plan.collectionDate,onChange:S=>j("plan","collectionDate",S.target.value),placeholder:"ว-ด-ป เช่น 31-12-2564"})]})}),i.jsx(gd,{title:"พนักงาน",icon:Ls,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(xo,{label:"พนักงานขาย",value:I.salespersonId,onChange:S=>Y("salespersonId",S.target.value),options:h,placeholder:g?"กำลังโหลดข้อมูล...":"--เลือกพนักงานขาย--",required:!0}),i.jsx(xo,{label:"ผู้ตรวจสอบ",value:I.inspectorId,onChange:S=>Y("inspectorId",S.target.value),options:v,placeholder:y?"กำลังโหลดข้อมูล...":"--เลือกผู้ตรวจสอบ--",required:!0}),i.jsx(xo,{label:"สาย",value:I.collectorId,onChange:S=>Y("collectorId",S.target.value),options:N,placeholder:k?"กำลังโหลดข้อมูล...":"--เลือกสาย--",required:!0})]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx(oe,{type:"button",variant:"outline",onClick:r,className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:"ยกเลิก"}),i.jsx(oe,{type:"submit",disabled:z,className:"bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:z?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"กำลังแก้ไข..."]}):i.jsxs(i.Fragment,{children:[i.jsx(U4,{className:"w-4 h-4 mr-2"}),"บันทึกการแก้ไข"]})})]})]})]})},fX=({contracts:e,onPrint:t,onView:r,onEdit:n,onDelete:s,sortField:a,sortDirection:o,onSort:l})=>{const c=h=>{switch(h){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},u=h=>{switch(h){case"active":return i.jsx(Vc,{className:"w-3 h-3"});case"completed":return i.jsx(Xn,{className:"w-3 h-3"});case"cancelled":return i.jsx(Ui,{className:"w-3 h-3"});default:return i.jsx(Vc,{className:"w-3 h-3"})}},d=h=>{switch(h){case"active":return"ใช้งาน";case"completed":return"เสร็จสิ้น";case"cancelled":return"ยกเลิก";default:return"ไม่ทราบ"}},f=h=>a!==h?i.jsx(qt,{className:"w-4 h-4 text-gray-400"}):o==="asc"?i.jsx(qt,{className:"w-4 h-4 text-blue-600"}):i.jsx($t,{className:"w-4 h-4 text-blue-600"});return e.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(ng,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ไม่พบรายการสัญญา"}),i.jsx("p",{className:"text-gray-500",children:"ลองเปลี่ยนคำค้นหาหรือตัวกรอง"})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>l&&l("contractNumber"),children:i.jsxs("div",{className:"flex items-center gap-2",children:["เลขสัญญา",f("contractNumber")]})}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>l&&l("contractDate"),children:i.jsxs("div",{className:"flex items-center gap-2",children:["วันที่",f("contractDate")]})}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>l&&l("customerName"),children:i.jsxs("div",{className:"flex items-center gap-2",children:["ลูกค้า",f("customerName")]})}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"สินค้า"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"ผ่อน/เดือน"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 w-48",children:"พนักงาน"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"สถานะ"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"การดำเนินการ"})]})}),i.jsx("tbody",{children:e.map((h,m)=>{var g,p;return i.jsxs(Me.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:m*.05},className:"border-b border-gray-100 hover:bg-gray-50",children:[i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"font-medium text-blue-600",children:h.contractNumber})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"text-sm text-gray-600",children:new Date(h.contractDate).toLocaleDateString("th-TH")})}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("div",{className:"font-medium text-gray-900",children:h.customerName}),i.jsx("div",{className:"text-xs text-gray-500",children:h.customerPhone})]}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("div",{className:"text-gray-900",children:h.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["฿",(g=h.productPrice)==null?void 0:g.toLocaleString()]})]}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsxs("div",{className:"font-medium text-green-600",children:["฿",(p=h.monthlyPayment)==null?void 0:p.toLocaleString()]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[h.months," งวด"]})]}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"text-gray-900",children:[i.jsx("div",{className:"font-medium text-blue-600",children:h.employeeName||h.salespersonFullName||"ไม่ระบุ"}),i.jsxs("div",{className:"text-xs text-purple-600",children:["ผู้ตรวจสอบ: ",h.inspectorName||h.inspectorFullName||"ไม่ระบุ"]}),i.jsxs("div",{className:"text-xs text-green-600",children:["สาย: ",h.line||"ไม่ระบุ"]})]})}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${c(h.status)}`,children:[u(h.status),i.jsx("span",{className:"ml-1",children:d(h.status)})]})}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"flex gap-1",children:[i.jsxs(oe,{size:"sm",onClick:()=>t(h),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-2 py-1",children:[i.jsx(hu,{className:"w-3 h-3 mr-1"}),"พิมพ์"]}),i.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>r(h),className:"text-gray-600 border-gray-200 hover:bg-gray-50 text-xs px-2 py-1",children:[i.jsx(g0,{className:"w-3 h-3 mr-1"}),"ดู"]}),i.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>n(h),className:"text-orange-600 border-orange-200 hover:bg-orange-50 text-xs px-2 py-1",children:[i.jsx(Bs,{className:"w-3 h-3 mr-1"}),"แก้ไข"]}),i.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>s(h),className:"text-red-600 border-red-200 hover:bg-red-50 text-xs px-2 py-1",children:[i.jsx(ha,{className:"w-3 h-3 mr-1"}),"ลบ"]})]})})]},h.id)})})]})})},hX=({contract:e,onClose:t,onEdit:r,onPrint:n})=>{var o,l,c,u,d,f,h,m,g,p,v,b,y,x,N;if(!e)return null;const s=_=>_?new Date(_).toLocaleDateString("th-TH"):"-",a=_=>_?`฿${parseFloat(_).toLocaleString()}`:"฿0";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs(Me.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["รายละเอียดสัญญา ",e.contractNumber]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(oe,{size:"sm",onClick:()=>r(e),className:"bg-orange-600 hover:bg-orange-700 text-white",children:"แก้ไข"}),i.jsx(oe,{size:"sm",onClick:()=>n(e),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"พิมพ์"}),i.jsx(oe,{variant:"outline",size:"sm",onClick:t,className:"text-gray-500 hover:text-gray-700",children:i.jsx(H4,{className:"w-4 h-4"})})]})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[i.jsx(gr,{className:"w-5 h-5"}),"ข้อมูลสัญญา"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"เลขสัญญา:"}),i.jsx("span",{className:"font-medium",children:e.contractNumber})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"วันที่ทำสัญญา:"}),i.jsx("span",{className:"font-medium",children:s(e.contractDate)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"สถานะ:"}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${e.status==="active"?"bg-green-100 text-green-800":e.status==="completed"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:e.status==="active"?"ใช้งาน":e.status==="completed"?"เสร็จสิ้น":"ยกเลิก"})]})]})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-3 flex items-center gap-2",children:[i.jsx(Mr,{className:"w-5 h-5"}),"ข้อมูลลูกค้า"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ชื่อ:"}),i.jsx("span",{className:"font-medium",children:((o=e.customerDetails)==null?void 0:o.name)||e.customerName})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"โทรศัพท์:"}),i.jsx("span",{className:"font-medium",children:((l=e.customerDetails)==null?void 0:l.phone1)||e.customerPhone})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ที่อยู่:"}),i.jsx("span",{className:"font-medium text-right",children:((c=e.customerDetails)==null?void 0:c.address)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ตำบล/แขวง:"}),i.jsx("span",{className:"font-medium",children:((u=e.customerDetails)==null?void 0:u.subdistrict)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"อำเภอ/เขต:"}),i.jsx("span",{className:"font-medium",children:((d=e.customerDetails)==null?void 0:d.district)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"จังหวัด:"}),i.jsx("span",{className:"font-medium",children:((f=e.customerDetails)==null?void 0:f.province)||"-"})]})]})]}),((h=e.guarantorDetails)==null?void 0:h.name)&&i.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-purple-800 mb-3 flex items-center gap-2",children:[i.jsx(jn,{className:"w-5 h-5"}),"ข้อมูลผู้ค้ำ"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ชื่อ:"}),i.jsx("span",{className:"font-medium",children:e.guarantorDetails.name})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"โทรศัพท์:"}),i.jsx("span",{className:"font-medium",children:e.guarantorDetails.phone1||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ที่อยู่:"}),i.jsx("span",{className:"font-medium text-right",children:e.guarantorDetails.address||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ตำบล/แขวง:"}),i.jsx("span",{className:"font-medium",children:e.guarantorDetails.subdistrict||"-"})]})]})]}),i.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-orange-800 mb-3 flex items-center gap-2",children:[i.jsx(Qr,{className:"w-5 h-5"}),"ข้อมูลสินค้า"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"สินค้า:"}),i.jsx("span",{className:"font-medium",children:((m=e.productDetails)==null?void 0:m.name)||e.productName})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ราคารวม:"}),i.jsx("span",{className:"font-medium",children:a(((g=e.productDetails)==null?void 0:g.price)||e.totalAmount)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"รุ่น:"}),i.jsx("span",{className:"font-medium",children:((p=e.productDetails)==null?void 0:p.model)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"S/N:"}),i.jsx("span",{className:"font-medium",children:((v=e.productDetails)==null?void 0:v.serialNumber)||"-"})]})]})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:[i.jsx(fl,{className:"w-5 h-5"}),"แผนการผ่อนชำระ"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"เงินดาวน์:"}),i.jsx("span",{className:"font-medium",children:a(((b=e.planDetails)==null?void 0:b.downPayment)||e.downPayment)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ผ่อนต่อเดือน:"}),i.jsx("span",{className:"font-medium",children:a(((y=e.planDetails)==null?void 0:y.monthlyPayment)||e.monthlyPayment)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"จำนวนงวด:"}),i.jsxs("span",{className:"font-medium",children:[((x=e.planDetails)==null?void 0:x.months)||e.months||e.installmentPeriod," งวด"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"วันที่เริ่มต้น:"}),i.jsx("span",{className:"font-medium",children:s(e.startDate)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"วันที่สิ้นสุด:"}),i.jsx("span",{className:"font-medium",children:s(e.endDate)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"เก็บทุกวันที่:"}),i.jsx("span",{className:"font-medium",children:((N=e.planDetails)==null?void 0:N.collectionDate)||"-"})]})]})]}),i.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-indigo-800 mb-3 flex items-center gap-2",children:[i.jsx(Ls,{className:"w-5 h-5"}),"ข้อมูลพนักงาน"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"พนักงานขาย:"}),i.jsx("span",{className:"font-medium",children:e.salespersonName||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ผู้ตรวจสอบ:"}),i.jsx("span",{className:"font-medium",children:e.inspectorName||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"สาย:"}),i.jsx("span",{className:"font-medium",children:e.line||"-"})]})]})]})]})]})})},mX=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,u]=E.useState([]),[d,f]=E.useState(!0),[h,m]=E.useState(!1),[g,p]=E.useState(!1),[v,b]=E.useState(""),[y,x]=E.useState("all"),[N,_]=E.useState("contractNumber"),[k,w]=E.useState("asc"),[C,D]=E.useState(null),[z,A]=E.useState(!1),[R,G]=E.useState(!1),[I,Z]=E.useState(null);E.useEffect(()=>{e?j():(n([]),a([]),l([]),u([]))},[e]);const j=async()=>{var J,Se,B,je;try{if(f(!0),console.log("Loading data for branch:",e),!e){console.log("No selectedBranch, using empty arrays"),n([]),a([]),setProducts([]),u([]);return}const[_e,Re,Te,pe]=await Promise.all([Ci.getAll(e),ki.getAll(e),Cs.getAll({branchId:e}),Ks.getAll(e)]);console.log("API responses:",{contractsRes:_e,customersRes:Re,inventoryRes:Te,employeesRes:pe});let Ae=(J=_e.data)!=null&&J.success?_e.data.data:_e.data||[];const et=(Se=Re.data)!=null&&Se.success?Re.data.data:Re.data||[],Q=(B=Te.data)!=null&&B.success?Te.data.data:Te.data||[],he=(je=pe.data)!=null&&je.success?pe.data.data:pe.data||[],Fe=Ae.length;Ae=Ae.filter((Le,Oe,Ve)=>Oe===Ve.findIndex(Ye=>Ye.id===Le.id)),Fe!==Ae.length&&(console.log("🔍 Removed duplicate contracts:",Fe-Ae.length),console.log("🔍 Original contracts:",Fe),console.log("🔍 Unique contracts:",Ae.length)),console.log("Processed data:",{contracts:Ae.length,customers:et.length,inventory:Q.length,employees:he.length}),n(Ae),a(et),l(Q),u(he)}catch(_e){console.error("Error loading data:",_e),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลได้",variant:"destructive"}),n([]),a([]),setProducts([]),u([])}finally{f(!1)}},Y=async J=>{var Se;try{m(!0);const B={...J,branchId:e,status:"active"},je=await Ci.create(B),_e=je.data;n(Re=>[_e,...Re]),p(!1),tt.close(),tt.fire({icon:"success",title:"สร้างสัญญาสำเร็จ!",html:`
          <div class="text-left">
            <p><strong>เลขสัญญา:</strong> ${_e.contractNumber||"ไม่ระบุ"}</p>
            <p><strong>ลูกค้า:</strong> ${_e.customerName||"ไม่ระบุ"}</p>
            <p><strong>สินค้า:</strong> ${_e.productName||"ไม่ระบุ"}</p>
            <p><strong>ราคารวม:</strong> ${((Se=_e.totalAmount)==null?void 0:Se.toLocaleString())||"0"} บาท</p>
            <p><strong>วันที่:</strong> ${new Date(_e.contractDate).toLocaleDateString("th-TH")}</p>
          </div>
        `,confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"}),je.warning&&tt.fire({icon:"warning",title:"แจ้งเตือน",text:je.warning,confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"})}catch(B){console.error("Error creating contract:",B),tt.close(),tt.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถสร้างสัญญาได้ กรุณาลองใหม่อีกครั้ง",confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"})}finally{m(!1)}},q=J=>{console.log("Printing contract:",J),tt.fire({icon:"info",title:"พิมพ์สัญญา",text:"ฟังก์ชันพิมพ์จะถูกเพิ่มในภายหลัง",confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"})},S=J=>{D(J),A(!0)},F=J=>{Z(J.id),G(!0)},L=async J=>{var B,je;if((await tt.fire({title:"ยืนยันการลบสัญญา",html:`
        <div class="text-left">
          <p class="mb-2">คุณต้องการลบสัญญา <strong>${J.contractNumber}</strong> ใช่หรือไม่?</p>
          <div class="bg-gray-100 p-3 rounded-lg text-sm">
            <p><strong>ลูกค้า:</strong> ${J.customerName||"ไม่ระบุ"}</p>
            <p><strong>สินค้า:</strong> ${J.productName||"ไม่ระบุ"}</p>
            <p><strong>วันที่:</strong> ${new Date(J.contractDate).toLocaleDateString("th-TH")}</p>
          </div>
          <p class="text-red-600 text-sm mt-2">⚠️ การลบสัญญาจะไม่สามารถกู้คืนได้</p>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"ลบสัญญา",cancelButtonText:"ยกเลิก",reverseButtons:!0,customClass:{popup:"rounded-lg",confirmButton:"rounded-md",cancelButton:"rounded-md"}})).isConfirmed)try{tt.fire({title:"กำลังลบสัญญา...",text:"กรุณารอสักครู่",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{tt.showLoading()}});const _e=await Ci.delete(J.id);if((B=_e.data)!=null&&B.success)n(Re=>Re.filter(Te=>Te.id!==J.id)),tt.fire({icon:"success",title:"ลบสัญญาเรียบร้อยแล้ว",text:`สัญญา ${J.contractNumber} ถูกลบออกจากระบบแล้ว`,confirmButtonColor:"#059669",confirmButtonText:"ตกลง"});else throw new Error(((je=_e.data)==null?void 0:je.message)||"เกิดข้อผิดพลาด")}catch(_e){console.error("Error deleting contract:",_e),tt.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:_e.message||"ไม่สามารถลบสัญญาได้",confirmButtonColor:"#dc2626",confirmButtonText:"ตกลง"})}},T=J=>{var Se;n(B=>B.map(je=>je.id===J.id?J:je)),G(!1),Z(null),tt.fire({icon:"success",title:"แก้ไขสัญญาสำเร็จ!",html:`
        <div class="text-left">
          <p><strong>เลขสัญญา:</strong> ${J.contractNumber||"ไม่ระบุ"}</p>
          <p><strong>ลูกค้า:</strong> ${J.customerName||"ไม่ระบุ"}</p>
          <p><strong>สินค้า:</strong> ${J.productName||"ไม่ระบุ"}</p>
          <p><strong>ราคารวม:</strong> ${((Se=J.totalAmount)==null?void 0:Se.toLocaleString())||"0"} บาท</p>
        </div>
      `,confirmButtonText:"ตกลง",confirmButtonColor:"#7c3aed"})},U=()=>{G(!1),Z(null)},X=J=>{N===J?w(k==="asc"?"desc":"asc"):(_(J),w("asc"))},H=J=>[...J].sort((Se,B)=>{let je=Se[N],_e=B[N];if(je==null&&(je=""),_e==null&&(_e=""),typeof je=="string"&&(je=je.toLowerCase()),typeof _e=="string"&&(_e=_e.toLowerCase()),N==="contractNumber"){const Re=je.match(/^([A-Z]+)(\d+)$/),Te=_e.match(/^([A-Z]+)(\d+)$/);if(Re&&Te){const pe=Re[1],Ae=Te[1],et=parseInt(Re[2]),Q=parseInt(Te[2]);return pe===Ae?k==="asc"?et-Q:Q-et:pe.localeCompare(Ae)}}if(N==="contractDate"){const Re=new Date(je),Te=new Date(_e);return k==="asc"?Re-Te:Te-Re}return typeof je=="number"&&typeof _e=="number"?k==="asc"?je-_e:_e-je:je<_e?k==="asc"?-1:1:je>_e?k==="asc"?1:-1:0}),ee=r.filter((J,Se,B)=>Se===B.findIndex(je=>je.id===J.id)),me=ee.filter(J=>{var je,_e,Re,Te;const Se=((je=J.contractNumber)==null?void 0:je.toLowerCase().includes(v.toLowerCase()))||((_e=J.customerName)==null?void 0:_e.toLowerCase().includes(v.toLowerCase()))||((Re=J.productName)==null?void 0:Re.toLowerCase().includes(v.toLowerCase()))||((Te=J.salespersonName)==null?void 0:Te.toLowerCase().includes(v.toLowerCase())),B=y==="all"||J.status===y;return Se&&B}),le=H(me),ce=[{value:"all",label:"ทั้งหมด"},{value:"active",label:"ใช้งาน"},{value:"completed",label:"เสร็จสิ้น"},{value:"cancelled",label:"ยกเลิก"}];return d?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"รายการสัญญา"}),i.jsx("p",{className:"text-gray-600",children:"กำลังโหลดข้อมูล..."})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Ut,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"กำลังโหลดข้อมูลสัญญา..."})]})})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"รายการสัญญา"}),i.jsxs("p",{className:"text-gray-600",children:["จัดการสัญญาผ่อนชำระและพิมพ์ใบสัญญา - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(ng,{className:"w-4 h-4"}),i.jsxs("span",{children:["สัญญาทั้งหมด: ",me.length," สัญญา"]}),r.length!==ee.length&&i.jsxs("span",{className:"text-orange-600",children:["(กรองแล้วจาก ",r.length," สัญญา)"]}),i.jsxs("span",{className:"text-blue-600",children:["| เรียงตาม: ",N==="contractNumber"?"เลขสัญญา":N==="contractDate"?"วันที่":N==="customerName"?"ลูกค้า":N==="totalAmount"?"ราคา":"ไม่ระบุ","(",k==="asc"?"น้อย→มาก":"มาก→น้อย",")"]})]}),i.jsxs(oe,{onClick:()=>{console.log("🔍 ContractsPage: Toggle showForm from",g,"to",!g),p(!g)},className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"สร้างสัญญา"]})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหาเลขสัญญา, ลูกค้า, สินค้า, หรือพนักงาน...",value:v,onChange:J=>b(J.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("select",{value:y,onChange:J=>x(J.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:ce.map(J=>i.jsx("option",{value:J.value,children:J.label},J.value))}),i.jsxs("select",{value:`${N}-${k}`,onChange:J=>{const[Se,B]=J.target.value.split("-");_(Se),w(B)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"contractNumber-asc",children:"เลขสัญญา: น้อย → มาก"}),i.jsx("option",{value:"contractNumber-desc",children:"เลขสัญญา: มาก → น้อย"}),i.jsx("option",{value:"contractDate-asc",children:"วันที่: เก่า → ใหม่"}),i.jsx("option",{value:"contractDate-desc",children:"วันที่: ใหม่ → เก่า"}),i.jsx("option",{value:"customerName-asc",children:"ลูกค้า: ก-ฮ"}),i.jsx("option",{value:"customerName-desc",children:"ลูกค้า: ฮ-ก"}),i.jsx("option",{value:"totalAmount-asc",children:"ราคา: ต่ำ → สูง"}),i.jsx("option",{value:"totalAmount-desc",children:"ราคา: สูง → ต่ำ"})]})]})]}),g&&i.jsxs(i.Fragment,{children:[console.log("🔍 ContractsPage: Rendering ContractForm with props:",{customersCount:(s==null?void 0:s.length)||0,inventoryCount:(o==null?void 0:o.length)||0,employeesCount:(c==null?void 0:c.length)||0,selectedBranch:e,currentBranch:t,showForm:g}),i.jsx(uX,{customers:s,inventory:o,employees:c,onSubmit:Y,selectedBranch:e,currentBranch:t,submitting:h})]}),R&&I&&i.jsx(dX,{contractId:I,selectedBranch:e,onBack:U,onSuccess:T}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"รายการสัญญาทั้งหมด"})}),i.jsx("div",{className:"p-6",children:i.jsx(fX,{contracts:le,onPrint:q,onView:S,onEdit:F,onDelete:L,sortField:N,sortDirection:k,onSort:X})})]}),z&&C&&i.jsx(hX,{contract:C,onClose:()=>A(!1),onEdit:F,onPrint:q})]})},pX=({selectedBranch:e,currentBranch:t})=>{const[r,n]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,u]=E.useState(""),[d,f]=E.useState("all"),[h,m]=E.useState({returnNumber:"",returnDate:new Date().toISOString().split("T")[0],customerName:"",productName:"",quantity:1,reason:"",condition:"good",refundAmount:0,status:"pending",notes:"",processedBy:""});E.useEffect(()=>{g()},[e]);const g=async()=>{try{a(!0),n([])}catch(_){console.error("Error loading returns:",_),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลการรับคืนได้",variant:"destructive"})}finally{a(!1)}},p=()=>{const _="R",k=new Date,w=k.getFullYear().toString().slice(-2),C=(k.getMonth()+1).toString().padStart(2,"0"),D=k.getDate().toString().padStart(2,"0"),z=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`${_}${w}${C}${D}${z}`},v=async _=>{if(_.preventDefault(),!h.customerName||!h.productName||!h.reason){ge({title:"กรุณากรอกข้อมูลให้ครบถ้วน",description:"ชื่อลูกค้า สินค้า และเหตุผลเป็นข้อมูลที่จำเป็น",variant:"destructive"});return}try{const k={...h,id:Date.now().toString(),returnNumber:p(),branchId:e,branchName:t==null?void 0:t.name,createdAt:new Date().toISOString(),processedBy:"ระบบ"};n(w=>[k,...w]),m({returnNumber:"",returnDate:new Date().toISOString().split("T")[0],customerName:"",productName:"",quantity:1,reason:"",condition:"good",refundAmount:0,status:"pending",notes:"",processedBy:""}),l(!1),ge({title:"บันทึกการรับคืนสำเร็จ! 🔄",description:`บันทึกการรับคืนเลขที่ ${k.returnNumber} แล้ว`})}catch(k){console.error("Error creating return:",k),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกการรับคืนได้",variant:"destructive"})}},b=async(_,k)=>{try{n(C=>C.map(D=>D.id===_?{...D,status:k,updatedAt:new Date().toISOString()}:D)),ge({title:"อัปเดตสถานะสำเร็จ",description:`เปลี่ยนสถานะเป็น: ${{pending:"รอดำเนินการ",approved:"อนุมัติ",rejected:"ปฏิเสธ",completed:"เสร็จสิ้น"}[k]}`})}catch(w){console.error("Error updating return status:",w),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถอัปเดตสถานะได้",variant:"destructive"})}},y=_=>{switch(_){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"approved":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},x=_=>{switch(_){case"pending":return"รอดำเนินการ";case"approved":return"อนุมัติ";case"rejected":return"ปฏิเสธ";case"completed":return"เสร็จสิ้น";default:return"ไม่ทราบสถานะ"}},N=r.filter(_=>{var C,D,z;const k=((C=_.customerName)==null?void 0:C.toLowerCase().includes(c.toLowerCase()))||((D=_.productName)==null?void 0:D.toLowerCase().includes(c.toLowerCase()))||((z=_.returnNumber)==null?void 0:z.toLowerCase().includes(c.toLowerCase())),w=d==="all"||_.status===d;return k&&w});return s?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการการรับคืนสินค้า"}),i.jsx("p",{className:"text-gray-600",children:"กำลังโหลดข้อมูล..."})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Ut,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"กำลังโหลดข้อมูลการรับคืน..."})]})})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการการรับคืนสินค้า"}),i.jsxs("p",{className:"text-gray-600",children:["บันทึกและติดตามการรับคืนสินค้าจากลูกค้า - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(dp,{className:"w-4 h-4"}),i.jsxs("span",{children:["การรับคืนทั้งหมด: ",N.length," รายการ"]})]}),i.jsxs(oe,{onClick:()=>l(!o),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"บันทึกการรับคืน"]})]})]}),o&&i.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"บันทึกการรับคืนใหม่"}),i.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ชื่อลูกค้า *"}),i.jsx("input",{type:"text",value:h.customerName,onChange:_=>m(k=>({...k,customerName:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ชื่อลูกค้า",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"สินค้า *"}),i.jsx("input",{type:"text",value:h.productName,onChange:_=>m(k=>({...k,productName:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ชื่อสินค้า",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"จำนวน"}),i.jsx("input",{type:"number",value:h.quantity,onChange:_=>m(k=>({...k,quantity:parseInt(_.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"จำนวนเงินคืน"}),i.jsx("input",{type:"number",value:h.refundAmount,onChange:_=>m(k=>({...k,refundAmount:parseFloat(_.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"สภาพสินค้า"}),i.jsxs("select",{value:h.condition,onChange:_=>m(k=>({...k,condition:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"good",children:"ดี"}),i.jsx("option",{value:"fair",children:"ปานกลาง"}),i.jsx("option",{value:"poor",children:"เสียหาย"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"วันที่รับคืน"}),i.jsx("input",{type:"date",value:h.returnDate,onChange:_=>m(k=>({...k,returnDate:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"เหตุผลการรับคืน *"}),i.jsx("textarea",{value:h.reason,onChange:_=>m(k=>({...k,reason:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ระบุเหตุผลการรับคืน",rows:"3",required:!0})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"หมายเหตุ"}),i.jsx("textarea",{value:h.notes,onChange:_=>m(k=>({...k,notes:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"หมายเหตุเพิ่มเติม",rows:"2"})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3",children:[i.jsx(oe,{type:"button",variant:"outline",onClick:()=>l(!1),children:"ยกเลิก"}),i.jsxs(oe,{type:"submit",className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"บันทึกการรับคืน"]})]})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"ค้นหาลูกค้า, สินค้า, หรือเลขที่รับคืน...",value:c,onChange:_=>u(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{value:d,onChange:_=>f(_.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:"สถานะทั้งหมด"}),i.jsx("option",{value:"pending",children:"รอดำเนินการ"}),i.jsx("option",{value:"approved",children:"อนุมัติ"}),i.jsx("option",{value:"rejected",children:"ปฏิเสธ"}),i.jsx("option",{value:"completed",children:"เสร็จสิ้น"})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"รายการการรับคืนทั้งหมด"})}),i.jsx("div",{className:"p-6",children:N.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(dp,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ไม่มีการรับคืน"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"ยังไม่มีการรับคืนสินค้าในระบบ"}),i.jsxs(oe,{onClick:()=>l(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"บันทึกการรับคืน"]})]}):i.jsx("div",{className:"grid gap-4",children:N.map((_,k)=>i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.1},className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:_.customerName}),i.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:_.returnNumber})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Qr,{className:"w-4 h-4"}),_.productName]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ca,{className:"w-4 h-4"}),new Date(_.returnDate).toLocaleDateString("th-TH")]}),_.refundAmount>0&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(gr,{className:"w-4 h-4"}),"฿",_.refundAmount.toLocaleString()]})]}),_.reason&&i.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("strong",{children:"เหตุผล:"})," ",_.reason]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium border ${y(_.status)}`,children:x(_.status)}),_.status==="pending"&&i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(oe,{size:"sm",onClick:()=>b(_.id,"approved"),className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(Xn,{className:"w-4 h-4 mr-1"}),"อนุมัติ"]}),i.jsxs(oe,{size:"sm",onClick:()=>b(_.id,"rejected"),className:"bg-red-600 hover:bg-red-700 text-white",children:[i.jsx(gf,{className:"w-4 h-4 mr-1"}),"ปฏิเสธ"]})]})]})]})},_.id))})})]})]})},xX=({products:e,installmentPlans:t,customers:r,employees:n})=>{const s=o=>{ge({title:"🚧 ฟีเจอร์นี้ยังไม่ได้ใช้งาน—แต่ไม่ต้องกังวล! คุณสามารถขอให้เพิ่มในข้อความถัดไป! 🚀",description:`กำลังเตรียมการส่งออกรายงาน${o}`})},a=[{title:"รายงานการขาย",description:"สรุปยอดขายและรายได้รายเดือน",icon:gr,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"รายงานลูกค้า",description:"ข้อมูลลูกค้าและประวัติการซื้อ",icon:gr,color:"text-green-600",bgColor:"bg-green-100"},{title:"รายงานการผ่อนชำระ",description:"สถานะการชำระเงินและงวดค้างชำระ",icon:gr,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"รายงานพนักงาน",description:"การเข้างานและประสิทธิภาพ",icon:gr,color:"text-orange-600",bgColor:"bg-orange-100"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"รายงาน"}),i.jsx("p",{className:"text-gray-600",children:"สร้างและส่งออกรายงานต่างๆ"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(oe,{variant:"outline",className:"flex items-center gap-2",children:[i.jsx($c,{className:"w-4 h-4"}),"กรองข้อมูล"]}),i.jsxs(oe,{variant:"outline",className:"flex items-center gap-2",children:[i.jsx(ca,{className:"w-4 h-4"}),"เลือกช่วงเวลา"]})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.map((o,l)=>{const c=o.icon;return i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:`p-3 rounded-lg ${o.bgColor}`,children:i.jsx(c,{className:`w-6 h-6 ${o.color}`})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:o.title}),i.jsx("p",{className:"text-gray-600 mb-4",children:o.description}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(oe,{size:"sm",onClick:()=>s(o.title),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(ua,{className:"w-4 h-4 mr-2"}),"ส่งออก PDF"]}),i.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>s(o.title),children:[i.jsx(ua,{className:"w-4 h-4 mr-2"}),"ส่งออก Excel"]})]})]})]})},o.title)})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"รายงานด่วน"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:e.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"สินค้าทั้งหมด"})]}),i.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:r.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"ลูกค้าทั้งหมด"})]}),i.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:t.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"แผนการผ่อน"})]})]})]})]})},gX=({products:e=[],installmentPlans:t=[],customers:r=[],employees:n=[],selectedBranch:s,currentBranch:a})=>{const o=t.filter(b=>b.branchId===s),l=r.filter(b=>b.branchId===s),c=n.filter(b=>b.branchId===s),u=e.filter(b=>b.branchId===s),d=o.reduce((b,y)=>{var N;const x=((N=y.payments)==null?void 0:N.filter(_=>_.status==="paid"))||[];return b+x.reduce((_,k)=>_+(k.amount||0),0)},0),f=o.reduce((b,y)=>{var N;const x=((N=y.payments)==null?void 0:N.filter(_=>_.status==="pending"))||[];return b+x.reduce((_,k)=>_+(k.amount||0),0)},0),h=[{title:"รายได้ทั้งหมด",value:`฿${d.toLocaleString()}`,icon:fl,color:"text-green-600",bgColor:"bg-green-100"},{title:"รายได้ค้างรับ",value:`฿${f.toLocaleString()}`,icon:hl,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"ลูกค้าทั้งหมด",value:l.length,icon:Qn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"สินค้าทั้งหมด",value:u.length,icon:Qr,color:"text-purple-600",bgColor:"bg-purple-100"}],m=o.reduce((b,y)=>{var x;return b+(((x=y.payments)==null?void 0:x.filter(N=>N.status==="paid").length)||0)},0),g=o.reduce((b,y)=>{var x;return b+(((x=y.payments)==null?void 0:x.filter(N=>N.status==="pending").length)||0)},0),p=c.filter(b=>b.isCheckedIn).length,v=c.filter(b=>!b.isCheckedIn).length;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"รายงานและวิเคราะห์"}),i.jsxs("p",{className:"text-gray-600",children:["ภาพรวมและสถิติของระบบ - ",(a==null?void 0:a.name)||"ทุกสาขา"]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Ch,{className:"w-4 h-4"}),i.jsxs("span",{children:["อัพเดทล่าสุด: ",new Date().toLocaleDateString("th-TH")]})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map((b,y)=>{const x=b.icon;return i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsx("div",{className:`p-3 rounded-lg ${b.bgColor}`,children:i.jsx(x,{className:`w-6 h-6 ${b.color}`})})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:b.title}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.value})]})]},b.title)})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"สรุปข้อมูลระบบ"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"การผ่อนชำระ"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"แผนการผ่อนทั้งหมด:"}),i.jsxs("span",{className:"font-medium",children:[o.length," แผน"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"งวดที่ชำระแล้ว:"}),i.jsxs("span",{className:"font-medium text-green-600",children:[m," งวด"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"งวดค้างชำระ:"}),i.jsxs("span",{className:"font-medium text-red-600",children:[g," งวด"]})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"พนักงาน"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"พนักงานทั้งหมด:"}),i.jsxs("span",{className:"font-medium",children:[c.length," คน"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"เข้างานวันนี้:"}),i.jsxs("span",{className:"font-medium text-green-600",children:[p," คน"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ออกงานแล้ว:"}),i.jsxs("span",{className:"font-medium text-gray-600",children:[v," คน"]})]})]})]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Ch,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"กราฟและชาร์ตเพิ่มเติม"}),i.jsx("p",{className:"text-gray-500",children:"🚧 ฟีเจอร์นี้ยังไม่ได้ใช้งาน—แต่ไม่ต้องกังวล! คุณสามารถขอให้เพิ่มในข้อความถัดไป! 🚀"})]})}),o.length===0&&l.length===0&&i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[i.jsx(Ch,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"ยังไม่มีข้อมูลสำหรับการวิเคราะห์"}),i.jsx("p",{className:"text-gray-500",children:"เพิ่มลูกค้าและสร้างแผนการผ่อนก่อนเพื่อดูรายงานและวิเคราะห์"})]})]})},vX=({selectedBranch:e})=>{const[t,r]=E.useState([]),[n,s]=E.useState(!0),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,d]=E.useState(null),[f,h]=E.useState({name:"",address:"",phone:"",manager:""});E.useEffect(()=>{m()},[]);const m=async()=>{try{s(!0);const x=await xi.getAll();r(x.data||[])}catch(x){console.error("Error loading branches:",x),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลสาขาได้",variant:"destructive"})}finally{s(!1)}},g=async x=>{if(x.preventDefault(),!f.name||!f.address){ge({title:"กรุณากรอกข้อมูลให้ครบถ้วน",description:"ชื่อสาขาและที่อยู่เป็นข้อมูลที่จำเป็น",variant:"destructive"});return}try{o(!0),u?(await xi.update(u.id,f),ge({title:"แก้ไขสาขาสำเร็จ! ✏️",description:`แก้ไขข้อมูล ${f.name} แล้ว`}),d(null)):(await xi.create(f),ge({title:"เพิ่มสาขาสำเร็จ! 🏢",description:`เพิ่ม ${f.name} เข้าสู่ระบบแล้ว`})),h({name:"",address:"",phone:"",manager:""}),c(!1),m()}catch(N){console.error("Error saving branch:",N),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกข้อมูลสาขาได้",variant:"destructive"})}finally{o(!1)}},p=x=>{h({name:x.name,address:x.address,phone:x.phone||"",manager:x.manager||""}),d(x),c(!0)},v=async x=>{if(t.length<=1){ge({title:"ไม่สามารถลบได้",description:"ต้องมีสาขาอย่างน้อย 1 สาขา",variant:"destructive"});return}if(x===e){ge({title:"ไม่สามารถลบได้",description:"ไม่สามารถลบสาขาที่กำลังใช้งานอยู่",variant:"destructive"});return}try{await xi.delete(x),ge({title:"ลบสาขาสำเร็จ",description:"ลบสาขาออกจากระบบแล้ว"}),m()}catch(N){console.error("Error deleting branch:",N),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบสาขาได้",variant:"destructive"})}},b=async x=>{try{const _={isActive:!t.find(k=>k.id===x).isActive};await xi.update(x,_),ge({title:"อัปเดตสถานะสำเร็จ",description:"อัปเดตสถานะสาขาแล้ว"}),m()}catch(N){console.error("Error updating branch status:",N),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถอัปเดตสถานะสาขาได้",variant:"destructive"})}},y=()=>{h({name:"",address:"",phone:"",manager:""}),d(null),c(!1)};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"จัดการสาขา"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"จัดการข้อมูลสาขาต่างๆ ในระบบ"})]}),i.jsxs(oe,{onClick:()=>c(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มสาขาใหม่"]})]})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n?Array.from({length:6}).map((x,N)=>i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 animate-pulse",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-4"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]},N)):t.length===0?i.jsx("div",{className:"col-span-full",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[i.jsx(la,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีสาขา"}),i.jsx("p",{className:"text-gray-500 mb-6",children:"เริ่มต้นโดยการเพิ่มสาขาแรกของคุณ"}),i.jsxs(oe,{onClick:()=>c(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),"เพิ่มสาขาแรก"]})]})}):t.map((x,N)=>i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:i.jsx(la,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:x.name}),i.jsxs("div",{className:"flex items-center gap-2",children:[x.isActive?i.jsx(Xn,{className:"w-4 h-4 text-green-500"}):i.jsx(gf,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{className:`text-sm ${x.isActive?"text-green-600":"text-red-600"}`,children:x.isActive?"เปิดใช้งาน":"ปิดใช้งาน"})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>b(x.id),className:"text-gray-500 hover:text-gray-700",children:x.isActive?"ปิด":"เปิด"}),i.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>p(x),className:"text-blue-600 hover:text-blue-700",children:i.jsx(Bs,{className:"w-4 h-4"})}),i.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>v(x.id),className:"text-red-600 hover:text-red-700",disabled:x.id===e,children:i.jsx(ha,{className:"w-4 h-4"})})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx(v0,{className:"w-4 h-4"}),i.jsx("span",{className:"truncate",children:x.address})]}),x.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx(As,{className:"w-4 h-4"}),i.jsx("span",{children:x.phone})]}),x.manager&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx(Mr,{className:"w-4 h-4"}),i.jsx("span",{children:x.manager})]})]}),x.id===e&&i.jsx("div",{className:"mt-4 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:i.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"สาขาปัจจุบัน"})})]},x.id))}),(l||u)&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:u?"แก้ไขสาขา":"เพิ่มสาขาใหม่"}),i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อสาขา *"}),i.jsx("input",{type:"text",value:f.name,onChange:x=>h(N=>({...N,name:x.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ชื่อสาขา"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ที่อยู่ *"}),i.jsx("textarea",{value:f.address,onChange:x=>h(N=>({...N,address:x.target.value})),required:!0,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ที่อยู่สาขา"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"เบอร์โทรศัพท์"}),i.jsx("input",{type:"tel",value:f.phone,onChange:x=>h(N=>({...N,phone:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"เบอร์โทรศัพท์"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ผู้จัดการ"}),i.jsx("input",{type:"text",value:f.manager,onChange:x=>h(N=>({...N,manager:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ชื่อผู้จัดการ"})]})]}),i.jsxs("div",{className:"flex gap-2 mt-6",children:[i.jsx(oe,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700",disabled:a,children:a?i.jsxs(i.Fragment,{children:[i.jsx(Ut,{className:"w-4 h-4 mr-2 animate-spin"}),"กำลังบันทึก..."]}):u?"แก้ไขสาขา":"เพิ่มสาขา"}),i.jsx(oe,{type:"button",variant:"outline",onClick:y,disabled:a,children:"ยกเลิก"})]})]})]})})]})},yX=()=>{const e=r=>{ge({title:"🚧 ฟีเจอร์นี้ยังไม่ได้ใช้งาน—แต่ไม่ต้องกังวล! คุณสามารถขอให้เพิ่มในข้อความถัดไป! 🚀",description:`กำลังอัพเดทการตั้งค่า: ${r}`})},t=[{title:"ระบบทั่วไป",icon:$i,settings:[{name:"ชื่อระบบ",value:"ระบบผ่อนสินค้า",type:"text"},{name:"เขตเวลา",value:"Asia/Bangkok",type:"select"},{name:"สกุลเงิน",value:"THB (บาท)",type:"select"}]},{title:"การแจ้งเตือน",icon:rg,settings:[{name:"แจ้งเตือนการชำระเงิน",value:!0,type:"toggle"},{name:"แจ้งเตือนงวดเกินกำหนด",value:!0,type:"toggle"},{name:"แจ้งเตือนทางอีเมล",value:!1,type:"toggle"}]},{title:"ความปลอดภัย",icon:jn,settings:[{name:"การยืนยันตัวตนสองขั้นตอน",value:!1,type:"toggle"},{name:"บันทึกการเข้าสู่ระบบ",value:!0,type:"toggle"},{name:"หมดอายุเซสชัน (นาที)",value:"30",type:"number"}]},{title:"ฐานข้อมูล",icon:Ly,settings:[{name:"สำรองข้อมูลอัตโนมัติ",value:!0,type:"toggle"},{name:"ความถี่การสำรอง (ชั่วโมง)",value:"24",type:"number"},{name:"เก็บข้อมูลสำรอง (วัน)",value:"30",type:"number"}]}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ตั้งค่าระบบ"}),i.jsx("p",{className:"text-gray-600",children:"จัดการการตั้งค่าและการกำหนดค่าระบบ"})]})}),i.jsx("div",{className:"grid gap-6",children:t.map((r,n)=>{const s=r.icon;return i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-3",children:[i.jsx(s,{className:"w-5 h-5"}),r.title]})}),i.jsx("div",{className:"p-6 space-y-4",children:r.settings.map((a,o)=>i.jsxs("div",{className:"flex items-center justify-between py-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:a.name}),a.type!=="toggle"&&i.jsxs("div",{className:"text-sm text-gray-500",children:["ค่าปัจจุบัน: ",a.value]})]}),i.jsx("div",{children:a.type==="toggle"?i.jsx(oe,{variant:a.value?"default":"outline",size:"sm",onClick:()=>e(a.name),className:a.value?"bg-green-600 hover:bg-green-700":"",children:a.value?"เปิด":"ปิด"}):i.jsx(oe,{variant:"outline",size:"sm",onClick:()=>e(a.name),children:"แก้ไข"})})]},a.name))})]},r.title)})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"การดำเนินการระบบ"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs(oe,{variant:"outline",onClick:()=>e("สำรองข้อมูล"),className:"h-auto p-4 flex flex-col items-center gap-2",children:[i.jsx(Ly,{className:"w-6 h-6"}),i.jsx("span",{children:"สำรองข้อมูล"})]}),i.jsxs(oe,{variant:"outline",onClick:()=>e("ล้างแคช"),className:"h-auto p-4 flex flex-col items-center gap-2",children:[i.jsx($i,{className:"w-6 h-6"}),i.jsx("span",{children:"ล้างแคช"})]}),i.jsxs(oe,{variant:"outline",onClick:()=>e("ตรวจสอบระบบ"),className:"h-auto p-4 flex flex-col items-center gap-2",children:[i.jsx(jn,{className:"w-6 h-6"}),i.jsx("span",{children:"ตรวจสอบระบบ"})]})]})]})]})},wX=({activeTab:e,selectedBranch:t,currentBranch:r,customerData:n,onBack:s,onViewPaymentSchedule:a})=>{const o=()=>{switch(e){case"dashboard":return i.jsx(Uy,{selectedBranch:t,currentBranch:r});case"products":return i.jsx(GL,{selectedBranch:t,currentBranch:r});case"customers":return i.jsx(XL,{selectedBranch:t,currentBranch:r});case"employees":return i.jsx(KL,{selectedBranch:t,currentBranch:r});case"salespeople":return i.jsx(YL,{selectedBranch:t,currentBranch:r});case"checkers":return i.jsx(ZL,{selectedBranch:t,currentBranch:r,onViewPaymentSchedule:a});case"checker-installment-report":return i.jsx(mS,{selectedBranch:t,currentBranch:r,onBack:s});case"sales-index":return i.jsx(JL,{selectedBranch:t,currentBranch:r});case"payment-schedule":return i.jsx(QL,{selectedBranch:t,currentBranch:r,customerData:n,onBack:s,onViewPaymentSchedule:a});case"contracts":return i.jsx(mX,{selectedBranch:t,currentBranch:r});case"payments":return i.jsx(tO,{selectedBranch:t,currentBranch:r});case"returns":return i.jsx(pX,{selectedBranch:t,currentBranch:r});case"reports":return i.jsx(xX,{selectedBranch:t,currentBranch:r});case"analytics":return i.jsx(gX,{selectedBranch:t,currentBranch:r});case"branches":return i.jsx(vX,{selectedBranch:t});case"import-data":return i.jsx(iX,{onBack:()=>window.history.back()});case"admin-users":return i.jsx(cX,{selectedBranch:t,currentBranch:r});case"settings":return i.jsx(yX,{});default:return i.jsx(Uy,{selectedBranch:t,currentBranch:r})}};return i.jsx("div",{className:"flex-1 overflow-auto",children:i.jsx("div",{className:"p-6",children:o()})})},bX=({branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:s,onLogout:a})=>{const[o,l]=E.useState("dashboard"),[c,u]=E.useState(!1),[d,f]=E.useState(null),h=e.find(p=>p.id===r)||e[0],m=()=>{l("checkers"),f(null)},g=p=>{f(p),l("payment-schedule")};return i.jsxs("div",{className:"flex h-screen bg-gray-50",children:[i.jsx(wD,{activeTab:o,setActiveTab:l,collapsed:c,setCollapsed:u,currentBranch:h}),i.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${c?"ml-16":"ml-64"}`,children:[i.jsx(bD,{sidebarCollapsed:c,setSidebarCollapsed:u,branches:e,selectedBranch:r,setSelectedBranch:n,currentBranch:h,currentUser:s,onLogout:a}),i.jsx(wX,{activeTab:o,selectedBranch:r,currentBranch:h,customerData:d,onBack:m,onViewPaymentSchedule:g})]})]})};class NX{constructor(){this.currentUser=null,this.token=localStorage.getItem("auth_token"),this.token&&(ye.defaults.headers.common.Authorization=`Bearer ${this.token}`)}async login(t,r){var n,s;try{const a=await ye.post("/auth/login",{username:t,password:r}),{token:o,user:l}=a.data;return this.token=o,this.currentUser=l,localStorage.setItem("auth_token",o),localStorage.setItem("current_user",JSON.stringify(l)),ye.defaults.headers.common.Authorization=`Bearer ${o}`,{success:!0,user:l}}catch(a){throw console.error("Login error:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("ไม่สามารถเข้าสู่ระบบได้")}}async logout(){try{await ye.post("/auth/logout")}catch(t){console.error("Logout error:",t)}finally{this.token=null,this.currentUser=null,localStorage.removeItem("auth_token"),localStorage.removeItem("current_user"),delete ye.defaults.headers.common.Authorization}}isAuthenticated(){return!!this.token}getCurrentUser(){if(!this.currentUser){const t=localStorage.getItem("current_user");t&&(this.currentUser=JSON.parse(t))}return this.currentUser}async refreshToken(){try{const t=await ye.post("/auth/refresh"),{token:r}=t.data;return this.token=r,localStorage.setItem("auth_token",r),ye.defaults.headers.common.Authorization=`Bearer ${r}`,r}catch(t){throw console.error("Token refresh error:",t),this.logout(),new Error("Session expired. Please login again.")}}hasPermission(t){var n;const r=this.getCurrentUser();return r?r.role==="super_admin"?!0:((n=r.permissions)==null?void 0:n.includes(t))||!1:!1}hasRole(t){const r=this.getCurrentUser();return r?Array.isArray(t)?t.includes(r.role):r.role===t:!1}isAdmin(){return this.hasRole(["super_admin","admin"])}isSuperAdmin(){return this.hasRole("super_admin")}canAccessBranch(t){const r=this.getCurrentUser();return r?this.hasRole(["super_admin","admin"])||!r.branch_id?!0:r.branch_id===t:!1}getAccessibleBranches(t){const r=this.getCurrentUser();return r?this.hasRole(["super_admin","admin"])?t:r.branch_id?t.filter(n=>n.id===r.branch_id):t:[]}async validateToken(){if(!this.token)return!1;try{return(await ye.get("/auth/validate")).data.valid}catch(t){return console.error("Token validation error:",t),!1}}async changePassword(t,r){var n,s;try{return(await ye.post("/auth/change-password",{current_password:t,new_password:r})).data}catch(a){throw console.error("Change password error:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("ไม่สามารถเปลี่ยนรหัสผ่านได้")}}async requestPasswordReset(t){var r,n;try{return(await ye.post("/auth/forgot-password",{email:t})).data}catch(s){throw console.error("Password reset request error:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("ไม่สามารถส่งคำขอรีเซ็ตรหัสผ่านได้")}}async resetPassword(t,r){var n,s;try{return(await ye.post("/auth/reset-password",{token:t,new_password:r})).data}catch(a){throw console.error("Password reset error:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("ไม่สามารถรีเซ็ตรหัสผ่านได้")}}}const Zl=new NX,kX=({onLoginSuccess:e})=>{const[t,r]=E.useState({username:"",password:""}),[n,s]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState({}),[u,d]=E.useState(0);E.useEffect(()=>{const p=setInterval(()=>{d(v=>(v+1)%3)},4e3);return()=>clearInterval(p)},[]);const f=[{icon:i.jsx(la,{className:"w-10 h-10"}),title:"จัดการสาขา",description:"บริหารจัดการสาขาต่างๆ ได้อย่างมีประสิทธิภาพ",color:"from-emerald-400 to-green-500"},{icon:i.jsx(Qn,{className:"w-10 h-10"}),title:"จัดการลูกค้า",description:"ดูแลข้อมูลลูกค้าและสัญญาผ่อนชำระ",color:"from-teal-400 to-cyan-500"},{icon:i.jsx(hl,{className:"w-10 h-10"}),title:"รายงานและสถิติ",description:"ติดตามผลการดำเนินงานด้วยรายงานที่ครบถ้วน",color:"from-green-400 to-emerald-500"}],h=p=>{const{name:v,value:b}=p.target;r(y=>({...y,[v]:b})),l[v]&&c(y=>({...y,[v]:""}))},m=()=>{const p={};return t.username.trim()||(p.username="กรุณากรอกชื่อผู้ใช้งาน"),t.password||(p.password="กรุณากรอกรหัสผ่าน"),c(p),Object.keys(p).length===0},g=async p=>{if(p.preventDefault(),!!m()){o(!0);try{const v=await Zl.login(t.username,t.password);ge({title:"เข้าสู่ระบบสำเร็จ",description:`ยินดีต้อนรับ ${v.user.full_name||v.user.username}`,variant:"default"}),e&&e(v.user)}catch(v){ge({title:"เข้าสู่ระบบไม่สำเร็จ",description:v.message,variant:"destructive"})}finally{o(!1)}}};return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-green-100 to-teal-50 flex relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("div",{className:"absolute top-20 left-20 w-96 h-96 bg-gradient-to-r from-emerald-300/30 to-green-400/30 rounded-full blur-3xl animate-pulse"}),i.jsx("div",{className:"absolute bottom-20 right-20 w-80 h-80 bg-gradient-to-r from-teal-300/30 to-cyan-400/30 rounded-full blur-3xl animate-pulse delay-1000"}),i.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-to-r from-green-300/30 to-emerald-400/30 rounded-full blur-3xl animate-pulse delay-500"}),i.jsx("div",{className:"absolute top-32 left-32 animate-bounce",children:i.jsx(lD,{className:"w-6 h-6 text-emerald-500"})}),i.jsx("div",{className:"absolute top-64 right-32 animate-bounce delay-1000",children:i.jsx(cD,{className:"w-4 h-4 text-green-500"})}),i.jsx("div",{className:"absolute bottom-32 left-1/3 animate-bounce delay-500",children:i.jsx(fD,{className:"w-5 h-5 text-teal-500"})})]}),i.jsx("div",{className:"hidden lg:flex lg:w-1/2 relative z-10",children:i.jsxs("div",{className:"flex flex-col justify-center items-center text-white p-12 w-full",children:[i.jsxs(Me.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1},className:"text-center mb-16",children:[i.jsxs(Me.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{delay:.3,type:"spring",stiffness:200},className:"w-24 h-24 bg-gradient-to-r from-emerald-400 via-green-500 to-teal-500 rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-2xl relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/50 via-green-500/50 to-teal-500/50 animate-pulse"}),i.jsx(nl,{className:"w-12 h-12 text-white relative z-10"})]}),i.jsx("h1",{className:"text-5xl font-bold mb-6 bg-gradient-to-r from-emerald-600 via-green-600 to-teal-600 bg-clip-text text-transparent",children:"ระบบจัดการผ่อนสินค้า"}),i.jsx("p",{className:"text-xl text-emerald-700 font-medium",children:"Admin Panel - Professional Management System"})]}),i.jsxs("div",{className:"w-full max-w-lg",children:[i.jsx(dc,{mode:"wait",children:i.jsxs(Me.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-100,scale:.8},transition:{duration:.6,type:"spring"},className:"text-center",children:[i.jsx("div",{className:`w-20 h-20 bg-gradient-to-r ${f[u].color} rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl transform hover:scale-110 transition-transform duration-300`,children:f[u].icon}),i.jsx("h3",{className:"text-2xl font-bold mb-3 text-emerald-800",children:f[u].title}),i.jsx("p",{className:"text-emerald-700 text-lg",children:f[u].description})]},u)}),i.jsx("div",{className:"flex justify-center gap-3 mt-8",children:f.map((p,v)=>i.jsx("button",{onClick:()=>d(v),className:`w-3 h-3 rounded-full transition-all duration-300 ${v===u?"bg-white w-8 scale-125":"bg-white/40 hover:bg-white/60"}`},v))})]}),i.jsxs(Me.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1,delay:.5},className:"mt-16 grid grid-cols-3 gap-12 text-center",children:[i.jsxs("div",{className:"group",children:[i.jsx("div",{className:"text-3xl font-bold text-emerald-600 group-hover:text-emerald-700 transition-colors",children:"50+"}),i.jsx("div",{className:"text-sm text-emerald-700 group-hover:text-emerald-800 transition-colors",children:"สาขา"})]}),i.jsxs("div",{className:"group",children:[i.jsx("div",{className:"text-3xl font-bold text-green-600 group-hover:text-green-700 transition-colors",children:"10K+"}),i.jsx("div",{className:"text-sm text-green-700 group-hover:text-green-800 transition-colors",children:"ลูกค้า"})]}),i.jsxs("div",{className:"group",children:[i.jsx("div",{className:"text-3xl font-bold text-teal-600 group-hover:text-teal-700 transition-colors",children:"99.9%"}),i.jsx("div",{className:"text-sm text-teal-700 group-hover:text-teal-800 transition-colors",children:"ความแม่นยำ"})]})]})]})}),i.jsx("div",{className:"flex-1 flex items-center justify-center p-8 relative z-10",children:i.jsxs(Me.div,{initial:{opacity:0,x:50,scale:.9},animate:{opacity:1,x:0,scale:1},transition:{duration:1,delay:.3},className:"w-full max-w-md",children:[i.jsxs(mr,{className:"shadow-2xl border-0 bg-white/90 backdrop-blur-xl rounded-3xl overflow-hidden border border-emerald-200",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-50/50 to-green-50/30"}),i.jsxs(Wn,{className:"text-center pb-8 relative z-10",children:[i.jsxs(Me.div,{initial:{scale:0,rotate:180},animate:{scale:1,rotate:0},transition:{delay:.6,type:"spring",stiffness:200},className:"w-20 h-20 bg-gradient-to-r from-emerald-400 via-green-500 to-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/50 via-green-500/50 to-teal-500/50 animate-pulse"}),i.jsx(jn,{className:"w-10 h-10 text-white relative z-10"})]}),i.jsx(Gn,{className:"text-3xl font-bold text-emerald-800 mb-2",children:"เข้าสู่ระบบ"}),i.jsx(Fs,{className:"text-emerald-600 text-lg",children:"กรุณาเข้าสู่ระบบเพื่อเข้าถึงระบบจัดการ"})]}),i.jsx(pr,{className:"relative z-10",children:i.jsxs("form",{onSubmit:g,className:"space-y-8",children:[i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:[i.jsx("label",{className:"block text-sm font-semibold text-emerald-800 mb-3",children:"ชื่อผู้ใช้งาน"}),i.jsxs("div",{className:"relative group",children:[i.jsx(Mr,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-emerald-500 h-5 w-5 group-focus-within:text-emerald-600 transition-colors"}),i.jsx("input",{type:"text",name:"username",value:t.username,onChange:h,className:`w-full pl-12 pr-4 py-4 border-2 rounded-2xl focus:ring-4 focus:ring-emerald-500/30 focus:border-emerald-400 transition-all duration-300 bg-white/80 backdrop-blur-sm text-emerald-900 placeholder-emerald-500 ${l.username?"border-red-400 bg-red-50":"border-emerald-300/50 hover:border-emerald-400"}`,placeholder:"กรอกชื่อผู้ใช้งาน",disabled:a})]}),i.jsx(dc,{children:l.username&&i.jsxs(Me.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-red-300 text-sm mt-2 flex items-center gap-2",children:[i.jsx(Ui,{className:"h-4 w-4"}),l.username]})})]}),i.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:[i.jsx("label",{className:"block text-sm font-semibold text-emerald-800 mb-3",children:"รหัสผ่าน"}),i.jsxs("div",{className:"relative group",children:[i.jsx(up,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-emerald-500 h-5 w-5 group-focus-within:text-emerald-600 transition-colors"}),i.jsx("input",{type:n?"text":"password",name:"password",value:t.password,onChange:h,className:`w-full pl-12 pr-14 py-4 border-2 rounded-2xl focus:ring-4 focus:ring-emerald-500/30 focus:border-emerald-400 transition-all duration-300 bg-white/80 backdrop-blur-sm text-emerald-900 placeholder-emerald-500 ${l.password?"border-red-400 bg-red-50":"border-emerald-300/50 hover:border-emerald-400"}`,placeholder:"กรอกรหัสผ่าน",disabled:a}),i.jsx("button",{type:"button",onClick:()=>s(!n),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-emerald-500 hover:text-emerald-600 transition-colors",disabled:a,children:n?i.jsx(cp,{className:"h-5 w-5"}):i.jsx(g0,{className:"h-5 w-5"})})]}),i.jsx(dc,{children:l.password&&i.jsxs(Me.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-red-300 text-sm mt-2 flex items-center gap-2",children:[i.jsx(Ui,{className:"h-4 w-4"}),l.password]})})]}),i.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},children:i.jsx(oe,{type:"submit",disabled:a,className:"w-full py-4 text-lg font-semibold bg-gradient-to-r from-emerald-400 via-green-500 to-teal-500 hover:from-emerald-500 hover:via-green-600 hover:to-teal-600 shadow-2xl hover:shadow-emerald-500/25 transition-all duration-300 transform hover:scale-105 rounded-2xl",children:a?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Ut,{className:"h-5 w-5 animate-spin"}),"กำลังเข้าสู่ระบบ..."]}):i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rD,{className:"h-5 w-5"}),"เข้าสู่ระบบ"]})})})]})})]}),i.jsx(Me.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},className:"text-center mt-8",children:i.jsxs("div",{className:"flex items-center justify-center gap-3 text-sm text-emerald-600",children:[i.jsx(jn,{className:"h-5 w-5"}),i.jsx("span",{className:"font-medium",children:"ระบบปลอดภัยด้วยการยืนยันตัวตน"})]})})]})})]})};function _X(){const[e,t]=E.useState([]),[r,n]=E.useState(null),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,u]=E.useState(null);E.useEffect(()=>{d()},[]),E.useEffect(()=>{o&&f()},[o]);const d=async()=>{try{if(a(!0),Zl.isAuthenticated()){const g=Zl.getCurrentUser();u(g),l(!0)}}catch(g){console.error("Auth check error:",g),Zl.logout()}finally{a(!1)}},f=async()=>{try{a(!0);const p=(await xi.getAll()).data||[];t(p),!r&&p.length>0&&n(p[0].id),console.log("✅ Branches loaded successfully:",p)}catch(g){console.error("❌ Error loading branches:",g),ge({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลสาขาได้",variant:"destructive"})}finally{a(!1)}},h=g=>{u(g),l(!0)},m=()=>{Zl.logout(),u(null),l(!1),t([]),n(null)};return s?i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"กำลังโหลดข้อมูล..."})]})}):o?i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[i.jsx(bX,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:m}),i.jsx(By,{})]}):i.jsxs(i.Fragment,{children:[i.jsx(kX,{onLoginSuccess:h}),i.jsx(By,{})]})}Zh.createRoot(document.getElementById("root")).render(i.jsx(xt.StrictMode,{children:i.jsx(_X,{})}));
