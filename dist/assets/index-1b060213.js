function UE(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function fb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hb={exports:{}},hf={},mb={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bu=Symbol.for("react.element"),VE=Symbol.for("react.portal"),zE=Symbol.for("react.fragment"),WE=Symbol.for("react.strict_mode"),HE=Symbol.for("react.profiler"),GE=Symbol.for("react.provider"),XE=Symbol.for("react.context"),KE=Symbol.for("react.forward_ref"),YE=Symbol.for("react.suspense"),qE=Symbol.for("react.memo"),JE=Symbol.for("react.lazy"),K1=Symbol.iterator;function ZE(e){return e===null||typeof e!="object"?null:(e=K1&&e[K1]||e["@@iterator"],typeof e=="function"?e:null)}var pb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xb=Object.assign,gb={};function kl(e,t,r){this.props=e,this.context=t,this.refs=gb,this.updater=r||pb}kl.prototype.isReactComponent={};kl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};kl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vb(){}vb.prototype=kl.prototype;function lx(e,t,r){this.props=e,this.context=t,this.refs=gb,this.updater=r||pb}var cx=lx.prototype=new vb;cx.constructor=lx;xb(cx,kl.prototype);cx.isPureReactComponent=!0;var Y1=Array.isArray,yb=Object.prototype.hasOwnProperty,ux={current:null},wb={key:!0,ref:!0,__self:!0,__source:!0};function bb(e,t,r){var n,s={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)yb.call(t,n)&&!wb.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:bu,type:e,key:a,ref:o,props:s,_owner:ux.current}}function QE(e,t){return{$$typeof:bu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function dx(e){return typeof e=="object"&&e!==null&&e.$$typeof===bu}function e3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var q1=/\/+/g;function dh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?e3(""+e.key):t.toString(36)}function Od(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case bu:case VE:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+dh(o,0):n,Y1(s)?(r="",e!=null&&(r=e.replace(q1,"$&/")+"/"),Od(s,t,r,"",function(u){return u})):s!=null&&(dx(s)&&(s=QE(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(q1,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",Y1(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+dh(a,l);o+=Od(a,t,r,c,s)}else if(c=ZE(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+dh(a,l++),o+=Od(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Zu(e,t,r){if(e==null)return e;var n=[],s=0;return Od(e,n,"","",function(a){return t.call(r,a,s++)}),n}function t3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ln={current:null},Md={transition:null},r3={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:Md,ReactCurrentOwner:ux};function Nb(){throw Error("act(...) is not supported in production builds of React.")}st.Children={map:Zu,forEach:function(e,t,r){Zu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Zu(e,function(){t++}),t},toArray:function(e){return Zu(e,function(t){return t})||[]},only:function(e){if(!dx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};st.Component=kl;st.Fragment=zE;st.Profiler=HE;st.PureComponent=lx;st.StrictMode=WE;st.Suspense=YE;st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r3;st.act=Nb;st.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=xb({},e.props),s=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=ux.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)yb.call(t,c)&&!wb.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:bu,type:e.type,key:s,ref:a,props:n,_owner:o}};st.createContext=function(e){return e={$$typeof:XE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:GE,_context:e},e.Consumer=e};st.createElement=bb;st.createFactory=function(e){var t=bb.bind(null,e);return t.type=e,t};st.createRef=function(){return{current:null}};st.forwardRef=function(e){return{$$typeof:KE,render:e}};st.isValidElement=dx;st.lazy=function(e){return{$$typeof:JE,_payload:{_status:-1,_result:e},_init:t3}};st.memo=function(e,t){return{$$typeof:qE,type:e,compare:t===void 0?null:t}};st.startTransition=function(e){var t=Md.transition;Md.transition={};try{e()}finally{Md.transition=t}};st.unstable_act=Nb;st.useCallback=function(e,t){return ln.current.useCallback(e,t)};st.useContext=function(e){return ln.current.useContext(e)};st.useDebugValue=function(){};st.useDeferredValue=function(e){return ln.current.useDeferredValue(e)};st.useEffect=function(e,t){return ln.current.useEffect(e,t)};st.useId=function(){return ln.current.useId()};st.useImperativeHandle=function(e,t,r){return ln.current.useImperativeHandle(e,t,r)};st.useInsertionEffect=function(e,t){return ln.current.useInsertionEffect(e,t)};st.useLayoutEffect=function(e,t){return ln.current.useLayoutEffect(e,t)};st.useMemo=function(e,t){return ln.current.useMemo(e,t)};st.useReducer=function(e,t,r){return ln.current.useReducer(e,t,r)};st.useRef=function(e){return ln.current.useRef(e)};st.useState=function(e){return ln.current.useState(e)};st.useSyncExternalStore=function(e,t,r){return ln.current.useSyncExternalStore(e,t,r)};st.useTransition=function(){return ln.current.useTransition()};st.version="18.3.1";mb.exports=st;var k=mb.exports;const wt=fb(k),n3=UE({__proto__:null,default:wt},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s3=k,a3=Symbol.for("react.element"),i3=Symbol.for("react.fragment"),o3=Object.prototype.hasOwnProperty,l3=s3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c3={key:!0,ref:!0,__self:!0,__source:!0};function kb(e,t,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)o3.call(t,n)&&!c3.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:a3,type:e,key:a,ref:o,props:s,_owner:l3.current}}hf.Fragment=i3;hf.jsx=kb;hf.jsxs=kb;hb.exports=hf;var i=hb.exports,km={},_b={exports:{}},Mn={},Sb={exports:{}},jb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,C){var R=q.length;q.push(C);e:for(;0<R;){var F=R-1>>>1,E=q[F];if(0<s(E,C))q[F]=C,q[R]=E,R=F;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var C=q[0],R=q.pop();if(R!==C){q[0]=R;e:for(var F=0,E=q.length,M=E>>>1;F<M;){var H=2*(F+1)-1,G=q[H],re=H+1,he=q[re];if(0>s(G,R))re<E&&0>s(he,G)?(q[F]=he,q[re]=R,F=re):(q[F]=G,q[H]=R,F=H);else if(re<E&&0>s(he,R))q[F]=he,q[re]=R,F=re;else break e}}return C}function s(q,C){var R=q.sortIndex-C.sortIndex;return R!==0?R:q.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,g=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(q){for(var C=r(u);C!==null;){if(C.callback===null)n(u);else if(C.startTime<=q)n(u),C.sortIndex=C.expirationTime,t(c,C);else break;C=r(u)}}function N(q){if(p=!1,x(q),!g)if(r(c)!==null)g=!0,j(S);else{var C=r(u);C!==null&&U(N,C.startTime-q)}}function S(q,C){g=!1,p&&(p=!1,w(A),A=-1),m=!0;var R=h;try{for(x(C),f=r(c);f!==null&&(!(f.expirationTime>C)||q&&!P());){var F=f.callback;if(typeof F=="function"){f.callback=null,h=f.priorityLevel;var E=F(f.expirationTime<=C);C=e.unstable_now(),typeof E=="function"?f.callback=E:f===r(c)&&n(c),x(C)}else n(c);f=r(c)}if(f!==null)var M=!0;else{var H=r(u);H!==null&&U(N,H.startTime-C),M=!1}return M}finally{f=null,h=R,m=!1}}var _=!1,b=null,A=-1,D=5,V=-1;function P(){return!(e.unstable_now()-V<D)}function T(){if(b!==null){var q=e.unstable_now();V=q;var C=!0;try{C=b(!0,q)}finally{C?z():(_=!1,b=null)}}else _=!1}var z;if(typeof y=="function")z=function(){y(T)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,ee=L.port2;L.port1.onmessage=T,z=function(){ee.postMessage(null)}}else z=function(){v(T,0)};function j(q){b=q,_||(_=!0,z())}function U(q,C){A=v(function(){q(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,j(S))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(h){case 1:case 2:case 3:var C=3;break;default:C=h}var R=h;h=C;try{return q()}finally{h=R}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,C){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var R=h;h=q;try{return C()}finally{h=R}},e.unstable_scheduleCallback=function(q,C,R){var F=e.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?F+R:F):R=F,q){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=R+E,q={id:d++,callback:C,priorityLevel:q,startTime:R,expirationTime:E,sortIndex:-1},R>F?(q.sortIndex=R,t(u,q),r(c)===null&&q===r(u)&&(p?(w(A),A=-1):p=!0,U(N,R-F))):(q.sortIndex=E,t(c,q),g||m||(g=!0,j(S))),q},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(q){var C=h;return function(){var R=h;h=C;try{return q.apply(this,arguments)}finally{h=R}}}})(jb);Sb.exports=jb;var u3=Sb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d3=k,In=u3;function je(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Cb=new Set,Oc={};function co(e,t){ol(e,t),ol(e+"Capture",t)}function ol(e,t){for(Oc[e]=t,e=0;e<t.length;e++)Cb.add(t[e])}var ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_m=Object.prototype.hasOwnProperty,f3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,J1={},Z1={};function h3(e){return _m.call(Z1,e)?!0:_m.call(J1,e)?!1:f3.test(e)?Z1[e]=!0:(J1[e]=!0,!1)}function m3(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function p3(e,t,r,n){if(t===null||typeof t>"u"||m3(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function cn(e,t,r,n,s,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Pr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pr[e]=new cn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pr[t]=new cn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pr[e]=new cn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pr[e]=new cn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pr[e]=new cn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pr[e]=new cn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pr[e]=new cn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pr[e]=new cn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pr[e]=new cn(e,5,!1,e.toLowerCase(),null,!1,!1)});var fx=/[\-:]([a-z])/g;function hx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(fx,hx);Pr[t]=new cn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(fx,hx);Pr[t]=new cn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(fx,hx);Pr[t]=new cn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pr[e]=new cn(e,1,!1,e.toLowerCase(),null,!1,!1)});Pr.xlinkHref=new cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pr[e]=new cn(e,1,!1,e.toLowerCase(),null,!0,!0)});function mx(e,t,r,n){var s=Pr.hasOwnProperty(t)?Pr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(p3(t,r,s,n)&&(r=null),n||s===null?h3(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ba=d3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qu=Symbol.for("react.element"),Fo=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),px=Symbol.for("react.strict_mode"),Sm=Symbol.for("react.profiler"),Eb=Symbol.for("react.provider"),Tb=Symbol.for("react.context"),xx=Symbol.for("react.forward_ref"),jm=Symbol.for("react.suspense"),Cm=Symbol.for("react.suspense_list"),gx=Symbol.for("react.memo"),Pa=Symbol.for("react.lazy"),Ab=Symbol.for("react.offscreen"),Q1=Symbol.iterator;function Wl(e){return e===null||typeof e!="object"?null:(e=Q1&&e[Q1]||e["@@iterator"],typeof e=="function"?e:null)}var Vt=Object.assign,fh;function ic(e){if(fh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);fh=t&&t[1]||""}return`
`+fh+e}var hh=!1;function mh(e,t){if(!e||hh)return"";hh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{hh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ic(e):""}function x3(e){switch(e.tag){case 5:return ic(e.type);case 16:return ic("Lazy");case 13:return ic("Suspense");case 19:return ic("SuspenseList");case 0:case 2:case 15:return e=mh(e.type,!1),e;case 11:return e=mh(e.type.render,!1),e;case 1:return e=mh(e.type,!0),e;default:return""}}function Em(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Po:return"Fragment";case Fo:return"Portal";case Sm:return"Profiler";case px:return"StrictMode";case jm:return"Suspense";case Cm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Tb:return(e.displayName||"Context")+".Consumer";case Eb:return(e._context.displayName||"Context")+".Provider";case xx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case gx:return t=e.displayName||null,t!==null?t:Em(e.type)||"Memo";case Pa:t=e._payload,e=e._init;try{return Em(e(t))}catch{}}return null}function g3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Em(t);case 8:return t===px?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ti(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Fb(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function v3(e){var t=Fb(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ed(e){e._valueTracker||(e._valueTracker=v3(e))}function Pb(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Fb(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function i0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Tm(e,t){var r=t.checked;return Vt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function ev(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ti(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Db(e,t){t=t.checked,t!=null&&mx(e,"checked",t,!1)}function Am(e,t){Db(e,t);var r=ti(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Fm(e,t.type,r):t.hasOwnProperty("defaultValue")&&Fm(e,t.type,ti(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function tv(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Fm(e,t,r){(t!=="number"||i0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var oc=Array.isArray;function Yo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ti(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Pm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(je(91));return Vt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rv(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(je(92));if(oc(r)){if(1<r.length)throw Error(je(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ti(r)}}function Ib(e,t){var r=ti(t.value),n=ti(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function nv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Rb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Rb(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var td,Lb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(td=td||document.createElement("div"),td.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=td.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var pc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},y3=["Webkit","ms","Moz","O"];Object.keys(pc).forEach(function(e){y3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pc[t]=pc[e]})});function Ob(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||pc.hasOwnProperty(e)&&pc[e]?(""+t).trim():t+"px"}function Mb(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Ob(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var w3=Vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Im(e,t){if(t){if(w3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(je(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(je(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(je(61))}if(t.style!=null&&typeof t.style!="object")throw Error(je(62))}}function Rm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lm=null;function vx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Om=null,qo=null,Jo=null;function sv(e){if(e=_u(e)){if(typeof Om!="function")throw Error(je(280));var t=e.stateNode;t&&(t=vf(t),Om(e.stateNode,e.type,t))}}function Bb(e){qo?Jo?Jo.push(e):Jo=[e]:qo=e}function $b(){if(qo){var e=qo,t=Jo;if(Jo=qo=null,sv(e),t)for(e=0;e<t.length;e++)sv(t[e])}}function Ub(e,t){return e(t)}function Vb(){}var ph=!1;function zb(e,t,r){if(ph)return e(t,r);ph=!0;try{return Ub(e,t,r)}finally{ph=!1,(qo!==null||Jo!==null)&&(Vb(),$b())}}function Bc(e,t){var r=e.stateNode;if(r===null)return null;var n=vf(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(je(231,t,typeof r));return r}var Mm=!1;if(ha)try{var Hl={};Object.defineProperty(Hl,"passive",{get:function(){Mm=!0}}),window.addEventListener("test",Hl,Hl),window.removeEventListener("test",Hl,Hl)}catch{Mm=!1}function b3(e,t,r,n,s,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var xc=!1,o0=null,l0=!1,Bm=null,N3={onError:function(e){xc=!0,o0=e}};function k3(e,t,r,n,s,a,o,l,c){xc=!1,o0=null,b3.apply(N3,arguments)}function _3(e,t,r,n,s,a,o,l,c){if(k3.apply(this,arguments),xc){if(xc){var u=o0;xc=!1,o0=null}else throw Error(je(198));l0||(l0=!0,Bm=u)}}function uo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Wb(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function av(e){if(uo(e)!==e)throw Error(je(188))}function S3(e){var t=e.alternate;if(!t){if(t=uo(e),t===null)throw Error(je(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return av(s),e;if(a===n)return av(s),t;a=a.sibling}throw Error(je(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(je(189))}}if(r.alternate!==n)throw Error(je(190))}if(r.tag!==3)throw Error(je(188));return r.stateNode.current===r?e:t}function Hb(e){return e=S3(e),e!==null?Gb(e):null}function Gb(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Gb(e);if(t!==null)return t;e=e.sibling}return null}var Xb=In.unstable_scheduleCallback,iv=In.unstable_cancelCallback,j3=In.unstable_shouldYield,C3=In.unstable_requestPaint,Qt=In.unstable_now,E3=In.unstable_getCurrentPriorityLevel,yx=In.unstable_ImmediatePriority,Kb=In.unstable_UserBlockingPriority,c0=In.unstable_NormalPriority,T3=In.unstable_LowPriority,Yb=In.unstable_IdlePriority,mf=null,Bs=null;function A3(e){if(Bs&&typeof Bs.onCommitFiberRoot=="function")try{Bs.onCommitFiberRoot(mf,e,void 0,(e.current.flags&128)===128)}catch{}}var ys=Math.clz32?Math.clz32:D3,F3=Math.log,P3=Math.LN2;function D3(e){return e>>>=0,e===0?32:31-(F3(e)/P3|0)|0}var rd=64,nd=4194304;function lc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function u0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=lc(l):(a&=o,a!==0&&(n=lc(a)))}else o=r&~s,o!==0?n=lc(o):a!==0&&(n=lc(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ys(t),s=1<<r,n|=e[r],t&=~s;return n}function I3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R3(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ys(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=I3(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function $m(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function qb(){var e=rd;return rd<<=1,!(rd&4194240)&&(rd=64),e}function xh(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Nu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ys(t),e[t]=r}function L3(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-ys(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function wx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ys(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var yt=0;function Jb(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Zb,bx,Qb,eN,tN,Um=!1,sd=[],Ha=null,Ga=null,Xa=null,$c=new Map,Uc=new Map,La=[],O3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ov(e,t){switch(e){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":Ga=null;break;case"mouseover":case"mouseout":Xa=null;break;case"pointerover":case"pointerout":$c.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uc.delete(t.pointerId)}}function Gl(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=_u(t),t!==null&&bx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function M3(e,t,r,n,s){switch(t){case"focusin":return Ha=Gl(Ha,e,t,r,n,s),!0;case"dragenter":return Ga=Gl(Ga,e,t,r,n,s),!0;case"mouseover":return Xa=Gl(Xa,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return $c.set(a,Gl($c.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Uc.set(a,Gl(Uc.get(a)||null,e,t,r,n,s)),!0}return!1}function rN(e){var t=Ai(e.target);if(t!==null){var r=uo(t);if(r!==null){if(t=r.tag,t===13){if(t=Wb(r),t!==null){e.blockedOn=t,tN(e.priority,function(){Qb(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Vm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Lm=n,r.target.dispatchEvent(n),Lm=null}else return t=_u(r),t!==null&&bx(t),e.blockedOn=r,!1;t.shift()}return!0}function lv(e,t,r){Bd(e)&&r.delete(t)}function B3(){Um=!1,Ha!==null&&Bd(Ha)&&(Ha=null),Ga!==null&&Bd(Ga)&&(Ga=null),Xa!==null&&Bd(Xa)&&(Xa=null),$c.forEach(lv),Uc.forEach(lv)}function Xl(e,t){e.blockedOn===t&&(e.blockedOn=null,Um||(Um=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,B3)))}function Vc(e){function t(s){return Xl(s,e)}if(0<sd.length){Xl(sd[0],e);for(var r=1;r<sd.length;r++){var n=sd[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ha!==null&&Xl(Ha,e),Ga!==null&&Xl(Ga,e),Xa!==null&&Xl(Xa,e),$c.forEach(t),Uc.forEach(t),r=0;r<La.length;r++)n=La[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<La.length&&(r=La[0],r.blockedOn===null);)rN(r),r.blockedOn===null&&La.shift()}var Zo=ba.ReactCurrentBatchConfig,d0=!0;function $3(e,t,r,n){var s=yt,a=Zo.transition;Zo.transition=null;try{yt=1,Nx(e,t,r,n)}finally{yt=s,Zo.transition=a}}function U3(e,t,r,n){var s=yt,a=Zo.transition;Zo.transition=null;try{yt=4,Nx(e,t,r,n)}finally{yt=s,Zo.transition=a}}function Nx(e,t,r,n){if(d0){var s=Vm(e,t,r,n);if(s===null)jh(e,t,n,f0,r),ov(e,n);else if(M3(s,e,t,r,n))n.stopPropagation();else if(ov(e,n),t&4&&-1<O3.indexOf(e)){for(;s!==null;){var a=_u(s);if(a!==null&&Zb(a),a=Vm(e,t,r,n),a===null&&jh(e,t,n,f0,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else jh(e,t,n,null,r)}}var f0=null;function Vm(e,t,r,n){if(f0=null,e=vx(n),e=Ai(e),e!==null)if(t=uo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Wb(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return f0=e,null}function nN(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(E3()){case yx:return 1;case Kb:return 4;case c0:case T3:return 16;case Yb:return 536870912;default:return 16}default:return 16}}var Ba=null,kx=null,$d=null;function sN(){if($d)return $d;var e,t=kx,r=t.length,n,s="value"in Ba?Ba.value:Ba.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[a-n];n++);return $d=s.slice(e,1<n?1-n:void 0)}function Ud(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ad(){return!0}function cv(){return!1}function Bn(e){function t(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ad:cv,this.isPropagationStopped=cv,this}return Vt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ad)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ad)},persist:function(){},isPersistent:ad}),t}var _l={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_x=Bn(_l),ku=Vt({},_l,{view:0,detail:0}),V3=Bn(ku),gh,vh,Kl,pf=Vt({},ku,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Kl&&(Kl&&e.type==="mousemove"?(gh=e.screenX-Kl.screenX,vh=e.screenY-Kl.screenY):vh=gh=0,Kl=e),gh)},movementY:function(e){return"movementY"in e?e.movementY:vh}}),uv=Bn(pf),z3=Vt({},pf,{dataTransfer:0}),W3=Bn(z3),H3=Vt({},ku,{relatedTarget:0}),yh=Bn(H3),G3=Vt({},_l,{animationName:0,elapsedTime:0,pseudoElement:0}),X3=Bn(G3),K3=Vt({},_l,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Y3=Bn(K3),q3=Vt({},_l,{data:0}),dv=Bn(q3),J3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Q3[e])?!!t[e]:!1}function Sx(){return eT}var tT=Vt({},ku,{key:function(e){if(e.key){var t=J3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ud(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Z3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sx,charCode:function(e){return e.type==="keypress"?Ud(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ud(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),rT=Bn(tT),nT=Vt({},pf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fv=Bn(nT),sT=Vt({},ku,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sx}),aT=Bn(sT),iT=Vt({},_l,{propertyName:0,elapsedTime:0,pseudoElement:0}),oT=Bn(iT),lT=Vt({},pf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),cT=Bn(lT),uT=[9,13,27,32],jx=ha&&"CompositionEvent"in window,gc=null;ha&&"documentMode"in document&&(gc=document.documentMode);var dT=ha&&"TextEvent"in window&&!gc,aN=ha&&(!jx||gc&&8<gc&&11>=gc),hv=String.fromCharCode(32),mv=!1;function iN(e,t){switch(e){case"keyup":return uT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oN(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Do=!1;function fT(e,t){switch(e){case"compositionend":return oN(t);case"keypress":return t.which!==32?null:(mv=!0,hv);case"textInput":return e=t.data,e===hv&&mv?null:e;default:return null}}function hT(e,t){if(Do)return e==="compositionend"||!jx&&iN(e,t)?(e=sN(),$d=kx=Ba=null,Do=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return aN&&t.locale!=="ko"?null:t.data;default:return null}}var mT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!mT[e.type]:t==="textarea"}function lN(e,t,r,n){Bb(n),t=h0(t,"onChange"),0<t.length&&(r=new _x("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var vc=null,zc=null;function pT(e){yN(e,0)}function xf(e){var t=Lo(e);if(Pb(t))return e}function xT(e,t){if(e==="change")return t}var cN=!1;if(ha){var wh;if(ha){var bh="oninput"in document;if(!bh){var xv=document.createElement("div");xv.setAttribute("oninput","return;"),bh=typeof xv.oninput=="function"}wh=bh}else wh=!1;cN=wh&&(!document.documentMode||9<document.documentMode)}function gv(){vc&&(vc.detachEvent("onpropertychange",uN),zc=vc=null)}function uN(e){if(e.propertyName==="value"&&xf(zc)){var t=[];lN(t,zc,e,vx(e)),zb(pT,t)}}function gT(e,t,r){e==="focusin"?(gv(),vc=t,zc=r,vc.attachEvent("onpropertychange",uN)):e==="focusout"&&gv()}function vT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xf(zc)}function yT(e,t){if(e==="click")return xf(t)}function wT(e,t){if(e==="input"||e==="change")return xf(t)}function bT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _s=typeof Object.is=="function"?Object.is:bT;function Wc(e,t){if(_s(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!_m.call(t,s)||!_s(e[s],t[s]))return!1}return!0}function vv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function yv(e,t){var r=vv(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=vv(r)}}function dN(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dN(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fN(){for(var e=window,t=i0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=i0(e.document)}return t}function Cx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function NT(e){var t=fN(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&dN(r.ownerDocument.documentElement,r)){if(n!==null&&Cx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=yv(r,a);var o=yv(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var kT=ha&&"documentMode"in document&&11>=document.documentMode,Io=null,zm=null,yc=null,Wm=!1;function wv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Wm||Io==null||Io!==i0(n)||(n=Io,"selectionStart"in n&&Cx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),yc&&Wc(yc,n)||(yc=n,n=h0(zm,"onSelect"),0<n.length&&(t=new _x("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Io)))}function id(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ro={animationend:id("Animation","AnimationEnd"),animationiteration:id("Animation","AnimationIteration"),animationstart:id("Animation","AnimationStart"),transitionend:id("Transition","TransitionEnd")},Nh={},hN={};ha&&(hN=document.createElement("div").style,"AnimationEvent"in window||(delete Ro.animationend.animation,delete Ro.animationiteration.animation,delete Ro.animationstart.animation),"TransitionEvent"in window||delete Ro.transitionend.transition);function gf(e){if(Nh[e])return Nh[e];if(!Ro[e])return e;var t=Ro[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in hN)return Nh[e]=t[r];return e}var mN=gf("animationend"),pN=gf("animationiteration"),xN=gf("animationstart"),gN=gf("transitionend"),vN=new Map,bv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function di(e,t){vN.set(e,t),co(t,[e])}for(var kh=0;kh<bv.length;kh++){var _h=bv[kh],_T=_h.toLowerCase(),ST=_h[0].toUpperCase()+_h.slice(1);di(_T,"on"+ST)}di(mN,"onAnimationEnd");di(pN,"onAnimationIteration");di(xN,"onAnimationStart");di("dblclick","onDoubleClick");di("focusin","onFocus");di("focusout","onBlur");di(gN,"onTransitionEnd");ol("onMouseEnter",["mouseout","mouseover"]);ol("onMouseLeave",["mouseout","mouseover"]);ol("onPointerEnter",["pointerout","pointerover"]);ol("onPointerLeave",["pointerout","pointerover"]);co("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));co("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));co("onBeforeInput",["compositionend","keypress","textInput","paste"]);co("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));co("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));co("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jT=new Set("cancel close invalid load scroll toggle".split(" ").concat(cc));function Nv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,_3(n,t,void 0,e),e.currentTarget=null}function yN(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;Nv(s,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;Nv(s,l,u),a=c}}}if(l0)throw e=Bm,l0=!1,Bm=null,e}function Ct(e,t){var r=t[Ym];r===void 0&&(r=t[Ym]=new Set);var n=e+"__bubble";r.has(n)||(wN(t,e,2,!1),r.add(n))}function Sh(e,t,r){var n=0;t&&(n|=4),wN(r,e,n,t)}var od="_reactListening"+Math.random().toString(36).slice(2);function Hc(e){if(!e[od]){e[od]=!0,Cb.forEach(function(r){r!=="selectionchange"&&(jT.has(r)||Sh(r,!1,e),Sh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[od]||(t[od]=!0,Sh("selectionchange",!1,t))}}function wN(e,t,r,n){switch(nN(t)){case 1:var s=$3;break;case 4:s=U3;break;default:s=Nx}r=s.bind(null,t,r,e),s=void 0,!Mm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function jh(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ai(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}zb(function(){var u=a,d=vx(r),f=[];e:{var h=vN.get(e);if(h!==void 0){var m=_x,g=e;switch(e){case"keypress":if(Ud(r)===0)break e;case"keydown":case"keyup":m=rT;break;case"focusin":g="focus",m=yh;break;case"focusout":g="blur",m=yh;break;case"beforeblur":case"afterblur":m=yh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=uv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=W3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=aT;break;case mN:case pN:case xN:m=X3;break;case gN:m=oT;break;case"scroll":m=V3;break;case"wheel":m=cT;break;case"copy":case"cut":case"paste":m=Y3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=fv}var p=(t&4)!==0,v=!p&&e==="scroll",w=p?h!==null?h+"Capture":null:h;p=[];for(var y=u,x;y!==null;){x=y;var N=x.stateNode;if(x.tag===5&&N!==null&&(x=N,w!==null&&(N=Bc(y,w),N!=null&&p.push(Gc(y,N,x)))),v)break;y=y.return}0<p.length&&(h=new m(h,g,null,r,d),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==Lm&&(g=r.relatedTarget||r.fromElement)&&(Ai(g)||g[ma]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=u,g=g?Ai(g):null,g!==null&&(v=uo(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(p=uv,N="onMouseLeave",w="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=fv,N="onPointerLeave",w="onPointerEnter",y="pointer"),v=m==null?h:Lo(m),x=g==null?h:Lo(g),h=new p(N,y+"leave",m,r,d),h.target=v,h.relatedTarget=x,N=null,Ai(d)===u&&(p=new p(w,y+"enter",g,r,d),p.target=x,p.relatedTarget=v,N=p),v=N,m&&g)t:{for(p=m,w=g,y=0,x=p;x;x=_o(x))y++;for(x=0,N=w;N;N=_o(N))x++;for(;0<y-x;)p=_o(p),y--;for(;0<x-y;)w=_o(w),x--;for(;y--;){if(p===w||w!==null&&p===w.alternate)break t;p=_o(p),w=_o(w)}p=null}else p=null;m!==null&&kv(f,h,m,p,!1),g!==null&&v!==null&&kv(f,v,g,p,!0)}}e:{if(h=u?Lo(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var S=xT;else if(pv(h))if(cN)S=wT;else{S=vT;var _=gT}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=yT);if(S&&(S=S(e,u))){lN(f,S,r,d);break e}_&&_(e,h,u),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&Fm(h,"number",h.value)}switch(_=u?Lo(u):window,e){case"focusin":(pv(_)||_.contentEditable==="true")&&(Io=_,zm=u,yc=null);break;case"focusout":yc=zm=Io=null;break;case"mousedown":Wm=!0;break;case"contextmenu":case"mouseup":case"dragend":Wm=!1,wv(f,r,d);break;case"selectionchange":if(kT)break;case"keydown":case"keyup":wv(f,r,d)}var b;if(jx)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Do?iN(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(aN&&r.locale!=="ko"&&(Do||A!=="onCompositionStart"?A==="onCompositionEnd"&&Do&&(b=sN()):(Ba=d,kx="value"in Ba?Ba.value:Ba.textContent,Do=!0)),_=h0(u,A),0<_.length&&(A=new dv(A,e,null,r,d),f.push({event:A,listeners:_}),b?A.data=b:(b=oN(r),b!==null&&(A.data=b)))),(b=dT?fT(e,r):hT(e,r))&&(u=h0(u,"onBeforeInput"),0<u.length&&(d=new dv("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=b))}yN(f,t)})}function Gc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function h0(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Bc(e,r),a!=null&&n.unshift(Gc(e,a,s)),a=Bc(e,t),a!=null&&n.push(Gc(e,a,s))),e=e.return}return n}function _o(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function kv(e,t,r,n,s){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Bc(r,a),c!=null&&o.unshift(Gc(r,c,l))):s||(c=Bc(r,a),c!=null&&o.push(Gc(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var CT=/\r\n?/g,ET=/\u0000|\uFFFD/g;function _v(e){return(typeof e=="string"?e:""+e).replace(CT,`
`).replace(ET,"")}function ld(e,t,r){if(t=_v(t),_v(e)!==t&&r)throw Error(je(425))}function m0(){}var Hm=null,Gm=null;function Xm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Km=typeof setTimeout=="function"?setTimeout:void 0,TT=typeof clearTimeout=="function"?clearTimeout:void 0,Sv=typeof Promise=="function"?Promise:void 0,AT=typeof queueMicrotask=="function"?queueMicrotask:typeof Sv<"u"?function(e){return Sv.resolve(null).then(e).catch(FT)}:Km;function FT(e){setTimeout(function(){throw e})}function Ch(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Vc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Vc(t)}function Ka(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function jv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Sl=Math.random().toString(36).slice(2),Ls="__reactFiber$"+Sl,Xc="__reactProps$"+Sl,ma="__reactContainer$"+Sl,Ym="__reactEvents$"+Sl,PT="__reactListeners$"+Sl,DT="__reactHandles$"+Sl;function Ai(e){var t=e[Ls];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ma]||r[Ls]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=jv(e);e!==null;){if(r=e[Ls])return r;e=jv(e)}return t}e=r,r=e.parentNode}return null}function _u(e){return e=e[Ls]||e[ma],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Lo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(je(33))}function vf(e){return e[Xc]||null}var qm=[],Oo=-1;function fi(e){return{current:e}}function Tt(e){0>Oo||(e.current=qm[Oo],qm[Oo]=null,Oo--)}function Nt(e,t){Oo++,qm[Oo]=e.current,e.current=t}var ri={},Kr=fi(ri),mn=fi(!1),Hi=ri;function ll(e,t){var r=e.type.contextTypes;if(!r)return ri;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function pn(e){return e=e.childContextTypes,e!=null}function p0(){Tt(mn),Tt(Kr)}function Cv(e,t,r){if(Kr.current!==ri)throw Error(je(168));Nt(Kr,t),Nt(mn,r)}function bN(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(je(108,g3(e)||"Unknown",s));return Vt({},r,n)}function x0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ri,Hi=Kr.current,Nt(Kr,e),Nt(mn,mn.current),!0}function Ev(e,t,r){var n=e.stateNode;if(!n)throw Error(je(169));r?(e=bN(e,t,Hi),n.__reactInternalMemoizedMergedChildContext=e,Tt(mn),Tt(Kr),Nt(Kr,e)):Tt(mn),Nt(mn,r)}var Zs=null,yf=!1,Eh=!1;function NN(e){Zs===null?Zs=[e]:Zs.push(e)}function IT(e){yf=!0,NN(e)}function hi(){if(!Eh&&Zs!==null){Eh=!0;var e=0,t=yt;try{var r=Zs;for(yt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Zs=null,yf=!1}catch(s){throw Zs!==null&&(Zs=Zs.slice(e+1)),Xb(yx,hi),s}finally{yt=t,Eh=!1}}return null}var Mo=[],Bo=0,g0=null,v0=0,qn=[],Jn=0,Gi=null,Qs=1,ea="";function ki(e,t){Mo[Bo++]=v0,Mo[Bo++]=g0,g0=e,v0=t}function kN(e,t,r){qn[Jn++]=Qs,qn[Jn++]=ea,qn[Jn++]=Gi,Gi=e;var n=Qs;e=ea;var s=32-ys(n)-1;n&=~(1<<s),r+=1;var a=32-ys(t)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Qs=1<<32-ys(t)+s|r<<s|n,ea=a+e}else Qs=1<<a|r<<s|n,ea=e}function Ex(e){e.return!==null&&(ki(e,1),kN(e,1,0))}function Tx(e){for(;e===g0;)g0=Mo[--Bo],Mo[Bo]=null,v0=Mo[--Bo],Mo[Bo]=null;for(;e===Gi;)Gi=qn[--Jn],qn[Jn]=null,ea=qn[--Jn],qn[Jn]=null,Qs=qn[--Jn],qn[Jn]=null}var Dn=null,Pn=null,Dt=!1,xs=null;function _N(e,t){var r=es(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Tv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dn=e,Pn=Ka(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dn=e,Pn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Gi!==null?{id:Qs,overflow:ea}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=es(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Dn=e,Pn=null,!0):!1;default:return!1}}function Jm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zm(e){if(Dt){var t=Pn;if(t){var r=t;if(!Tv(e,t)){if(Jm(e))throw Error(je(418));t=Ka(r.nextSibling);var n=Dn;t&&Tv(e,t)?_N(n,r):(e.flags=e.flags&-4097|2,Dt=!1,Dn=e)}}else{if(Jm(e))throw Error(je(418));e.flags=e.flags&-4097|2,Dt=!1,Dn=e}}}function Av(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dn=e}function cd(e){if(e!==Dn)return!1;if(!Dt)return Av(e),Dt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xm(e.type,e.memoizedProps)),t&&(t=Pn)){if(Jm(e))throw SN(),Error(je(418));for(;t;)_N(e,t),t=Ka(t.nextSibling)}if(Av(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(je(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Pn=Ka(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Pn=null}}else Pn=Dn?Ka(e.stateNode.nextSibling):null;return!0}function SN(){for(var e=Pn;e;)e=Ka(e.nextSibling)}function cl(){Pn=Dn=null,Dt=!1}function Ax(e){xs===null?xs=[e]:xs.push(e)}var RT=ba.ReactCurrentBatchConfig;function Yl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(je(309));var n=r.stateNode}if(!n)throw Error(je(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(je(284));if(!r._owner)throw Error(je(290,e))}return e}function ud(e,t){throw e=Object.prototype.toString.call(t),Error(je(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Fv(e){var t=e._init;return t(e._payload)}function jN(e){function t(w,y){if(e){var x=w.deletions;x===null?(w.deletions=[y],w.flags|=16):x.push(y)}}function r(w,y){if(!e)return null;for(;y!==null;)t(w,y),y=y.sibling;return null}function n(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function s(w,y){return w=Za(w,y),w.index=0,w.sibling=null,w}function a(w,y,x){return w.index=x,e?(x=w.alternate,x!==null?(x=x.index,x<y?(w.flags|=2,y):x):(w.flags|=2,y)):(w.flags|=1048576,y)}function o(w){return e&&w.alternate===null&&(w.flags|=2),w}function l(w,y,x,N){return y===null||y.tag!==6?(y=Rh(x,w.mode,N),y.return=w,y):(y=s(y,x),y.return=w,y)}function c(w,y,x,N){var S=x.type;return S===Po?d(w,y,x.props.children,N,x.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Pa&&Fv(S)===y.type)?(N=s(y,x.props),N.ref=Yl(w,y,x),N.return=w,N):(N=Kd(x.type,x.key,x.props,null,w.mode,N),N.ref=Yl(w,y,x),N.return=w,N)}function u(w,y,x,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=Lh(x,w.mode,N),y.return=w,y):(y=s(y,x.children||[]),y.return=w,y)}function d(w,y,x,N,S){return y===null||y.tag!==7?(y=Bi(x,w.mode,N,S),y.return=w,y):(y=s(y,x),y.return=w,y)}function f(w,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Rh(""+y,w.mode,x),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Qu:return x=Kd(y.type,y.key,y.props,null,w.mode,x),x.ref=Yl(w,null,y),x.return=w,x;case Fo:return y=Lh(y,w.mode,x),y.return=w,y;case Pa:var N=y._init;return f(w,N(y._payload),x)}if(oc(y)||Wl(y))return y=Bi(y,w.mode,x,null),y.return=w,y;ud(w,y)}return null}function h(w,y,x,N){var S=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:l(w,y,""+x,N);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Qu:return x.key===S?c(w,y,x,N):null;case Fo:return x.key===S?u(w,y,x,N):null;case Pa:return S=x._init,h(w,y,S(x._payload),N)}if(oc(x)||Wl(x))return S!==null?null:d(w,y,x,N,null);ud(w,x)}return null}function m(w,y,x,N,S){if(typeof N=="string"&&N!==""||typeof N=="number")return w=w.get(x)||null,l(y,w,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Qu:return w=w.get(N.key===null?x:N.key)||null,c(y,w,N,S);case Fo:return w=w.get(N.key===null?x:N.key)||null,u(y,w,N,S);case Pa:var _=N._init;return m(w,y,x,_(N._payload),S)}if(oc(N)||Wl(N))return w=w.get(x)||null,d(y,w,N,S,null);ud(y,N)}return null}function g(w,y,x,N){for(var S=null,_=null,b=y,A=y=0,D=null;b!==null&&A<x.length;A++){b.index>A?(D=b,b=null):D=b.sibling;var V=h(w,b,x[A],N);if(V===null){b===null&&(b=D);break}e&&b&&V.alternate===null&&t(w,b),y=a(V,y,A),_===null?S=V:_.sibling=V,_=V,b=D}if(A===x.length)return r(w,b),Dt&&ki(w,A),S;if(b===null){for(;A<x.length;A++)b=f(w,x[A],N),b!==null&&(y=a(b,y,A),_===null?S=b:_.sibling=b,_=b);return Dt&&ki(w,A),S}for(b=n(w,b);A<x.length;A++)D=m(b,w,A,x[A],N),D!==null&&(e&&D.alternate!==null&&b.delete(D.key===null?A:D.key),y=a(D,y,A),_===null?S=D:_.sibling=D,_=D);return e&&b.forEach(function(P){return t(w,P)}),Dt&&ki(w,A),S}function p(w,y,x,N){var S=Wl(x);if(typeof S!="function")throw Error(je(150));if(x=S.call(x),x==null)throw Error(je(151));for(var _=S=null,b=y,A=y=0,D=null,V=x.next();b!==null&&!V.done;A++,V=x.next()){b.index>A?(D=b,b=null):D=b.sibling;var P=h(w,b,V.value,N);if(P===null){b===null&&(b=D);break}e&&b&&P.alternate===null&&t(w,b),y=a(P,y,A),_===null?S=P:_.sibling=P,_=P,b=D}if(V.done)return r(w,b),Dt&&ki(w,A),S;if(b===null){for(;!V.done;A++,V=x.next())V=f(w,V.value,N),V!==null&&(y=a(V,y,A),_===null?S=V:_.sibling=V,_=V);return Dt&&ki(w,A),S}for(b=n(w,b);!V.done;A++,V=x.next())V=m(b,w,A,V.value,N),V!==null&&(e&&V.alternate!==null&&b.delete(V.key===null?A:V.key),y=a(V,y,A),_===null?S=V:_.sibling=V,_=V);return e&&b.forEach(function(T){return t(w,T)}),Dt&&ki(w,A),S}function v(w,y,x,N){if(typeof x=="object"&&x!==null&&x.type===Po&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Qu:e:{for(var S=x.key,_=y;_!==null;){if(_.key===S){if(S=x.type,S===Po){if(_.tag===7){r(w,_.sibling),y=s(_,x.props.children),y.return=w,w=y;break e}}else if(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Pa&&Fv(S)===_.type){r(w,_.sibling),y=s(_,x.props),y.ref=Yl(w,_,x),y.return=w,w=y;break e}r(w,_);break}else t(w,_);_=_.sibling}x.type===Po?(y=Bi(x.props.children,w.mode,N,x.key),y.return=w,w=y):(N=Kd(x.type,x.key,x.props,null,w.mode,N),N.ref=Yl(w,y,x),N.return=w,w=N)}return o(w);case Fo:e:{for(_=x.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(w,y.sibling),y=s(y,x.children||[]),y.return=w,w=y;break e}else{r(w,y);break}else t(w,y);y=y.sibling}y=Lh(x,w.mode,N),y.return=w,w=y}return o(w);case Pa:return _=x._init,v(w,y,_(x._payload),N)}if(oc(x))return g(w,y,x,N);if(Wl(x))return p(w,y,x,N);ud(w,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(w,y.sibling),y=s(y,x),y.return=w,w=y):(r(w,y),y=Rh(x,w.mode,N),y.return=w,w=y),o(w)):r(w,y)}return v}var ul=jN(!0),CN=jN(!1),y0=fi(null),w0=null,$o=null,Fx=null;function Px(){Fx=$o=w0=null}function Dx(e){var t=y0.current;Tt(y0),e._currentValue=t}function Qm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Qo(e,t){w0=e,Fx=$o=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(hn=!0),e.firstContext=null)}function as(e){var t=e._currentValue;if(Fx!==e)if(e={context:e,memoizedValue:t,next:null},$o===null){if(w0===null)throw Error(je(308));$o=e,w0.dependencies={lanes:0,firstContext:e}}else $o=$o.next=e;return t}var Fi=null;function Ix(e){Fi===null?Fi=[e]:Fi.push(e)}function EN(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Ix(t)):(r.next=s.next,s.next=r),t.interleaved=r,pa(e,n)}function pa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Da=!1;function Rx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TN(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function aa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ya(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ct&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,pa(e,r)}return s=n.interleaved,s===null?(t.next=t,Ix(n)):(t.next=s.next,s.next=t),n.interleaved=t,pa(e,r)}function Vd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,wx(e,r)}}function Pv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function b0(e,t,r,n){var s=e.updateQueue;Da=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=s.baseState;o=0,d=u=c=null,l=a;do{var h=l.lane,m=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,p=l;switch(h=t,m=r,p.tag){case 1:if(g=p.payload,typeof g=="function"){f=g.call(m,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,h=typeof g=="function"?g.call(m,f,h):g,h==null)break e;f=Vt({},f,h);break e;case 2:Da=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(1);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Ki|=o,e.lanes=o,e.memoizedState=f}}function Dv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(je(191,s));s.call(n)}}}var Su={},$s=fi(Su),Kc=fi(Su),Yc=fi(Su);function Pi(e){if(e===Su)throw Error(je(174));return e}function Lx(e,t){switch(Nt(Yc,t),Nt(Kc,e),Nt($s,Su),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Dm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Dm(t,e)}Tt($s),Nt($s,t)}function dl(){Tt($s),Tt(Kc),Tt(Yc)}function AN(e){Pi(Yc.current);var t=Pi($s.current),r=Dm(t,e.type);t!==r&&(Nt(Kc,e),Nt($s,r))}function Ox(e){Kc.current===e&&(Tt($s),Tt(Kc))}var Ot=fi(0);function N0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Th=[];function Mx(){for(var e=0;e<Th.length;e++)Th[e]._workInProgressVersionPrimary=null;Th.length=0}var zd=ba.ReactCurrentDispatcher,Ah=ba.ReactCurrentBatchConfig,Xi=0,Ut=null,dr=null,vr=null,k0=!1,wc=!1,qc=0,LT=0;function Lr(){throw Error(je(321))}function Bx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!_s(e[r],t[r]))return!1;return!0}function $x(e,t,r,n,s,a){if(Xi=a,Ut=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zd.current=e===null||e.memoizedState===null?$T:UT,e=r(n,s),wc){a=0;do{if(wc=!1,qc=0,25<=a)throw Error(je(301));a+=1,vr=dr=null,t.updateQueue=null,zd.current=VT,e=r(n,s)}while(wc)}if(zd.current=_0,t=dr!==null&&dr.next!==null,Xi=0,vr=dr=Ut=null,k0=!1,t)throw Error(je(300));return e}function Ux(){var e=qc!==0;return qc=0,e}function Is(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vr===null?Ut.memoizedState=vr=e:vr=vr.next=e,vr}function is(){if(dr===null){var e=Ut.alternate;e=e!==null?e.memoizedState:null}else e=dr.next;var t=vr===null?Ut.memoizedState:vr.next;if(t!==null)vr=t,dr=e;else{if(e===null)throw Error(je(310));dr=e,e={memoizedState:dr.memoizedState,baseState:dr.baseState,baseQueue:dr.baseQueue,queue:dr.queue,next:null},vr===null?Ut.memoizedState=vr=e:vr=vr.next=e}return vr}function Jc(e,t){return typeof t=="function"?t(e):t}function Fh(e){var t=is(),r=t.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=e;var n=dr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((Xi&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ut.lanes|=d,Ki|=d}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,_s(n,t.memoizedState)||(hn=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Ut.lanes|=a,Ki|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ph(e){var t=is(),r=t.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=e(a,o.action),o=o.next;while(o!==s);_s(a,t.memoizedState)||(hn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function FN(){}function PN(e,t){var r=Ut,n=is(),s=t(),a=!_s(n.memoizedState,s);if(a&&(n.memoizedState=s,hn=!0),n=n.queue,Vx(RN.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||vr!==null&&vr.memoizedState.tag&1){if(r.flags|=2048,Zc(9,IN.bind(null,r,n,s,t),void 0,null),_r===null)throw Error(je(349));Xi&30||DN(r,t,s)}return s}function DN(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ut.updateQueue,t===null?(t={lastEffect:null,stores:null},Ut.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function IN(e,t,r,n){t.value=r,t.getSnapshot=n,LN(t)&&ON(e)}function RN(e,t,r){return r(function(){LN(t)&&ON(e)})}function LN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_s(e,r)}catch{return!0}}function ON(e){var t=pa(e,1);t!==null&&ws(t,e,1,-1)}function Iv(e){var t=Is();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jc,lastRenderedState:e},t.queue=e,e=e.dispatch=BT.bind(null,Ut,e),[t.memoizedState,e]}function Zc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ut.updateQueue,t===null?(t={lastEffect:null,stores:null},Ut.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function MN(){return is().memoizedState}function Wd(e,t,r,n){var s=Is();Ut.flags|=e,s.memoizedState=Zc(1|t,r,void 0,n===void 0?null:n)}function wf(e,t,r,n){var s=is();n=n===void 0?null:n;var a=void 0;if(dr!==null){var o=dr.memoizedState;if(a=o.destroy,n!==null&&Bx(n,o.deps)){s.memoizedState=Zc(t,r,a,n);return}}Ut.flags|=e,s.memoizedState=Zc(1|t,r,a,n)}function Rv(e,t){return Wd(8390656,8,e,t)}function Vx(e,t){return wf(2048,8,e,t)}function BN(e,t){return wf(4,2,e,t)}function $N(e,t){return wf(4,4,e,t)}function UN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function VN(e,t,r){return r=r!=null?r.concat([e]):null,wf(4,4,UN.bind(null,t,e),r)}function zx(){}function zN(e,t){var r=is();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Bx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function WN(e,t){var r=is();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Bx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function HN(e,t,r){return Xi&21?(_s(r,t)||(r=qb(),Ut.lanes|=r,Ki|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,hn=!0),e.memoizedState=r)}function OT(e,t){var r=yt;yt=r!==0&&4>r?r:4,e(!0);var n=Ah.transition;Ah.transition={};try{e(!1),t()}finally{yt=r,Ah.transition=n}}function GN(){return is().memoizedState}function MT(e,t,r){var n=Ja(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},XN(e))KN(t,r);else if(r=EN(e,t,r,n),r!==null){var s=nn();ws(r,e,n,s),YN(r,t,n)}}function BT(e,t,r){var n=Ja(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(XN(e))KN(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,_s(l,o)){var c=t.interleaved;c===null?(s.next=s,Ix(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=EN(e,t,s,n),r!==null&&(s=nn(),ws(r,e,n,s),YN(r,t,n))}}function XN(e){var t=e.alternate;return e===Ut||t!==null&&t===Ut}function KN(e,t){wc=k0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function YN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,wx(e,r)}}var _0={readContext:as,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},$T={readContext:as,useCallback:function(e,t){return Is().memoizedState=[e,t===void 0?null:t],e},useContext:as,useEffect:Rv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Wd(4194308,4,UN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Wd(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wd(4,2,e,t)},useMemo:function(e,t){var r=Is();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Is();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=MT.bind(null,Ut,e),[n.memoizedState,e]},useRef:function(e){var t=Is();return e={current:e},t.memoizedState=e},useState:Iv,useDebugValue:zx,useDeferredValue:function(e){return Is().memoizedState=e},useTransition:function(){var e=Iv(!1),t=e[0];return e=OT.bind(null,e[1]),Is().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ut,s=Is();if(Dt){if(r===void 0)throw Error(je(407));r=r()}else{if(r=t(),_r===null)throw Error(je(349));Xi&30||DN(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,Rv(RN.bind(null,n,a,e),[e]),n.flags|=2048,Zc(9,IN.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Is(),t=_r.identifierPrefix;if(Dt){var r=ea,n=Qs;r=(n&~(1<<32-ys(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=qc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=LT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},UT={readContext:as,useCallback:zN,useContext:as,useEffect:Vx,useImperativeHandle:VN,useInsertionEffect:BN,useLayoutEffect:$N,useMemo:WN,useReducer:Fh,useRef:MN,useState:function(){return Fh(Jc)},useDebugValue:zx,useDeferredValue:function(e){var t=is();return HN(t,dr.memoizedState,e)},useTransition:function(){var e=Fh(Jc)[0],t=is().memoizedState;return[e,t]},useMutableSource:FN,useSyncExternalStore:PN,useId:GN,unstable_isNewReconciler:!1},VT={readContext:as,useCallback:zN,useContext:as,useEffect:Vx,useImperativeHandle:VN,useInsertionEffect:BN,useLayoutEffect:$N,useMemo:WN,useReducer:Ph,useRef:MN,useState:function(){return Ph(Jc)},useDebugValue:zx,useDeferredValue:function(e){var t=is();return dr===null?t.memoizedState=e:HN(t,dr.memoizedState,e)},useTransition:function(){var e=Ph(Jc)[0],t=is().memoizedState;return[e,t]},useMutableSource:FN,useSyncExternalStore:PN,useId:GN,unstable_isNewReconciler:!1};function hs(e,t){if(e&&e.defaultProps){t=Vt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ep(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Vt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var bf={isMounted:function(e){return(e=e._reactInternals)?uo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=nn(),s=Ja(e),a=aa(n,s);a.payload=t,r!=null&&(a.callback=r),t=Ya(e,a,s),t!==null&&(ws(t,e,s,n),Vd(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=nn(),s=Ja(e),a=aa(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ya(e,a,s),t!==null&&(ws(t,e,s,n),Vd(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=nn(),n=Ja(e),s=aa(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ya(e,s,n),t!==null&&(ws(t,e,n,r),Vd(t,e,n))}};function Lv(e,t,r,n,s,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!Wc(r,n)||!Wc(s,a):!0}function qN(e,t,r){var n=!1,s=ri,a=t.contextType;return typeof a=="object"&&a!==null?a=as(a):(s=pn(t)?Hi:Kr.current,n=t.contextTypes,a=(n=n!=null)?ll(e,s):ri),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=bf,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ov(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&bf.enqueueReplaceState(t,t.state,null)}function tp(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Rx(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=as(a):(a=pn(t)?Hi:Kr.current,s.context=ll(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(ep(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&bf.enqueueReplaceState(s,s.state,null),b0(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function fl(e,t){try{var r="",n=t;do r+=x3(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Dh(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function rp(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var zT=typeof WeakMap=="function"?WeakMap:Map;function JN(e,t,r){r=aa(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){j0||(j0=!0,fp=n),rp(e,t)},r}function ZN(e,t,r){r=aa(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){rp(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){rp(e,t),typeof n!="function"&&(qa===null?qa=new Set([this]):qa.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Mv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new zT;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=nA.bind(null,e,t,r),t.then(e,e))}function Bv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function $v(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=aa(-1,1),t.tag=2,Ya(r,t,1))),r.lanes|=1),e)}var WT=ba.ReactCurrentOwner,hn=!1;function en(e,t,r,n){t.child=e===null?CN(t,null,r,n):ul(t,e.child,r,n)}function Uv(e,t,r,n,s){r=r.render;var a=t.ref;return Qo(t,s),n=$x(e,t,r,n,a,s),r=Ux(),e!==null&&!hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,xa(e,t,s)):(Dt&&r&&Ex(t),t.flags|=1,en(e,t,n,s),t.child)}function Vv(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Jx(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,QN(e,t,a,n,s)):(e=Kd(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:Wc,r(o,n)&&e.ref===t.ref)return xa(e,t,s)}return t.flags|=1,e=Za(a,n),e.ref=t.ref,e.return=t,t.child=e}function QN(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Wc(a,n)&&e.ref===t.ref)if(hn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(hn=!0);else return t.lanes=e.lanes,xa(e,t,s)}return np(e,t,r,n,s)}function ek(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(Vo,jn),jn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Nt(Vo,jn),jn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Nt(Vo,jn),jn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Nt(Vo,jn),jn|=n;return en(e,t,s,r),t.child}function tk(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function np(e,t,r,n,s){var a=pn(r)?Hi:Kr.current;return a=ll(t,a),Qo(t,s),r=$x(e,t,r,n,a,s),n=Ux(),e!==null&&!hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,xa(e,t,s)):(Dt&&n&&Ex(t),t.flags|=1,en(e,t,r,s),t.child)}function zv(e,t,r,n,s){if(pn(r)){var a=!0;x0(t)}else a=!1;if(Qo(t,s),t.stateNode===null)Hd(e,t),qN(t,r,n),tp(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=as(u):(u=pn(r)?Hi:Kr.current,u=ll(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&Ov(t,o,n,u),Da=!1;var h=t.memoizedState;o.state=h,b0(t,n,o,s),c=t.memoizedState,l!==n||h!==c||mn.current||Da?(typeof d=="function"&&(ep(t,r,d,n),c=t.memoizedState),(l=Da||Lv(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,TN(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:hs(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=as(c):(c=pn(r)?Hi:Kr.current,c=ll(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&Ov(t,o,n,c),Da=!1,h=t.memoizedState,o.state=h,b0(t,n,o,s);var g=t.memoizedState;l!==f||h!==g||mn.current||Da?(typeof m=="function"&&(ep(t,r,m,n),g=t.memoizedState),(u=Da||Lv(t,r,u,n,h,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return sp(e,t,r,n,a,s)}function sp(e,t,r,n,s,a){tk(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&Ev(t,r,!1),xa(e,t,a);n=t.stateNode,WT.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ul(t,e.child,null,a),t.child=ul(t,null,l,a)):en(e,t,l,a),t.memoizedState=n.state,s&&Ev(t,r,!0),t.child}function rk(e){var t=e.stateNode;t.pendingContext?Cv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Cv(e,t.context,!1),Lx(e,t.containerInfo)}function Wv(e,t,r,n,s){return cl(),Ax(s),t.flags|=256,en(e,t,r,n),t.child}var ap={dehydrated:null,treeContext:null,retryLane:0};function ip(e){return{baseLanes:e,cachePool:null,transitions:null}}function nk(e,t,r){var n=t.pendingProps,s=Ot.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Nt(Ot,s&1),e===null)return Zm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=_f(o,n,0,null),e=Bi(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ip(r),t.memoizedState=ap,e):Wx(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return HT(e,t,o,n,l,s,r);if(a){a=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Za(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=Za(l,a):(a=Bi(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?ip(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=ap,n}return a=e.child,e=a.sibling,n=Za(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Wx(e,t){return t=_f({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function dd(e,t,r,n){return n!==null&&Ax(n),ul(t,e.child,null,r),e=Wx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function HT(e,t,r,n,s,a,o){if(r)return t.flags&256?(t.flags&=-257,n=Dh(Error(je(422))),dd(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=_f({mode:"visible",children:n.children},s,0,null),a=Bi(a,s,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&ul(t,e.child,null,o),t.child.memoizedState=ip(o),t.memoizedState=ap,a);if(!(t.mode&1))return dd(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(je(419)),n=Dh(a,n,void 0),dd(e,t,o,n)}if(l=(o&e.childLanes)!==0,hn||l){if(n=_r,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,pa(e,s),ws(n,e,s,-1))}return qx(),n=Dh(Error(je(421))),dd(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=sA.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,Pn=Ka(s.nextSibling),Dn=t,Dt=!0,xs=null,e!==null&&(qn[Jn++]=Qs,qn[Jn++]=ea,qn[Jn++]=Gi,Qs=e.id,ea=e.overflow,Gi=t),t=Wx(t,n.children),t.flags|=4096,t)}function Hv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Qm(e.return,t,r)}function Ih(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function sk(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(en(e,t,n.children,r),n=Ot.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Hv(e,r,t);else if(e.tag===19)Hv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Nt(Ot,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&N0(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Ih(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&N0(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Ih(t,!0,r,null,a);break;case"together":Ih(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function xa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ki|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(je(153));if(t.child!==null){for(e=t.child,r=Za(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Za(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function GT(e,t,r){switch(t.tag){case 3:rk(t),cl();break;case 5:AN(t);break;case 1:pn(t.type)&&x0(t);break;case 4:Lx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Nt(y0,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Nt(Ot,Ot.current&1),t.flags|=128,null):r&t.child.childLanes?nk(e,t,r):(Nt(Ot,Ot.current&1),e=xa(e,t,r),e!==null?e.sibling:null);Nt(Ot,Ot.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return sk(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Nt(Ot,Ot.current),n)break;return null;case 22:case 23:return t.lanes=0,ek(e,t,r)}return xa(e,t,r)}var ak,op,ik,ok;ak=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};op=function(){};ik=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Pi($s.current);var a=null;switch(r){case"input":s=Tm(e,s),n=Tm(e,n),a=[];break;case"select":s=Vt({},s,{value:void 0}),n=Vt({},n,{value:void 0}),a=[];break;case"textarea":s=Pm(e,s),n=Pm(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=m0)}Im(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Oc.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Oc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ct("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};ok=function(e,t,r,n){r!==n&&(t.flags|=4)};function ql(e,t){if(!Dt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Or(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function XT(e,t,r){var n=t.pendingProps;switch(Tx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(t),null;case 1:return pn(t.type)&&p0(),Or(t),null;case 3:return n=t.stateNode,dl(),Tt(mn),Tt(Kr),Mx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(cd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xs!==null&&(pp(xs),xs=null))),op(e,t),Or(t),null;case 5:Ox(t);var s=Pi(Yc.current);if(r=t.type,e!==null&&t.stateNode!=null)ik(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(je(166));return Or(t),null}if(e=Pi($s.current),cd(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Ls]=t,n[Xc]=a,e=(t.mode&1)!==0,r){case"dialog":Ct("cancel",n),Ct("close",n);break;case"iframe":case"object":case"embed":Ct("load",n);break;case"video":case"audio":for(s=0;s<cc.length;s++)Ct(cc[s],n);break;case"source":Ct("error",n);break;case"img":case"image":case"link":Ct("error",n),Ct("load",n);break;case"details":Ct("toggle",n);break;case"input":ev(n,a),Ct("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Ct("invalid",n);break;case"textarea":rv(n,a),Ct("invalid",n)}Im(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&ld(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&ld(n.textContent,l,e),s=["children",""+l]):Oc.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ct("scroll",n)}switch(r){case"input":ed(n),tv(n,a,!0);break;case"textarea":ed(n),nv(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=m0)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Rb(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Ls]=t,e[Xc]=n,ak(e,t,!1,!1),t.stateNode=e;e:{switch(o=Rm(r,n),r){case"dialog":Ct("cancel",e),Ct("close",e),s=n;break;case"iframe":case"object":case"embed":Ct("load",e),s=n;break;case"video":case"audio":for(s=0;s<cc.length;s++)Ct(cc[s],e);s=n;break;case"source":Ct("error",e),s=n;break;case"img":case"image":case"link":Ct("error",e),Ct("load",e),s=n;break;case"details":Ct("toggle",e),s=n;break;case"input":ev(e,n),s=Tm(e,n),Ct("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Vt({},n,{value:void 0}),Ct("invalid",e);break;case"textarea":rv(e,n),s=Pm(e,n),Ct("invalid",e);break;default:s=n}Im(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?Mb(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Lb(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Mc(e,c):typeof c=="number"&&Mc(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Oc.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Ct("scroll",e):c!=null&&mx(e,a,c,o))}switch(r){case"input":ed(e),tv(e,n,!1);break;case"textarea":ed(e),nv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ti(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Yo(e,!!n.multiple,a,!1):n.defaultValue!=null&&Yo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=m0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Or(t),null;case 6:if(e&&t.stateNode!=null)ok(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(je(166));if(r=Pi(Yc.current),Pi($s.current),cd(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ls]=t,(a=n.nodeValue!==r)&&(e=Dn,e!==null))switch(e.tag){case 3:ld(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ld(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ls]=t,t.stateNode=n}return Or(t),null;case 13:if(Tt(Ot),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Dt&&Pn!==null&&t.mode&1&&!(t.flags&128))SN(),cl(),t.flags|=98560,a=!1;else if(a=cd(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(je(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(je(317));a[Ls]=t}else cl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Or(t),a=!1}else xs!==null&&(pp(xs),xs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ot.current&1?hr===0&&(hr=3):qx())),t.updateQueue!==null&&(t.flags|=4),Or(t),null);case 4:return dl(),op(e,t),e===null&&Hc(t.stateNode.containerInfo),Or(t),null;case 10:return Dx(t.type._context),Or(t),null;case 17:return pn(t.type)&&p0(),Or(t),null;case 19:if(Tt(Ot),a=t.memoizedState,a===null)return Or(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)ql(a,!1);else{if(hr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=N0(e),o!==null){for(t.flags|=128,ql(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Nt(Ot,Ot.current&1|2),t.child}e=e.sibling}a.tail!==null&&Qt()>hl&&(t.flags|=128,n=!0,ql(a,!1),t.lanes=4194304)}else{if(!n)if(e=N0(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ql(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Dt)return Or(t),null}else 2*Qt()-a.renderingStartTime>hl&&r!==1073741824&&(t.flags|=128,n=!0,ql(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qt(),t.sibling=null,r=Ot.current,Nt(Ot,n?r&1|2:r&1),t):(Or(t),null);case 22:case 23:return Yx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?jn&1073741824&&(Or(t),t.subtreeFlags&6&&(t.flags|=8192)):Or(t),null;case 24:return null;case 25:return null}throw Error(je(156,t.tag))}function KT(e,t){switch(Tx(t),t.tag){case 1:return pn(t.type)&&p0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return dl(),Tt(mn),Tt(Kr),Mx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ox(t),null;case 13:if(Tt(Ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(je(340));cl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Tt(Ot),null;case 4:return dl(),null;case 10:return Dx(t.type._context),null;case 22:case 23:return Yx(),null;case 24:return null;default:return null}}var fd=!1,zr=!1,YT=typeof WeakSet=="function"?WeakSet:Set,Me=null;function Uo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ht(e,t,n)}else r.current=null}function lp(e,t,r){try{r()}catch(n){Ht(e,t,n)}}var Gv=!1;function qT(e,t){if(Hm=d0,e=fN(),Cx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==a||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===s&&(l=o),h===a&&++d===n&&(c=o),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Gm={focusedElem:e,selectionRange:r},d0=!1,Me=t;Me!==null;)if(t=Me,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Me=e;else for(;Me!==null;){t=Me;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,v=g.memoizedState,w=t.stateNode,y=w.getSnapshotBeforeUpdate(t.elementType===t.type?p:hs(t.type,p),v);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(N){Ht(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Me=e;break}Me=t.return}return g=Gv,Gv=!1,g}function bc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&lp(t,r,a)}s=s.next}while(s!==n)}}function Nf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function cp(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function lk(e){var t=e.alternate;t!==null&&(e.alternate=null,lk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ls],delete t[Xc],delete t[Ym],delete t[PT],delete t[DT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ck(e){return e.tag===5||e.tag===3||e.tag===4}function Xv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ck(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function up(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=m0));else if(n!==4&&(e=e.child,e!==null))for(up(e,t,r),e=e.sibling;e!==null;)up(e,t,r),e=e.sibling}function dp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(dp(e,t,r),e=e.sibling;e!==null;)dp(e,t,r),e=e.sibling}var Er=null,ps=!1;function Ca(e,t,r){for(r=r.child;r!==null;)uk(e,t,r),r=r.sibling}function uk(e,t,r){if(Bs&&typeof Bs.onCommitFiberUnmount=="function")try{Bs.onCommitFiberUnmount(mf,r)}catch{}switch(r.tag){case 5:zr||Uo(r,t);case 6:var n=Er,s=ps;Er=null,Ca(e,t,r),Er=n,ps=s,Er!==null&&(ps?(e=Er,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Er.removeChild(r.stateNode));break;case 18:Er!==null&&(ps?(e=Er,r=r.stateNode,e.nodeType===8?Ch(e.parentNode,r):e.nodeType===1&&Ch(e,r),Vc(e)):Ch(Er,r.stateNode));break;case 4:n=Er,s=ps,Er=r.stateNode.containerInfo,ps=!0,Ca(e,t,r),Er=n,ps=s;break;case 0:case 11:case 14:case 15:if(!zr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&lp(r,t,o),s=s.next}while(s!==n)}Ca(e,t,r);break;case 1:if(!zr&&(Uo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ht(r,t,l)}Ca(e,t,r);break;case 21:Ca(e,t,r);break;case 22:r.mode&1?(zr=(n=zr)||r.memoizedState!==null,Ca(e,t,r),zr=n):Ca(e,t,r);break;default:Ca(e,t,r)}}function Kv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new YT),t.forEach(function(n){var s=aA.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function us(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Er=l.stateNode,ps=!1;break e;case 3:Er=l.stateNode.containerInfo,ps=!0;break e;case 4:Er=l.stateNode.containerInfo,ps=!0;break e}l=l.return}if(Er===null)throw Error(je(160));uk(a,o,s),Er=null,ps=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Ht(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)dk(t,e),t=t.sibling}function dk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(us(t,e),Ts(e),n&4){try{bc(3,e,e.return),Nf(3,e)}catch(p){Ht(e,e.return,p)}try{bc(5,e,e.return)}catch(p){Ht(e,e.return,p)}}break;case 1:us(t,e),Ts(e),n&512&&r!==null&&Uo(r,r.return);break;case 5:if(us(t,e),Ts(e),n&512&&r!==null&&Uo(r,r.return),e.flags&32){var s=e.stateNode;try{Mc(s,"")}catch(p){Ht(e,e.return,p)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Db(s,a),Rm(l,o);var u=Rm(l,a);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?Mb(s,f):d==="dangerouslySetInnerHTML"?Lb(s,f):d==="children"?Mc(s,f):mx(s,d,f,u)}switch(l){case"input":Am(s,a);break;case"textarea":Ib(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Yo(s,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?Yo(s,!!a.multiple,a.defaultValue,!0):Yo(s,!!a.multiple,a.multiple?[]:"",!1))}s[Xc]=a}catch(p){Ht(e,e.return,p)}}break;case 6:if(us(t,e),Ts(e),n&4){if(e.stateNode===null)throw Error(je(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(p){Ht(e,e.return,p)}}break;case 3:if(us(t,e),Ts(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vc(t.containerInfo)}catch(p){Ht(e,e.return,p)}break;case 4:us(t,e),Ts(e);break;case 13:us(t,e),Ts(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Xx=Qt())),n&4&&Kv(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(zr=(u=zr)||d,us(t,e),zr=u):us(t,e),Ts(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Me=e,d=e.child;d!==null;){for(f=Me=d;Me!==null;){switch(h=Me,m=h.child,h.tag){case 0:case 11:case 14:case 15:bc(4,h,h.return);break;case 1:Uo(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(p){Ht(n,r,p)}}break;case 5:Uo(h,h.return);break;case 22:if(h.memoizedState!==null){qv(f);continue}}m!==null?(m.return=h,Me=m):qv(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Ob("display",o))}catch(p){Ht(e,e.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Ht(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:us(t,e),Ts(e),n&4&&Kv(e);break;case 21:break;default:us(t,e),Ts(e)}}function Ts(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ck(r)){var n=r;break e}r=r.return}throw Error(je(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Mc(s,""),n.flags&=-33);var a=Xv(e);dp(e,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Xv(e);up(e,l,o);break;default:throw Error(je(161))}}catch(c){Ht(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function JT(e,t,r){Me=e,fk(e)}function fk(e,t,r){for(var n=(e.mode&1)!==0;Me!==null;){var s=Me,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||fd;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||zr;l=fd;var u=zr;if(fd=o,(zr=c)&&!u)for(Me=s;Me!==null;)o=Me,c=o.child,o.tag===22&&o.memoizedState!==null?Jv(s):c!==null?(c.return=o,Me=c):Jv(s);for(;a!==null;)Me=a,fk(a),a=a.sibling;Me=s,fd=l,zr=u}Yv(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Me=a):Yv(e)}}function Yv(e){for(;Me!==null;){var t=Me;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:zr||Nf(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!zr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:hs(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Dv(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Dv(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Vc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}zr||t.flags&512&&cp(t)}catch(h){Ht(t,t.return,h)}}if(t===e){Me=null;break}if(r=t.sibling,r!==null){r.return=t.return,Me=r;break}Me=t.return}}function qv(e){for(;Me!==null;){var t=Me;if(t===e){Me=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Me=r;break}Me=t.return}}function Jv(e){for(;Me!==null;){var t=Me;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Nf(4,t)}catch(c){Ht(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Ht(t,s,c)}}var a=t.return;try{cp(t)}catch(c){Ht(t,a,c)}break;case 5:var o=t.return;try{cp(t)}catch(c){Ht(t,o,c)}}}catch(c){Ht(t,t.return,c)}if(t===e){Me=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Me=l;break}Me=t.return}}var ZT=Math.ceil,S0=ba.ReactCurrentDispatcher,Hx=ba.ReactCurrentOwner,ns=ba.ReactCurrentBatchConfig,ct=0,_r=null,cr=null,Fr=0,jn=0,Vo=fi(0),hr=0,Qc=null,Ki=0,kf=0,Gx=0,Nc=null,fn=null,Xx=0,hl=1/0,Js=null,j0=!1,fp=null,qa=null,hd=!1,$a=null,C0=0,kc=0,hp=null,Gd=-1,Xd=0;function nn(){return ct&6?Qt():Gd!==-1?Gd:Gd=Qt()}function Ja(e){return e.mode&1?ct&2&&Fr!==0?Fr&-Fr:RT.transition!==null?(Xd===0&&(Xd=qb()),Xd):(e=yt,e!==0||(e=window.event,e=e===void 0?16:nN(e.type)),e):1}function ws(e,t,r,n){if(50<kc)throw kc=0,hp=null,Error(je(185));Nu(e,r,n),(!(ct&2)||e!==_r)&&(e===_r&&(!(ct&2)&&(kf|=r),hr===4&&Oa(e,Fr)),xn(e,n),r===1&&ct===0&&!(t.mode&1)&&(hl=Qt()+500,yf&&hi()))}function xn(e,t){var r=e.callbackNode;R3(e,t);var n=u0(e,e===_r?Fr:0);if(n===0)r!==null&&iv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&iv(r),t===1)e.tag===0?IT(Zv.bind(null,e)):NN(Zv.bind(null,e)),AT(function(){!(ct&6)&&hi()}),r=null;else{switch(Jb(n)){case 1:r=yx;break;case 4:r=Kb;break;case 16:r=c0;break;case 536870912:r=Yb;break;default:r=c0}r=wk(r,hk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function hk(e,t){if(Gd=-1,Xd=0,ct&6)throw Error(je(327));var r=e.callbackNode;if(el()&&e.callbackNode!==r)return null;var n=u0(e,e===_r?Fr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=E0(e,n);else{t=n;var s=ct;ct|=2;var a=pk();(_r!==e||Fr!==t)&&(Js=null,hl=Qt()+500,Mi(e,t));do try{tA();break}catch(l){mk(e,l)}while(1);Px(),S0.current=a,ct=s,cr!==null?t=0:(_r=null,Fr=0,t=hr)}if(t!==0){if(t===2&&(s=$m(e),s!==0&&(n=s,t=mp(e,s))),t===1)throw r=Qc,Mi(e,0),Oa(e,n),xn(e,Qt()),r;if(t===6)Oa(e,n);else{if(s=e.current.alternate,!(n&30)&&!QT(s)&&(t=E0(e,n),t===2&&(a=$m(e),a!==0&&(n=a,t=mp(e,a))),t===1))throw r=Qc,Mi(e,0),Oa(e,n),xn(e,Qt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(je(345));case 2:_i(e,fn,Js);break;case 3:if(Oa(e,n),(n&130023424)===n&&(t=Xx+500-Qt(),10<t)){if(u0(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){nn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Km(_i.bind(null,e,fn,Js),t);break}_i(e,fn,Js);break;case 4:if(Oa(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-ys(n);a=1<<o,o=t[o],o>s&&(s=o),n&=~a}if(n=s,n=Qt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ZT(n/1960))-n,10<n){e.timeoutHandle=Km(_i.bind(null,e,fn,Js),n);break}_i(e,fn,Js);break;case 5:_i(e,fn,Js);break;default:throw Error(je(329))}}}return xn(e,Qt()),e.callbackNode===r?hk.bind(null,e):null}function mp(e,t){var r=Nc;return e.current.memoizedState.isDehydrated&&(Mi(e,t).flags|=256),e=E0(e,t),e!==2&&(t=fn,fn=r,t!==null&&pp(t)),e}function pp(e){fn===null?fn=e:fn.push.apply(fn,e)}function QT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!_s(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Oa(e,t){for(t&=~Gx,t&=~kf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ys(t),n=1<<r;e[r]=-1,t&=~n}}function Zv(e){if(ct&6)throw Error(je(327));el();var t=u0(e,0);if(!(t&1))return xn(e,Qt()),null;var r=E0(e,t);if(e.tag!==0&&r===2){var n=$m(e);n!==0&&(t=n,r=mp(e,n))}if(r===1)throw r=Qc,Mi(e,0),Oa(e,t),xn(e,Qt()),r;if(r===6)throw Error(je(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_i(e,fn,Js),xn(e,Qt()),null}function Kx(e,t){var r=ct;ct|=1;try{return e(t)}finally{ct=r,ct===0&&(hl=Qt()+500,yf&&hi())}}function Yi(e){$a!==null&&$a.tag===0&&!(ct&6)&&el();var t=ct;ct|=1;var r=ns.transition,n=yt;try{if(ns.transition=null,yt=1,e)return e()}finally{yt=n,ns.transition=r,ct=t,!(ct&6)&&hi()}}function Yx(){jn=Vo.current,Tt(Vo)}function Mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,TT(r)),cr!==null)for(r=cr.return;r!==null;){var n=r;switch(Tx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&p0();break;case 3:dl(),Tt(mn),Tt(Kr),Mx();break;case 5:Ox(n);break;case 4:dl();break;case 13:Tt(Ot);break;case 19:Tt(Ot);break;case 10:Dx(n.type._context);break;case 22:case 23:Yx()}r=r.return}if(_r=e,cr=e=Za(e.current,null),Fr=jn=t,hr=0,Qc=null,Gx=kf=Ki=0,fn=Nc=null,Fi!==null){for(t=0;t<Fi.length;t++)if(r=Fi[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}Fi=null}return e}function mk(e,t){do{var r=cr;try{if(Px(),zd.current=_0,k0){for(var n=Ut.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}k0=!1}if(Xi=0,vr=dr=Ut=null,wc=!1,qc=0,Hx.current=null,r===null||r.return===null){hr=1,Qc=t,cr=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=Fr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=Bv(o);if(m!==null){m.flags&=-257,$v(m,o,l,a,t),m.mode&1&&Mv(a,u,t),t=m,c=u;var g=t.updateQueue;if(g===null){var p=new Set;p.add(c),t.updateQueue=p}else g.add(c);break e}else{if(!(t&1)){Mv(a,u,t),qx();break e}c=Error(je(426))}}else if(Dt&&l.mode&1){var v=Bv(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),$v(v,o,l,a,t),Ax(fl(c,l));break e}}a=c=fl(c,l),hr!==4&&(hr=2),Nc===null?Nc=[a]:Nc.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var w=JN(a,c,t);Pv(a,w);break e;case 1:l=c;var y=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(qa===null||!qa.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=ZN(a,l,t);Pv(a,N);break e}}a=a.return}while(a!==null)}gk(r)}catch(S){t=S,cr===r&&r!==null&&(cr=r=r.return);continue}break}while(1)}function pk(){var e=S0.current;return S0.current=_0,e===null?_0:e}function qx(){(hr===0||hr===3||hr===2)&&(hr=4),_r===null||!(Ki&268435455)&&!(kf&268435455)||Oa(_r,Fr)}function E0(e,t){var r=ct;ct|=2;var n=pk();(_r!==e||Fr!==t)&&(Js=null,Mi(e,t));do try{eA();break}catch(s){mk(e,s)}while(1);if(Px(),ct=r,S0.current=n,cr!==null)throw Error(je(261));return _r=null,Fr=0,hr}function eA(){for(;cr!==null;)xk(cr)}function tA(){for(;cr!==null&&!j3();)xk(cr)}function xk(e){var t=yk(e.alternate,e,jn);e.memoizedProps=e.pendingProps,t===null?gk(e):cr=t,Hx.current=null}function gk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=KT(r,t),r!==null){r.flags&=32767,cr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{hr=6,cr=null;return}}else if(r=XT(r,t,jn),r!==null){cr=r;return}if(t=t.sibling,t!==null){cr=t;return}cr=t=e}while(t!==null);hr===0&&(hr=5)}function _i(e,t,r){var n=yt,s=ns.transition;try{ns.transition=null,yt=1,rA(e,t,r,n)}finally{ns.transition=s,yt=n}return null}function rA(e,t,r,n){do el();while($a!==null);if(ct&6)throw Error(je(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(je(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(L3(e,a),e===_r&&(cr=_r=null,Fr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||hd||(hd=!0,wk(c0,function(){return el(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=ns.transition,ns.transition=null;var o=yt;yt=1;var l=ct;ct|=4,Hx.current=null,qT(e,r),dk(r,e),NT(Gm),d0=!!Hm,Gm=Hm=null,e.current=r,JT(r),C3(),ct=l,yt=o,ns.transition=a}else e.current=r;if(hd&&(hd=!1,$a=e,C0=s),a=e.pendingLanes,a===0&&(qa=null),A3(r.stateNode),xn(e,Qt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(j0)throw j0=!1,e=fp,fp=null,e;return C0&1&&e.tag!==0&&el(),a=e.pendingLanes,a&1?e===hp?kc++:(kc=0,hp=e):kc=0,hi(),null}function el(){if($a!==null){var e=Jb(C0),t=ns.transition,r=yt;try{if(ns.transition=null,yt=16>e?16:e,$a===null)var n=!1;else{if(e=$a,$a=null,C0=0,ct&6)throw Error(je(331));var s=ct;for(ct|=4,Me=e.current;Me!==null;){var a=Me,o=a.child;if(Me.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Me=u;Me!==null;){var d=Me;switch(d.tag){case 0:case 11:case 15:bc(8,d,a)}var f=d.child;if(f!==null)f.return=d,Me=f;else for(;Me!==null;){d=Me;var h=d.sibling,m=d.return;if(lk(d),d===u){Me=null;break}if(h!==null){h.return=m,Me=h;break}Me=m}}}var g=a.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}Me=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Me=o;else e:for(;Me!==null;){if(a=Me,a.flags&2048)switch(a.tag){case 0:case 11:case 15:bc(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,Me=w;break e}Me=a.return}}var y=e.current;for(Me=y;Me!==null;){o=Me;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,Me=x;else e:for(o=y;Me!==null;){if(l=Me,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Nf(9,l)}}catch(S){Ht(l,l.return,S)}if(l===o){Me=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,Me=N;break e}Me=l.return}}if(ct=s,hi(),Bs&&typeof Bs.onPostCommitFiberRoot=="function")try{Bs.onPostCommitFiberRoot(mf,e)}catch{}n=!0}return n}finally{yt=r,ns.transition=t}}return!1}function Qv(e,t,r){t=fl(r,t),t=JN(e,t,1),e=Ya(e,t,1),t=nn(),e!==null&&(Nu(e,1,t),xn(e,t))}function Ht(e,t,r){if(e.tag===3)Qv(e,e,r);else for(;t!==null;){if(t.tag===3){Qv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qa===null||!qa.has(n))){e=fl(r,e),e=ZN(t,e,1),t=Ya(t,e,1),e=nn(),t!==null&&(Nu(t,1,e),xn(t,e));break}}t=t.return}}function nA(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=nn(),e.pingedLanes|=e.suspendedLanes&r,_r===e&&(Fr&r)===r&&(hr===4||hr===3&&(Fr&130023424)===Fr&&500>Qt()-Xx?Mi(e,0):Gx|=r),xn(e,t)}function vk(e,t){t===0&&(e.mode&1?(t=nd,nd<<=1,!(nd&130023424)&&(nd=4194304)):t=1);var r=nn();e=pa(e,t),e!==null&&(Nu(e,t,r),xn(e,r))}function sA(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),vk(e,r)}function aA(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(je(314))}n!==null&&n.delete(t),vk(e,r)}var yk;yk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||mn.current)hn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return hn=!1,GT(e,t,r);hn=!!(e.flags&131072)}else hn=!1,Dt&&t.flags&1048576&&kN(t,v0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Hd(e,t),e=t.pendingProps;var s=ll(t,Kr.current);Qo(t,r),s=$x(null,t,n,e,s,r);var a=Ux();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pn(n)?(a=!0,x0(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Rx(t),s.updater=bf,t.stateNode=s,s._reactInternals=t,tp(t,n,e,r),t=sp(null,t,n,!0,a,r)):(t.tag=0,Dt&&a&&Ex(t),en(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Hd(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=oA(n),e=hs(n,e),s){case 0:t=np(null,t,n,e,r);break e;case 1:t=zv(null,t,n,e,r);break e;case 11:t=Uv(null,t,n,e,r);break e;case 14:t=Vv(null,t,n,hs(n.type,e),r);break e}throw Error(je(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:hs(n,s),np(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:hs(n,s),zv(e,t,n,s,r);case 3:e:{if(rk(t),e===null)throw Error(je(387));n=t.pendingProps,a=t.memoizedState,s=a.element,TN(e,t),b0(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=fl(Error(je(423)),t),t=Wv(e,t,n,r,s);break e}else if(n!==s){s=fl(Error(je(424)),t),t=Wv(e,t,n,r,s);break e}else for(Pn=Ka(t.stateNode.containerInfo.firstChild),Dn=t,Dt=!0,xs=null,r=CN(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(cl(),n===s){t=xa(e,t,r);break e}en(e,t,n,r)}t=t.child}return t;case 5:return AN(t),e===null&&Zm(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,o=s.children,Xm(n,s)?o=null:a!==null&&Xm(n,a)&&(t.flags|=32),tk(e,t),en(e,t,o,r),t.child;case 6:return e===null&&Zm(t),null;case 13:return nk(e,t,r);case 4:return Lx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ul(t,null,n,r):en(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:hs(n,s),Uv(e,t,n,s,r);case 7:return en(e,t,t.pendingProps,r),t.child;case 8:return en(e,t,t.pendingProps.children,r),t.child;case 12:return en(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,Nt(y0,n._currentValue),n._currentValue=o,a!==null)if(_s(a.value,o)){if(a.children===s.children&&!mn.current){t=xa(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=aa(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Qm(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(je(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Qm(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}en(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Qo(t,r),s=as(s),n=n(s),t.flags|=1,en(e,t,n,r),t.child;case 14:return n=t.type,s=hs(n,t.pendingProps),s=hs(n.type,s),Vv(e,t,n,s,r);case 15:return QN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:hs(n,s),Hd(e,t),t.tag=1,pn(n)?(e=!0,x0(t)):e=!1,Qo(t,r),qN(t,n,s),tp(t,n,s,r),sp(null,t,n,!0,e,r);case 19:return sk(e,t,r);case 22:return ek(e,t,r)}throw Error(je(156,t.tag))};function wk(e,t){return Xb(e,t)}function iA(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function es(e,t,r,n){return new iA(e,t,r,n)}function Jx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function oA(e){if(typeof e=="function")return Jx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xx)return 11;if(e===gx)return 14}return 2}function Za(e,t){var r=e.alternate;return r===null?(r=es(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Kd(e,t,r,n,s,a){var o=2;if(n=e,typeof e=="function")Jx(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Po:return Bi(r.children,s,a,t);case px:o=8,s|=8;break;case Sm:return e=es(12,r,t,s|2),e.elementType=Sm,e.lanes=a,e;case jm:return e=es(13,r,t,s),e.elementType=jm,e.lanes=a,e;case Cm:return e=es(19,r,t,s),e.elementType=Cm,e.lanes=a,e;case Ab:return _f(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Eb:o=10;break e;case Tb:o=9;break e;case xx:o=11;break e;case gx:o=14;break e;case Pa:o=16,n=null;break e}throw Error(je(130,e==null?e:typeof e,""))}return t=es(o,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Bi(e,t,r,n){return e=es(7,e,n,t),e.lanes=r,e}function _f(e,t,r,n){return e=es(22,e,n,t),e.elementType=Ab,e.lanes=r,e.stateNode={isHidden:!1},e}function Rh(e,t,r){return e=es(6,e,null,t),e.lanes=r,e}function Lh(e,t,r){return t=es(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function lA(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xh(0),this.expirationTimes=xh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xh(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Zx(e,t,r,n,s,a,o,l,c){return e=new lA(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=es(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rx(a),e}function cA(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function bk(e){if(!e)return ri;e=e._reactInternals;e:{if(uo(e)!==e||e.tag!==1)throw Error(je(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(je(171))}if(e.tag===1){var r=e.type;if(pn(r))return bN(e,r,t)}return t}function Nk(e,t,r,n,s,a,o,l,c){return e=Zx(r,n,!0,e,s,a,o,l,c),e.context=bk(null),r=e.current,n=nn(),s=Ja(r),a=aa(n,s),a.callback=t??null,Ya(r,a,s),e.current.lanes=s,Nu(e,s,n),xn(e,n),e}function Sf(e,t,r,n){var s=t.current,a=nn(),o=Ja(s);return r=bk(r),t.context===null?t.context=r:t.pendingContext=r,t=aa(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ya(s,t,o),e!==null&&(ws(e,s,o,a),Vd(e,s,o)),o}function T0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ey(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Qx(e,t){ey(e,t),(e=e.alternate)&&ey(e,t)}function uA(){return null}var kk=typeof reportError=="function"?reportError:function(e){console.error(e)};function eg(e){this._internalRoot=e}jf.prototype.render=eg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(je(409));Sf(e,t,null,null)};jf.prototype.unmount=eg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Yi(function(){Sf(null,e,null,null)}),t[ma]=null}};function jf(e){this._internalRoot=e}jf.prototype.unstable_scheduleHydration=function(e){if(e){var t=eN();e={blockedOn:null,target:e,priority:t};for(var r=0;r<La.length&&t!==0&&t<La[r].priority;r++);La.splice(r,0,e),r===0&&rN(e)}};function tg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Cf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ty(){}function dA(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=T0(o);a.call(u)}}var o=Nk(t,n,e,0,null,!1,!1,"",ty);return e._reactRootContainer=o,e[ma]=o.current,Hc(e.nodeType===8?e.parentNode:e),Yi(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=T0(c);l.call(u)}}var c=Zx(e,0,!1,null,null,!1,!1,"",ty);return e._reactRootContainer=c,e[ma]=c.current,Hc(e.nodeType===8?e.parentNode:e),Yi(function(){Sf(t,c,r,n)}),c}function Ef(e,t,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=T0(o);l.call(c)}}Sf(t,o,e,s)}else o=dA(r,t,e,s,n);return T0(o)}Zb=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=lc(t.pendingLanes);r!==0&&(wx(t,r|1),xn(t,Qt()),!(ct&6)&&(hl=Qt()+500,hi()))}break;case 13:Yi(function(){var n=pa(e,1);if(n!==null){var s=nn();ws(n,e,1,s)}}),Qx(e,1)}};bx=function(e){if(e.tag===13){var t=pa(e,134217728);if(t!==null){var r=nn();ws(t,e,134217728,r)}Qx(e,134217728)}};Qb=function(e){if(e.tag===13){var t=Ja(e),r=pa(e,t);if(r!==null){var n=nn();ws(r,e,t,n)}Qx(e,t)}};eN=function(){return yt};tN=function(e,t){var r=yt;try{return yt=e,t()}finally{yt=r}};Om=function(e,t,r){switch(t){case"input":if(Am(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=vf(n);if(!s)throw Error(je(90));Pb(n),Am(n,s)}}}break;case"textarea":Ib(e,r);break;case"select":t=r.value,t!=null&&Yo(e,!!r.multiple,t,!1)}};Ub=Kx;Vb=Yi;var fA={usingClientEntryPoint:!1,Events:[_u,Lo,vf,Bb,$b,Kx]},Jl={findFiberByHostInstance:Ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hA={bundleType:Jl.bundleType,version:Jl.version,rendererPackageName:Jl.rendererPackageName,rendererConfig:Jl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ba.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Hb(e),e===null?null:e.stateNode},findFiberByHostInstance:Jl.findFiberByHostInstance||uA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!md.isDisabled&&md.supportsFiber)try{mf=md.inject(hA),Bs=md}catch{}}Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fA;Mn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tg(t))throw Error(je(200));return cA(e,t,null,r)};Mn.createRoot=function(e,t){if(!tg(e))throw Error(je(299));var r=!1,n="",s=kk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Zx(e,1,!1,null,null,r,!1,n,s),e[ma]=t.current,Hc(e.nodeType===8?e.parentNode:e),new eg(t)};Mn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(je(188)):(e=Object.keys(e).join(","),Error(je(268,e)));return e=Hb(t),e=e===null?null:e.stateNode,e};Mn.flushSync=function(e){return Yi(e)};Mn.hydrate=function(e,t,r){if(!Cf(t))throw Error(je(200));return Ef(null,e,t,!0,r)};Mn.hydrateRoot=function(e,t,r){if(!tg(e))throw Error(je(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=kk;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Nk(t,null,e,1,r??null,s,!1,a,o),e[ma]=t.current,Hc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new jf(t)};Mn.render=function(e,t,r){if(!Cf(t))throw Error(je(200));return Ef(null,e,t,!1,r)};Mn.unmountComponentAtNode=function(e){if(!Cf(e))throw Error(je(40));return e._reactRootContainer?(Yi(function(){Ef(null,null,e,!1,function(){e._reactRootContainer=null,e[ma]=null})}),!0):!1};Mn.unstable_batchedUpdates=Kx;Mn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Cf(r))throw Error(je(200));if(e==null||e._reactInternals===void 0)throw Error(je(38));return Ef(e,t,r,!1,n)};Mn.version="18.3.1-next-f1338f8080-20240426";function _k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_k)}catch(e){console.error(e)}}_k(),_b.exports=Mn;var Tf=_b.exports;const mA=fb(Tf);var ry=Tf;km.createRoot=ry.createRoot,km.hydrateRoot=ry.hydrateRoot;const pA="modulepreload",xA=function(e){return"/"+e},ny={},gA=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=xA(a),a in ny)return;ny[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===a&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":pA,o||(u.as="script",u.crossOrigin=""),u.href=a,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};var sy="popstate";function vA(e={}){function t(n,s){let{pathname:a,search:o,hash:l}=n.location;return xp("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:eu(s)}return wA(t,r,null,e)}function It(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ss(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yA(){return Math.random().toString(36).substring(2,10)}function ay(e,t){return{usr:e.state,key:e.key,idx:t}}function xp(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?jl(t):t,state:r,key:t&&t.key||n||yA()}}function eu({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function jl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function wA(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let v=d(),w=v==null?null:v-u;u=v,c&&c({action:l,location:p.location,delta:w})}function h(v,w){l="PUSH";let y=xp(p.location,v,w);r&&r(y,v),u=d()+1;let x=ay(y,u),N=p.createHref(y);try{o.pushState(x,"",N)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(N)}a&&c&&c({action:l,location:p.location,delta:1})}function m(v,w){l="REPLACE";let y=xp(p.location,v,w);r&&r(y,v),u=d();let x=ay(y,u),N=p.createHref(y);o.replaceState(x,"",N),a&&c&&c({action:l,location:p.location,delta:0})}function g(v){return bA(v)}let p={get action(){return l},get location(){return e(s,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(sy,f),c=v,()=>{s.removeEventListener(sy,f),c=null}},createHref(v){return t(s,v)},createURL:g,encodeLocation(v){let w=g(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:h,replace:m,go(v){return o.go(v)}};return p}function bA(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),It(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:eu(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function Sk(e,t,r="/"){return NA(e,t,r,!1)}function NA(e,t,r,n){let s=typeof t=="string"?jl(t):t,a=ga(s.pathname||"/",r);if(a==null)return null;let o=jk(e);kA(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=IA(a);l=PA(o[c],u,n)}return l}function jk(e,t=[],r=[],n="",s=!1){let a=(o,l,c=s,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;It(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=ia([n,d.relativePath]),h=r.concat(d);o.children&&o.children.length>0&&(It(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),jk(o.children,t,h,f,c)),!(o.path==null&&!o.index)&&t.push({path:f,score:AA(f,o.index),routesMeta:h})};return e.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let u of Ck(o.path))a(o,l,!0,u)}),t}function Ck(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=Ck(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function kA(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:FA(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var _A=/^:[\w-]+$/,SA=3,jA=2,CA=1,EA=10,TA=-2,iy=e=>e==="*";function AA(e,t){let r=e.split("/"),n=r.length;return r.some(iy)&&(n+=TA),t&&(n+=jA),r.filter(s=>!iy(s)).reduce((s,a)=>s+(_A.test(a)?SA:a===""?CA:EA),n)}function FA(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function PA(e,t,r=!1){let{routesMeta:n}=e,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=A0({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=A0({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:ia([a,f.pathname]),pathnameBase:MA(ia([a,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(a=ia([a,f.pathnameBase]))}return o}function A0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=DA(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},h)=>{if(d==="*"){let g=l[h]||"";o=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const m=l[h];return f&&!m?u[d]=void 0:u[d]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function DA(e,t=!1,r=!0){Ss(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function IA(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ss(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ga(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function RA(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?jl(e):e;return{pathname:r?r.startsWith("/")?r:LA(r,t):t,search:BA(n),hash:$A(s)}}function LA(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Oh(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function OA(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function rg(e){let t=OA(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function ng(e,t,r,n=!1){let s;typeof e=="string"?s=jl(e):(s={...e},It(!s.pathname||!s.pathname.includes("?"),Oh("?","pathname","search",s)),It(!s.pathname||!s.pathname.includes("#"),Oh("#","pathname","hash",s)),It(!s.search||!s.search.includes("#"),Oh("#","search","hash",s)));let a=e===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=RA(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var ia=e=>e.join("/").replace(/\/\/+/g,"/"),MA=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),BA=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,$A=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function UA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Ek=["POST","PUT","PATCH","DELETE"];new Set(Ek);var VA=["GET",...Ek];new Set(VA);var Cl=k.createContext(null);Cl.displayName="DataRouter";var Af=k.createContext(null);Af.displayName="DataRouterState";k.createContext(!1);var Tk=k.createContext({isTransitioning:!1});Tk.displayName="ViewTransition";var zA=k.createContext(new Map);zA.displayName="Fetchers";var WA=k.createContext(null);WA.displayName="Await";var js=k.createContext(null);js.displayName="Navigation";var ju=k.createContext(null);ju.displayName="Location";var Gs=k.createContext({outlet:null,matches:[],isDataRoute:!1});Gs.displayName="Route";var sg=k.createContext(null);sg.displayName="RouteError";function HA(e,{relative:t}={}){It(El(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=k.useContext(js),{hash:s,pathname:a,search:o}=Cu(e,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:ia([r,a])),n.createHref({pathname:l,search:o,hash:s})}function El(){return k.useContext(ju)!=null}function Na(){return It(El(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(ju).location}var Ak="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Fk(e){k.useContext(js).static||k.useLayoutEffect(e)}function ag(){let{isDataRoute:e}=k.useContext(Gs);return e?s5():GA()}function GA(){It(El(),"useNavigate() may be used only in the context of a <Router> component.");let e=k.useContext(Cl),{basename:t,navigator:r}=k.useContext(js),{matches:n}=k.useContext(Gs),{pathname:s}=Na(),a=JSON.stringify(rg(n)),o=k.useRef(!1);return Fk(()=>{o.current=!0}),k.useCallback((c,u={})=>{if(Ss(o.current,Ak),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=ng(c,JSON.parse(a),s,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ia([t,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[t,r,a,s,e])}k.createContext(null);function Cu(e,{relative:t}={}){let{matches:r}=k.useContext(Gs),{pathname:n}=Na(),s=JSON.stringify(rg(r));return k.useMemo(()=>ng(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function XA(e,t){return Pk(e,t)}function Pk(e,t,r,n,s){var y;It(El(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=k.useContext(js),{matches:o}=k.useContext(Gs),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",f=l&&l.route;{let x=f&&f.path||"";Dk(u,!f||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let h=Na(),m;if(t){let x=typeof t=="string"?jl(t):t;It(d==="/"||((y=x.pathname)==null?void 0:y.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${x.pathname}" was given in the \`location\` prop.`),m=x}else m=h;let g=m.pathname||"/",p=g;if(d!=="/"){let x=d.replace(/^\//,"").split("/");p="/"+g.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=Sk(e,{pathname:p});Ss(f||v!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Ss(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=ZA(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},c,x.params),pathname:ia([d,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?d:ia([d,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),o,r,n,s);return t&&w?k.createElement(ju.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},w):w}function KA(){let e=n5(),t=UA(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:a},"ErrorBoundary")," or"," ",k.createElement("code",{style:a},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},t),r?k.createElement("pre",{style:s},r):null,o)}var YA=k.createElement(KA,null),qA=class extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?k.createElement(Gs.Provider,{value:this.props.routeContext},k.createElement(sg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function JA({routeContext:e,match:t,children:r}){let n=k.useContext(Cl);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(Gs.Provider,{value:e},r)}function ZA(e,t=[],r=null,n=null,s=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=r==null?void 0:r.errors;if(o!=null){let u=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);It(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=r,m=d.route.loader&&!f.hasOwnProperty(d.route.id)&&(!h||h[d.route.id]===void 0);if(d.route.lazy||m){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,d,f)=>{let h,m=!1,g=null,p=null;r&&(h=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||YA,l&&(c<0&&f===0?(Dk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,p=null):c===f&&(m=!0,p=d.route.hydrateFallbackElement||null)));let v=t.concat(a.slice(0,f+1)),w=()=>{let y;return h?y=g:m?y=p:d.route.Component?y=k.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=u,k.createElement(JA,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:y})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?k.createElement(qA,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0},unstable_onError:n}):w()},null)}function ig(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function QA(e){let t=k.useContext(Cl);return It(t,ig(e)),t}function e5(e){let t=k.useContext(Af);return It(t,ig(e)),t}function t5(e){let t=k.useContext(Gs);return It(t,ig(e)),t}function og(e){let t=t5(e),r=t.matches[t.matches.length-1];return It(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function r5(){return og("useRouteId")}function n5(){var n;let e=k.useContext(sg),t=e5("useRouteError"),r=og("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function s5(){let{router:e}=QA("useNavigate"),t=og("useNavigate"),r=k.useRef(!1);return Fk(()=>{r.current=!0}),k.useCallback(async(s,a={})=>{Ss(r.current,Ak),r.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...a}))},[e,t])}var oy={};function Dk(e,t,r){!t&&!oy[e]&&(oy[e]=!0,Ss(!1,r))}k.memo(a5);function a5({routes:e,future:t,state:r,unstable_onError:n}){return Pk(e,void 0,r,n,t)}function i5({to:e,replace:t,state:r,relative:n}){It(El(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=k.useContext(js);Ss(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=k.useContext(Gs),{pathname:o}=Na(),l=ag(),c=ng(e,rg(a),o,n==="path"),u=JSON.stringify(c);return k.useEffect(()=>{l(JSON.parse(u),{replace:t,state:r,relative:n})},[l,u,n,t,r]),null}function zt(e){It(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function o5({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:a=!1}){It(!El(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=k.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof r=="string"&&(r=jl(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:h="default"}=r,m=k.useMemo(()=>{let g=ga(c,o);return g==null?null:{location:{pathname:g,search:u,hash:d,state:f,key:h},navigationType:n}},[o,c,u,d,f,h,n]);return Ss(m!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:k.createElement(js.Provider,{value:l},k.createElement(ju.Provider,{children:t,value:m}))}function l5({children:e,location:t}){return XA(gp(e),t)}function gp(e,t=[]){let r=[];return k.Children.forEach(e,(n,s)=>{if(!k.isValidElement(n))return;let a=[...t,s];if(n.type===k.Fragment){r.push.apply(r,gp(n.props.children,a));return}It(n.type===zt,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),It(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=gp(n.props.children,a)),r.push(o)}),r}var Yd="get",qd="application/x-www-form-urlencoded";function Ff(e){return e!=null&&typeof e.tagName=="string"}function c5(e){return Ff(e)&&e.tagName.toLowerCase()==="button"}function u5(e){return Ff(e)&&e.tagName.toLowerCase()==="form"}function d5(e){return Ff(e)&&e.tagName.toLowerCase()==="input"}function f5(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function h5(e,t){return e.button===0&&(!t||t==="_self")&&!f5(e)}var pd=null;function m5(){if(pd===null)try{new FormData(document.createElement("form"),0),pd=!1}catch{pd=!0}return pd}var p5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Mh(e){return e!=null&&!p5.has(e)?(Ss(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${qd}"`),null):e}function x5(e,t){let r,n,s,a,o;if(u5(e)){let l=e.getAttribute("action");n=l?ga(l,t):null,r=e.getAttribute("method")||Yd,s=Mh(e.getAttribute("enctype"))||qd,a=new FormData(e)}else if(c5(e)||d5(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(n=c?ga(c,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||Yd,s=Mh(e.getAttribute("formenctype"))||Mh(l.getAttribute("enctype"))||qd,a=new FormData(l,e),!m5()){let{name:u,type:d,value:f}=e;if(d==="image"){let h=u?`${u}.`:"";a.append(`${h}x`,"0"),a.append(`${h}y`,"0")}else u&&a.append(u,f)}}else{if(Ff(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Yd,n=null,s=qd,o=e}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function lg(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function g5(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&ga(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function v5(e,t){if(e.id in t)return t[e.id];try{let r=await gA(()=>import(e.module),[]);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function y5(e){return e!=null&&typeof e.page=="string"}function w5(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function b5(e,t,r){let n=await Promise.all(e.map(async s=>{let a=t.routes[s.route.id];if(a){let o=await v5(a,r);return o.links?o.links():[]}return[]}));return S5(n.flat(1).filter(w5).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function ly(e,t,r,n,s,a){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return a==="assets"?t.filter((c,u)=>o(c,u)||l(c,u)):a==="data"?t.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function N5(e,t,{includeHydrateFallback:r}={}){return k5(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function k5(e){return[...new Set(e)]}function _5(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function S5(e,t){let r=new Set,n=new Set(t);return e.reduce((s,a)=>{if(t&&!y5(a)&&a.as==="script"&&a.href&&n.has(a.href))return s;let l=JSON.stringify(_5(a));return r.has(l)||(r.add(l),s.push({key:l,link:a})),s},[])}function Ik(){let e=k.useContext(Cl);return lg(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function j5(){let e=k.useContext(Af);return lg(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var cg=k.createContext(void 0);cg.displayName="FrameworkContext";function Rk(){let e=k.useContext(cg);return lg(e,"You must render this element inside a <HydratedRouter> element"),e}function C5(e,t){let r=k.useContext(cg),[n,s]=k.useState(!1),[a,o]=k.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=t,h=k.useRef(null);k.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let p=w=>{w.forEach(y=>{o(y.isIntersecting)})},v=new IntersectionObserver(p,{threshold:.5});return h.current&&v.observe(h.current),()=>{v.disconnect()}}},[e]),k.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let m=()=>{s(!0)},g=()=>{s(!1),o(!1)};return r?e!=="intent"?[a,h,{}]:[a,h,{onFocus:Zl(l,m),onBlur:Zl(c,g),onMouseEnter:Zl(u,m),onMouseLeave:Zl(d,g),onTouchStart:Zl(f,m)}]:[!1,h,{}]}function Zl(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function E5({page:e,...t}){let{router:r}=Ik(),n=k.useMemo(()=>Sk(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?k.createElement(A5,{page:e,matches:n,...t}):null}function T5(e){let{manifest:t,routeModules:r}=Rk(),[n,s]=k.useState([]);return k.useEffect(()=>{let a=!1;return b5(e,t,r).then(o=>{a||s(o)}),()=>{a=!0}},[e,t,r]),n}function A5({page:e,matches:t,...r}){let n=Na(),{manifest:s,routeModules:a}=Rk(),{basename:o}=Ik(),{loaderData:l,matches:c}=j5(),u=k.useMemo(()=>ly(e,t,c,s,n,"data"),[e,t,c,s,n]),d=k.useMemo(()=>ly(e,t,c,s,n,"assets"),[e,t,c,s,n]),f=k.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let g=new Set,p=!1;if(t.forEach(w=>{var x;let y=s.routes[w.route.id];!y||!y.hasLoader||(!u.some(N=>N.route.id===w.route.id)&&w.route.id in l&&((x=a[w.route.id])!=null&&x.shouldRevalidate)||y.hasClientLoader?p=!0:g.add(w.route.id))}),g.size===0)return[];let v=g5(e,o,"data");return p&&g.size>0&&v.searchParams.set("_routes",t.filter(w=>g.has(w.route.id)).map(w=>w.route.id).join(",")),[v.pathname+v.search]},[o,l,n,s,u,t,e,a]),h=k.useMemo(()=>N5(d,s),[d,s]),m=T5(d);return k.createElement(k.Fragment,null,f.map(g=>k.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),h.map(g=>k.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),m.map(({key:g,link:p})=>k.createElement("link",{key:g,nonce:r.nonce,...p})))}function F5(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Lk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Lk&&(window.__reactRouterVersion="7.9.1")}catch{}function P5({basename:e,children:t,window:r}){let n=k.useRef();n.current==null&&(n.current=vA({window:r,v5Compat:!0}));let s=n.current,[a,o]=k.useState({action:s.action,location:s.location}),l=k.useCallback(c=>{k.startTransition(()=>o(c))},[o]);return k.useLayoutEffect(()=>s.listen(l),[s,l]),k.createElement(o5,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:s})}var Ok=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mk=k.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...h},m){let{basename:g}=k.useContext(js),p=typeof u=="string"&&Ok.test(u),v,w=!1;if(typeof u=="string"&&p&&(v=u,Lk))try{let D=new URL(window.location.href),V=u.startsWith("//")?new URL(D.protocol+u):new URL(u),P=ga(V.pathname,g);V.origin===D.origin&&P!=null?u=P+V.search+V.hash:w=!0}catch{Ss(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=HA(u,{relative:s}),[x,N,S]=C5(n,h),_=L5(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:f});function b(D){t&&t(D),D.defaultPrevented||_(D)}let A=k.createElement("a",{...h,...S,href:v||y,onClick:w||a?t:b,ref:F5(m,N),target:c,"data-discover":!p&&r==="render"?"true":void 0});return x&&!p?k.createElement(k.Fragment,null,A,k.createElement(E5,{page:y})):A});Mk.displayName="Link";var D5=k.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:c,...u},d){let f=Cu(o,{relative:u.relative}),h=Na(),m=k.useContext(Af),{navigator:g,basename:p}=k.useContext(js),v=m!=null&&U5(f)&&l===!0,w=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,y=h.pathname,x=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(y=y.toLowerCase(),x=x?x.toLowerCase():null,w=w.toLowerCase()),x&&p&&(x=ga(x,p)||x);const N=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let S=y===w||!s&&y.startsWith(w)&&y.charAt(N)==="/",_=x!=null&&(x===w||!s&&x.startsWith(w)&&x.charAt(w.length)==="/"),b={isActive:S,isPending:_,isTransitioning:v},A=S?t:void 0,D;typeof n=="function"?D=n(b):D=[n,S?"active":null,_?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(b):a;return k.createElement(Mk,{...u,"aria-current":A,className:D,ref:d,style:V,to:o,viewTransition:l},typeof c=="function"?c(b):c)});D5.displayName="NavLink";var I5=k.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:a,method:o=Yd,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...h},m)=>{let g=B5(),p=$5(l,{relative:u}),v=o.toLowerCase()==="get"?"get":"post",w=typeof l=="string"&&Ok.test(l),y=x=>{if(c&&c(x),x.defaultPrevented)return;x.preventDefault();let N=x.nativeEvent.submitter,S=(N==null?void 0:N.getAttribute("formmethod"))||o;g(N||x.currentTarget,{fetcherKey:t,method:S,navigate:r,replace:s,state:a,relative:u,preventScrollReset:d,viewTransition:f})};return k.createElement("form",{ref:m,method:v,action:p,onSubmit:n?c:y,...h,"data-discover":!w&&e==="render"?"true":void 0})});I5.displayName="Form";function R5(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bk(e){let t=k.useContext(Cl);return It(t,R5(e)),t}function L5(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}={}){let l=ag(),c=Na(),u=Cu(e,{relative:a});return k.useCallback(d=>{if(h5(d,t)){d.preventDefault();let f=r!==void 0?r:eu(c)===eu(u);l(e,{replace:f,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,u,r,n,t,e,s,a,o])}var O5=0,M5=()=>`__${String(++O5)}__`;function B5(){let{router:e}=Bk("useSubmit"),{basename:t}=k.useContext(js),r=r5();return k.useCallback(async(n,s={})=>{let{action:a,method:o,encType:l,formData:c,body:u}=x5(n,t);if(s.navigate===!1){let d=s.fetcherKey||M5();await e.fetch(d,r,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await e.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}function $5(e,{relative:t}={}){let{basename:r}=k.useContext(js),n=k.useContext(Gs);It(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...Cu(e||".",{relative:t})},o=Na();if(e==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();a.search=d?`?${d}`:""}}return(!e||e===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:ia([r,a.pathname])),eu(a)}function U5(e,{relative:t}={}){let r=k.useContext(Tk);It(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Bk("useViewTransitionState"),s=Cu(e,{relative:t});if(!r.isTransitioning)return!1;let a=ga(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=ga(r.nextLocation.pathname,n)||r.nextLocation.pathname;return A0(s.pathname,o)!=null||A0(s.pathname,a)!=null}const $k=k.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Pf=k.createContext({}),Df=k.createContext(null),If=typeof document<"u",ug=If?k.useLayoutEffect:k.useEffect,Uk=k.createContext({strict:!1}),dg=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),V5="framerAppearId",Vk="data-"+dg(V5);function z5(e,t,r,n){const{visualElement:s}=k.useContext(Pf),a=k.useContext(Uk),o=k.useContext(Df),l=k.useContext($k).reducedMotion,c=k.useRef();n=n||a.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:s,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;k.useInsertionEffect(()=>{u&&u.update(r,o)});const d=k.useRef(!!(r[Vk]&&!window.HandoffComplete));return ug(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),k.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function zo(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function W5(e,t,r){return k.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):zo(r)&&(r.current=n))},[t])}function tu(e){return typeof e=="string"||Array.isArray(e)}function Rf(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const fg=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],hg=["initial",...fg];function Lf(e){return Rf(e.animate)||hg.some(t=>tu(e[t]))}function zk(e){return!!(Lf(e)||e.variants)}function H5(e,t){if(Lf(e)){const{initial:r,animate:n}=e;return{initial:r===!1||tu(r)?r:void 0,animate:tu(n)?n:void 0}}return e.inherit!==!1?t:{}}function G5(e){const{initial:t,animate:r}=H5(e,k.useContext(Pf));return k.useMemo(()=>({initial:t,animate:r}),[cy(t),cy(r)])}function cy(e){return Array.isArray(e)?e.join(" "):e}const uy={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ru={};for(const e in uy)ru[e]={isEnabled:t=>uy[e].some(r=>!!t[r])};function X5(e){for(const t in e)ru[t]={...ru[t],...e[t]}}const mg=k.createContext({}),Wk=k.createContext({}),K5=Symbol.for("motionComponentSymbol");function Y5({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){e&&X5(e);function a(l,c){let u;const d={...k.useContext($k),...l,layoutId:q5(l)},{isStatic:f}=d,h=G5(l),m=n(l,f);if(!f&&If){h.visualElement=z5(s,m,d,t);const g=k.useContext(Wk),p=k.useContext(Uk).strict;h.visualElement&&(u=h.visualElement.loadFeatures(d,p,e,g))}return k.createElement(Pf.Provider,{value:h},u&&h.visualElement?k.createElement(u,{visualElement:h.visualElement,...d}):null,r(s,l,W5(m,h.visualElement,c),m,f,h.visualElement))}const o=k.forwardRef(a);return o[K5]=s,o}function q5({layoutId:e}){const t=k.useContext(mg).id;return t&&e!==void 0?t+"-"+e:e}function J5(e){function t(n,s={}){return Y5(e(n,s))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,s)=>(r.has(s)||r.set(s,t(s)),r.get(s))})}const Z5=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function pg(e){return typeof e!="string"||e.includes("-")?!1:!!(Z5.indexOf(e)>-1||/[A-Z]/.test(e))}const F0={};function Q5(e){Object.assign(F0,e)}const Eu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],fo=new Set(Eu);function Hk(e,{layout:t,layoutId:r}){return fo.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!F0[e]||e==="opacity")}const bn=e=>!!(e&&e.getVelocity),e6={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},t6=Eu.length;function r6(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,s){let a="";for(let o=0;o<t6;o++){const l=Eu[o];if(e[l]!==void 0){const c=e6[l]||l;a+=`${c}(${e[l]}) `}}return t&&!e.z&&(a+="translateZ(0)"),a=a.trim(),s?a=s(e,n?"":a):r&&n&&(a="none"),a}const Gk=e=>t=>typeof t=="string"&&t.startsWith(e),Xk=Gk("--"),vp=Gk("var(--"),n6=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,s6=(e,t)=>t&&typeof e=="number"?t.transform(e):e,ni=(e,t,r)=>Math.min(Math.max(r,e),t),ho={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},_c={...ho,transform:e=>ni(0,1,e)},xd={...ho,default:1},Sc=e=>Math.round(e*1e5)/1e5,Of=/(-)?([\d]*\.?[\d])+/g,Kk=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,a6=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Tu(e){return typeof e=="string"}const Au=e=>({test:t=>Tu(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Fa=Au("deg"),Us=Au("%"),Ge=Au("px"),i6=Au("vh"),o6=Au("vw"),dy={...Us,parse:e=>Us.parse(e)/100,transform:e=>Us.transform(e*100)},fy={...ho,transform:Math.round},Yk={borderWidth:Ge,borderTopWidth:Ge,borderRightWidth:Ge,borderBottomWidth:Ge,borderLeftWidth:Ge,borderRadius:Ge,radius:Ge,borderTopLeftRadius:Ge,borderTopRightRadius:Ge,borderBottomRightRadius:Ge,borderBottomLeftRadius:Ge,width:Ge,maxWidth:Ge,height:Ge,maxHeight:Ge,size:Ge,top:Ge,right:Ge,bottom:Ge,left:Ge,padding:Ge,paddingTop:Ge,paddingRight:Ge,paddingBottom:Ge,paddingLeft:Ge,margin:Ge,marginTop:Ge,marginRight:Ge,marginBottom:Ge,marginLeft:Ge,rotate:Fa,rotateX:Fa,rotateY:Fa,rotateZ:Fa,scale:xd,scaleX:xd,scaleY:xd,scaleZ:xd,skew:Fa,skewX:Fa,skewY:Fa,distance:Ge,translateX:Ge,translateY:Ge,translateZ:Ge,x:Ge,y:Ge,z:Ge,perspective:Ge,transformPerspective:Ge,opacity:_c,originX:dy,originY:dy,originZ:Ge,zIndex:fy,fillOpacity:_c,strokeOpacity:_c,numOctaves:fy};function xg(e,t,r,n){const{style:s,vars:a,transform:o,transformOrigin:l}=e;let c=!1,u=!1,d=!0;for(const f in t){const h=t[f];if(Xk(f)){a[f]=h;continue}const m=Yk[f],g=s6(h,m);if(fo.has(f)){if(c=!0,o[f]=g,!d)continue;h!==(m.default||0)&&(d=!1)}else f.startsWith("origin")?(u=!0,l[f]=g):s[f]=g}if(t.transform||(c||n?s.transform=r6(e.transform,r,d,n):s.transform&&(s.transform="none")),u){const{originX:f="50%",originY:h="50%",originZ:m=0}=l;s.transformOrigin=`${f} ${h} ${m}`}}const gg=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function qk(e,t,r){for(const n in t)!bn(t[n])&&!Hk(n,r)&&(e[n]=t[n])}function l6({transformTemplate:e},t,r){return k.useMemo(()=>{const n=gg();return xg(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function c6(e,t,r){const n=e.style||{},s={};return qk(s,n,e),Object.assign(s,l6(e,t,r)),e.transformValues?e.transformValues(s):s}function u6(e,t,r){const n={},s=c6(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const d6=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function P0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||d6.has(e)}let Jk=e=>!P0(e);function f6(e){e&&(Jk=t=>t.startsWith("on")?!P0(t):e(t))}try{f6(require("@emotion/is-prop-valid").default)}catch{}function h6(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(Jk(s)||r===!0&&P0(s)||!t&&!P0(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function hy(e,t,r){return typeof e=="string"?e:Ge.transform(t+r*e)}function m6(e,t,r){const n=hy(t,e.x,e.width),s=hy(r,e.y,e.height);return`${n} ${s}`}const p6={offset:"stroke-dashoffset",array:"stroke-dasharray"},x6={offset:"strokeDashoffset",array:"strokeDasharray"};function g6(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?p6:x6;e[a.offset]=Ge.transform(-n);const o=Ge.transform(t),l=Ge.transform(r);e[a.array]=`${o} ${l}`}function vg(e,{attrX:t,attrY:r,attrScale:n,originX:s,originY:a,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,f,h){if(xg(e,u,d,h),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:g,dimensions:p}=e;m.transform&&(p&&(g.transform=m.transform),delete m.transform),p&&(s!==void 0||a!==void 0||g.transform)&&(g.transformOrigin=m6(p,s!==void 0?s:.5,a!==void 0?a:.5)),t!==void 0&&(m.x=t),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),o!==void 0&&g6(m,o,l,c,!1)}const Zk=()=>({...gg(),attrs:{}}),yg=e=>typeof e=="string"&&e.toLowerCase()==="svg";function v6(e,t,r,n){const s=k.useMemo(()=>{const a=Zk();return vg(a,t,{enableHardwareAcceleration:!1},yg(n),e.transformTemplate),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};qk(a,e.style,e),s.style={...a,...s.style}}return s}function y6(e=!1){return(r,n,s,{latestValues:a},o)=>{const c=(pg(r)?v6:u6)(n,a,o,r),d={...h6(n,typeof r=="string",e),...c,ref:s},{children:f}=n,h=k.useMemo(()=>bn(f)?f.get():f,[f]);return k.createElement(r,{...d,children:h})}}function Qk(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const a in r)e.style.setProperty(a,r[a])}const e_=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function t_(e,t,r,n){Qk(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(e_.has(s)?s:dg(s),t.attrs[s])}function wg(e,t){const{style:r}=e,n={};for(const s in r)(bn(r[s])||t.style&&bn(t.style[s])||Hk(s,e))&&(n[s]=r[s]);return n}function r_(e,t){const r=wg(e,t);for(const n in e)if(bn(e[n])||bn(t[n])){const s=Eu.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=e[n]}return r}function bg(e,t,r,n={},s={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),t}function n_(e){const t=k.useRef(null);return t.current===null&&(t.current=e()),t.current}const D0=e=>Array.isArray(e),w6=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),b6=e=>D0(e)?e[e.length-1]||0:e;function Jd(e){const t=bn(e)?e.get():e;return w6(t)?t.toValue():t}function N6({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,s,a){const o={latestValues:k6(n,s,a,e),renderState:t()};return r&&(o.mount=l=>r(n,l,o)),o}const s_=e=>(t,r)=>{const n=k.useContext(Pf),s=k.useContext(Df),a=()=>N6(e,t,n,s);return r?a():n_(a)};function k6(e,t,r,n){const s={},a=n(e,{});for(const h in a)s[h]=Jd(a[h]);let{initial:o,animate:l}=e;const c=Lf(e),u=zk(e);t&&u&&!c&&e.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let d=r?r.initial===!1:!1;d=d||o===!1;const f=d?l:o;return f&&typeof f!="boolean"&&!Rf(f)&&(Array.isArray(f)?f:[f]).forEach(m=>{const g=bg(e,m);if(!g)return;const{transitionEnd:p,transition:v,...w}=g;for(const y in w){let x=w[y];if(Array.isArray(x)){const N=d?x.length-1:0;x=x[N]}x!==null&&(s[y]=x)}for(const y in p)s[y]=p[y]}),s}const Xt=e=>e;class my{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function _6(e){let t=new my,r=new my,n=0,s=!1,a=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const f=d&&s,h=f?t:r;return u&&o.add(c),h.add(c)&&f&&s&&(n=t.order.length),c},cancel:c=>{r.remove(c),o.delete(c)},process:c=>{if(s){a=!0;return}if(s=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let u=0;u<n;u++){const d=t.order[u];d(c),o.has(d)&&(l.schedule(d),e())}s=!1,a&&(a=!1,l.process(c))}};return l}const gd=["prepare","read","update","preRender","render","postRender"],S6=40;function j6(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=gd.reduce((f,h)=>(f[h]=_6(()=>r=!0),f),{}),o=f=>a[f].process(s),l=()=>{const f=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(f-s.timestamp,S6),1),s.timestamp=f,s.isProcessing=!0,gd.forEach(o),s.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,s.isProcessing||e(l)};return{schedule:gd.reduce((f,h)=>{const m=a[h];return f[h]=(g,p=!1,v=!1)=>(r||c(),m.schedule(g,p,v)),f},{}),cancel:f=>gd.forEach(h=>a[h].cancel(f)),state:s,steps:a}}const{schedule:kt,cancel:va,state:$r,steps:Bh}=j6(typeof requestAnimationFrame<"u"?requestAnimationFrame:Xt,!0),C6={useVisualState:s_({scrapeMotionValuesFromProps:r_,createRenderState:Zk,onMount:(e,t,{renderState:r,latestValues:n})=>{kt.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),kt.render(()=>{vg(r,n,{enableHardwareAcceleration:!1},yg(t.tagName),e.transformTemplate),t_(t,r)})}})},E6={useVisualState:s_({scrapeMotionValuesFromProps:wg,createRenderState:gg})};function T6(e,{forwardMotionProps:t=!1},r,n){return{...pg(e)?C6:E6,preloadedFeatures:r,useRender:y6(t),createVisualElement:n,Component:e}}function ta(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const a_=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Mf(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const A6=e=>t=>a_(t)&&e(t,Mf(t));function oa(e,t,r,n){return ta(e,t,A6(r),n)}const F6=(e,t)=>r=>t(e(r)),Qa=(...e)=>e.reduce(F6);function i_(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const py=i_("dragHorizontal"),xy=i_("dragVertical");function o_(e){let t=!1;if(e==="y")t=xy();else if(e==="x")t=py();else{const r=py(),n=xy();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function l_(){const e=o_(!0);return e?(e(),!1):!0}class mi{constructor(t){this.isMounted=!1,this.node=t}update(){}}function gy(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),s=(a,o)=>{if(a.pointerType==="touch"||l_())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&kt.update(()=>l[n](a,o))};return oa(e.current,r,s,{passive:!e.getProps()[n]})}class P6 extends mi{mount(){this.unmount=Qa(gy(this.node,!0),gy(this.node,!1))}unmount(){}}class D6 extends mi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Qa(ta(this.node.current,"focus",()=>this.onFocus()),ta(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const c_=(e,t)=>t?e===t?!0:c_(e,t.parentElement):!1;function $h(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,Mf(r))}class I6 extends mi{constructor(){super(...arguments),this.removeStartListeners=Xt,this.removeEndListeners=Xt,this.removeAccessibleListeners=Xt,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),a=oa(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:f}=this.node.getProps();kt.update(()=>{!f&&!c_(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),o=oa(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Qa(a,o),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=a=>{if(a.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||$h("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&kt.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=ta(this.node.current,"keyup",o),$h("down",(l,c)=>{this.startPress(l,c)})},r=ta(this.node.current,"keydown",t),n=()=>{this.isPressing&&$h("cancel",(a,o)=>this.cancelPress(a,o))},s=ta(this.node.current,"blur",n);this.removeAccessibleListeners=Qa(r,s)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&kt.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!l_()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&kt.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=oa(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=ta(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Qa(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const yp=new WeakMap,Uh=new WeakMap,R6=e=>{const t=yp.get(e.target);t&&t(e)},L6=e=>{e.forEach(R6)};function O6({root:e,...t}){const r=e||document;Uh.has(r)||Uh.set(r,{});const n=Uh.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(L6,{root:e,...t})),n[s]}function M6(e,t,r){const n=O6(t);return yp.set(e,r),n.observe(e),()=>{yp.delete(e),n.unobserve(e)}}const B6={some:0,all:1};class $6 extends mi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:B6[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return M6(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(U6(t,r))&&this.startObserver()}unmount(){}}function U6({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const V6={inView:{Feature:$6},tap:{Feature:I6},focus:{Feature:D6},hover:{Feature:P6}};function u_(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function z6(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function W6(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function Bf(e,t,r){const n=e.getProps();return bg(n,t,r!==void 0?r:n.custom,z6(e),W6(e))}let H6=Xt,Ng=Xt;const ei=e=>e*1e3,la=e=>e/1e3,G6={current:!1},d_=e=>Array.isArray(e)&&typeof e[0]=="number";function f_(e){return!!(!e||typeof e=="string"&&h_[e]||d_(e)||Array.isArray(e)&&e.every(f_))}const uc=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,h_={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:uc([0,.65,.55,1]),circOut:uc([.55,0,1,.45]),backIn:uc([.31,.01,.66,-.59]),backOut:uc([.33,1.53,.69,.99])};function m_(e){if(e)return d_(e)?uc(e):Array.isArray(e)?e.map(m_):h_[e]}function X6(e,t,r,{delay:n=0,duration:s,repeat:a=0,repeatType:o="loop",ease:l,times:c}={}){const u={[t]:r};c&&(u.offset=c);const d=m_(l);return Array.isArray(d)&&(u.easing=d),e.animate(u,{delay:n,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"})}function K6(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const p_=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Y6=1e-7,q6=12;function J6(e,t,r,n,s){let a,o,l=0;do o=t+(r-t)/2,a=p_(o,n,s)-e,a>0?r=o:t=o;while(Math.abs(a)>Y6&&++l<q6);return o}function Fu(e,t,r,n){if(e===t&&r===n)return Xt;const s=a=>J6(a,0,1,e,r);return a=>a===0||a===1?a:p_(s(a),t,n)}const Z6=Fu(.42,0,1,1),Q6=Fu(0,0,.58,1),x_=Fu(.42,0,.58,1),eF=e=>Array.isArray(e)&&typeof e[0]!="number",g_=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,v_=e=>t=>1-e(1-t),kg=e=>1-Math.sin(Math.acos(e)),y_=v_(kg),tF=g_(kg),w_=Fu(.33,1.53,.69,.99),_g=v_(w_),rF=g_(_g),nF=e=>(e*=2)<1?.5*_g(e):.5*(2-Math.pow(2,-10*(e-1))),sF={linear:Xt,easeIn:Z6,easeInOut:x_,easeOut:Q6,circIn:kg,circInOut:tF,circOut:y_,backIn:_g,backInOut:rF,backOut:w_,anticipate:nF},vy=e=>{if(Array.isArray(e)){Ng(e.length===4);const[t,r,n,s]=e;return Fu(t,r,n,s)}else if(typeof e=="string")return sF[e];return e},Sg=(e,t)=>r=>!!(Tu(r)&&a6.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),b_=(e,t,r)=>n=>{if(!Tu(n))return n;const[s,a,o,l]=n.match(Of);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},aF=e=>ni(0,255,e),Vh={...ho,transform:e=>Math.round(aF(e))},Di={test:Sg("rgb","red"),parse:b_("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+Vh.transform(e)+", "+Vh.transform(t)+", "+Vh.transform(r)+", "+Sc(_c.transform(n))+")"};function iF(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const wp={test:Sg("#"),parse:iF,transform:Di.transform},Wo={test:Sg("hsl","hue"),parse:b_("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Us.transform(Sc(t))+", "+Us.transform(Sc(r))+", "+Sc(_c.transform(n))+")"},Zr={test:e=>Di.test(e)||wp.test(e)||Wo.test(e),parse:e=>Di.test(e)?Di.parse(e):Wo.test(e)?Wo.parse(e):wp.parse(e),transform:e=>Tu(e)?e:e.hasOwnProperty("red")?Di.transform(e):Wo.transform(e)},Mt=(e,t,r)=>-r*e+r*t+e;function zh(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function oF({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,o=0;if(!t)s=a=o=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;s=zh(c,l,e+1/3),a=zh(c,l,e),o=zh(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:n}}const Wh=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},lF=[wp,Di,Wo],cF=e=>lF.find(t=>t.test(e));function yy(e){const t=cF(e);let r=t.parse(e);return t===Wo&&(r=oF(r)),r}const N_=(e,t)=>{const r=yy(e),n=yy(t),s={...r};return a=>(s.red=Wh(r.red,n.red,a),s.green=Wh(r.green,n.green,a),s.blue=Wh(r.blue,n.blue,a),s.alpha=Mt(r.alpha,n.alpha,a),Di.transform(s))};function uF(e){var t,r;return isNaN(e)&&Tu(e)&&(((t=e.match(Of))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(Kk))===null||r===void 0?void 0:r.length)||0)>0}const k_={regex:n6,countKey:"Vars",token:"${v}",parse:Xt},__={regex:Kk,countKey:"Colors",token:"${c}",parse:Zr.parse},S_={regex:Of,countKey:"Numbers",token:"${n}",parse:ho.parse};function Hh(e,{regex:t,countKey:r,token:n,parse:s}){const a=e.tokenised.match(t);a&&(e["num"+r]=a.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...a.map(s)))}function I0(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&Hh(r,k_),Hh(r,__),Hh(r,S_),r}function j_(e){return I0(e).values}function C_(e){const{values:t,numColors:r,numVars:n,tokenised:s}=I0(e),a=t.length;return o=>{let l=s;for(let c=0;c<a;c++)c<n?l=l.replace(k_.token,o[c]):c<n+r?l=l.replace(__.token,Zr.transform(o[c])):l=l.replace(S_.token,Sc(o[c]));return l}}const dF=e=>typeof e=="number"?0:e;function fF(e){const t=j_(e);return C_(e)(t.map(dF))}const si={test:uF,parse:j_,createTransformer:C_,getAnimatableNone:fF},E_=(e,t)=>r=>`${r>0?t:e}`;function T_(e,t){return typeof e=="number"?r=>Mt(e,t,r):Zr.test(e)?N_(e,t):e.startsWith("var(")?E_(e,t):F_(e,t)}const A_=(e,t)=>{const r=[...e],n=r.length,s=e.map((a,o)=>T_(a,t[o]));return a=>{for(let o=0;o<n;o++)r[o]=s[o](a);return r}},hF=(e,t)=>{const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=T_(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}},F_=(e,t)=>{const r=si.createTransformer(t),n=I0(e),s=I0(t);return n.numVars===s.numVars&&n.numColors===s.numColors&&n.numNumbers>=s.numNumbers?Qa(A_(n.values,s.values),r):E_(e,t)},nu=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},wy=(e,t)=>r=>Mt(e,t,r);function mF(e){return typeof e=="number"?wy:typeof e=="string"?Zr.test(e)?N_:F_:Array.isArray(e)?A_:typeof e=="object"?hF:wy}function pF(e,t,r){const n=[],s=r||mF(e[0]),a=e.length-1;for(let o=0;o<a;o++){let l=s(e[o],e[o+1]);if(t){const c=Array.isArray(t)?t[o]||Xt:t;l=Qa(c,l)}n.push(l)}return n}function P_(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(Ng(a===t.length),a===1)return()=>t[0];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=pF(t,n,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const f=nu(e[d],e[d+1],u);return o[d](f)};return r?u=>c(ni(e[0],e[a-1],u)):c}function xF(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=nu(0,t,n);e.push(Mt(r,1,s))}}function gF(e){const t=[0];return xF(t,e.length-1),t}function vF(e,t){return e.map(r=>r*t)}function yF(e,t){return e.map(()=>t||x_).splice(0,e.length-1)}function R0({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=eF(n)?n.map(vy):vy(n),a={done:!1,value:t[0]},o=vF(r&&r.length===t.length?r:gF(t),e),l=P_(o,t,{ease:Array.isArray(s)?s:yF(t,s)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}function D_(e,t){return t?e*(1e3/t):0}const wF=5;function I_(e,t,r){const n=Math.max(t-wF,0);return D_(r-e(n),t-n)}const Gh=.001,bF=.01,by=10,NF=.05,kF=1;function _F({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let s,a;H6(e<=ei(by));let o=1-t;o=ni(NF,kF,o),e=ni(bF,by,la(e)),o<1?(s=u=>{const d=u*o,f=d*e,h=d-r,m=bp(u,o),g=Math.exp(-f);return Gh-h/m*g},a=u=>{const f=u*o*e,h=f*r+r,m=Math.pow(o,2)*Math.pow(u,2)*e,g=Math.exp(-f),p=bp(Math.pow(u,2),o);return(-s(u)+Gh>0?-1:1)*((h-m)*g)/p}):(s=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-Gh+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const l=5/e,c=jF(s,a,l);if(e=ei(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:e}}}const SF=12;function jF(e,t,r){let n=r;for(let s=1;s<SF;s++)n=n-e(n)/t(n);return n}function bp(e,t){return e*Math.sqrt(1-t*t)}const CF=["duration","bounce"],EF=["stiffness","damping","mass"];function Ny(e,t){return t.some(r=>e[r]!==void 0)}function TF(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Ny(e,EF)&&Ny(e,CF)){const r=_F(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function R_({keyframes:e,restDelta:t,restSpeed:r,...n}){const s=e[0],a=e[e.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:f,isResolvedFromDuration:h}=TF({...n,velocity:-la(n.velocity||0)}),m=f||0,g=c/(2*Math.sqrt(l*u)),p=a-s,v=la(Math.sqrt(l/u)),w=Math.abs(p)<5;r||(r=w?.01:2),t||(t=w?.005:.5);let y;if(g<1){const x=bp(v,g);y=N=>{const S=Math.exp(-g*v*N);return a-S*((m+g*v*p)/x*Math.sin(x*N)+p*Math.cos(x*N))}}else if(g===1)y=x=>a-Math.exp(-v*x)*(p+(m+v*p)*x);else{const x=v*Math.sqrt(g*g-1);y=N=>{const S=Math.exp(-g*v*N),_=Math.min(x*N,300);return a-S*((m+g*v*p)*Math.sinh(_)+x*p*Math.cosh(_))/x}}return{calculatedDuration:h&&d||null,next:x=>{const N=y(x);if(h)o.done=x>=d;else{let S=m;x!==0&&(g<1?S=I_(y,x,N):S=0);const _=Math.abs(S)<=r,b=Math.abs(a-N)<=t;o.done=_&&b}return o.value=o.done?a:N,o}}}function ky({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},m=A=>l!==void 0&&A<l||c!==void 0&&A>c,g=A=>l===void 0?c:c===void 0||Math.abs(l-A)<Math.abs(c-A)?l:c;let p=r*t;const v=f+p,w=o===void 0?v:o(v);w!==v&&(p=w-f);const y=A=>-p*Math.exp(-A/n),x=A=>w+y(A),N=A=>{const D=y(A),V=x(A);h.done=Math.abs(D)<=u,h.value=h.done?w:V};let S,_;const b=A=>{m(h.value)&&(S=A,_=R_({keyframes:[h.value,g(h.value)],velocity:I_(x,A,h.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return b(0),{calculatedDuration:null,next:A=>{let D=!1;return!_&&S===void 0&&(D=!0,N(A),b(A)),S!==void 0&&A>S?_.next(A-S):(!D&&N(A),h)}}}const AF=e=>{const t=({timestamp:r})=>e(r);return{start:()=>kt.update(t,!0),stop:()=>va(t),now:()=>$r.isProcessing?$r.timestamp:performance.now()}},_y=2e4;function Sy(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<_y;)t+=r,n=e.next(t);return t>=_y?1/0:t}const FF={decay:ky,inertia:ky,tween:R0,keyframes:R0,spring:R_};function L0({autoplay:e=!0,delay:t=0,driver:r=AF,keyframes:n,type:s="keyframes",repeat:a=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:f,...h}){let m=1,g=!1,p,v;const w=()=>{v=new Promise(F=>{p=F})};w();let y;const x=FF[s]||R0;let N;x!==R0&&typeof n[0]!="number"&&(N=P_([0,100],n,{clamp:!1}),n=[0,100]);const S=x({...h,keyframes:n});let _;l==="mirror"&&(_=x({...h,keyframes:[...n].reverse(),velocity:-(h.velocity||0)}));let b="idle",A=null,D=null,V=null;S.calculatedDuration===null&&a&&(S.calculatedDuration=Sy(S));const{calculatedDuration:P}=S;let T=1/0,z=1/0;P!==null&&(T=P+o,z=T*(a+1)-o);let L=0;const ee=F=>{if(D===null)return;m>0&&(D=Math.min(D,F)),m<0&&(D=Math.min(F-z/m,D)),A!==null?L=A:L=Math.round(F-D)*m;const E=L-t*(m>=0?1:-1),M=m>=0?E<0:E>z;L=Math.max(E,0),b==="finished"&&A===null&&(L=z);let H=L,G=S;if(a){const ce=Math.min(L,z)/T;let Q=Math.floor(ce),J=ce%1;!J&&ce>=1&&(J=1),J===1&&Q--,Q=Math.min(Q,a+1),!!(Q%2)&&(l==="reverse"?(J=1-J,o&&(J-=o/T)):l==="mirror"&&(G=_)),H=ni(0,1,J)*T}const re=M?{done:!1,value:n[0]}:G.next(H);N&&(re.value=N(re.value));let{done:he}=re;!M&&P!==null&&(he=m>=0?L>=z:L<=0);const oe=A===null&&(b==="finished"||b==="running"&&he);return f&&f(re.value),oe&&q(),re},j=()=>{y&&y.stop(),y=void 0},U=()=>{b="idle",j(),p(),w(),D=V=null},q=()=>{b="finished",d&&d(),j(),p()},C=()=>{if(g)return;y||(y=r(ee));const F=y.now();c&&c(),A!==null?D=F-A:(!D||b==="finished")&&(D=F),b==="finished"&&w(),V=D,A=null,b="running",y.start()};e&&C();const R={then(F,E){return v.then(F,E)},get time(){return la(L)},set time(F){F=ei(F),L=F,A!==null||!y||m===0?A=F:D=y.now()-F/m},get duration(){const F=S.calculatedDuration===null?Sy(S):S.calculatedDuration;return la(F)},get speed(){return m},set speed(F){F===m||!y||(m=F,R.time=la(L))},get state(){return b},play:C,pause:()=>{b="paused",A=L},stop:()=>{g=!0,b!=="idle"&&(b="idle",u&&u(),U())},cancel:()=>{V!==null&&ee(V),U()},complete:()=>{b="finished"},sample:F=>(D=0,ee(F))};return R}function PF(e){let t;return()=>(t===void 0&&(t=e()),t)}const DF=PF(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),IF=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),vd=10,RF=2e4,LF=(e,t)=>t.type==="spring"||e==="backgroundColor"||!f_(t.ease);function OF(e,t,{onUpdate:r,onComplete:n,...s}){if(!(DF()&&IF.has(t)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(x=>{l=x})};d();let{keyframes:f,duration:h=300,ease:m,times:g}=s;if(LF(t,s)){const x=L0({...s,repeat:0,delay:0});let N={done:!1,value:f[0]};const S=[];let _=0;for(;!N.done&&_<RF;)N=x.sample(_),S.push(N.value),_+=vd;g=void 0,f=S,h=_-vd,m="linear"}const p=X6(e.owner.current,t,f,{...s,duration:h,ease:m,times:g}),v=()=>{u=!1,p.cancel()},w=()=>{u=!0,kt.update(v),l(),d()};return p.onfinish=()=>{u||(e.set(K6(f,s)),n&&n(),w())},{then(x,N){return c.then(x,N)},attachTimeline(x){return p.timeline=x,p.onfinish=null,Xt},get time(){return la(p.currentTime||0)},set time(x){p.currentTime=ei(x)},get speed(){return p.playbackRate},set speed(x){p.playbackRate=x},get duration(){return la(h)},play:()=>{o||(p.play(),va(v))},pause:()=>p.pause(),stop:()=>{if(o=!0,p.playState==="idle")return;const{currentTime:x}=p;if(x){const N=L0({...s,autoplay:!1});e.setWithVelocity(N.sample(x-vd).value,N.sample(x).value,vd)}w()},complete:()=>{u||p.finish()},cancel:w}}function MF({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const s=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:Xt,pause:Xt,stop:Xt,then:a=>(a(),Promise.resolve()),cancel:Xt,complete:Xt});return t?L0({keyframes:[0,1],duration:0,delay:t,onComplete:s}):s()}const BF={type:"spring",stiffness:500,damping:25,restSpeed:10},$F=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),UF={type:"keyframes",duration:.8},VF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},zF=(e,{keyframes:t})=>t.length>2?UF:fo.has(e)?e.startsWith("scale")?$F(t[1]):BF:VF,Np=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(si.test(t)||t==="0")&&!t.startsWith("url(")),WF=new Set(["brightness","contrast","saturate","opacity"]);function HF(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(Of)||[];if(!n)return e;const s=r.replace(n,"");let a=WF.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const GF=/([a-z-]*)\(.*?\)/g,kp={...si,getAnimatableNone:e=>{const t=e.match(GF);return t?t.map(HF).join(" "):e}},XF={...Yk,color:Zr,backgroundColor:Zr,outlineColor:Zr,fill:Zr,stroke:Zr,borderColor:Zr,borderTopColor:Zr,borderRightColor:Zr,borderBottomColor:Zr,borderLeftColor:Zr,filter:kp,WebkitFilter:kp},jg=e=>XF[e];function L_(e,t){let r=jg(e);return r!==kp&&(r=si),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const O_=e=>/^0[^.\s]+$/.test(e);function KF(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||O_(e)}function YF(e,t,r,n){const s=Np(t,r);let a;Array.isArray(r)?a=[...r]:a=[null,r];const o=n.from!==void 0?n.from:e.get();let l;const c=[];for(let u=0;u<a.length;u++)a[u]===null&&(a[u]=u===0?o:a[u-1]),KF(a[u])&&c.push(u),typeof a[u]=="string"&&a[u]!=="none"&&a[u]!=="0"&&(l=a[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];a[d]=L_(t,l)}return a}function qF({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function Cg(e,t){return e[t]||e.default||e}const JF={skipAnimations:!1},Eg=(e,t,r,n={})=>s=>{const a=Cg(n,e)||{},o=a.delay||n.delay||0;let{elapsed:l=0}=n;l=l-ei(o);const c=YF(t,e,r,a),u=c[0],d=c[c.length-1],f=Np(e,u),h=Np(e,d);let m={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...a,delay:-l,onUpdate:g=>{t.set(g),a.onUpdate&&a.onUpdate(g)},onComplete:()=>{s(),a.onComplete&&a.onComplete()}};if(qF(a)||(m={...m,...zF(e,m)}),m.duration&&(m.duration=ei(m.duration)),m.repeatDelay&&(m.repeatDelay=ei(m.repeatDelay)),!f||!h||G6.current||a.type===!1||JF.skipAnimations)return MF(m);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const g=OF(t,e,m);if(g)return g}return L0(m)};function O0(e){return!!(bn(e)&&e.add)}const M_=e=>/^\-?\d*\.?\d+$/.test(e);function Tg(e,t){e.indexOf(t)===-1&&e.push(t)}function Ag(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class Fg{constructor(){this.subscriptions=[]}add(t){return Tg(this.subscriptions,t),()=>Ag(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const o=this.subscriptions[a];o&&o(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ZF=e=>!isNaN(parseFloat(e));class QF{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,s=!0)=>{this.prev=this.current,this.current=n;const{delta:a,timestamp:o}=$r;this.lastUpdated!==o&&(this.timeDelta=a,this.lastUpdated=o,kt.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>kt.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=ZF(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Fg);const n=this.events[t].add(r);return t==="change"?()=>{n(),kt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?D_(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ml(e,t){return new QF(e,t)}const B_=e=>t=>t.test(e),eP={test:e=>e==="auto",parse:e=>e},$_=[ho,Ge,Us,Fa,o6,i6,eP],Ql=e=>$_.find(B_(e)),tP=[...$_,Zr,si],rP=e=>tP.find(B_(e));function nP(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,ml(r))}function sP(e,t){const r=Bf(e,t);let{transitionEnd:n={},transition:s={},...a}=r?e.makeTargetAnimatable(r,!1):{};a={...a,...n};for(const o in a){const l=b6(a[o]);nP(e,o,l)}}function aP(e,t,r){var n,s;const a=Object.keys(t).filter(l=>!e.hasValue(l)),o=a.length;if(o)for(let l=0;l<o;l++){const c=a[l],u=t[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&s!==void 0?s:t[c]),d!=null&&(typeof d=="string"&&(M_(d)||O_(d))?d=parseFloat(d):!rP(d)&&si.test(u)&&(d=L_(c,u)),e.addValue(c,ml(d,{owner:e})),r[c]===void 0&&(r[c]=d),d!==null&&e.setBaseTarget(c,d))}}function iP(e,t){return t?(t[e]||t.default||t).from:void 0}function oP(e,t,r){const n={};for(const s in e){const a=iP(s,t);if(a!==void 0)n[s]=a;else{const o=r.getValue(s);o&&(n[s]=o.get())}}return n}function lP({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function cP(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function U_(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:o,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(a=n);const u=[],d=s&&e.animationState&&e.animationState.getState()[s];for(const f in l){const h=e.getValue(f),m=l[f];if(!h||m===void 0||d&&lP(d,f))continue;const g={delay:r,elapsed:0,...Cg(a||{},f)};if(window.HandoffAppearAnimations){const w=e.getProps()[Vk];if(w){const y=window.HandoffAppearAnimations(w,f,h,kt);y!==null&&(g.elapsed=y,g.isHandoff=!0)}}let p=!g.isHandoff&&!cP(h,m);if(g.type==="spring"&&(h.getVelocity()||g.velocity)&&(p=!1),h.animation&&(p=!1),p)continue;h.start(Eg(f,h,m,e.shouldReduceMotion&&fo.has(f)?{type:!1}:g));const v=h.animation;O0(c)&&(c.add(f),v.then(()=>c.remove(f))),u.push(v)}return o&&Promise.all(u).then(()=>{o&&sP(e,o)}),u}function _p(e,t,r={}){const n=Bf(e,t,r.custom);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(U_(e,n,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=s;return uP(e,t,u+c,d,f,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>u())}else return Promise.all([a(),o(r.delay)])}function uP(e,t,r=0,n=0,s=1,a){const o=[],l=(e.variantChildren.size-1)*n,c=s===1?(u=0)=>u*n:(u=0)=>l-u*n;return Array.from(e.variantChildren).sort(dP).forEach((u,d)=>{u.notify("AnimationStart",t),o.push(_p(u,t,{...a,delay:r+c(d)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(o)}function dP(e,t){return e.sortNodePosition(t)}function fP(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>_p(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=_p(e,t,r);else{const s=typeof t=="function"?Bf(e,t,r.custom):t;n=Promise.all(U_(e,s,r))}return n.then(()=>e.notify("AnimationComplete",t))}const hP=[...fg].reverse(),mP=fg.length;function pP(e){return t=>Promise.all(t.map(({animation:r,options:n})=>fP(e,r,n)))}function xP(e){let t=pP(e);const r=vP();let n=!0;const s=(c,u)=>{const d=Bf(e,u);if(d){const{transition:f,transitionEnd:h,...m}=d;c={...c,...m,...h}}return c};function a(c){t=c(e)}function o(c,u){const d=e.getProps(),f=e.getVariantContext(!0)||{},h=[],m=new Set;let g={},p=1/0;for(let w=0;w<mP;w++){const y=hP[w],x=r[y],N=d[y]!==void 0?d[y]:f[y],S=tu(N),_=y===u?x.isActive:null;_===!1&&(p=w);let b=N===f[y]&&N!==d[y]&&S;if(b&&n&&e.manuallyAnimateOnMount&&(b=!1),x.protectedKeys={...g},!x.isActive&&_===null||!N&&!x.prevProp||Rf(N)||typeof N=="boolean")continue;let D=gP(x.prevProp,N)||y===u&&x.isActive&&!b&&S||w>p&&S,V=!1;const P=Array.isArray(N)?N:[N];let T=P.reduce(s,{});_===!1&&(T={});const{prevResolvedValues:z={}}=x,L={...z,...T},ee=j=>{D=!0,m.has(j)&&(V=!0,m.delete(j)),x.needsAnimating[j]=!0};for(const j in L){const U=T[j],q=z[j];if(g.hasOwnProperty(j))continue;let C=!1;D0(U)&&D0(q)?C=!u_(U,q):C=U!==q,C?U!==void 0?ee(j):m.add(j):U!==void 0&&m.has(j)?ee(j):x.protectedKeys[j]=!0}x.prevProp=N,x.prevResolvedValues=T,x.isActive&&(g={...g,...T}),n&&e.blockInitialAnimation&&(D=!1),D&&(!b||V)&&h.push(...P.map(j=>({animation:j,options:{type:y,...c}})))}if(m.size){const w={};m.forEach(y=>{const x=e.getBaseTarget(y);x!==void 0&&(w[y]=x)}),h.push({animation:w})}let v=!!h.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(v=!1),n=!1,v?t(h):Promise.resolve()}function l(c,u,d){var f;if(r[c].isActive===u)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),r[c].isActive=u;const h=o(d,c);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>r}}function gP(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!u_(t,e):!1}function wi(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function vP(){return{animate:wi(!0),whileInView:wi(),whileHover:wi(),whileTap:wi(),whileDrag:wi(),whileFocus:wi(),exit:wi()}}class yP extends mi{constructor(t){super(t),t.animationState||(t.animationState=xP(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),Rf(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let wP=0;class bP extends mi{constructor(){super(...arguments),this.id=wP++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const a=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&a.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const NP={animation:{Feature:yP},exit:{Feature:bP}},jy=(e,t)=>Math.abs(e-t);function kP(e,t){const r=jy(e.x,t.x),n=jy(e.y,t.y);return Math.sqrt(r**2+n**2)}class V_{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Kh(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=kP(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:g}=f,{timestamp:p}=$r;this.history.push({...g,timestamp:p});const{onStart:v,onMove:w}=this.handlers;h||(v&&v(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Xh(h,this.transformPagePoint),kt.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:p}=this.handlers;if(this.dragSnapToOrigin&&p&&p(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=Kh(f.type==="pointercancel"?this.lastMoveEventInfo:Xh(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,v),g&&g(f,v)},!a_(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const o=Mf(t),l=Xh(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=$r;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(t,Kh(l,this.history)),this.removeListeners=Qa(oa(this.contextWindow,"pointermove",this.handlePointerMove),oa(this.contextWindow,"pointerup",this.handlePointerUp),oa(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),va(this.updatePoint)}}function Xh(e,t){return t?{point:t(e.point)}:e}function Cy(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Kh({point:e},t){return{point:e,delta:Cy(e,z_(t)),offset:Cy(e,_P(t)),velocity:SP(t,.1)}}function _P(e){return e[0]}function z_(e){return e[e.length-1]}function SP(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=z_(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>ei(t)));)r--;if(!n)return{x:0,y:0};const a=la(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const o={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Rn(e){return e.max-e.min}function Sp(e,t=0,r=.01){return Math.abs(e-t)<=r}function Ey(e,t,r,n=.5){e.origin=n,e.originPoint=Mt(t.min,t.max,e.origin),e.scale=Rn(r)/Rn(t),(Sp(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Mt(r.min,r.max,e.origin)-e.originPoint,(Sp(e.translate)||isNaN(e.translate))&&(e.translate=0)}function jc(e,t,r,n){Ey(e.x,t.x,r.x,n?n.originX:void 0),Ey(e.y,t.y,r.y,n?n.originY:void 0)}function Ty(e,t,r){e.min=r.min+t.min,e.max=e.min+Rn(t)}function jP(e,t,r){Ty(e.x,t.x,r.x),Ty(e.y,t.y,r.y)}function Ay(e,t,r){e.min=t.min-r.min,e.max=e.min+Rn(t)}function Cc(e,t,r){Ay(e.x,t.x,r.x),Ay(e.y,t.y,r.y)}function CP(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Mt(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Mt(r,e,n.max):Math.min(e,r)),e}function Fy(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function EP(e,{top:t,left:r,bottom:n,right:s}){return{x:Fy(e.x,r,s),y:Fy(e.y,t,n)}}function Py(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function TP(e,t){return{x:Py(e.x,t.x),y:Py(e.y,t.y)}}function AP(e,t){let r=.5;const n=Rn(e),s=Rn(t);return s>n?r=nu(t.min,t.max-n,e.min):n>s&&(r=nu(e.min,e.max-s,t.min)),ni(0,1,r)}function FP(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const jp=.35;function PP(e=jp){return e===!1?e=0:e===!0&&(e=jp),{x:Dy(e,"left","right"),y:Dy(e,"top","bottom")}}function Dy(e,t,r){return{min:Iy(e,t),max:Iy(e,r)}}function Iy(e,t){return typeof e=="number"?e:e[t]||0}const Ry=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ho=()=>({x:Ry(),y:Ry()}),Ly=()=>({min:0,max:0}),ir=()=>({x:Ly(),y:Ly()});function Xn(e){return[e("x"),e("y")]}function W_({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function DP({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function IP(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function Yh(e){return e===void 0||e===1}function Cp({scale:e,scaleX:t,scaleY:r}){return!Yh(e)||!Yh(t)||!Yh(r)}function Si(e){return Cp(e)||H_(e)||e.z||e.rotate||e.rotateX||e.rotateY}function H_(e){return Oy(e.x)||Oy(e.y)}function Oy(e){return e&&e!=="0%"}function M0(e,t,r){const n=e-r,s=t*n;return r+s}function My(e,t,r,n,s){return s!==void 0&&(e=M0(e,s,n)),M0(e,r,n)+t}function Ep(e,t=0,r=1,n,s){e.min=My(e.min,t,r,n,s),e.max=My(e.max,t,r,n,s)}function G_(e,{x:t,y:r}){Ep(e.x,t.translate,t.scale,t.originPoint),Ep(e.y,r.translate,r.scale,r.originPoint)}function RP(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,o;for(let l=0;l<s;l++){a=r[l],o=a.projectionDelta;const c=a.instance;c&&c.style&&c.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Go(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,G_(e,o)),n&&Si(a.latestValues)&&Go(e,a.latestValues))}t.x=By(t.x),t.y=By(t.y)}function By(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Ia(e,t){e.min=e.min+t,e.max=e.max+t}function $y(e,t,[r,n,s]){const a=t[s]!==void 0?t[s]:.5,o=Mt(e.min,e.max,a);Ep(e,t[r],t[n],o,t.scale)}const LP=["x","scaleX","originX"],OP=["y","scaleY","originY"];function Go(e,t){$y(e.x,t,LP),$y(e.y,t,OP)}function X_(e,t){return W_(IP(e.getBoundingClientRect(),t))}function MP(e,t,r){const n=X_(e,r),{scroll:s}=t;return s&&(Ia(n.x,s.offset.x),Ia(n.y,s.offset.y)),n}const K_=({current:e})=>e?e.ownerDocument.defaultView:null,BP=new WeakMap;class $P{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ir(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Mf(d,"page").point)},a=(d,f)=>{const{drag:h,dragPropagation:m,onDragStart:g}=this.getProps();if(h&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=o_(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xn(v=>{let w=this.getAxisMotionValue(v).get()||0;if(Us.test(w)){const{projection:y}=this.visualElement;if(y&&y.layout){const x=y.layout.layoutBox[v];x&&(w=Rn(x)*(parseFloat(w)/100))}}this.originPoint[v]=w}),g&&kt.update(()=>g(d,f),!1,!0);const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},o=(d,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:g,onDrag:p}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:v}=f;if(m&&this.currentDirection===null){this.currentDirection=UP(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),p&&p(d,f)},l=(d,f)=>this.stop(d,f),c=()=>Xn(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new V_(t,{onSessionStart:s,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:K_(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:a}=this.getProps();a&&kt.update(()=>a(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!yd(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let o=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(o=CP(o,this.constraints[t],this.elastic[t])),a.set(o)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,a=this.constraints;r&&zo(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=EP(s.layoutBox,r):this.constraints=!1,this.elastic=PP(n),a!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Xn(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=FP(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!zo(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=MP(n,s.root,this.visualElement.getTransformPagePoint());let o=TP(s.layout.layoutBox,a);if(r){const l=r(DP(o));this.hasMutatedConstraints=!!l,l&&(o=W_(l))}return o}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Xn(d=>{if(!yd(d,r,this.currentDirection))return;let f=c&&c[d]||{};o&&(f={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:n?t[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(Eg(t,n,0,r))}stopAnimation(){Xn(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Xn(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Xn(r=>{const{drag:n}=this.getProps();if(!yd(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[r];a.set(t[r]-Mt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!zo(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Xn(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=AP({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Xn(o=>{if(!yd(o,t,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(Mt(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;BP.set(this.visualElement,this);const t=this.visualElement.current,r=oa(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();zo(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),n();const o=ta(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Xn(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),r(),a(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:o=jp,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function yd(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function UP(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class VP extends mi{constructor(t){super(t),this.removeGroupControls=Xt,this.removeListeners=Xt,this.controls=new $P(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Xt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Uy=e=>(t,r)=>{e&&kt.update(()=>e(t,r))};class zP extends mi{constructor(){super(...arguments),this.removePointerDownListener=Xt}onPointerDown(t){this.session=new V_(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:K_(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:Uy(t),onStart:Uy(r),onMove:n,onEnd:(a,o)=>{delete this.session,s&&kt.update(()=>s(a,o))}}}mount(){this.removePointerDownListener=oa(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function WP(){const e=k.useContext(Df);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,s=k.useId();return k.useEffect(()=>n(s),[]),!t&&r?[!1,()=>r&&r(s)]:[!0]}const Zd={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Vy(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ec={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ge.test(e))e=parseFloat(e);else return e;const r=Vy(e,t.target.x),n=Vy(e,t.target.y);return`${r}% ${n}%`}},HP={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=si.parse(e);if(s.length>5)return n;const a=si.createTransformer(e),o=typeof s[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;s[0+o]/=l,s[1+o]/=c;const u=Mt(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),a(s)}};class GP extends wt.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;Q5(XP),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Zd.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,o=n.projection;return o&&(o.isPresent=a,s||t.layoutDependency!==r||r===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?o.promote():o.relegate()||kt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Y_(e){const[t,r]=WP(),n=k.useContext(mg);return wt.createElement(GP,{...e,layoutGroup:n,switchLayoutGroup:k.useContext(Wk),isPresent:t,safeToRemove:r})}const XP={borderRadius:{...ec,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ec,borderTopRightRadius:ec,borderBottomLeftRadius:ec,borderBottomRightRadius:ec,boxShadow:HP},q_=["TopLeft","TopRight","BottomLeft","BottomRight"],KP=q_.length,zy=e=>typeof e=="string"?parseFloat(e):e,Wy=e=>typeof e=="number"||Ge.test(e);function YP(e,t,r,n,s,a){s?(e.opacity=Mt(0,r.opacity!==void 0?r.opacity:1,qP(n)),e.opacityExit=Mt(t.opacity!==void 0?t.opacity:1,0,JP(n))):a&&(e.opacity=Mt(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let o=0;o<KP;o++){const l=`border${q_[o]}Radius`;let c=Hy(t,l),u=Hy(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||Wy(c)===Wy(u)?(e[l]=Math.max(Mt(zy(c),zy(u),n),0),(Us.test(u)||Us.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||r.rotate)&&(e.rotate=Mt(t.rotate||0,r.rotate||0,n))}function Hy(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const qP=J_(0,.5,y_),JP=J_(.5,.95,Xt);function J_(e,t,r){return n=>n<e?0:n>t?1:r(nu(e,t,n))}function Gy(e,t){e.min=t.min,e.max=t.max}function Vn(e,t){Gy(e.x,t.x),Gy(e.y,t.y)}function Xy(e,t,r,n,s){return e-=t,e=M0(e,1/r,n),s!==void 0&&(e=M0(e,1/s,n)),e}function ZP(e,t=0,r=1,n=.5,s,a=e,o=e){if(Us.test(t)&&(t=parseFloat(t),t=Mt(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=Mt(a.min,a.max,n);e===a&&(l-=t),e.min=Xy(e.min,t,r,l,s),e.max=Xy(e.max,t,r,l,s)}function Ky(e,t,[r,n,s],a,o){ZP(e,t[r],t[n],t[s],t.scale,a,o)}const QP=["x","scaleX","originX"],eD=["y","scaleY","originY"];function Yy(e,t,r,n){Ky(e.x,t,QP,r?r.x:void 0,n?n.x:void 0),Ky(e.y,t,eD,r?r.y:void 0,n?n.y:void 0)}function qy(e){return e.translate===0&&e.scale===1}function Z_(e){return qy(e.x)&&qy(e.y)}function tD(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function Q_(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function Jy(e){return Rn(e.x)/Rn(e.y)}class rD{constructor(){this.members=[]}add(t){Tg(this.members,t),t.scheduleRender()}remove(t){if(Ag(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Zy(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y;if((s||a)&&(n=`translate3d(${s}px, ${a}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:u,rotateY:d}=r;c&&(n+=`rotate(${c}deg) `),u&&(n+=`rotateX(${u}deg) `),d&&(n+=`rotateY(${d}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const nD=(e,t)=>e.depth-t.depth;class sD{constructor(){this.children=[],this.isDirty=!1}add(t){Tg(this.children,t),this.isDirty=!0}remove(t){Ag(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(nD),this.isDirty=!1,this.children.forEach(t)}}function aD(e,t){const r=performance.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(va(n),e(a-t))};return kt.read(n,!0),()=>va(n)}function iD(e){window.MotionDebug&&window.MotionDebug.record(e)}function oD(e){return e instanceof SVGElement&&e.tagName!=="svg"}function lD(e,t,r){const n=bn(e)?e:ml(e);return n.start(Eg("",n,t,r)),n.animation}const Qy=["","X","Y","Z"],cD={visibility:"hidden"},ew=1e3;let uD=0;const ji={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function e4({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},l=t==null?void 0:t()){this.id=uD++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ji.totalNodes=ji.resolvedTargetDeltas=ji.recalculatedProjection=0,this.nodes.forEach(hD),this.nodes.forEach(vD),this.nodes.forEach(yD),this.nodes.forEach(mD),iD(ji)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new sD)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Fg),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=oD(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),e){let f;const h=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=aD(h,250),Zd.hasAnimatedSinceResize&&(Zd.hasAnimatedSinceResize=!1,this.nodes.forEach(rw))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||d.getDefaultTransition()||_D,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=d.getProps(),y=!this.targetLayout||!Q_(this.targetLayout,g)||m,x=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||h&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,x);const N={...Cg(p,"layout"),onPlay:v,onComplete:w};(d.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N)}else h||rw(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,va(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(wD),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(tw);return}this.isUpdating||this.nodes.forEach(xD),this.isUpdating=!1,this.nodes.forEach(gD),this.nodes.forEach(dD),this.nodes.forEach(fD),this.clearAllSnapshots();const l=performance.now();$r.delta=ni(0,1e3/60,l-$r.timestamp),$r.timestamp=l,$r.isProcessing=!0,Bh.update.process($r),Bh.preRender.process($r),Bh.render.process($r),$r.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(pD),this.sharedNodes.forEach(bD)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,kt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){kt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ir(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!Z_(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||Si(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),SD(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return ir();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(Ia(l.x,c.offset.x),Ia(l.y,c.offset.y)),l}removeElementScroll(o){const l=ir();Vn(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:f}=u;if(u!==this.root&&d&&f.layoutScroll){if(d.isRoot){Vn(l,o);const{scroll:h}=this.root;h&&(Ia(l.x,-h.offset.x),Ia(l.y,-h.offset.y))}Ia(l.x,d.offset.x),Ia(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=ir();Vn(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Go(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Si(d.latestValues)&&Go(c,d.latestValues)}return Si(this.latestValues)&&Go(c,this.latestValues),c}removeTransform(o){const l=ir();Vn(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Si(u.latestValues))continue;Cp(u.latestValues)&&u.updateSnapshot();const d=ir(),f=u.measurePageBox();Vn(d,f),Yy(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Si(this.latestValues)&&Yy(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==$r.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=$r.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ir(),this.relativeTargetOrigin=ir(),Cc(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Vn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ir(),this.targetWithTransforms=ir()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),jP(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Vn(this.target,this.layout.layoutBox),G_(this.target,this.targetDelta)):Vn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ir(),this.relativeTargetOrigin=ir(),Cc(this.relativeTargetOrigin,this.target,m.target),Vn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ji.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Cp(this.parent.latestValues)||H_(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===$r.timestamp&&(u=!1),u)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;Vn(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;RP(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=Ho(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Ho(),this.projectionDeltaWithTransform=Ho());const p=this.projectionTransform;jc(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=Zy(this.projectionDelta,this.treeScale),(this.projectionTransform!==p||this.treeScale.x!==h||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),ji.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Ho();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=ir(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,p=m!==g,v=this.getStack(),w=!v||v.members.length<=1,y=!!(p&&!w&&this.options.crossfade===!0&&!this.path.some(kD));this.animationProgress=0;let x;this.mixTargetDelta=N=>{const S=N/1e3;nw(f.x,o.x,S),nw(f.y,o.y,S),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Cc(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ND(this.relativeTarget,this.relativeTargetOrigin,h,S),x&&tD(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=ir()),Vn(x,this.relativeTarget)),p&&(this.animationValues=d,YP(d,u,this.latestValues,S,y,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(va(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=kt.update(()=>{Zd.hasAnimatedSinceResize=!0,this.currentAnimation=lD(0,ew,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ew),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&t4(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||ir();const f=Rn(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+f;const h=Rn(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+h}Vn(l,c),Go(l,d),jc(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new rD),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<Qy.length;d++){const f="rotate"+Qy[d];c[f]&&(u[f]=c[f],o.setStaticValue(f,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return cD;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Jd(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const p={};return this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=Jd(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Si(this.latestValues)&&(p.transform=d?d({},""):"none",this.hasProjected=!1),p}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=Zy(this.projectionDeltaWithTransform,this.treeScale,h),d&&(u.transform=d(h,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,f.animationValues?u.opacity=f===this?(c=(l=h.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const p in F0){if(h[p]===void 0)continue;const{correct:v,applyTo:w}=F0[p],y=u.transform==="none"?h[p]:v(h[p],f);if(w){const x=w.length;for(let N=0;N<x;N++)u[w[N]]=y}else u[p]=y}return this.options.layoutId&&(u.pointerEvents=f===this?Jd(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(tw),this.root.sharedNodes.clear()}}}function dD(e){e.updateLayout()}function fD(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:a}=e.options,o=r.source!==e.layout.source;a==="size"?Xn(f=>{const h=o?r.measuredBox[f]:r.layoutBox[f],m=Rn(h);h.min=n[f].min,h.max=h.min+m}):t4(a,r.layoutBox,n)&&Xn(f=>{const h=o?r.measuredBox[f]:r.layoutBox[f],m=Rn(n[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const l=Ho();jc(l,n,r.layoutBox);const c=Ho();o?jc(c,e.applyTransform(s,!0),r.measuredBox):jc(c,n,r.layoutBox);const u=!Z_(l);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const g=ir();Cc(g,r.layoutBox,h.layoutBox);const p=ir();Cc(p,n,m.layoutBox),Q_(g,p)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=g,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function hD(e){ji.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function mD(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function pD(e){e.clearSnapshot()}function tw(e){e.clearMeasurements()}function xD(e){e.isLayoutDirty=!1}function gD(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function rw(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function vD(e){e.resolveTargetDelta()}function yD(e){e.calcProjection()}function wD(e){e.resetRotation()}function bD(e){e.removeLeadSnapshot()}function nw(e,t,r){e.translate=Mt(t.translate,0,r),e.scale=Mt(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function sw(e,t,r,n){e.min=Mt(t.min,r.min,n),e.max=Mt(t.max,r.max,n)}function ND(e,t,r,n){sw(e.x,t.x,r.x,n),sw(e.y,t.y,r.y,n)}function kD(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const _D={duration:.45,ease:[.4,0,.1,1]},aw=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),iw=aw("applewebkit/")&&!aw("chrome/")?Math.round:Xt;function ow(e){e.min=iw(e.min),e.max=iw(e.max)}function SD(e){ow(e.x),ow(e.y)}function t4(e,t,r){return e==="position"||e==="preserve-aspect"&&!Sp(Jy(t),Jy(r),.2)}const jD=e4({attachResizeListener:(e,t)=>ta(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),qh={current:void 0},r4=e4({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!qh.current){const e=new jD({});e.mount(window),e.setOptions({layoutScroll:!0}),qh.current=e}return qh.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),CD={pan:{Feature:zP},drag:{Feature:VP,ProjectionNode:r4,MeasureLayout:Y_}},ED=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function TD(e){const t=ED.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function Tp(e,t,r=1){const[n,s]=TD(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const o=a.trim();return M_(o)?parseFloat(o):o}else return vp(s)?Tp(s,t,r+1):s}function AD(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(s=>{const a=s.get();if(!vp(a))return;const o=Tp(a,n);o&&s.set(o)});for(const s in t){const a=t[s];if(!vp(a))continue;const o=Tp(a,n);o&&(t[s]=o,r||(r={}),r[s]===void 0&&(r[s]=a))}return{target:t,transitionEnd:r}}const FD=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),n4=e=>FD.has(e),PD=e=>Object.keys(e).some(n4),lw=e=>e===ho||e===Ge,cw=(e,t)=>parseFloat(e.split(", ")[t]),uw=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/);if(s)return cw(s[1],t);{const a=n.match(/^matrix\((.+)\)$/);return a?cw(a[1],e):0}},DD=new Set(["x","y","z"]),ID=Eu.filter(e=>!DD.has(e));function RD(e){const t=[];return ID.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const pl={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:uw(4,13),y:uw(5,14)};pl.translateX=pl.x;pl.translateY=pl.y;const LD=(e,t,r)=>{const n=t.measureViewportBox(),s=t.current,a=getComputedStyle(s),{display:o}=a,l={};o==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(u=>{l[u]=pl[u](n,a)}),t.render();const c=t.measureViewportBox();return r.forEach(u=>{const d=t.getValue(u);d&&d.jump(l[u]),e[u]=pl[u](c,a)}),e},OD=(e,t,r={},n={})=>{t={...t},n={...n};const s=Object.keys(t).filter(n4);let a=[],o=!1;const l=[];if(s.forEach(c=>{const u=e.getValue(c);if(!e.hasValue(c))return;let d=r[c],f=Ql(d);const h=t[c];let m;if(D0(h)){const g=h.length,p=h[0]===null?1:0;d=h[p],f=Ql(d);for(let v=p;v<g&&h[v]!==null;v++)m?Ng(Ql(h[v])===m):m=Ql(h[v])}else m=Ql(h);if(f!==m)if(lw(f)&&lw(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof h=="string"?t[c]=parseFloat(h):Array.isArray(h)&&m===Ge&&(t[c]=h.map(parseFloat))}else f!=null&&f.transform&&(m!=null&&m.transform)&&(d===0||h===0)?d===0?u.set(m.transform(d)):t[c]=f.transform(h):(o||(a=RD(e),o=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],u.jump(h))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=LD(t,e,l);return a.length&&a.forEach(([d,f])=>{e.getValue(d).set(f)}),e.render(),If&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:n}}else return{target:t,transitionEnd:n}};function MD(e,t,r,n){return PD(t)?OD(e,t,r,n):{target:t,transitionEnd:n}}const BD=(e,t,r,n)=>{const s=AD(e,t,n);return t=s.target,n=s.transitionEnd,MD(e,t,r,n)},Ap={current:null},s4={current:!1};function $D(){if(s4.current=!0,!!If)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Ap.current=e.matches;e.addListener(t),t()}else Ap.current=!1}function UD(e,t,r){const{willChange:n}=t;for(const s in t){const a=t[s],o=r[s];if(bn(a))e.addValue(s,a),O0(n)&&n.add(s);else if(bn(o))e.addValue(s,ml(a,{owner:e})),O0(n)&&n.remove(s);else if(o!==a)if(e.hasValue(s)){const l=e.getValue(s);!l.hasAnimated&&l.set(a)}else{const l=e.getStaticValue(s);e.addValue(s,ml(l!==void 0?l:a,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const dw=new WeakMap,a4=Object.keys(ru),VD=a4.length,fw=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],zD=hg.length;class WD{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>kt.render(this.render,!1,!0);const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=Lf(r),this.isVariantNode=zk(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(r,{});for(const f in d){const h=d[f];l[f]!==void 0&&bn(h)&&(h.set(l[f],!1),O0(u)&&u.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,dw.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),s4.current||$D(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ap.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){dw.delete(this.current),this.projection&&this.projection.unmount(),va(this.notifyUpdate),va(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=fo.has(t),s=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&kt.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),a=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{s(),a()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,s,a){let o,l;for(let c=0;c<VD;c++){const u=a4[c],{isEnabled:d,Feature:f,ProjectionNode:h,MeasureLayout:m}=ru[u];h&&(o=h),d(r)&&(!this.features[u]&&f&&(this.features[u]=new f(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:f,layoutScroll:h,layoutRoot:m}=r;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||f&&zo(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:a,layoutScroll:h,layoutRoot:m})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ir()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<fw.length;n++){const s=fw[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a=t["on"+s];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=UD(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<zD;n++){const s=hg[n],a=this.props[s];(tu(a)||a===!1)&&(r[s]=a)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=ml(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,s=typeof n=="string"||typeof n=="object"?(r=bg(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&s!==void 0)return s;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!bn(a)?a:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Fg),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class i4 extends WD{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:s},a){let o=oP(n,t||{},this);if(s&&(r&&(r=s(r)),n&&(n=s(n)),o&&(o=s(o))),a){aP(this,n,o);const l=BD(this,n,o,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function HD(e){return window.getComputedStyle(e)}class GD extends i4{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(fo.has(r)){const n=jg(r);return n&&n.default||0}else{const n=HD(t),s=(Xk(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return X_(t,r)}build(t,r,n,s){xg(t,r,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,r){return wg(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;bn(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,s){Qk(t,r,n,s)}}class XD extends i4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(fo.has(r)){const n=jg(r);return n&&n.default||0}return r=e_.has(r)?r:dg(r),t.getAttribute(r)}measureInstanceViewportBox(){return ir()}scrapeMotionValuesFromProps(t,r){return r_(t,r)}build(t,r,n,s){vg(t,r,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,r,n,s){t_(t,r,n,s)}mount(t){this.isSVGTag=yg(t.tagName),super.mount(t)}}const KD=(e,t)=>pg(e)?new XD(t,{enableHardwareAcceleration:!1}):new GD(t,{enableHardwareAcceleration:!0}),YD={layout:{ProjectionNode:r4,MeasureLayout:Y_}},qD={...NP,...V6,...CD,...YD},$e=J5((e,t)=>T6(e,t,qD,KD));function o4(){const e=k.useRef(!1);return ug(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function JD(){const e=o4(),[t,r]=k.useState(0),n=k.useCallback(()=>{e.current&&r(t+1)},[t]);return[k.useCallback(()=>kt.postRender(n),[n]),t]}class ZD extends k.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function QD({children:e,isPresent:t}){const r=k.useId(),n=k.useRef(null),s=k.useRef({width:0,height:0,top:0,left:0});return k.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=s.current;if(t||!n.current||!a||!o)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),k.createElement(ZD,{isPresent:t,childRef:n,sizeRef:s},k.cloneElement(e,{ref:n}))}const Jh=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:o})=>{const l=n_(e8),c=k.useId(),u=k.useMemo(()=>({id:c,initial:t,isPresent:r,custom:s,onExitComplete:d=>{l.set(d,!0);for(const f of l.values())if(!f)return;n&&n()},register:d=>(l.set(d,!1),()=>l.delete(d))}),a?void 0:[r]);return k.useMemo(()=>{l.forEach((d,f)=>l.set(f,!1))},[r]),k.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),o==="popLayout"&&(e=k.createElement(QD,{isPresent:r},e)),k.createElement(Df.Provider,{value:u},e)};function e8(){return new Map}function t8(e){return k.useEffect(()=>()=>e(),[])}const Ci=e=>e.key||"";function r8(e,t){e.forEach(r=>{const n=Ci(r);t.set(n,r)})}function n8(e){const t=[];return k.Children.forEach(e,r=>{k.isValidElement(r)&&t.push(r)}),t}const Ec=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:s,presenceAffectsLayout:a=!0,mode:o="sync"})=>{const l=k.useContext(mg).forceRender||JD()[0],c=o4(),u=n8(e);let d=u;const f=k.useRef(new Map).current,h=k.useRef(d),m=k.useRef(new Map).current,g=k.useRef(!0);if(ug(()=>{g.current=!1,r8(u,m),h.current=d}),t8(()=>{g.current=!0,m.clear(),f.clear()}),g.current)return k.createElement(k.Fragment,null,d.map(y=>k.createElement(Jh,{key:Ci(y),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:a,mode:o},y)));d=[...d];const p=h.current.map(Ci),v=u.map(Ci),w=p.length;for(let y=0;y<w;y++){const x=p[y];v.indexOf(x)===-1&&!f.has(x)&&f.set(x,void 0)}return o==="wait"&&f.size&&(d=[]),f.forEach((y,x)=>{if(v.indexOf(x)!==-1)return;const N=m.get(x);if(!N)return;const S=p.indexOf(x);let _=y;if(!_){const b=()=>{f.delete(x);const A=Array.from(m.keys()).filter(D=>!v.includes(D));if(A.forEach(D=>m.delete(D)),h.current=u.filter(D=>{const V=Ci(D);return V===x||A.includes(V)}),!f.size){if(c.current===!1)return;l(),n&&n()}};_=k.createElement(Jh,{key:Ci(N),isPresent:!1,onExitComplete:b,custom:t,presenceAffectsLayout:a,mode:o},N),f.set(x,_)}d.splice(S,0,_)}),d=d.map(y=>{const x=y.key;return f.has(x)?y:k.createElement(Jh,{key:Ci(y),isPresent:!0,presenceAffectsLayout:a,mode:o},y)}),k.createElement(k.Fragment,null,f.size?d:d.map(y=>k.cloneElement(y)))};function l4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=l4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function c4(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=l4(e))&&(n&&(n+=" "),n+=t);return n}function s8(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=u4(t))&&(n&&(n+=" "),n+=r);return n}function u4(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=u4(e[n]))&&(r&&(r+=" "),r+=t);return r}var Pg="-";function a8(e){var t=o8(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,s=n===void 0?{}:n;function a(l){var c=l.split(Pg);return c[0]===""&&c.length!==1&&c.shift(),d4(c,t)||i8(l)}function o(l,c){var u=r[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:a,getConflictingClassGroupIds:o}}function d4(e,t){var o;if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),s=n?d4(e.slice(1),n):void 0;if(s)return s;if(t.validators.length!==0){var a=e.join(Pg);return(o=t.validators.find(function(l){var c=l.validator;return c(a)}))==null?void 0:o.classGroupId}}var hw=/^\[(.+)\]$/;function i8(e){if(hw.test(e)){var t=hw.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function o8(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},s=c8(Object.entries(e.classGroups),r);return s.forEach(function(a){var o=a[0],l=a[1];Fp(l,n,o,t)}),n}function Fp(e,t,r,n){e.forEach(function(s){if(typeof s=="string"){var a=s===""?t:mw(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(l8(s)){Fp(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];Fp(c,mw(t,l),r,n)})})}function mw(e,t){var r=e;return t.split(Pg).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function l8(e){return e.isThemeGetter}function c8(e,t){return t?e.map(function(r){var n=r[0],s=r[1],a=s.map(function(o){return typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[t+c,u]})):o});return[n,a]}):e}function u8(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function s(a,o){r.set(a,o),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(o){var l=r.get(o);if(l!==void 0)return l;if((l=n.get(o))!==void 0)return s(o,l),l},set:function(o,l){r.has(o)?r.set(o,l):s(o,l)}}}var f4="!";function d8(e){var t=e.separator||":",r=t.length===1,n=t[0],s=t.length;return function(o){for(var l=[],c=0,u=0,d,f=0;f<o.length;f++){var h=o[f];if(c===0){if(h===n&&(r||o.slice(f,f+s)===t)){l.push(o.slice(u,f)),u=f+s;continue}if(h==="/"){d=f;continue}}h==="["?c++:h==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(f4),p=g?m.substring(1):m,v=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:p,maybePostfixModifierPosition:v}}}function f8(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var s=n[0]==="[";s?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function h8(e){return{cache:u8(e.cacheSize),splitModifiers:d8(e),...a8(e)}}var m8=/\s+/;function p8(e,t){var r=t.splitModifiers,n=t.getClassGroupId,s=t.getConflictingClassGroupIds,a=new Set;return e.trim().split(m8).map(function(o){var l=r(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,f=l.maybePostfixModifierPosition,h=n(f?d.substring(0,f):d),m=!!f;if(!h){if(!f)return{isTailwindClass:!1,originalClassName:o};if(h=n(d),!h)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=f8(c).join(":"),p=u?g+f4:g;return{isTailwindClass:!0,modifierId:p,classGroupId:h,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return a.has(d)?!1:(a.add(d),s(c,u).forEach(function(f){return a.add(l+f)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function x8(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,s,a,o=l;function l(u){var d=t[0],f=t.slice(1),h=f.reduce(function(m,g){return g(m)},d());return n=h8(h),s=n.cache.get,a=n.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var f=p8(u,n);return a(u,f),f}return function(){return o(s8.apply(null,arguments))}}function jt(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var h4=/^\[(?:([a-z-]+):)?(.+)\]$/i,g8=/^\d+\/\d+$/,v8=new Set(["px","full","screen"]),y8=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,w8=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,b8=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function ds(e){return Ii(e)||v8.has(e)||g8.test(e)||Pp(e)}function Pp(e){return mo(e,"length",C8)}function N8(e){return mo(e,"size",m4)}function k8(e){return mo(e,"position",m4)}function _8(e){return mo(e,"url",E8)}function wd(e){return mo(e,"number",Ii)}function Ii(e){return!Number.isNaN(Number(e))}function S8(e){return e.endsWith("%")&&Ii(e.slice(0,-1))}function tc(e){return pw(e)||mo(e,"number",pw)}function at(e){return h4.test(e)}function rc(){return!0}function Ea(e){return y8.test(e)}function j8(e){return mo(e,"",T8)}function mo(e,t,r){var n=h4.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function C8(e){return w8.test(e)}function m4(){return!1}function E8(e){return e.startsWith("url(")}function pw(e){return Number.isInteger(Number(e))}function T8(e){return b8.test(e)}function A8(){var e=jt("colors"),t=jt("spacing"),r=jt("blur"),n=jt("brightness"),s=jt("borderColor"),a=jt("borderRadius"),o=jt("borderSpacing"),l=jt("borderWidth"),c=jt("contrast"),u=jt("grayscale"),d=jt("hueRotate"),f=jt("invert"),h=jt("gap"),m=jt("gradientColorStops"),g=jt("gradientColorStopPositions"),p=jt("inset"),v=jt("margin"),w=jt("opacity"),y=jt("padding"),x=jt("saturate"),N=jt("scale"),S=jt("sepia"),_=jt("skew"),b=jt("space"),A=jt("translate"),D=function(){return["auto","contain","none"]},V=function(){return["auto","hidden","clip","visible","scroll"]},P=function(){return["auto",at,t]},T=function(){return[at,t]},z=function(){return["",ds]},L=function(){return["auto",Ii,at]},ee=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},j=function(){return["solid","dashed","dotted","double","none"]},U=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},q=function(){return["start","end","center","between","around","evenly","stretch"]},C=function(){return["","0",at]},R=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},F=function(){return[Ii,wd]},E=function(){return[Ii,at]};return{cacheSize:500,theme:{colors:[rc],spacing:[ds],blur:["none","",Ea,at],brightness:F(),borderColor:[e],borderRadius:["none","","full",Ea,at],borderSpacing:T(),borderWidth:z(),contrast:F(),grayscale:C(),hueRotate:E(),invert:C(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[S8,Pp],inset:P(),margin:P(),opacity:F(),padding:T(),saturate:F(),scale:F(),sepia:C(),skew:E(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",at]}],container:["container"],columns:[{columns:[Ea]}],"break-after":[{"break-after":R()}],"break-before":[{"break-before":R()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(ee(),[at])}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",tc]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",at]}],grow:[{grow:C()}],shrink:[{shrink:C()}],order:[{order:["first","last","none",tc]}],"grid-cols":[{"grid-cols":[rc]}],"col-start-end":[{col:["auto",{span:["full",tc]},at]}],"col-start":[{"col-start":L()}],"col-end":[{"col-end":L()}],"grid-rows":[{"grid-rows":[rc]}],"row-start-end":[{row:["auto",{span:[tc]},at]}],"row-start":[{"row-start":L()}],"row-end":[{"row-end":L()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",at]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",at]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(q())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(q(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(q(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[b]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[b]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",at,t]}],"min-w":[{"min-w":["min","max","fit",at,ds]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Ea]},Ea,at]}],h:[{h:[at,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",at,ds]}],"max-h":[{"max-h":[at,t,"min","max","fit"]}],"font-size":[{text:["base",Ea,Pp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",wd]}],"font-family":[{font:[rc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",at]}],"line-clamp":[{"line-clamp":["none",Ii,wd]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",at,ds]}],"list-image":[{"list-image":["none",at]}],"list-style-type":[{list:["none","disc","decimal",at]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(j(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",ds]}],"underline-offset":[{"underline-offset":["auto",at,ds]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",at]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",at]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(ee(),[k8])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",N8]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},_8]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[].concat(j(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:j()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(j())}],"outline-offset":[{"outline-offset":[at,ds]}],"outline-w":[{outline:[ds]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[ds]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ea,j8]}],"shadow-color":[{shadow:[rc]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":U()}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Ea,at]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[f]}],saturate:[{saturate:[x]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",at]}],duration:[{duration:E()}],ease:[{ease:["linear","in","out","in-out",at]}],delay:[{delay:E()}],animate:[{animate:["none","spin","ping","pulse","bounce",at]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[tc,at]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",at]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",at]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",at]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ds,wd]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var F8=x8(A8);function Dr(...e){return F8(c4(e))}function Tn(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function xw(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function p4(...e){return t=>{let r=!1;const n=e.map(s=>{const a=xw(s,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():xw(e[s],null)}}}}function qi(...e){return k.useCallback(p4(...e),e)}function x4(e,t=[]){let r=[];function n(a,o){const l=k.createContext(o),c=r.length;r=[...r,o];const u=f=>{var w;const{scope:h,children:m,...g}=f,p=((w=h==null?void 0:h[e])==null?void 0:w[c])||l,v=k.useMemo(()=>g,Object.values(g));return i.jsx(p.Provider,{value:v,children:m})};u.displayName=a+"Provider";function d(f,h){var p;const m=((p=h==null?void 0:h[e])==null?void 0:p[c])||l,g=k.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${a}\``)}return[u,d]}const s=()=>{const a=r.map(o=>k.createContext(o));return function(l){const c=(l==null?void 0:l[e])||a;return k.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,P8(s,...t)]}function P8(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const o=n.reduce((l,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...l,...f}},{});return k.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function B0(e){const t=I8(e),r=k.forwardRef((n,s)=>{const{children:a,...o}=n,l=k.Children.toArray(a),c=l.find(L8);if(c){const u=c.props.children,d=l.map(f=>f===c?k.Children.count(u)>1?k.Children.only(null):k.isValidElement(u)?u.props.children:null:f);return i.jsx(t,{...o,ref:s,children:k.isValidElement(u)?k.cloneElement(u,void 0,d):null})}return i.jsx(t,{...o,ref:s,children:a})});return r.displayName=`${e}.Slot`,r}var D8=B0("Slot");function I8(e){const t=k.forwardRef((r,n)=>{const{children:s,...a}=r;if(k.isValidElement(s)){const o=M8(s),l=O8(a,s.props);return s.type!==k.Fragment&&(l.ref=n?p4(n,o):o),k.cloneElement(s,l)}return k.Children.count(s)>1?k.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var R8=Symbol("radix.slottable");function L8(e){return k.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===R8}function O8(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...l)=>{const c=a(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function M8(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function B8(e){const t=e+"CollectionProvider",[r,n]=x4(t),[s,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:v,children:w}=p,y=wt.useRef(null),x=wt.useRef(new Map).current;return i.jsx(s,{scope:v,itemMap:x,collectionRef:y,children:w})};o.displayName=t;const l=e+"CollectionSlot",c=B0(l),u=wt.forwardRef((p,v)=>{const{scope:w,children:y}=p,x=a(l,w),N=qi(v,x.collectionRef);return i.jsx(c,{ref:N,children:y})});u.displayName=l;const d=e+"CollectionItemSlot",f="data-radix-collection-item",h=B0(d),m=wt.forwardRef((p,v)=>{const{scope:w,children:y,...x}=p,N=wt.useRef(null),S=qi(v,N),_=a(d,w);return wt.useEffect(()=>(_.itemMap.set(N,{ref:N,...x}),()=>void _.itemMap.delete(N))),i.jsx(h,{[f]:"",ref:S,children:y})});m.displayName=d;function g(p){const v=a(e+"CollectionConsumer",p);return wt.useCallback(()=>{const y=v.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${f}]`));return Array.from(v.itemMap.values()).sort((_,b)=>x.indexOf(_.ref.current)-x.indexOf(b.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,n]}var $8=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Xs=$8.reduce((e,t)=>{const r=B0(`Primitive.${t}`),n=k.forwardRef((s,a)=>{const{asChild:o,...l}=s,c=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),i.jsx(c,{...l,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function g4(e,t){e&&Tf.flushSync(()=>e.dispatchEvent(t))}function Ji(e){const t=k.useRef(e);return k.useEffect(()=>{t.current=e}),k.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function U8(e,t=globalThis==null?void 0:globalThis.document){const r=Ji(e);k.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var V8="DismissableLayer",Dp="dismissableLayer.update",z8="dismissableLayer.pointerDownOutside",W8="dismissableLayer.focusOutside",gw,v4=k.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),y4=k.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,onDismiss:l,...c}=e,u=k.useContext(v4),[d,f]=k.useState(null),h=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=k.useState({}),g=qi(t,b=>f(b)),p=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=p.indexOf(v),y=d?p.indexOf(d):-1,x=u.layersWithOutsidePointerEventsDisabled.size>0,N=y>=w,S=G8(b=>{const A=b.target,D=[...u.branches].some(V=>V.contains(A));!N||D||(s==null||s(b),o==null||o(b),b.defaultPrevented||l==null||l())},h),_=X8(b=>{const A=b.target;[...u.branches].some(V=>V.contains(A))||(a==null||a(b),o==null||o(b),b.defaultPrevented||l==null||l())},h);return U8(b=>{y===u.layers.size-1&&(n==null||n(b),!b.defaultPrevented&&l&&(b.preventDefault(),l()))},h),k.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(gw=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),vw(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=gw)}},[d,h,r,u]),k.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),vw())},[d,u]),k.useEffect(()=>{const b=()=>m({});return document.addEventListener(Dp,b),()=>document.removeEventListener(Dp,b)},[]),i.jsx(Xs.div,{...c,ref:g,style:{pointerEvents:x?N?"auto":"none":void 0,...e.style},onFocusCapture:Tn(e.onFocusCapture,_.onFocusCapture),onBlurCapture:Tn(e.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Tn(e.onPointerDownCapture,S.onPointerDownCapture)})});y4.displayName=V8;var H8="DismissableLayerBranch",w4=k.forwardRef((e,t)=>{const r=k.useContext(v4),n=k.useRef(null),s=qi(t,n);return k.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),i.jsx(Xs.div,{...e,ref:s})});w4.displayName=H8;function G8(e,t=globalThis==null?void 0:globalThis.document){const r=Ji(e),n=k.useRef(!1),s=k.useRef(()=>{});return k.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let c=function(){b4(z8,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function X8(e,t=globalThis==null?void 0:globalThis.document){const r=Ji(e),n=k.useRef(!1);return k.useEffect(()=>{const s=a=>{a.target&&!n.current&&b4(W8,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function vw(){const e=new CustomEvent(Dp);document.dispatchEvent(e)}function b4(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?g4(s,a):s.dispatchEvent(a)}var K8=y4,Y8=w4,su=globalThis!=null&&globalThis.document?k.useLayoutEffect:()=>{},q8="Portal",N4=k.forwardRef((e,t)=>{var l;const{container:r,...n}=e,[s,a]=k.useState(!1);su(()=>a(!0),[]);const o=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?mA.createPortal(i.jsx(Xs.div,{...n,ref:t}),o):null});N4.displayName=q8;function J8(e,t){return k.useReducer((r,n)=>t[r][n]??r,e)}var k4=e=>{const{present:t,children:r}=e,n=Z8(t),s=typeof r=="function"?r({present:n.isPresent}):k.Children.only(r),a=qi(n.ref,Q8(s));return typeof r=="function"||n.isPresent?k.cloneElement(s,{ref:a}):null};k4.displayName="Presence";function Z8(e){const[t,r]=k.useState(),n=k.useRef(null),s=k.useRef(e),a=k.useRef("none"),o=e?"mounted":"unmounted",[l,c]=J8(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return k.useEffect(()=>{const u=bd(n.current);a.current=l==="mounted"?u:"none"},[l]),su(()=>{const u=n.current,d=s.current;if(d!==e){const h=a.current,m=bd(u);e?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),su(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,f=m=>{const p=bd(n.current).includes(m.animationName);if(m.target===t&&p&&(c("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(a.current=bd(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:k.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function bd(e){return(e==null?void 0:e.animationName)||"none"}function Q8(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var eI=n3[" useInsertionEffect ".trim().toString()]||su;function tI({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,a,o]=rI({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:s;{const d=k.useRef(e!==void 0);k.useEffect(()=>{const f=d.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const u=k.useCallback(d=>{var f;if(l){const h=nI(d)?d(e):d;h!==e&&((f=o.current)==null||f.call(o,h))}else a(d)},[l,e,a,o]);return[c,u]}function rI({defaultProp:e,onChange:t}){const[r,n]=k.useState(e),s=k.useRef(r),a=k.useRef(t);return eI(()=>{a.current=t},[t]),k.useEffect(()=>{var o;s.current!==r&&((o=a.current)==null||o.call(a,r),s.current=r)},[r,s]),[r,n,a]}function nI(e){return typeof e=="function"}var sI=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),aI="VisuallyHidden",Dg=k.forwardRef((e,t)=>i.jsx(Xs.span,{...e,ref:t,style:{...sI,...e.style}}));Dg.displayName=aI;var Ig="ToastProvider",[Rg,iI,oI]=B8("Toast"),[_4,tq]=x4("Toast",[oI]),[lI,$f]=_4(Ig),S4=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:a=50,children:o}=e,[l,c]=k.useState(null),[u,d]=k.useState(0),f=k.useRef(!1),h=k.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${Ig}\`. Expected non-empty \`string\`.`),i.jsx(Rg.Provider,{scope:t,children:i.jsx(lI,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:a,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:k.useCallback(()=>d(m=>m+1),[]),onToastRemove:k.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:o})})};S4.displayName=Ig;var j4="ToastViewport",cI=["F8"],Ip="toast.viewportPause",Rp="toast.viewportResume",C4=k.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=cI,label:s="Notifications ({hotkey})",...a}=e,o=$f(j4,r),l=iI(r),c=k.useRef(null),u=k.useRef(null),d=k.useRef(null),f=k.useRef(null),h=qi(t,f,o.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;k.useEffect(()=>{const v=w=>{var x;n.length!==0&&n.every(N=>w[N]||w.code===N)&&((x=f.current)==null||x.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n]),k.useEffect(()=>{const v=c.current,w=f.current;if(g&&v&&w){const y=()=>{if(!o.isClosePausedRef.current){const _=new CustomEvent(Ip);w.dispatchEvent(_),o.isClosePausedRef.current=!0}},x=()=>{if(o.isClosePausedRef.current){const _=new CustomEvent(Rp);w.dispatchEvent(_),o.isClosePausedRef.current=!1}},N=_=>{!v.contains(_.relatedTarget)&&x()},S=()=>{v.contains(document.activeElement)||x()};return v.addEventListener("focusin",y),v.addEventListener("focusout",N),v.addEventListener("pointermove",y),v.addEventListener("pointerleave",S),window.addEventListener("blur",y),window.addEventListener("focus",x),()=>{v.removeEventListener("focusin",y),v.removeEventListener("focusout",N),v.removeEventListener("pointermove",y),v.removeEventListener("pointerleave",S),window.removeEventListener("blur",y),window.removeEventListener("focus",x)}}},[g,o.isClosePausedRef]);const p=k.useCallback(({tabbingDirection:v})=>{const y=l().map(x=>{const N=x.ref.current,S=[N,...NI(N)];return v==="forwards"?S:S.reverse()});return(v==="forwards"?y.reverse():y).flat()},[l]);return k.useEffect(()=>{const v=f.current;if(v){const w=y=>{var S,_,b;const x=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!x){const A=document.activeElement,D=y.shiftKey;if(y.target===v&&D){(S=u.current)==null||S.focus();return}const T=p({tabbingDirection:D?"backwards":"forwards"}),z=T.findIndex(L=>L===A);Zh(T.slice(z+1))?y.preventDefault():D?(_=u.current)==null||_.focus():(b=d.current)==null||b.focus()}};return v.addEventListener("keydown",w),()=>v.removeEventListener("keydown",w)}},[l,p]),i.jsxs(Y8,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&i.jsx(Lp,{ref:u,onFocusFromOutsideViewport:()=>{const v=p({tabbingDirection:"forwards"});Zh(v)}}),i.jsx(Rg.Slot,{scope:r,children:i.jsx(Xs.ol,{tabIndex:-1,...a,ref:h})}),g&&i.jsx(Lp,{ref:d,onFocusFromOutsideViewport:()=>{const v=p({tabbingDirection:"backwards"});Zh(v)}})]})});C4.displayName=j4;var E4="ToastFocusProxy",Lp=k.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,a=$f(E4,r);return i.jsx(Dg,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=a.viewport)!=null&&u.contains(l))&&n()}})});Lp.displayName=E4;var Pu="Toast",uI="toast.swipeStart",dI="toast.swipeMove",fI="toast.swipeCancel",hI="toast.swipeEnd",T4=k.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:a,...o}=e,[l,c]=tI({prop:n,defaultProp:s??!0,onChange:a,caller:Pu});return i.jsx(k4,{present:r||l,children:i.jsx(xI,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:Ji(e.onPause),onResume:Ji(e.onResume),onSwipeStart:Tn(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Tn(e.onSwipeMove,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Tn(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Tn(e.onSwipeEnd,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});T4.displayName=Pu;var[mI,pI]=_4(Pu,{onClose(){}}),xI=k.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:a,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:m,...g}=e,p=$f(Pu,r),[v,w]=k.useState(null),y=qi(t,L=>w(L)),x=k.useRef(null),N=k.useRef(null),S=s||p.duration,_=k.useRef(0),b=k.useRef(S),A=k.useRef(0),{onToastAdd:D,onToastRemove:V}=p,P=Ji(()=>{var ee;(v==null?void 0:v.contains(document.activeElement))&&((ee=p.viewport)==null||ee.focus()),o()}),T=k.useCallback(L=>{!L||L===1/0||(window.clearTimeout(A.current),_.current=new Date().getTime(),A.current=window.setTimeout(P,L))},[P]);k.useEffect(()=>{const L=p.viewport;if(L){const ee=()=>{T(b.current),u==null||u()},j=()=>{const U=new Date().getTime()-_.current;b.current=b.current-U,window.clearTimeout(A.current),c==null||c()};return L.addEventListener(Ip,j),L.addEventListener(Rp,ee),()=>{L.removeEventListener(Ip,j),L.removeEventListener(Rp,ee)}}},[p.viewport,S,c,u,T]),k.useEffect(()=>{a&&!p.isClosePausedRef.current&&T(S)},[a,S,p.isClosePausedRef,T]),k.useEffect(()=>(D(),()=>V()),[D,V]);const z=k.useMemo(()=>v?L4(v):null,[v]);return p.viewport?i.jsxs(i.Fragment,{children:[z&&i.jsx(gI,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:z}),i.jsx(mI,{scope:r,onClose:P,children:Tf.createPortal(i.jsx(Rg.ItemSlot,{scope:r,children:i.jsx(K8,{asChild:!0,onEscapeKeyDown:Tn(l,()=>{p.isFocusedToastEscapeKeyDownRef.current||P(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:i.jsx(Xs.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":p.swipeDirection,...g,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Tn(e.onKeyDown,L=>{L.key==="Escape"&&(l==null||l(L.nativeEvent),L.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:Tn(e.onPointerDown,L=>{L.button===0&&(x.current={x:L.clientX,y:L.clientY})}),onPointerMove:Tn(e.onPointerMove,L=>{if(!x.current)return;const ee=L.clientX-x.current.x,j=L.clientY-x.current.y,U=!!N.current,q=["left","right"].includes(p.swipeDirection),C=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,R=q?C(0,ee):0,F=q?0:C(0,j),E=L.pointerType==="touch"?10:2,M={x:R,y:F},H={originalEvent:L,delta:M};U?(N.current=M,Nd(dI,f,H,{discrete:!1})):yw(M,p.swipeDirection,E)?(N.current=M,Nd(uI,d,H,{discrete:!1}),L.target.setPointerCapture(L.pointerId)):(Math.abs(ee)>E||Math.abs(j)>E)&&(x.current=null)}),onPointerUp:Tn(e.onPointerUp,L=>{const ee=N.current,j=L.target;if(j.hasPointerCapture(L.pointerId)&&j.releasePointerCapture(L.pointerId),N.current=null,x.current=null,ee){const U=L.currentTarget,q={originalEvent:L,delta:ee};yw(ee,p.swipeDirection,p.swipeThreshold)?Nd(hI,m,q,{discrete:!0}):Nd(fI,h,q,{discrete:!0}),U.addEventListener("click",C=>C.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),gI=e=>{const{__scopeToast:t,children:r,...n}=e,s=$f(Pu,t),[a,o]=k.useState(!1),[l,c]=k.useState(!1);return wI(()=>o(!0)),k.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:i.jsx(N4,{asChild:!0,children:i.jsx(Dg,{...n,children:a&&i.jsxs(i.Fragment,{children:[s.label," ",r]})})})},vI="ToastTitle",A4=k.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return i.jsx(Xs.div,{...n,ref:t})});A4.displayName=vI;var yI="ToastDescription",F4=k.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return i.jsx(Xs.div,{...n,ref:t})});F4.displayName=yI;var P4="ToastAction",D4=k.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?i.jsx(R4,{altText:r,asChild:!0,children:i.jsx(Lg,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${P4}\`. Expected non-empty \`string\`.`),null)});D4.displayName=P4;var I4="ToastClose",Lg=k.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=pI(I4,r);return i.jsx(R4,{asChild:!0,children:i.jsx(Xs.button,{type:"button",...n,ref:t,onClick:Tn(e.onClick,s.onClose)})})});Lg.displayName=I4;var R4=k.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return i.jsx(Xs.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function L4(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),bI(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",a=n.dataset.radixToastAnnounceExclude==="";if(!s)if(a){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...L4(n))}}),t}function Nd(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?g4(s,a):s.dispatchEvent(a)}var yw=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),a=n>s;return t==="left"||t==="right"?a&&n>r:!a&&s>r};function wI(e=()=>{}){const t=Ji(e);su(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function bI(e){return e.nodeType===e.ELEMENT_NODE}function NI(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Zh(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var kI=S4,O4=C4,M4=T4,B4=A4,$4=F4,U4=D4,V4=Lg;const ww=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,bw=c4,Og=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return bw(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:a}=t,o=Object.keys(s).map(u=>{const d=r==null?void 0:r[u],f=a==null?void 0:a[u];if(d===null)return null;const h=ww(d)||ww(f);return s[u][h]}),l=r&&Object.entries(r).reduce((u,d)=>{let[f,h]=d;return h===void 0||(u[f]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:h,...m}=d;return Object.entries(m).every(g=>{let[p,v]=g;return Array.isArray(v)?v.includes({...a,...l}[p]):{...a,...l}[p]===v})?[...u,f,h]:u},[]);return bw(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};var _I={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const SI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Be=(e,t)=>{const r=k.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,children:l,...c},u)=>k.createElement("svg",{ref:u,..._I,width:s,height:s,stroke:n,strokeWidth:o?Number(a)*24/Number(s):a,className:`lucide lucide-${SI(e)}`,...c},[...t.map(([d,f])=>k.createElement(d,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},Zi=Be("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Qd=Be("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ai=Be("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Nw=Be("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Qh=Be("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Mg=Be("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),jI=Be("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Vs=Be("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),em=Be("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),ya=Be("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ts=Be("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),z4=Be("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Wt=Be("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),W4=Be("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),H4=Be("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Zt=Be("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Bg=Be("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),$0=Be("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),xl=Be("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),kw=Be("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),_w=Be("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),ii=Be("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),zs=Be("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Op=Be("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),au=Be("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),CI=Be("FileSignature",[["path",{d:"M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L18 5.5",key:"kd5d3"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z",key:"johvi5"}]]),tm=Be("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),mr=Be("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),iu=Be("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),EI=Be("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Sw=Be("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),TI=Be("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),Pt=Be("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Mp=Be("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),AI=Be("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),FI=Be("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),G4=Be("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),gl=Be("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),PI=Be("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),er=Be("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Cs=Be("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),rs=Be("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),DI=Be("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),Sr=Be("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Qi=Be("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Bp=Be("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),II=Be("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),an=Be("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),eo=Be("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),RI=Be("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Nn=Be("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),LI=Be("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),OI=Be("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),MI=Be("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),ka=Be("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Tl=Be("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),jw=Be("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),$p=Be("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ws=Be("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),BI=Be("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),br=Be("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),gn=Be("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Uf=Be("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),X4=Be("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),$I=Be("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),UI=kI,K4=wt.forwardRef(({className:e,...t},r)=>i.jsx(O4,{ref:r,className:Dr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));K4.displayName=O4.displayName;const VI=Og("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Y4=wt.forwardRef(({className:e,variant:t,...r},n)=>i.jsx(M4,{ref:n,className:Dr(VI({variant:t}),e),...r}));Y4.displayName=M4.displayName;const zI=wt.forwardRef(({className:e,...t},r)=>i.jsx(U4,{ref:r,className:Dr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));zI.displayName=U4.displayName;const q4=wt.forwardRef(({className:e,...t},r)=>i.jsx(V4,{ref:r,className:Dr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:i.jsx(X4,{className:"h-4 w-4"})}));q4.displayName=V4.displayName;const J4=wt.forwardRef(({className:e,...t},r)=>i.jsx(B4,{ref:r,className:Dr("text-sm font-semibold",e),...t}));J4.displayName=B4.displayName;const Z4=wt.forwardRef(({className:e,...t},r)=>i.jsx($4,{ref:r,className:Dr("text-sm opacity-90",e),...t}));Z4.displayName=$4.displayName;const WI=1;let rm=0;function HI(){return rm=(rm+1)%Number.MAX_VALUE,rm.toString()}const Qr={state:{toasts:[]},listeners:[],getState:()=>Qr.state,setState:e=>{typeof e=="function"?Qr.state=e(Qr.state):Qr.state={...Qr.state,...e},Qr.listeners.forEach(t=>t(Qr.state))},subscribe:e=>(Qr.listeners.push(e),()=>{Qr.listeners=Qr.listeners.filter(t=>t!==e)})},we=({...e})=>{const t=HI(),r=s=>Qr.setState(a=>({...a,toasts:a.toasts.map(o=>o.id===t?{...o,...s}:o)})),n=()=>Qr.setState(s=>({...s,toasts:s.toasts.filter(a=>a.id!==t)}));return Qr.setState(s=>({...s,toasts:[{...e,id:t,dismiss:n},...s.toasts].slice(0,WI)})),{id:t,dismiss:n,update:r}};function GI(){const[e,t]=k.useState(Qr.getState());return k.useEffect(()=>Qr.subscribe(n=>{t(n)}),[]),k.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const s=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(s)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:we,toasts:e.toasts}}function Cw(){const{toasts:e}=GI();return i.jsxs(UI,{children:[e.map(({id:t,title:r,description:n,action:s,...a})=>i.jsxs(Y4,{...a,children:[i.jsxs("div",{className:"grid gap-1",children:[r&&i.jsx(J4,{children:r}),n&&i.jsx(Z4,{children:n})]}),s,i.jsx(q4,{})]},t)),i.jsx(K4,{})]})}const XI=Og("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ae=wt.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},a)=>{const o=n?D8:"button";return i.jsx(o,{className:Dr(XI({variant:t,size:r,className:e})),ref:a,...s})});ae.displayName="Button";const KI=({activeTab:e,setActiveTab:t,collapsed:r,setCollapsed:n,currentBranch:s})=>{const a=[{id:"dashboard",label:"",icon:TI},{id:"branches",label:"",icon:Vs},{id:"products",label:"",icon:er},{id:"contracts",label:"",icon:Bg},{id:"payments",label:"",icon:ya},{id:"returns",label:"",icon:Bp},{id:"customers",label:"",icon:gn},{id:"employees",label:"",icon:Ws},{id:"salespeople",label:"",icon:gn},{id:"checkers",label:"",icon:Nn},{id:"all-checker-customers",label:"",icon:gn},{id:"sales-index",label:"",icon:Tl},{id:"import-data",label:"Import ",icon:$p},{id:"admin-users",label:"",icon:Ws},{id:"settings",label:"",icon:eo}];return i.jsx($e.div,{initial:{x:-250},animate:{x:0,width:r?64:256},transition:{duration:.3},className:"fixed left-0 top-0 h-full bg-white border-r border-gray-200 shadow-lg z-50",children:i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[!r&&i.jsxs($e.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center",children:i.jsx(xl,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-gray-800",children:"Admin Panel"}),i.jsx("p",{className:"text-xs text-gray-500",children:""})]})]}),i.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>n(!r),className:"p-1.5 hover:bg-gray-100",children:r?i.jsx(H4,{className:"w-4 h-4"}):i.jsx(W4,{className:"w-4 h-4"})})]})}),!r&&s&&i.jsx("div",{className:"p-3 bg-gradient-to-r from-emerald-50 to-teal-50 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[i.jsx(Vs,{className:"w-4 h-4 text-emerald-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"font-medium text-emerald-800 truncate",children:s.name}),i.jsx("div",{className:"text-xs text-emerald-600 truncate",children:s.address})]})]})}),i.jsx("nav",{className:"flex-1 p-2 space-y-1 overflow-y-auto sidebar-scrollbar",children:a.map(o=>{const l=o.icon,c=e===o.id;return i.jsxs(ae,{variant:c?"default":"ghost",onClick:()=>t(o.id),className:`w-full justify-start gap-3 h-10 ${r?"px-2":"px-3"} ${c?"bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-md":"hover:bg-gray-100 text-gray-700"}`,children:[i.jsx(l,{className:`${r?"w-5 h-5":"w-4 h-4"} flex-shrink-0`}),!r&&i.jsx("span",{className:"text-sm font-medium",children:o.label})]},o.id)})}),i.jsx("div",{className:"p-4 border-t border-gray-200",children:!r&&i.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-3",children:[i.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:" v1.0"}),i.jsx("div",{className:"text-xs text-gray-500",children:" wooyou creative"})]})})]})})},YI=({sidebarCollapsed:e,setSidebarCollapsed:t,branches:r,selectedBranch:n,setSelectedBranch:s,currentBranch:a,currentUser:o,onLogout:l})=>{const[c,u]=k.useState(!1),[d,f]=k.useState(!1),h=m=>{s(m),u(!1)};return i.jsx($e.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>t(!e),className:"lg:hidden",children:i.jsx(PI,{className:"w-5 h-5"})}),i.jsxs("div",{className:"relative",children:[i.jsxs(ae,{variant:"outline",onClick:()=>u(!c),className:"branch-selector flex items-center gap-2 min-w-[200px] max-w-[300px] justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[i.jsx(Vs,{className:"w-4 h-4 flex-shrink-0"}),i.jsx("span",{className:"font-medium truncate",children:(a==null?void 0:a.name)||""})]}),i.jsx(Wt,{className:"w-4 h-4 flex-shrink-0"})]}),i.jsx(Ec,{children:c&&i.jsx($e.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 mt-2 w-full max-w-[400px] bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:i.jsx("div",{className:"p-2",children:r.map(m=>i.jsxs(ae,{variant:"ghost",onClick:()=>h(m.id),className:`w-full justify-start gap-2 h-auto py-2 ${m.id===n?"bg-emerald-50 text-emerald-700":""}`,children:[i.jsx(gl,{className:"w-4 h-4 flex-shrink-0"}),i.jsxs("div",{className:"text-left min-w-0 flex-1",children:[i.jsx("div",{className:"font-medium truncate",children:m.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:m.address})]})]},m.id))})})})]}),i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"...",className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent w-64"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(ae,{variant:"ghost",size:"sm",className:"relative",children:[i.jsx(Mg,{className:"w-5 h-5"}),i.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full text-xs"})]}),i.jsx(ae,{variant:"ghost",size:"sm",children:i.jsx(eo,{className:"w-5 h-5"})}),i.jsxs("div",{className:"relative",children:[i.jsxs(ae,{variant:"ghost",onClick:()=>f(!d),className:"flex items-center gap-3 pl-3 border-l border-gray-200",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-medium text-gray-800",children:(o==null?void 0:o.full_name)||(o==null?void 0:o.username)||""}),i.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[i.jsx(Nn,{className:"w-3 h-3"}),(o==null?void 0:o.role)==="super_admin"?"Super Admin":(o==null?void 0:o.role)==="admin"?"Admin":(o==null?void 0:o.role)==="manager"?"Manager":"User"]})]}),i.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white font-medium text-sm",children:((o==null?void 0:o.full_name)||(o==null?void 0:o.username)||"A").charAt(0).toUpperCase()})}),i.jsx(Wt,{className:"w-4 h-4 text-gray-400"})]}),i.jsx(Ec,{children:d&&i.jsxs($e.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[i.jsx("div",{className:"font-medium text-gray-900",children:(o==null?void 0:o.full_name)||(o==null?void 0:o.username)}),i.jsx("div",{className:"text-sm text-gray-500",children:o==null?void 0:o.email}),i.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[": ",(o==null?void 0:o.branch_name)||(a==null?void 0:a.name)||""]})]}),i.jsxs("div",{className:"py-1",children:[i.jsxs("button",{onClick:()=>{f(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[i.jsx(br,{className:"w-4 h-4"}),""]}),i.jsxs("button",{onClick:()=>{f(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[i.jsx(eo,{className:"w-4 h-4"}),""]})]}),i.jsx("div",{className:"border-t border-gray-100 py-1",children:i.jsxs("button",{onClick:()=>{f(!1),l()},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(FI,{className:"w-4 h-4"}),""]})})]})})]})]})]})})},Ew=({products:e,installmentPlans:t,customers:r,employees:n,checkers:s})=>{const a=(e==null?void 0:e.length)||0,o=(t==null?void 0:t.length)||0,l=(r==null?void 0:r.length)||0,c=(n==null?void 0:n.length)||0,u=(s==null?void 0:s.length)||0,d=(n==null?void 0:n.filter(x=>x.isCheckedIn).length)||0,f=(e==null?void 0:e.reduce((x,N)=>x+N.price,0))||0,h=(t==null?void 0:t.flatMap(x=>x.payments))||[],m=h.filter(x=>x.status==="paid"),g=h.filter(x=>x.status==="pending"),p=h.filter(x=>x.status==="paid"?!1:new Date(x.dueDate)<new Date),v=m.reduce((x,N)=>x+N.amount,0),w=[{title:"",value:a,icon:er,color:"from-blue-500 to-blue-600",bgColor:"bg-blue-50",textColor:"text-blue-600"},{title:"",value:o,icon:xl,color:"from-purple-500 to-purple-600",bgColor:"bg-purple-50",textColor:"text-purple-600"},{title:"",value:l,icon:gn,color:"from-indigo-500 to-indigo-600",bgColor:"bg-indigo-50",textColor:"text-indigo-600"},{title:"",value:`${d}/${c}`,icon:Ws,color:"from-green-500 to-green-600",bgColor:"bg-green-50",textColor:"text-green-600"},{title:"",value:`${f.toLocaleString()}`,icon:ii,color:"from-yellow-500 to-yellow-600",bgColor:"bg-yellow-50",textColor:"text-yellow-600"},{title:"",value:`${v.toLocaleString()}`,icon:ts,color:"from-emerald-500 to-emerald-600",bgColor:"bg-emerald-50",textColor:"text-emerald-600"},{title:"",value:u,icon:Nn,color:"from-orange-500 to-orange-600",bgColor:"bg-orange-50",textColor:"text-orange-600"}],y=[{title:"",count:m.length,icon:ts,color:"text-green-500",bgColor:"bg-green-100"},{title:"",count:g.length,icon:$0,color:"text-yellow-500",bgColor:"bg-yellow-100"},{title:"",count:p.length,icon:Zi,color:"text-red-500",bgColor:"bg-red-100"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:""})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map((x,N)=>{const S=x.icon;return i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsx("div",{className:`p-3 rounded-lg ${x.bgColor}`,children:i.jsx(S,{className:`w-6 h-6 ${x.textColor}`})})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("p",{className:"text-sm text-gray-600",children:x.title}),i.jsx("p",{className:"text-2xl font-bold text-gray-800",children:x.value})]})]},x.title)})}),t&&t.length>0&&i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[i.jsx(DI,{className:"w-5 h-5"}),""]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:y.map((x,N)=>{const S=x.icon;return i.jsxs($e.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.5+N*.1},className:"text-center",children:[i.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full ${x.bgColor} mb-3`,children:i.jsx(S,{className:`w-8 h-8 ${x.color}`})}),i.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-1",children:x.count}),i.jsx("div",{className:"text-sm text-gray-600",children:x.title})]},x.title)})})]}),t&&t.length>0&&i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[i.jsx(ya,{className:"w-5 h-5"}),""]}),i.jsx("div",{className:"space-y-4",children:t.slice(0,3).map((x,N)=>{const S=x.payments.filter(b=>b.status==="paid").length,_=S/x.payments.length*100;return i.jsxs($e.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7+N*.1},className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:x.productName}),i.jsxs("p",{className:"text-gray-600 text-sm",children:[" ",x.months,"   ",x.monthlyPayment.toLocaleString()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm text-gray-500",children:""}),i.jsxs("div",{className:"font-semibold",children:[S,"/",x.payments.length]})]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${_}%`}})}),i.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[_.toFixed(1),"% "]})]},x.id)})})]}),(!e||e.length===0)&&(!t||t.length===0)&&(!r||r.length===0)&&(!n||n.length===0)&&i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[i.jsx(er,{className:"w-24 h-24 text-gray-300 mx-auto mb-6"}),i.jsx("h3",{className:"text-2xl font-bold text-gray-600 mb-4",children:"! "}),i.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:" "}),i.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-full",children:[i.jsx(er,{className:"w-4 h-4"}),""]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-full",children:[i.jsx(xl,{className:"w-4 h-4"}),""]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-full",children:[i.jsx(ya,{className:"w-4 h-4"}),""]})]})]})]})},Tw=({onAddProduct:e,submitting:t=!1,initialData:r=null,contracts:n=[]})=>{const[s,a]=k.useState({productCode:(r==null?void 0:r.productCode)||"",productName:(r==null?void 0:r.productName)||"",shopName:(r==null?void 0:r.shopName)||"",contract:(r==null?void 0:r.contract)||"",costPrice:(r==null?void 0:r.costPrice)||"",receiveDate:(r==null?void 0:r.receiveDate)||"",remarks:(r==null?void 0:r.remarks)||""});k.useEffect(()=>{if(r){const c=r.costPrice?typeof r.costPrice=="string"?r.costPrice:parseFloat(r.costPrice).toLocaleString():"";a({productCode:r.productCode||"",productName:r.productName||"",shopName:r.shopName||"",contract:r.contract||"",costPrice:c,receiveDate:r.receiveDate||"",remarks:r.remarks||""})}},[r]);const o=c=>{if(c.preventDefault(),!s.productName||!s.costPrice){we({title:"",description:"",variant:"destructive"});return}const u=parseFloat(s.costPrice.replace(/,/g,""));if(isNaN(u)||u<=0){we({title:"",description:" 0",variant:"destructive"});return}e({...s,costPrice:u.toLocaleString(),name:s.productName,price:u,code:s.productCode,shopName:s.shopName,contract:s.contract,receiveDate:s.receiveDate,remarks:s.remarks}),r||a({productCode:"",productName:"",shopName:"",contract:"",costPrice:"",receiveDate:"",remarks:""})},l=c=>{const{name:u,value:d}=c.target;if(u==="costPrice"){const f=d.replace(/[^\d]/g,""),h=f?parseInt(f).toLocaleString():"";a(m=>({...m,[u]:h}))}else a(f=>({...f,[u]:d}))};return i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:i.jsxs("form",{onSubmit:o,className:"space-y-6",children:[i.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(EI,{className:"w-4 h-4"}),""]}),i.jsx("input",{type:"text",name:"productCode",value:s.productCode,onChange:l,placeholder:" R43, N903",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(er,{className:"w-4 h-4"})," *"]}),i.jsx("input",{type:"text",name:"productName",value:s.productName,onChange:l,placeholder:"  11 ",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm",required:!0})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(MI,{className:"w-4 h-4"}),""]}),i.jsx("input",{type:"text",name:"shopName",value:s.shopName,onChange:l,placeholder:"  A,  B",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(CI,{className:"w-4 h-4"}),""]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",name:"contract",value:s.contract,onChange:l,placeholder:" - ",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm pr-8"}),n.length>0&&i.jsxs("select",{value:"",onChange:c=>{c.target.value&&a(u=>({...u,contract:c.target.value}))},className:"absolute right-1 top-1/2 transform -translate-y-1/2 w-6 h-6 text-xs border-none bg-transparent focus:outline-none cursor-pointer",children:[i.jsx("option",{value:"",children:""}),n.map(c=>i.jsxs("option",{value:c.contractNumber,children:[c.contractNumber," - ",c.customerName]},c.id))]})]}),n.length>0&&i.jsx("p",{className:"text-xs text-gray-500",children:'  "-" '})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(ii,{className:"w-4 h-4"})," *"]}),i.jsx("input",{type:"text",name:"costPrice",value:s.costPrice,onChange:l,placeholder:" 2,740",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm",required:!0})]})]}),i.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(ya,{className:"w-4 h-4"}),".../"]}),i.jsx("input",{type:"date",name:"receiveDate",value:s.receiveDate,onChange:l,className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[i.jsx(mr,{className:"w-4 h-4"}),""]}),i.jsx("input",{type:"text",name:"remarks",value:s.remarks,onChange:l,placeholder:" ,  23/6/68",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-300 bg-white/80 backdrop-blur-sm text-sm"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 opacity-0",children:[i.jsx(Sr,{className:"w-4 h-4"}),""]}),i.jsx(ae,{type:"submit",disabled:t,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white py-3 px-4 rounded-lg font-medium text-base transition-all duration-300 transform hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:t?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),r?"...":"..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),r?"":""]})})]})]})]})})};function Q4(e,t){return function(){return e.apply(t,arguments)}}const{toString:qI}=Object.prototype,{getPrototypeOf:$g}=Object,{iterator:Vf,toStringTag:eS}=Symbol,zf=(e=>t=>{const r=qI.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Es=e=>(e=e.toLowerCase(),t=>zf(t)===e),Wf=e=>t=>typeof t===e,{isArray:Al}=Array,ou=Wf("undefined");function Du(e){return e!==null&&!ou(e)&&e.constructor!==null&&!ou(e.constructor)&&vn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const tS=Es("ArrayBuffer");function JI(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&tS(e.buffer),t}const ZI=Wf("string"),vn=Wf("function"),rS=Wf("number"),Iu=e=>e!==null&&typeof e=="object",QI=e=>e===!0||e===!1,e0=e=>{if(zf(e)!=="object")return!1;const t=$g(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(eS in e)&&!(Vf in e)},eR=e=>{if(!Iu(e)||Du(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},tR=Es("Date"),rR=Es("File"),nR=Es("Blob"),sR=Es("FileList"),aR=e=>Iu(e)&&vn(e.pipe),iR=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||vn(e.append)&&((t=zf(e))==="formdata"||t==="object"&&vn(e.toString)&&e.toString()==="[object FormData]"))},oR=Es("URLSearchParams"),[lR,cR,uR,dR]=["ReadableStream","Request","Response","Headers"].map(Es),fR=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ru(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Al(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(Du(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let l;for(n=0;n<o;n++)l=a[n],t.call(null,e[l],l,e)}}function nS(e,t){if(Du(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Ri=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),sS=e=>!ou(e)&&e!==Ri;function Up(){const{caseless:e}=sS(this)&&this||{},t={},r=(n,s)=>{const a=e&&nS(t,s)||s;e0(t[a])&&e0(n)?t[a]=Up(t[a],n):e0(n)?t[a]=Up({},n):Al(n)?t[a]=n.slice():t[a]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&Ru(arguments[n],r);return t}const hR=(e,t,r,{allOwnKeys:n}={})=>(Ru(t,(s,a)=>{r&&vn(s)?e[a]=Q4(s,r):e[a]=s},{allOwnKeys:n}),e),mR=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),pR=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},xR=(e,t,r,n)=>{let s,a,o;const l={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)o=s[a],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&$g(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},gR=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},vR=e=>{if(!e)return null;if(Al(e))return e;let t=e.length;if(!rS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},yR=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&$g(Uint8Array)),wR=(e,t)=>{const n=(e&&e[Vf]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},bR=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},NR=Es("HTMLFormElement"),kR=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),Aw=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),_R=Es("RegExp"),aS=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Ru(r,(s,a)=>{let o;(o=t(s,a,e))!==!1&&(n[a]=o||s)}),Object.defineProperties(e,n)},SR=e=>{aS(e,(t,r)=>{if(vn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(vn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},jR=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return Al(e)?n(e):n(String(e).split(t)),r},CR=()=>{},ER=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function TR(e){return!!(e&&vn(e.append)&&e[eS]==="FormData"&&e[Vf])}const AR=e=>{const t=new Array(10),r=(n,s)=>{if(Iu(n)){if(t.indexOf(n)>=0)return;if(Du(n))return n;if(!("toJSON"in n)){t[s]=n;const a=Al(n)?[]:{};return Ru(n,(o,l)=>{const c=r(o,s+1);!ou(c)&&(a[l]=c)}),t[s]=void 0,a}}return n};return r(e,0)},FR=Es("AsyncFunction"),PR=e=>e&&(Iu(e)||vn(e))&&vn(e.then)&&vn(e.catch),iS=((e,t)=>e?setImmediate:t?((r,n)=>(Ri.addEventListener("message",({source:s,data:a})=>{s===Ri&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Ri.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",vn(Ri.postMessage)),DR=typeof queueMicrotask<"u"?queueMicrotask.bind(Ri):typeof process<"u"&&process.nextTick||iS,IR=e=>e!=null&&vn(e[Vf]),fe={isArray:Al,isArrayBuffer:tS,isBuffer:Du,isFormData:iR,isArrayBufferView:JI,isString:ZI,isNumber:rS,isBoolean:QI,isObject:Iu,isPlainObject:e0,isEmptyObject:eR,isReadableStream:lR,isRequest:cR,isResponse:uR,isHeaders:dR,isUndefined:ou,isDate:tR,isFile:rR,isBlob:nR,isRegExp:_R,isFunction:vn,isStream:aR,isURLSearchParams:oR,isTypedArray:yR,isFileList:sR,forEach:Ru,merge:Up,extend:hR,trim:fR,stripBOM:mR,inherits:pR,toFlatObject:xR,kindOf:zf,kindOfTest:Es,endsWith:gR,toArray:vR,forEachEntry:wR,matchAll:bR,isHTMLForm:NR,hasOwnProperty:Aw,hasOwnProp:Aw,reduceDescriptors:aS,freezeMethods:SR,toObjectSet:jR,toCamelCase:kR,noop:CR,toFiniteNumber:ER,findKey:nS,global:Ri,isContextDefined:sS,isSpecCompliantForm:TR,toJSONObject:AR,isAsyncFn:FR,isThenable:PR,setImmediate:iS,asap:DR,isIterable:IR};function Ze(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}fe.inherits(Ze,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fe.toJSONObject(this.config),code:this.code,status:this.status}}});const oS=Ze.prototype,lS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{lS[e]={value:e}});Object.defineProperties(Ze,lS);Object.defineProperty(oS,"isAxiosError",{value:!0});Ze.from=(e,t,r,n,s,a)=>{const o=Object.create(oS);return fe.toFlatObject(e,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),Ze.call(o,e.message,t,r,n,s),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};const RR=null;function Vp(e){return fe.isPlainObject(e)||fe.isArray(e)}function cS(e){return fe.endsWith(e,"[]")?e.slice(0,-2):e}function Fw(e,t,r){return e?e.concat(t).map(function(s,a){return s=cS(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function LR(e){return fe.isArray(e)&&!e.some(Vp)}const OR=fe.toFlatObject(fe,{},null,function(t){return/^is[A-Z]/.test(t)});function Hf(e,t,r){if(!fe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=fe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,v){return!fe.isUndefined(v[p])});const n=r.metaTokens,s=r.visitor||d,a=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&fe.isSpecCompliantForm(t);if(!fe.isFunction(s))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(fe.isDate(g))return g.toISOString();if(fe.isBoolean(g))return g.toString();if(!c&&fe.isBlob(g))throw new Ze("Blob is not supported. Use a Buffer instead.");return fe.isArrayBuffer(g)||fe.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function d(g,p,v){let w=g;if(g&&!v&&typeof g=="object"){if(fe.endsWith(p,"{}"))p=n?p:p.slice(0,-2),g=JSON.stringify(g);else if(fe.isArray(g)&&LR(g)||(fe.isFileList(g)||fe.endsWith(p,"[]"))&&(w=fe.toArray(g)))return p=cS(p),w.forEach(function(x,N){!(fe.isUndefined(x)||x===null)&&t.append(o===!0?Fw([p],N,a):o===null?p:p+"[]",u(x))}),!1}return Vp(g)?!0:(t.append(Fw(v,p,a),u(g)),!1)}const f=[],h=Object.assign(OR,{defaultVisitor:d,convertValue:u,isVisitable:Vp});function m(g,p){if(!fe.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(g),fe.forEach(g,function(w,y){(!(fe.isUndefined(w)||w===null)&&s.call(t,w,fe.isString(y)?y.trim():y,p,h))===!0&&m(w,p?p.concat(y):[y])}),f.pop()}}if(!fe.isObject(e))throw new TypeError("data must be an object");return m(e),t}function Pw(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Ug(e,t){this._pairs=[],e&&Hf(e,this,t)}const uS=Ug.prototype;uS.append=function(t,r){this._pairs.push([t,r])};uS.toString=function(t){const r=t?function(n){return t.call(this,n,Pw)}:Pw;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function MR(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function dS(e,t,r){if(!t)return e;const n=r&&r.encode||MR;fe.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(t,r):a=fe.isURLSearchParams(t)?t.toString():new Ug(t,r).toString(n),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class BR{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){fe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Dw=BR,fS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$R=typeof URLSearchParams<"u"?URLSearchParams:Ug,UR=typeof FormData<"u"?FormData:null,VR=typeof Blob<"u"?Blob:null,zR={isBrowser:!0,classes:{URLSearchParams:$R,FormData:UR,Blob:VR},protocols:["http","https","file","blob","url","data"]},Vg=typeof window<"u"&&typeof document<"u",zp=typeof navigator=="object"&&navigator||void 0,WR=Vg&&(!zp||["ReactNative","NativeScript","NS"].indexOf(zp.product)<0),HR=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),GR=Vg&&window.location.href||"http://localhost",XR=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Vg,hasStandardBrowserEnv:WR,hasStandardBrowserWebWorkerEnv:HR,navigator:zp,origin:GR},Symbol.toStringTag,{value:"Module"})),Hr={...XR,...zR};function KR(e,t){return Hf(e,new Hr.classes.URLSearchParams,{visitor:function(r,n,s,a){return Hr.isNode&&fe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function YR(e){return fe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function qR(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function hS(e){function t(r,n,s,a){let o=r[a++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=a>=r.length;return o=!o&&fe.isArray(s)?s.length:o,c?(fe.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!l):((!s[o]||!fe.isObject(s[o]))&&(s[o]=[]),t(r,n,s[o],a)&&fe.isArray(s[o])&&(s[o]=qR(s[o])),!l)}if(fe.isFormData(e)&&fe.isFunction(e.entries)){const r={};return fe.forEachEntry(e,(n,s)=>{t(YR(n),s,r,0)}),r}return null}function JR(e,t,r){if(fe.isString(e))try{return(t||JSON.parse)(e),fe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const zg={transitional:fS,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=fe.isObject(t);if(a&&fe.isHTMLForm(t)&&(t=new FormData(t)),fe.isFormData(t))return s?JSON.stringify(hS(t)):t;if(fe.isArrayBuffer(t)||fe.isBuffer(t)||fe.isStream(t)||fe.isFile(t)||fe.isBlob(t)||fe.isReadableStream(t))return t;if(fe.isArrayBufferView(t))return t.buffer;if(fe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return KR(t,this.formSerializer).toString();if((l=fe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Hf(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),JR(t)):t}],transformResponse:[function(t){const r=this.transitional||zg.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(fe.isResponse(t)||fe.isReadableStream(t))return t;if(t&&fe.isString(t)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?Ze.from(l,Ze.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Hr.classes.FormData,Blob:Hr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fe.forEach(["delete","get","head","post","put","patch"],e=>{zg.headers[e]={}});const Wg=zg,ZR=fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),QR=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||t[r]&&ZR[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Iw=Symbol("internals");function nc(e){return e&&String(e).trim().toLowerCase()}function t0(e){return e===!1||e==null?e:fe.isArray(e)?e.map(t0):String(e)}function eL(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const tL=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function nm(e,t,r,n,s){if(fe.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!fe.isString(t)){if(fe.isString(n))return t.indexOf(n)!==-1;if(fe.isRegExp(n))return n.test(t)}}function rL(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function nL(e,t){const r=fe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,o){return this[n].call(this,t,s,a,o)},configurable:!0})})}class Gf{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(l,c,u){const d=nc(c);if(!d)throw new Error("header name must be a non-empty string");const f=fe.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=t0(l))}const o=(l,c)=>fe.forEach(l,(u,d)=>a(u,d,c));if(fe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(fe.isString(t)&&(t=t.trim())&&!tL(t))o(QR(t),r);else if(fe.isObject(t)&&fe.isIterable(t)){let l={},c,u;for(const d of t){if(!fe.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?fe.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=nc(t),t){const n=fe.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return eL(s);if(fe.isFunction(r))return r.call(this,s,n);if(fe.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=nc(t),t){const n=fe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||nm(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(o){if(o=nc(o),o){const l=fe.findKey(n,o);l&&(!r||nm(n,n[l],l,r))&&(delete n[l],s=!0)}}return fe.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||nm(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return fe.forEach(this,(s,a)=>{const o=fe.findKey(n,a);if(o){r[o]=t0(s),delete r[a];return}const l=t?rL(a):String(a).trim();l!==a&&delete r[a],r[l]=t0(s),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return fe.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&fe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[Iw]=this[Iw]={accessors:{}}).accessors,s=this.prototype;function a(o){const l=nc(o);n[l]||(nL(s,o),n[l]=!0)}return fe.isArray(t)?t.forEach(a):a(t),this}}Gf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);fe.reduceDescriptors(Gf.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});fe.freezeMethods(Gf);const bs=Gf;function sm(e,t){const r=this||Wg,n=t||r,s=bs.from(n.headers);let a=n.data;return fe.forEach(e,function(l){a=l.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function mS(e){return!!(e&&e.__CANCEL__)}function Fl(e,t,r){Ze.call(this,e??"canceled",Ze.ERR_CANCELED,t,r),this.name="CanceledError"}fe.inherits(Fl,Ze,{__CANCEL__:!0});function pS(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Ze("Request failed with status code "+r.status,[Ze.ERR_BAD_REQUEST,Ze.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function sL(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function aL(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[a];o||(o=u),r[s]=c,n[s]=u;let f=a,h=0;for(;f!==s;)h+=r[f++],f=f%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-o<t)return;const m=d&&u-d;return m?Math.round(h*1e3/m):void 0}}function iL(e,t){let r=0,n=1e3/t,s,a;const o=(u,d=Date.now())=>{r=d,s=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(s=u,a||(a=setTimeout(()=>{a=null,o(s)},n-f)))},()=>s&&o(s)]}const U0=(e,t,r=3)=>{let n=0;const s=aL(50,250);return iL(a=>{const o=a.loaded,l=a.lengthComputable?a.total:void 0,c=o-n,u=s(c),d=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:a,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},Rw=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Lw=e=>(...t)=>fe.asap(()=>e(...t)),oL=Hr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Hr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Hr.origin),Hr.navigator&&/(msie|trident)/i.test(Hr.navigator.userAgent)):()=>!0,lL=Hr.hasStandardBrowserEnv?{write(e,t,r,n,s,a){const o=[e+"="+encodeURIComponent(t)];fe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),fe.isString(n)&&o.push("path="+n),fe.isString(s)&&o.push("domain="+s),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function cL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function uL(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function xS(e,t,r){let n=!cL(t);return e&&(n||r==!1)?uL(e,t):t}const Ow=e=>e instanceof bs?{...e}:e;function to(e,t){t=t||{};const r={};function n(u,d,f,h){return fe.isPlainObject(u)&&fe.isPlainObject(d)?fe.merge.call({caseless:h},u,d):fe.isPlainObject(d)?fe.merge({},d):fe.isArray(d)?d.slice():d}function s(u,d,f,h){if(fe.isUndefined(d)){if(!fe.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function a(u,d){if(!fe.isUndefined(d))return n(void 0,d)}function o(u,d){if(fe.isUndefined(d)){if(!fe.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>s(Ow(u),Ow(d),f,!0)};return fe.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||s,h=f(e[d],t[d],d);fe.isUndefined(h)&&f!==l||(r[d]=h)}),r}const gS=e=>{const t=to({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:l}=t;t.headers=o=bs.from(o),t.url=dS(xS(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(fe.isFormData(r)){if(Hr.hasStandardBrowserEnv||Hr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(Hr.hasStandardBrowserEnv&&(n&&fe.isFunction(n)&&(n=n(t)),n||n!==!1&&oL(t.url))){const u=s&&a&&lL.read(a);u&&o.set(s,u)}return t},dL=typeof XMLHttpRequest<"u",fL=dL&&function(e){return new Promise(function(r,n){const s=gS(e);let a=s.data;const o=bs.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,f,h,m,g;function p(){m&&m(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function w(){if(!v)return;const x=bs.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),S={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:x,config:e,request:v};pS(function(b){r(b),p()},function(b){n(b),p()},S),v=null}"onloadend"in v?v.onloadend=w:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(w)},v.onabort=function(){v&&(n(new Ze("Request aborted",Ze.ECONNABORTED,e,v)),v=null)},v.onerror=function(){n(new Ze("Network Error",Ze.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let N=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const S=s.transitional||fS;s.timeoutErrorMessage&&(N=s.timeoutErrorMessage),n(new Ze(N,S.clarifyTimeoutError?Ze.ETIMEDOUT:Ze.ECONNABORTED,e,v)),v=null},a===void 0&&o.setContentType(null),"setRequestHeader"in v&&fe.forEach(o.toJSON(),function(N,S){v.setRequestHeader(S,N)}),fe.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),l&&l!=="json"&&(v.responseType=s.responseType),u&&([h,g]=U0(u,!0),v.addEventListener("progress",h)),c&&v.upload&&([f,m]=U0(c),v.upload.addEventListener("progress",f),v.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(d=x=>{v&&(n(!x||x.type?new Fl(null,e,v):x),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const y=sL(s.url);if(y&&Hr.protocols.indexOf(y)===-1){n(new Ze("Unsupported protocol "+y+":",Ze.ERR_BAD_REQUEST,e));return}v.send(a||null)})},hL=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof Ze?d:new Fl(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,a(new Ze(`timeout ${t} of ms exceeded`,Ze.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>fe.asap(l),c}},mL=hL,pL=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},xL=async function*(e,t){for await(const r of gL(e))yield*pL(r,t)},gL=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Mw=(e,t,r,n)=>{const s=xL(e,t);let a=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let h=a+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},Xf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",vS=Xf&&typeof ReadableStream=="function",vL=Xf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),yS=(e,...t)=>{try{return!!e(...t)}catch{return!1}},yL=vS&&yS(()=>{let e=!1;const t=new Request(Hr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Bw=64*1024,Wp=vS&&yS(()=>fe.isReadableStream(new Response("").body)),V0={stream:Wp&&(e=>e.body)};Xf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!V0[t]&&(V0[t]=fe.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new Ze(`Response type '${t}' is not supported`,Ze.ERR_NOT_SUPPORT,n)})})})(new Response);const wL=async e=>{if(e==null)return 0;if(fe.isBlob(e))return e.size;if(fe.isSpecCompliantForm(e))return(await new Request(Hr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(fe.isArrayBufferView(e)||fe.isArrayBuffer(e))return e.byteLength;if(fe.isURLSearchParams(e)&&(e=e+""),fe.isString(e))return(await vL(e)).byteLength},bL=async(e,t)=>{const r=fe.toFiniteNumber(e.getContentLength());return r??wL(t)},NL=Xf&&(async e=>{let{url:t,method:r,data:n,signal:s,cancelToken:a,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:h}=gS(e);u=u?(u+"").toLowerCase():"text";let m=mL([s,a&&a.toAbortSignal()],o),g;const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(c&&yL&&r!=="get"&&r!=="head"&&(v=await bL(d,n))!==0){let S=new Request(t,{method:"POST",body:n,duplex:"half"}),_;if(fe.isFormData(n)&&(_=S.headers.get("content-type"))&&d.setContentType(_),S.body){const[b,A]=Rw(v,U0(Lw(c)));n=Mw(S.body,Bw,b,A)}}fe.isString(f)||(f=f?"include":"omit");const w="credentials"in Request.prototype;g=new Request(t,{...h,signal:m,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:w?f:void 0});let y=await fetch(g,h);const x=Wp&&(u==="stream"||u==="response");if(Wp&&(l||x&&p)){const S={};["status","statusText","headers"].forEach(D=>{S[D]=y[D]});const _=fe.toFiniteNumber(y.headers.get("content-length")),[b,A]=l&&Rw(_,U0(Lw(l),!0))||[];y=new Response(Mw(y.body,Bw,b,()=>{A&&A(),p&&p()}),S)}u=u||"text";let N=await V0[fe.findKey(V0,u)||"text"](y,e);return!x&&p&&p(),await new Promise((S,_)=>{pS(S,_,{data:N,headers:bs.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:g})})}catch(w){throw p&&p(),w&&w.name==="TypeError"&&/Load failed|fetch/i.test(w.message)?Object.assign(new Ze("Network Error",Ze.ERR_NETWORK,e,g),{cause:w.cause||w}):Ze.from(w,w&&w.code,e,g)}}),Hp={http:RR,xhr:fL,fetch:NL};fe.forEach(Hp,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const $w=e=>`- ${e}`,kL=e=>fe.isFunction(e)||e===null||e===!1,wS={getAdapter:e=>{e=fe.isArray(e)?e:[e];const{length:t}=e;let r,n;const s={};for(let a=0;a<t;a++){r=e[a];let o;if(n=r,!kL(r)&&(n=Hp[(o=String(r)).toLowerCase()],n===void 0))throw new Ze(`Unknown adapter '${o}'`);if(n)break;s[o||"#"+a]=n}if(!n){const a=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map($w).join(`
`):" "+$w(a[0]):"as no adapter specified";throw new Ze("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Hp};function am(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Fl(null,e)}function Uw(e){return am(e),e.headers=bs.from(e.headers),e.data=sm.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),wS.getAdapter(e.adapter||Wg.adapter)(e).then(function(n){return am(e),n.data=sm.call(e,e.transformResponse,n),n.headers=bs.from(n.headers),n},function(n){return mS(n)||(am(e),n&&n.response&&(n.response.data=sm.call(e,e.transformResponse,n.response),n.response.headers=bs.from(n.response.headers))),Promise.reject(n)})}const bS="1.11.0",Kf={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Kf[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Vw={};Kf.transitional=function(t,r,n){function s(a,o){return"[Axios v"+bS+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,l)=>{if(t===!1)throw new Ze(s(o," has been removed"+(r?" in "+r:"")),Ze.ERR_DEPRECATED);return r&&!Vw[o]&&(Vw[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,o,l):!0}};Kf.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function _L(e,t,r){if(typeof e!="object")throw new Ze("options must be an object",Ze.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],o=t[a];if(o){const l=e[a],c=l===void 0||o(l,a,e);if(c!==!0)throw new Ze("option "+a+" must be "+c,Ze.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ze("Unknown option "+a,Ze.ERR_BAD_OPTION)}}const r0={assertOptions:_L,validators:Kf},As=r0.validators;class z0{constructor(t){this.defaults=t||{},this.interceptors={request:new Dw,response:new Dw}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=to(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&r0.assertOptions(n,{silentJSONParsing:As.transitional(As.boolean),forcedJSONParsing:As.transitional(As.boolean),clarifyTimeoutError:As.transitional(As.boolean)},!1),s!=null&&(fe.isFunction(s)?r.paramsSerializer={serialize:s}:r0.assertOptions(s,{encode:As.function,serialize:As.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),r0.assertOptions(r,{baseUrl:As.spelling("baseURL"),withXsrfToken:As.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=a&&fe.merge(a.common,a[r.method]);a&&fe.forEach(["delete","get","head","post","put","patch","common"],g=>{delete a[g]}),r.headers=bs.concat(o,a);const l=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,f=0,h;if(!c){const g=[Uw.bind(this),void 0];for(g.unshift(...l),g.push(...u),h=g.length,d=Promise.resolve(r);f<h;)d=d.then(g[f++],g[f++]);return d}h=l.length;let m=r;for(f=0;f<h;){const g=l[f++],p=l[f++];try{m=g(m)}catch(v){p.call(this,v);break}}try{d=Uw.call(this,m)}catch(g){return Promise.reject(g)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=to(this.defaults,t);const r=xS(t.baseURL,t.url,t.allowAbsoluteUrls);return dS(r,t.params,t.paramsSerializer)}}fe.forEach(["delete","get","head","options"],function(t){z0.prototype[t]=function(r,n){return this.request(to(n||{},{method:t,url:r,data:(n||{}).data}))}});fe.forEach(["post","put","patch"],function(t){function r(n){return function(a,o,l){return this.request(to(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}z0.prototype[t]=r(),z0.prototype[t+"Form"]=r(!0)});const n0=z0;class Hg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const o=new Promise(l=>{n.subscribe(l),a=l}).then(s);return o.cancel=function(){n.unsubscribe(a)},o},t(function(a,o,l){n.reason||(n.reason=new Fl(a,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Hg(function(s){t=s}),cancel:t}}}const SL=Hg;function jL(e){return function(r){return e.apply(null,r)}}function CL(e){return fe.isObject(e)&&e.isAxiosError===!0}const Gp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Gp).forEach(([e,t])=>{Gp[t]=e});const EL=Gp;function NS(e){const t=new n0(e),r=Q4(n0.prototype.request,t);return fe.extend(r,n0.prototype,t,{allOwnKeys:!0}),fe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return NS(to(e,s))},r}const ur=NS(Wg);ur.Axios=n0;ur.CanceledError=Fl;ur.CancelToken=SL;ur.isCancel=mS;ur.VERSION=bS;ur.toFormData=Hf;ur.AxiosError=Ze;ur.Cancel=ur.CanceledError;ur.all=function(t){return Promise.all(t)};ur.spread=jL;ur.isAxiosError=CL;ur.mergeConfig=to;ur.AxiosHeaders=bs;ur.formToJSON=e=>hS(fe.isHTMLForm(e)?new FormData(e):e);ur.getAdapter=wS.getAdapter;ur.HttpStatusCode=EL;ur.default=ur;const TL=ur,AL="https://api.kuntran.site/api",_e=TL.create({baseURL:AL,timeout:1e4,headers:{"Content-Type":"application/json"}});_e.interceptors.request.use(e=>e,e=>Promise.reject(e));_e.interceptors.response.use(e=>e,e=>{if(e.response)switch(console.error("API Error:",e.response.data),e.response.status){case 401:console.error("Unauthorized access");break;case 403:console.error("Access forbidden");break;case 404:console.error("Resource not found");break;case 500:console.error("Server error");break;default:console.error("API request failed")}else e.request?console.error("Network error:",e.request):console.error("Error:",e.message);return Promise.reject(e)});const ms={getAll:async(e={})=>{const t={page:e.page||1,limit:e.limit||15,...e};return _e.get("/inventory",{params:t})},getById:async e=>_e.get(`/inventory/${e}`),create:async e=>_e.post("/inventory",e),update:async(e,t)=>_e.put(`/inventory/${e}`,t),delete:async e=>_e.delete(`/inventory/${e}`),search:async(e,t={})=>{const r={search:e,page:t.page||1,limit:t.limit||15,...t};return _e.get("/inventory",{params:r})}},ra={getAll:async e=>{const t=e?{branchId:e}:{};return _e.get("/installments",{params:t})},getById:async e=>_e.get(`/installments/${e}`),create:async e=>_e.post("/installments",e),update:async(e,t)=>_e.put(`/installments/${e}`,t),delete:async e=>_e.delete(`/installments/${e}`)};/*!
* sweetalert2 v11.22.2
* Released under the MIT License.
*/function kS(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function FL(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zw(e,t){return e.get(kS(e,t))}function PL(e,t,r){FL(e,t),t.set(e,r)}function DL(e,t,r){return e.set(kS(e,t),r),r}const IL=100,We={},RL=()=>{We.previousActiveElement instanceof HTMLElement?(We.previousActiveElement.focus(),We.previousActiveElement=null):document.body&&document.body.focus()},LL=e=>new Promise(t=>{if(!e)return t();const r=window.scrollX,n=window.scrollY;We.restoreFocusTimeout=setTimeout(()=>{RL(),t()},IL),window.scrollTo(r,n)}),_S="swal2-",OL=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],me=OL.reduce((e,t)=>(e[t]=_S+t,e),{}),ML=["success","warning","info","question","error"],W0=ML.reduce((e,t)=>(e[t]=_S+t,e),{}),SS="SweetAlert2:",Gg=e=>e.charAt(0).toUpperCase()+e.slice(1),on=e=>{console.warn(`${SS} ${typeof e=="object"?e.join(" "):e}`)},po=e=>{console.error(`${SS} ${e}`)},Ww=[],BL=e=>{Ww.includes(e)||(Ww.push(e),on(e))},jS=(e,t=null)=>{BL(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},Yf=e=>typeof e=="function"?e():e,Xg=e=>e&&typeof e.toPromise=="function",Lu=e=>Xg(e)?e.toPromise():Promise.resolve(e),Kg=e=>e&&Promise.resolve(e)===e,un=()=>document.body.querySelector(`.${me.container}`),Ou=e=>{const t=un();return t?t.querySelector(e):null},$n=e=>Ou(`.${e}`),ht=()=>$n(me.popup),Pl=()=>$n(me.icon),$L=()=>$n(me["icon-content"]),CS=()=>$n(me.title),Yg=()=>$n(me["html-container"]),ES=()=>$n(me.image),qg=()=>$n(me["progress-steps"]),qf=()=>$n(me["validation-message"]),Hs=()=>Ou(`.${me.actions} .${me.confirm}`),Dl=()=>Ou(`.${me.actions} .${me.cancel}`),xo=()=>Ou(`.${me.actions} .${me.deny}`),UL=()=>$n(me["input-label"]),Il=()=>Ou(`.${me.loader}`),Mu=()=>$n(me.actions),TS=()=>$n(me.footer),Jf=()=>$n(me["timer-progress-bar"]),Jg=()=>$n(me.close),VL=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,Zg=()=>{const e=ht();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),r=Array.from(t).sort((a,o)=>{const l=parseInt(a.getAttribute("tabindex")||"0"),c=parseInt(o.getAttribute("tabindex")||"0");return l>c?1:l<c?-1:0}),n=e.querySelectorAll(VL),s=Array.from(n).filter(a=>a.getAttribute("tabindex")!=="-1");return[...new Set(r.concat(s))].filter(a=>yn(a))},Qg=()=>ca(document.body,me.shown)&&!ca(document.body,me["toast-shown"])&&!ca(document.body,me["no-backdrop"]),Zf=()=>{const e=ht();return e?ca(e,me.toast):!1},zL=()=>{const e=ht();return e?e.hasAttribute("data-loading"):!1},Un=(e,t)=>{if(e.textContent="",t){const n=new DOMParser().parseFromString(t,"text/html"),s=n.querySelector("head");s&&Array.from(s.childNodes).forEach(o=>{e.appendChild(o)});const a=n.querySelector("body");a&&Array.from(a.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?e.appendChild(o.cloneNode(!0)):e.appendChild(o)})}},ca=(e,t)=>{if(!t)return!1;const r=t.split(/\s+/);for(let n=0;n<r.length;n++)if(!e.classList.contains(r[n]))return!1;return!0},WL=(e,t)=>{Array.from(e.classList).forEach(r=>{!Object.values(me).includes(r)&&!Object.values(W0).includes(r)&&!Object.values(t.showClass||{}).includes(r)&&e.classList.remove(r)})},Ln=(e,t,r)=>{if(WL(e,t),!t.customClass)return;const n=t.customClass[r];if(n){if(typeof n!="string"&&!n.forEach){on(`Invalid type of customClass.${r}! Expected string or iterable object, got "${typeof n}"`);return}mt(e,n)}},Qf=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${me.popup} > .${me[t]}`);case"checkbox":return e.querySelector(`.${me.popup} > .${me.checkbox} input`);case"radio":return e.querySelector(`.${me.popup} > .${me.radio} input:checked`)||e.querySelector(`.${me.popup} > .${me.radio} input:first-child`);case"range":return e.querySelector(`.${me.popup} > .${me.range} input`);default:return e.querySelector(`.${me.popup} > .${me.input}`)}},AS=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},FS=(e,t,r)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(n=>{Array.isArray(e)?e.forEach(s=>{r?s.classList.add(n):s.classList.remove(n)}):r?e.classList.add(n):e.classList.remove(n)}))},mt=(e,t)=>{FS(e,t,!0)},os=(e,t)=>{FS(e,t,!1)},Ua=(e,t)=>{const r=Array.from(e.children);for(let n=0;n<r.length;n++){const s=r[n];if(s instanceof HTMLElement&&ca(s,t))return s}},$i=(e,t,r)=>{r===`${parseInt(r)}`&&(r=parseInt(r)),r||parseInt(r)===0?e.style.setProperty(t,typeof r=="number"?`${r}px`:r):e.style.removeProperty(t)},jr=(e,t="flex")=>{e&&(e.style.display=t)},Yr=e=>{e&&(e.style.display="none")},e1=(e,t="block")=>{e&&new MutationObserver(()=>{Bu(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},Hw=(e,t,r,n)=>{const s=e.querySelector(t);s&&s.style.setProperty(r,n)},Bu=(e,t,r="flex")=>{t?jr(e,r):Yr(e)},yn=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),HL=()=>!yn(Hs())&&!yn(xo())&&!yn(Dl()),Xp=e=>e.scrollHeight>e.clientHeight,GL=(e,t)=>{let r=e;for(;r&&r!==t;){if(Xp(r))return!0;r=r.parentElement}return!1},PS=e=>{const t=window.getComputedStyle(e),r=parseFloat(t.getPropertyValue("animation-duration")||"0"),n=parseFloat(t.getPropertyValue("transition-duration")||"0");return r>0||n>0},t1=(e,t=!1)=>{const r=Jf();r&&yn(r)&&(t&&(r.style.transition="none",r.style.width="100%"),setTimeout(()=>{r.style.transition=`width ${e/1e3}s linear`,r.style.width="0%"},10))},XL=()=>{const e=Jf();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const r=parseInt(window.getComputedStyle(e).width),n=t/r*100;e.style.width=`${n}%`},KL=()=>typeof window>"u"||typeof document>"u",YL=`
 <div aria-labelledby="${me.title}" aria-describedby="${me["html-container"]}" class="${me.popup}" tabindex="-1">
   <button type="button" class="${me.close}"></button>
   <ul class="${me["progress-steps"]}"></ul>
   <div class="${me.icon}"></div>
   <img class="${me.image}" />
   <h2 class="${me.title}" id="${me.title}"></h2>
   <div class="${me["html-container"]}" id="${me["html-container"]}"></div>
   <input class="${me.input}" id="${me.input}" />
   <input type="file" class="${me.file}" />
   <div class="${me.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${me.select}" id="${me.select}"></select>
   <div class="${me.radio}"></div>
   <label class="${me.checkbox}">
     <input type="checkbox" id="${me.checkbox}" />
     <span class="${me.label}"></span>
   </label>
   <textarea class="${me.textarea}" id="${me.textarea}"></textarea>
   <div class="${me["validation-message"]}" id="${me["validation-message"]}"></div>
   <div class="${me.actions}">
     <div class="${me.loader}"></div>
     <button type="button" class="${me.confirm}"></button>
     <button type="button" class="${me.deny}"></button>
     <button type="button" class="${me.cancel}"></button>
   </div>
   <div class="${me.footer}"></div>
   <div class="${me["timer-progress-bar-container"]}">
     <div class="${me["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),qL=()=>{const e=un();return e?(e.remove(),os([document.documentElement,document.body],[me["no-backdrop"],me["toast-shown"],me["has-column"]]),!0):!1},bi=()=>{We.currentInstance.resetValidationMessage()},JL=()=>{const e=ht(),t=Ua(e,me.input),r=Ua(e,me.file),n=e.querySelector(`.${me.range} input`),s=e.querySelector(`.${me.range} output`),a=Ua(e,me.select),o=e.querySelector(`.${me.checkbox} input`),l=Ua(e,me.textarea);t.oninput=bi,r.onchange=bi,a.onchange=bi,o.onchange=bi,l.oninput=bi,n.oninput=()=>{bi(),s.value=n.value},n.onchange=()=>{bi(),s.value=n.value}},ZL=e=>typeof e=="string"?document.querySelector(e):e,QL=e=>{const t=ht();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},eO=e=>{window.getComputedStyle(e).direction==="rtl"&&mt(un(),me.rtl)},tO=e=>{const t=qL();if(KL()){po("SweetAlert2 requires document to initialize");return}const r=document.createElement("div");r.className=me.container,t&&mt(r,me["no-transition"]),Un(r,YL),r.dataset.swal2Theme=e.theme;const n=ZL(e.target);n.appendChild(r),e.topLayer&&(r.setAttribute("popover",""),r.showPopover()),QL(e),eO(n),JL()},r1=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?rO(e,t):e&&Un(t,e)},rO=(e,t)=>{e.jquery?nO(t,e):Un(t,e.toString())},nO=(e,t)=>{if(e.textContent="",0 in t)for(let r=0;r in t;r++)e.appendChild(t[r].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},sO=(e,t)=>{const r=Mu(),n=Il();!r||!n||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?Yr(r):jr(r),Ln(r,t,"actions"),aO(r,n,t),Un(n,t.loaderHtml||""),Ln(n,t,"loader"))};function aO(e,t,r){const n=Hs(),s=xo(),a=Dl();!n||!s||!a||(om(n,"confirm",r),om(s,"deny",r),om(a,"cancel",r),iO(n,s,a,r),r.reverseButtons&&(r.toast?(e.insertBefore(a,n),e.insertBefore(s,n)):(e.insertBefore(a,t),e.insertBefore(s,t),e.insertBefore(n,t))))}function iO(e,t,r,n){if(!n.buttonsStyling){os([e,t,r],me.styled);return}mt([e,t,r],me.styled),n.confirmButtonColor&&e.style.setProperty("--swal2-confirm-button-background-color",n.confirmButtonColor),n.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",n.denyButtonColor),n.cancelButtonColor&&r.style.setProperty("--swal2-cancel-button-background-color",n.cancelButtonColor),im(e),im(t),im(r)}function im(e){const t=window.getComputedStyle(e);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const r=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");e.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${r}`))}function om(e,t,r){const n=Gg(t);Bu(e,r[`show${n}Button`],"inline-block"),Un(e,r[`${t}ButtonText`]||""),e.setAttribute("aria-label",r[`${t}ButtonAriaLabel`]||""),e.className=me[t],Ln(e,r,`${t}Button`)}const oO=(e,t)=>{const r=Jg();r&&(Un(r,t.closeButtonHtml||""),Ln(r,t,"closeButton"),Bu(r,t.showCloseButton),r.setAttribute("aria-label",t.closeButtonAriaLabel||""))},lO=(e,t)=>{const r=un();r&&(cO(r,t.backdrop),uO(r,t.position),dO(r,t.grow),Ln(r,t,"container"))};function cO(e,t){typeof t=="string"?e.style.background=t:t||mt([document.documentElement,document.body],me["no-backdrop"])}function uO(e,t){t&&(t in me?mt(e,me[t]):(on('The "position" parameter is not valid, defaulting to "center"'),mt(e,me.center)))}function dO(e,t){t&&mt(e,me[`grow-${t}`])}var _t={innerParams:new WeakMap,domCache:new WeakMap};const fO=["input","file","range","select","radio","checkbox","textarea"],hO=(e,t)=>{const r=ht();if(!r)return;const n=_t.innerParams.get(e),s=!n||t.input!==n.input;fO.forEach(a=>{const o=Ua(r,me[a]);o&&(xO(a,t.inputAttributes),o.className=me[a],s&&Yr(o))}),t.input&&(s&&mO(t),gO(t))},mO=e=>{if(!e.input)return;if(!Jt[e.input]){po(`Unexpected type of input! Expected ${Object.keys(Jt).join(" | ")}, got "${e.input}"`);return}const t=DS(e.input);if(!t)return;const r=Jt[e.input](t,e);jr(t),e.inputAutoFocus&&setTimeout(()=>{AS(r)})},pO=e=>{for(let t=0;t<e.attributes.length;t++){const r=e.attributes[t].name;["id","type","value","style"].includes(r)||e.removeAttribute(r)}},xO=(e,t)=>{const r=ht();if(!r)return;const n=Qf(r,e);if(n){pO(n);for(const s in t)n.setAttribute(s,t[s])}},gO=e=>{if(!e.input)return;const t=DS(e.input);t&&Ln(t,e,"input")},n1=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},$u=(e,t,r)=>{if(r.inputLabel){const n=document.createElement("label"),s=me["input-label"];n.setAttribute("for",e.id),n.className=s,typeof r.customClass=="object"&&mt(n,r.customClass.inputLabel),n.innerText=r.inputLabel,t.insertAdjacentElement("beforebegin",n)}},DS=e=>{const t=ht();if(t)return Ua(t,me[e]||me.input)},H0=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:Kg(t)||on(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},Jt={};Jt.text=Jt.email=Jt.password=Jt.number=Jt.tel=Jt.url=Jt.search=Jt.date=Jt["datetime-local"]=Jt.time=Jt.week=Jt.month=(e,t)=>(H0(e,t.inputValue),$u(e,e,t),n1(e,t),e.type=t.input,e);Jt.file=(e,t)=>($u(e,e,t),n1(e,t),e);Jt.range=(e,t)=>{const r=e.querySelector("input"),n=e.querySelector("output");return H0(r,t.inputValue),r.type=t.input,H0(n,t.inputValue),$u(r,e,t),e};Jt.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const r=document.createElement("option");Un(r,t.inputPlaceholder),r.value="",r.disabled=!0,r.selected=!0,e.appendChild(r)}return $u(e,e,t),e};Jt.radio=e=>(e.textContent="",e);Jt.checkbox=(e,t)=>{const r=Qf(ht(),"checkbox");r.value="1",r.checked=!!t.inputValue;const n=e.querySelector("span");return Un(n,t.inputPlaceholder||t.inputLabel),r};Jt.textarea=(e,t)=>{H0(e,t.inputValue),n1(e,t),$u(e,e,t);const r=n=>parseInt(window.getComputedStyle(n).marginLeft)+parseInt(window.getComputedStyle(n).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const n=parseInt(window.getComputedStyle(ht()).width),s=()=>{if(!document.body.contains(e))return;const a=e.offsetWidth+r(e);a>n?ht().style.width=`${a}px`:$i(ht(),"width",t.width)};new MutationObserver(s).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const vO=(e,t)=>{const r=Yg();r&&(e1(r),Ln(r,t,"htmlContainer"),t.html?(r1(t.html,r),jr(r,"block")):t.text?(r.textContent=t.text,jr(r,"block")):Yr(r),hO(e,t))},yO=(e,t)=>{const r=TS();r&&(e1(r),Bu(r,t.footer,"block"),t.footer&&r1(t.footer,r),Ln(r,t,"footer"))},wO=(e,t)=>{const r=_t.innerParams.get(e),n=Pl();if(!n)return;if(r&&t.icon===r.icon){Xw(n,t),Gw(n,t);return}if(!t.icon&&!t.iconHtml){Yr(n);return}if(t.icon&&Object.keys(W0).indexOf(t.icon)===-1){po(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),Yr(n);return}jr(n),Xw(n,t),Gw(n,t),mt(n,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",IS)},Gw=(e,t)=>{for(const[r,n]of Object.entries(W0))t.icon!==r&&os(e,n);mt(e,t.icon&&W0[t.icon]),kO(e,t),IS(),Ln(e,t,"icon")},IS=()=>{const e=ht();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),r=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let n=0;n<r.length;n++)r[n].style.backgroundColor=t},bO=e=>`
  ${e.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${e.animation?'<div class="swal2-success-fix"></div>':""}
  ${e.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,NO=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,Xw=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let r=e.innerHTML,n="";t.iconHtml?n=Kw(t.iconHtml):t.icon==="success"?(n=bO(t),r=r.replace(/ style=".*?"/g,"")):t.icon==="error"?n=NO:t.icon&&(n=Kw({question:"?",warning:"!",info:"i"}[t.icon])),r.trim()!==n.trim()&&Un(e,n)},kO=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const r of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Hw(e,r,"background-color",t.iconColor);Hw(e,".swal2-success-ring","border-color",t.iconColor)}},Kw=e=>`<div class="${me["icon-content"]}">${e}</div>`,_O=(e,t)=>{const r=ES();if(r){if(!t.imageUrl){Yr(r);return}jr(r,""),r.setAttribute("src",t.imageUrl),r.setAttribute("alt",t.imageAlt||""),$i(r,"width",t.imageWidth),$i(r,"height",t.imageHeight),r.className=me.image,Ln(r,t,"image")}};let s1=!1,RS=0,LS=0,OS=0,MS=0;const SO=e=>{e.addEventListener("mousedown",G0),document.body.addEventListener("mousemove",X0),e.addEventListener("mouseup",K0),e.addEventListener("touchstart",G0),document.body.addEventListener("touchmove",X0),e.addEventListener("touchend",K0)},jO=e=>{e.removeEventListener("mousedown",G0),document.body.removeEventListener("mousemove",X0),e.removeEventListener("mouseup",K0),e.removeEventListener("touchstart",G0),document.body.removeEventListener("touchmove",X0),e.removeEventListener("touchend",K0)},G0=e=>{const t=ht();if(e.target===t||Pl().contains(e.target)){s1=!0;const r=BS(e);RS=r.clientX,LS=r.clientY,OS=parseInt(t.style.insetInlineStart)||0,MS=parseInt(t.style.insetBlockStart)||0,mt(t,"swal2-dragging")}},X0=e=>{const t=ht();if(s1){let{clientX:r,clientY:n}=BS(e);t.style.insetInlineStart=`${OS+(r-RS)}px`,t.style.insetBlockStart=`${MS+(n-LS)}px`}},K0=()=>{const e=ht();s1=!1,os(e,"swal2-dragging")},BS=e=>{let t=0,r=0;return e.type.startsWith("mouse")?(t=e.clientX,r=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,r=e.touches[0].clientY),{clientX:t,clientY:r}},CO=(e,t)=>{const r=un(),n=ht();if(!(!r||!n)){if(t.toast){$i(r,"width",t.width),n.style.width="100%";const s=Il();s&&n.insertBefore(s,Pl())}else $i(n,"width",t.width);$i(n,"padding",t.padding),t.color&&(n.style.color=t.color),t.background&&(n.style.background=t.background),Yr(qf()),EO(n,t),t.draggable&&!t.toast?(mt(n,me.draggable),SO(n)):(os(n,me.draggable),jO(n))}},EO=(e,t)=>{const r=t.showClass||{};e.className=`${me.popup} ${yn(e)?r.popup:""}`,t.toast?(mt([document.documentElement,document.body],me["toast-shown"]),mt(e,me.toast)):mt(e,me.modal),Ln(e,t,"popup"),typeof t.customClass=="string"&&mt(e,t.customClass),t.icon&&mt(e,me[`icon-${t.icon}`])},TO=(e,t)=>{const r=qg();if(!r)return;const{progressSteps:n,currentProgressStep:s}=t;if(!n||n.length===0||s===void 0){Yr(r);return}jr(r),r.textContent="",s>=n.length&&on("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),n.forEach((a,o)=>{const l=AO(a);if(r.appendChild(l),o===s&&mt(l,me["active-progress-step"]),o!==n.length-1){const c=FO(t);r.appendChild(c)}})},AO=e=>{const t=document.createElement("li");return mt(t,me["progress-step"]),Un(t,e),t},FO=e=>{const t=document.createElement("li");return mt(t,me["progress-step-line"]),e.progressStepsDistance&&$i(t,"width",e.progressStepsDistance),t},PO=(e,t)=>{const r=CS();r&&(e1(r),Bu(r,t.title||t.titleText,"block"),t.title&&r1(t.title,r),t.titleText&&(r.innerText=t.titleText),Ln(r,t,"title"))},$S=(e,t)=>{CO(e,t),lO(e,t),TO(e,t),wO(e,t),_O(e,t),PO(e,t),oO(e,t),vO(e,t),sO(e,t),yO(e,t);const r=ht();typeof t.didRender=="function"&&r&&t.didRender(r),We.eventEmitter.emit("didRender",r)},DO=()=>yn(ht()),US=()=>{var e;return(e=Hs())===null||e===void 0?void 0:e.click()},IO=()=>{var e;return(e=xo())===null||e===void 0?void 0:e.click()},RO=()=>{var e;return(e=Dl())===null||e===void 0?void 0:e.click()},Rl=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),VS=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},LO=(e,t,r)=>{VS(e),t.toast||(e.keydownHandler=n=>MO(t,n,r),e.keydownTarget=t.keydownListenerCapture?window:ht(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},Kp=(e,t)=>{var r;const n=Zg();if(n.length){e=e+t,e===-2&&(e=n.length-1),e===n.length?e=0:e===-1&&(e=n.length-1),n[e].focus();return}(r=ht())===null||r===void 0||r.focus()},zS=["ArrowRight","ArrowDown"],OO=["ArrowLeft","ArrowUp"],MO=(e,t,r)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?BO(t,e):t.key==="Tab"?$O(t):[...zS,...OO].includes(t.key)?UO(t.key):t.key==="Escape"&&VO(t,e,r)))},BO=(e,t)=>{if(!Yf(t.allowEnterKey))return;const r=Qf(ht(),t.input);if(e.target&&r&&e.target instanceof HTMLElement&&e.target.outerHTML===r.outerHTML){if(["textarea","file"].includes(t.input))return;US(),e.preventDefault()}},$O=e=>{const t=e.target,r=Zg();let n=-1;for(let s=0;s<r.length;s++)if(t===r[s]){n=s;break}e.shiftKey?Kp(n,-1):Kp(n,1),e.stopPropagation(),e.preventDefault()},UO=e=>{const t=Mu(),r=Hs(),n=xo(),s=Dl();if(!t||!r||!n||!s)return;const a=[r,n,s];if(document.activeElement instanceof HTMLElement&&!a.includes(document.activeElement))return;const o=zS.includes(e)?"nextElementSibling":"previousElementSibling";let l=document.activeElement;if(l){for(let c=0;c<t.children.length;c++){if(l=l[o],!l)return;if(l instanceof HTMLButtonElement&&yn(l))break}l instanceof HTMLButtonElement&&l.focus()}},VO=(e,t,r)=>{e.preventDefault(),Yf(t.allowEscapeKey)&&r(Rl.esc)};var vl={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const zO=()=>{const e=un();Array.from(document.body.children).forEach(r=>{r.contains(e)||(r.hasAttribute("aria-hidden")&&r.setAttribute("data-previous-aria-hidden",r.getAttribute("aria-hidden")||""),r.setAttribute("aria-hidden","true"))})},WS=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},HS=typeof window<"u"&&!!window.GestureEvent,WO=()=>{if(HS&&!ca(document.body,me.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,mt(document.body,me.iosfix),HO()}},HO=()=>{const e=un();if(!e)return;let t;e.ontouchstart=r=>{t=GO(r)},e.ontouchmove=r=>{t&&(r.preventDefault(),r.stopPropagation())}},GO=e=>{const t=e.target,r=un(),n=Yg();return!r||!n||XO(e)||KO(e)?!1:t===r||!Xp(r)&&t instanceof HTMLElement&&!GL(t,n)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(Xp(n)&&n.contains(t))},XO=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",KO=e=>e.touches&&e.touches.length>1,YO=()=>{if(ca(document.body,me.iosfix)){const e=parseInt(document.body.style.top,10);os(document.body,me.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},qO=()=>{const e=document.createElement("div");e.className=me["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let tl=null;const JO=e=>{tl===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&(tl=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${tl+qO()}px`)},ZO=()=>{tl!==null&&(document.body.style.paddingRight=`${tl}px`,tl=null)};function GS(e,t,r,n){Zf()?Yw(e,n):(LL(r).then(()=>Yw(e,n)),VS(We)),HS?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),Qg()&&(ZO(),YO(),WS()),QO()}function QO(){os([document.documentElement,document.body],[me.shown,me["height-auto"],me["no-backdrop"],me["toast-shown"]])}function Va(e){e=tM(e);const t=vl.swalPromiseResolve.get(this),r=eM(this);this.isAwaitingPromise?e.isDismissed||(Uu(this),t(e)):r&&t(e)}const eM=e=>{const t=ht();if(!t)return!1;const r=_t.innerParams.get(e);if(!r||ca(t,r.hideClass.popup))return!1;os(t,r.showClass.popup),mt(t,r.hideClass.popup);const n=un();return os(n,r.showClass.backdrop),mt(n,r.hideClass.backdrop),rM(e,t,r),!0};function XS(e){const t=vl.swalPromiseReject.get(this);Uu(this),t&&t(e)}const Uu=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,_t.innerParams.get(e)||e._destroy())},tM=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),rM=(e,t,r)=>{var n;const s=un(),a=PS(t);typeof r.willClose=="function"&&r.willClose(t),(n=We.eventEmitter)===null||n===void 0||n.emit("willClose",t),a?nM(e,t,s,r.returnFocus,r.didClose):GS(e,s,r.returnFocus,r.didClose)},nM=(e,t,r,n,s)=>{We.swalCloseEventFinishedCallback=GS.bind(null,e,r,n,s);const a=function(o){if(o.target===t){var l;(l=We.swalCloseEventFinishedCallback)===null||l===void 0||l.call(We),delete We.swalCloseEventFinishedCallback,t.removeEventListener("animationend",a),t.removeEventListener("transitionend",a)}};t.addEventListener("animationend",a),t.addEventListener("transitionend",a)},Yw=(e,t)=>{setTimeout(()=>{var r;typeof t=="function"&&t.bind(e.params)(),(r=We.eventEmitter)===null||r===void 0||r.emit("didClose"),e._destroy&&e._destroy()})},yl=e=>{let t=ht();if(t||new lt,t=ht(),!t)return;const r=Il();Zf()?Yr(Pl()):sM(t,e),jr(r),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},sM=(e,t)=>{const r=Mu(),n=Il();!r||!n||(!t&&yn(Hs())&&(t=Hs()),jr(r),t&&(Yr(t),n.setAttribute("data-button-to-replace",t.className),r.insertBefore(n,t)),mt([e,r],me.loading))},aM=(e,t)=>{t.input==="select"||t.input==="radio"?uM(e,t):["text","email","number","tel","textarea"].some(r=>r===t.input)&&(Xg(t.inputValue)||Kg(t.inputValue))&&(yl(Hs()),dM(e,t))},iM=(e,t)=>{const r=e.getInput();if(!r)return null;switch(t.input){case"checkbox":return oM(r);case"radio":return lM(r);case"file":return cM(r);default:return t.inputAutoTrim?r.value.trim():r.value}},oM=e=>e.checked?1:0,lM=e=>e.checked?e.value:null,cM=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,uM=(e,t)=>{const r=ht();if(!r)return;const n=s=>{t.input==="select"?fM(r,Y0(s),t):t.input==="radio"&&hM(r,Y0(s),t)};Xg(t.inputOptions)||Kg(t.inputOptions)?(yl(Hs()),Lu(t.inputOptions).then(s=>{e.hideLoading(),n(s)})):typeof t.inputOptions=="object"?n(t.inputOptions):po(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},dM=(e,t)=>{const r=e.getInput();r&&(Yr(r),Lu(t.inputValue).then(n=>{r.value=t.input==="number"?`${parseFloat(n)||0}`:`${n}`,jr(r),r.focus(),e.hideLoading()}).catch(n=>{po(`Error in inputValue promise: ${n}`),r.value="",jr(r),r.focus(),e.hideLoading()}))};function fM(e,t,r){const n=Ua(e,me.select);if(!n)return;const s=(a,o,l)=>{const c=document.createElement("option");c.value=l,Un(c,o),c.selected=KS(l,r.inputValue),a.appendChild(c)};t.forEach(a=>{const o=a[0],l=a[1];if(Array.isArray(l)){const c=document.createElement("optgroup");c.label=o,c.disabled=!1,n.appendChild(c),l.forEach(u=>s(c,u[1],u[0]))}else s(n,l,o)}),n.focus()}function hM(e,t,r){const n=Ua(e,me.radio);if(!n)return;t.forEach(a=>{const o=a[0],l=a[1],c=document.createElement("input"),u=document.createElement("label");c.type="radio",c.name=me.radio,c.value=o,KS(o,r.inputValue)&&(c.checked=!0);const d=document.createElement("span");Un(d,l),d.className=me.label,u.appendChild(c),u.appendChild(d),n.appendChild(u)});const s=n.querySelectorAll("input");s.length&&s[0].focus()}const Y0=e=>{const t=[];return e instanceof Map?e.forEach((r,n)=>{let s=r;typeof s=="object"&&(s=Y0(s)),t.push([n,s])}):Object.keys(e).forEach(r=>{let n=e[r];typeof n=="object"&&(n=Y0(n)),t.push([r,n])}),t},KS=(e,t)=>!!t&&t.toString()===e.toString(),mM=e=>{const t=_t.innerParams.get(e);e.disableButtons(),t.input?YS(e,"confirm"):i1(e,!0)},pM=e=>{const t=_t.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?YS(e,"deny"):a1(e,!1)},xM=(e,t)=>{e.disableButtons(),t(Rl.cancel)},YS=(e,t)=>{const r=_t.innerParams.get(e);if(!r.input){po(`The "input" parameter is needed to be set when using returnInputValueOn${Gg(t)}`);return}const n=e.getInput(),s=iM(e,r);r.inputValidator?gM(e,s,t):n&&!n.checkValidity()?(e.enableButtons(),e.showValidationMessage(r.validationMessage||n.validationMessage)):t==="deny"?a1(e,s):i1(e,s)},gM=(e,t,r)=>{const n=_t.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>Lu(n.inputValidator(t,n.validationMessage))).then(a=>{e.enableButtons(),e.enableInput(),a?e.showValidationMessage(a):r==="deny"?a1(e,t):i1(e,t)})},a1=(e,t)=>{const r=_t.innerParams.get(e||void 0);r.showLoaderOnDeny&&yl(xo()),r.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>Lu(r.preDeny(t,r.validationMessage))).then(s=>{s===!1?(e.hideLoading(),Uu(e)):e.close({isDenied:!0,value:typeof s>"u"?t:s})}).catch(s=>qS(e||void 0,s))):e.close({isDenied:!0,value:t})},qw=(e,t)=>{e.close({isConfirmed:!0,value:t})},qS=(e,t)=>{e.rejectPromise(t)},i1=(e,t)=>{const r=_t.innerParams.get(e||void 0);r.showLoaderOnConfirm&&yl(),r.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>Lu(r.preConfirm(t,r.validationMessage))).then(s=>{yn(qf())||s===!1?(e.hideLoading(),Uu(e)):qw(e,typeof s>"u"?t:s)}).catch(s=>qS(e||void 0,s))):qw(e,t)};function q0(){const e=_t.innerParams.get(this);if(!e)return;const t=_t.domCache.get(this);Yr(t.loader),Zf()?e.icon&&jr(Pl()):vM(t),os([t.popup,t.actions],me.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const vM=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?jr(t[0],"inline-block"):HL()&&Yr(e.actions)};function JS(){const e=_t.innerParams.get(this),t=_t.domCache.get(this);return t?Qf(t.popup,e.input):null}function ZS(e,t,r){const n=_t.domCache.get(e);t.forEach(s=>{n[s].disabled=r})}function QS(e,t){const r=ht();if(!(!r||!e))if(e.type==="radio"){const n=r.querySelectorAll(`[name="${me.radio}"]`);for(let s=0;s<n.length;s++)n[s].disabled=t}else e.disabled=t}function ej(){ZS(this,["confirmButton","denyButton","cancelButton"],!1)}function tj(){ZS(this,["confirmButton","denyButton","cancelButton"],!0)}function rj(){QS(this.getInput(),!1)}function nj(){QS(this.getInput(),!0)}function sj(e){const t=_t.domCache.get(this),r=_t.innerParams.get(this);Un(t.validationMessage,e),t.validationMessage.className=me["validation-message"],r.customClass&&r.customClass.validationMessage&&mt(t.validationMessage,r.customClass.validationMessage),jr(t.validationMessage);const n=this.getInput();n&&(n.setAttribute("aria-invalid","true"),n.setAttribute("aria-describedby",me["validation-message"]),AS(n),mt(n,me.inputerror))}function aj(){const e=_t.domCache.get(this);e.validationMessage&&Yr(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),os(t,me.inputerror))}const rl={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},yM=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],wM={allowEnterKey:void 0},bM=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],ij=e=>Object.prototype.hasOwnProperty.call(rl,e),oj=e=>yM.indexOf(e)!==-1,lj=e=>wM[e],NM=e=>{ij(e)||on(`Unknown parameter "${e}"`)},kM=e=>{bM.includes(e)&&on(`The parameter "${e}" is incompatible with toasts`)},_M=e=>{const t=lj(e);t&&jS(e,t)},cj=e=>{e.backdrop===!1&&e.allowOutsideClick&&on('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(e.theme)&&on(`Invalid theme "${e.theme}"`);for(const t in e)NM(t),e.toast&&kM(t),_M(t)};function uj(e){const t=un(),r=ht(),n=_t.innerParams.get(this);if(!r||ca(r,n.hideClass.popup)){on("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const s=SM(e),a=Object.assign({},n,s);cj(a),t.dataset.swal2Theme=a.theme,$S(this,a),_t.innerParams.set(this,a),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const SM=e=>{const t={};return Object.keys(e).forEach(r=>{oj(r)?t[r]=e[r]:on(`Invalid parameter to update: ${r}`)}),t};function dj(){const e=_t.domCache.get(this),t=_t.innerParams.get(this);if(!t){fj(this);return}e.popup&&We.swalCloseEventFinishedCallback&&(We.swalCloseEventFinishedCallback(),delete We.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),We.eventEmitter.emit("didDestroy"),jM(this)}const jM=e=>{fj(e),delete e.params,delete We.keydownHandler,delete We.keydownTarget,delete We.currentInstance},fj=e=>{e.isAwaitingPromise?(lm(_t,e),e.isAwaitingPromise=!0):(lm(vl,e),lm(_t,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},lm=(e,t)=>{for(const r in e)e[r].delete(t)};var CM=Object.freeze({__proto__:null,_destroy:dj,close:Va,closeModal:Va,closePopup:Va,closeToast:Va,disableButtons:tj,disableInput:nj,disableLoading:q0,enableButtons:ej,enableInput:rj,getInput:JS,handleAwaitingPromise:Uu,hideLoading:q0,rejectPromise:XS,resetValidationMessage:aj,showValidationMessage:sj,update:uj});const EM=(e,t,r)=>{e.toast?TM(e,t,r):(FM(t),PM(t),DM(e,t,r))},TM=(e,t,r)=>{t.popup.onclick=()=>{e&&(AM(e)||e.timer||e.input)||r(Rl.close)}},AM=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let J0=!1;const FM=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(J0=!0)}}},PM=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(r){e.popup.onmouseup=()=>{},(r.target===e.popup||r.target instanceof HTMLElement&&e.popup.contains(r.target))&&(J0=!0)}}},DM=(e,t,r)=>{t.container.onclick=n=>{if(J0){J0=!1;return}n.target===t.container&&Yf(e.allowOutsideClick)&&r(Rl.backdrop)}},IM=e=>typeof e=="object"&&e.jquery,Jw=e=>e instanceof Element||IM(e),RM=e=>{const t={};return typeof e[0]=="object"&&!Jw(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((r,n)=>{const s=e[n];typeof s=="string"||Jw(s)?t[r]=s:s!==void 0&&po(`Unexpected type of ${r}! Expected "string" or "Element", got ${typeof s}`)}),t};function LM(...e){return new this(...e)}function OM(e){class t extends this{_main(n,s){return super._main(n,Object.assign({},e,s))}}return t}const MM=()=>We.timeout&&We.timeout.getTimerLeft(),hj=()=>{if(We.timeout)return XL(),We.timeout.stop()},mj=()=>{if(We.timeout){const e=We.timeout.start();return t1(e),e}},BM=()=>{const e=We.timeout;return e&&(e.running?hj():mj())},$M=e=>{if(We.timeout){const t=We.timeout.increase(e);return t1(t,!0),t}},UM=()=>!!(We.timeout&&We.timeout.isRunning());let Zw=!1;const Yp={};function VM(e="data-swal-template"){Yp[e]=this,Zw||(document.body.addEventListener("click",zM),Zw=!0)}const zM=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const r in Yp){const n=t.getAttribute(r);if(n){Yp[r].fire({template:n});return}}};class WM{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,r){const n=this._getHandlersByEventName(t);n.includes(r)||n.push(r)}once(t,r){const n=(...s)=>{this.removeListener(t,n),r.apply(this,s)};this.on(t,n)}emit(t,...r){this._getHandlersByEventName(t).forEach(n=>{try{n.apply(this,r)}catch(s){console.error(s)}})}removeListener(t,r){const n=this._getHandlersByEventName(t),s=n.indexOf(r);s>-1&&n.splice(s,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}We.eventEmitter=new WM;const HM=(e,t)=>{We.eventEmitter.on(e,t)},GM=(e,t)=>{We.eventEmitter.once(e,t)},XM=(e,t)=>{if(!e){We.eventEmitter.reset();return}t?We.eventEmitter.removeListener(e,t):We.eventEmitter.removeAllListeners(e)};var KM=Object.freeze({__proto__:null,argsToParams:RM,bindClickHandler:VM,clickCancel:RO,clickConfirm:US,clickDeny:IO,enableLoading:yl,fire:LM,getActions:Mu,getCancelButton:Dl,getCloseButton:Jg,getConfirmButton:Hs,getContainer:un,getDenyButton:xo,getFocusableElements:Zg,getFooter:TS,getHtmlContainer:Yg,getIcon:Pl,getIconContent:$L,getImage:ES,getInputLabel:UL,getLoader:Il,getPopup:ht,getProgressSteps:qg,getTimerLeft:MM,getTimerProgressBar:Jf,getTitle:CS,getValidationMessage:qf,increaseTimer:$M,isDeprecatedParameter:lj,isLoading:zL,isTimerRunning:UM,isUpdatableParameter:oj,isValidParameter:ij,isVisible:DO,mixin:OM,off:XM,on:HM,once:GM,resumeTimer:mj,showLoading:yl,stopTimer:hj,toggleTimer:BM});class YM{constructor(t,r){this.callback=t,this.remaining=r,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const r=this.running;return r&&this.stop(),this.remaining+=t,r&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const pj=["swal-title","swal-html","swal-footer"],qM=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const r=t.content;return s7(r),Object.assign(JM(r),ZM(r),QM(r),e7(r),t7(r),r7(r),n7(r,pj))},JM=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(n=>{ro(n,["name","value"]);const s=n.getAttribute("name"),a=n.getAttribute("value");!s||!a||(typeof rl[s]=="boolean"?t[s]=a!=="false":typeof rl[s]=="object"?t[s]=JSON.parse(a):t[s]=a)}),t},ZM=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(n=>{const s=n.getAttribute("name"),a=n.getAttribute("value");!s||!a||(t[s]=new Function(`return ${a}`)())}),t},QM=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(n=>{ro(n,["type","color","aria-label"]);const s=n.getAttribute("type");!s||!["confirm","cancel","deny"].includes(s)||(t[`${s}ButtonText`]=n.innerHTML,t[`show${Gg(s)}Button`]=!0,n.hasAttribute("color")&&(t[`${s}ButtonColor`]=n.getAttribute("color")),n.hasAttribute("aria-label")&&(t[`${s}ButtonAriaLabel`]=n.getAttribute("aria-label")))}),t},e7=e=>{const t={},r=e.querySelector("swal-image");return r&&(ro(r,["src","width","height","alt"]),r.hasAttribute("src")&&(t.imageUrl=r.getAttribute("src")||void 0),r.hasAttribute("width")&&(t.imageWidth=r.getAttribute("width")||void 0),r.hasAttribute("height")&&(t.imageHeight=r.getAttribute("height")||void 0),r.hasAttribute("alt")&&(t.imageAlt=r.getAttribute("alt")||void 0)),t},t7=e=>{const t={},r=e.querySelector("swal-icon");return r&&(ro(r,["type","color"]),r.hasAttribute("type")&&(t.icon=r.getAttribute("type")),r.hasAttribute("color")&&(t.iconColor=r.getAttribute("color")),t.iconHtml=r.innerHTML),t},r7=e=>{const t={},r=e.querySelector("swal-input");r&&(ro(r,["type","label","placeholder","value"]),t.input=r.getAttribute("type")||"text",r.hasAttribute("label")&&(t.inputLabel=r.getAttribute("label")),r.hasAttribute("placeholder")&&(t.inputPlaceholder=r.getAttribute("placeholder")),r.hasAttribute("value")&&(t.inputValue=r.getAttribute("value")));const n=Array.from(e.querySelectorAll("swal-input-option"));return n.length&&(t.inputOptions={},n.forEach(s=>{ro(s,["value"]);const a=s.getAttribute("value");if(!a)return;const o=s.innerHTML;t.inputOptions[a]=o})),t},n7=(e,t)=>{const r={};for(const n in t){const s=t[n],a=e.querySelector(s);a&&(ro(a,[]),r[s.replace(/^swal-/,"")]=a.innerHTML.trim())}return r},s7=e=>{const t=pj.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(r=>{const n=r.tagName.toLowerCase();t.includes(n)||on(`Unrecognized element <${n}>`)})},ro=(e,t)=>{Array.from(e.attributes).forEach(r=>{t.indexOf(r.name)===-1&&on([`Unrecognized attribute "${r.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},xj=10,a7=e=>{const t=un(),r=ht();typeof e.willOpen=="function"&&e.willOpen(r),We.eventEmitter.emit("willOpen",r);const s=window.getComputedStyle(document.body).overflowY;l7(t,r,e),setTimeout(()=>{i7(t,r)},xj),Qg()&&(o7(t,e.scrollbarPadding,s),zO()),!Zf()&&!We.previousActiveElement&&(We.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(r)),We.eventEmitter.emit("didOpen",r),os(t,me["no-transition"])},Z0=e=>{const t=ht();if(e.target!==t)return;const r=un();t.removeEventListener("animationend",Z0),t.removeEventListener("transitionend",Z0),r.style.overflowY="auto"},i7=(e,t)=>{PS(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",Z0),t.addEventListener("transitionend",Z0)):e.style.overflowY="auto"},o7=(e,t,r)=>{WO(),t&&r!=="hidden"&&JO(r),setTimeout(()=>{e.scrollTop=0})},l7=(e,t,r)=>{mt(e,r.showClass.backdrop),r.animation?(t.style.setProperty("opacity","0","important"),jr(t,"grid"),setTimeout(()=>{mt(t,r.showClass.popup),t.style.removeProperty("opacity")},xj)):jr(t,"grid"),mt([document.documentElement,document.body],me.shown),r.heightAuto&&r.backdrop&&!r.toast&&mt([document.documentElement,document.body],me["height-auto"])};var Qw={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function c7(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=Qw.email),e.input==="url"&&(e.inputValidator=Qw.url))}function u7(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(on('Target parameter is not valid, defaulting to "body"'),e.target="body")}function d7(e){c7(e),e.showLoaderOnConfirm&&!e.preConfirm&&on(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),u7(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),tO(e)}let Rs;var kd=new WeakMap;class rr{constructor(...t){if(PL(this,kd,void 0),typeof window>"u")return;Rs=this;const r=Object.freeze(this.constructor.argsToParams(t));this.params=r,this.isAwaitingPromise=!1,DL(kd,this,this._main(Rs.params))}_main(t,r={}){if(cj(Object.assign({},r,t)),We.currentInstance){const a=vl.swalPromiseResolve.get(We.currentInstance),{isAwaitingPromise:o}=We.currentInstance;We.currentInstance._destroy(),o||a({isDismissed:!0}),Qg()&&WS()}We.currentInstance=Rs;const n=h7(t,r);d7(n),Object.freeze(n),We.timeout&&(We.timeout.stop(),delete We.timeout),clearTimeout(We.restoreFocusTimeout);const s=m7(Rs);return $S(Rs,n),_t.innerParams.set(Rs,n),f7(Rs,s,n)}then(t){return zw(kd,this).then(t)}finally(t){return zw(kd,this).finally(t)}}const f7=(e,t,r)=>new Promise((n,s)=>{const a=o=>{e.close({isDismissed:!0,dismiss:o})};vl.swalPromiseResolve.set(e,n),vl.swalPromiseReject.set(e,s),t.confirmButton.onclick=()=>{mM(e)},t.denyButton.onclick=()=>{pM(e)},t.cancelButton.onclick=()=>{xM(e,a)},t.closeButton.onclick=()=>{a(Rl.close)},EM(r,t,a),LO(We,r,a),aM(e,r),a7(r),p7(We,r,a),x7(t,r),setTimeout(()=>{t.container.scrollTop=0})}),h7=(e,t)=>{const r=qM(e),n=Object.assign({},rl,t,r,e);return n.showClass=Object.assign({},rl.showClass,n.showClass),n.hideClass=Object.assign({},rl.hideClass,n.hideClass),n.animation===!1&&(n.showClass={backdrop:"swal2-noanimation"},n.hideClass={}),n},m7=e=>{const t={popup:ht(),container:un(),actions:Mu(),confirmButton:Hs(),denyButton:xo(),cancelButton:Dl(),loader:Il(),closeButton:Jg(),validationMessage:qf(),progressSteps:qg()};return _t.domCache.set(e,t),t},p7=(e,t,r)=>{const n=Jf();Yr(n),t.timer&&(e.timeout=new YM(()=>{r("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(jr(n),Ln(n,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&t1(t.timer)})))},x7=(e,t)=>{if(!t.toast){if(!Yf(t.allowEnterKey)){jS("allowEnterKey"),y7();return}g7(e)||v7(e,t)||Kp(-1,1)}},g7=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const r of t)if(r instanceof HTMLElement&&yn(r))return r.focus(),!0;return!1},v7=(e,t)=>t.focusDeny&&yn(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&yn(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&yn(e.confirmButton)?(e.confirmButton.focus(),!0):!1,y7=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const e=new Date,t=localStorage.getItem("swal-initiation");t?(e.getTime()-Date.parse(t))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const r=document.createElement("audio");r.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",r.loop=!0,document.body.appendChild(r),setTimeout(()=>{r.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${e}`)}rr.prototype.disableButtons=tj;rr.prototype.enableButtons=ej;rr.prototype.getInput=JS;rr.prototype.disableInput=nj;rr.prototype.enableInput=rj;rr.prototype.hideLoading=q0;rr.prototype.disableLoading=q0;rr.prototype.showValidationMessage=sj;rr.prototype.resetValidationMessage=aj;rr.prototype.close=Va;rr.prototype.closePopup=Va;rr.prototype.closeModal=Va;rr.prototype.closeToast=Va;rr.prototype.rejectPromise=XS;rr.prototype.update=uj;rr.prototype._destroy=dj;Object.assign(rr,KM);Object.keys(CM).forEach(e=>{rr[e]=function(...t){return Rs&&Rs[e]?Rs[e](...t):null}});rr.DismissReason=Rl;rr.version="11.22.2";const lt=rr;lt.default=lt;typeof document<"u"&&function(e,t){var r=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(r),r.styleSheet)r.styleSheet.disabled||(r.styleSheet.cssText=t);else try{r.innerHTML=t}catch{r.innerText=t}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const w7=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(!1),[c,u]=k.useState(""),[d,f]=k.useState(1),[h,m]=k.useState(20),[g,p]=k.useState(0),[v,w]=k.useState(null),[y,x]=k.useState(0),[N,S]=k.useState("1"),[_,b]=k.useState([]),[A,D]=k.useState({}),[V,P]=k.useState({totalItems:0,activeItems:0,itemsWithStock:0,totalValue:0,categories:{},contractsCount:0,itemsWithContracts:0});k.useEffect(()=>{(async()=>{var O,ve;a(!0);try{const ye=await T();await z();const xe=await ms.getAll({branchId:e,page:d,limit:h});if(xe.data.success){const ke=xe.data.total||((O=xe.data.pagination)==null?void 0:O.totalItems)||xe.data.count||0;ke&&p(ke);const ue=((ve=xe.data.pagination)==null?void 0:ve.totalPages)||0;ue&&x(ue);const De=xe.data.data.map(Ee=>{const Ie=ye.find(te=>te.product_id===Ee.id);return{...Ee,display_name:(Ie==null?void 0:Ie.product_name)||Ee.product_name}}).sort((Ee,Ie)=>Ee.receive_date&&Ie.receive_date?new Date(Ee.receive_date)-new Date(Ie.receive_date):Ee.display_name&&Ie.display_name?Ee.display_name.localeCompare(Ie.display_name,"th"):0);n(De)}else console.error("Error loading products:",xe.data.message);console.log(" Before calculateInventoryStats - contractDetails:",A),await L(),a(!1)}catch(ye){console.error("Error loading data:",ye),a(!1)}})()},[e,d,h]);const T=async()=>{var J;try{if(e){const O=await ra.getAll(e),ve=(J=O.data)!=null&&J.success?O.data.data:O.data||[];return b(ve),ve}return[]}catch(O){return console.error("Error loading contracts:",O),b([]),[]}},z=async()=>{var J;try{if(!e)return;const O=await ra.getAll(e),ve=(J=O.data)!=null&&J.success?O.data.data:O.data||[];console.log(" loadContractDetails - raw response:",O.data),console.log(" loadContractDetails - contractsData:",ve);const ye={};ve.forEach(xe=>{const ke=xe.productId||xe.product_id;ke&&(ye[ke]={contractNumber:xe.contractNumber,customerName:xe.customerName,totalAmount:xe.totalAmount,status:xe.status,createdAt:xe.createdAt,productName:xe.productName})}),console.log(" All contracts with productId/product_id:",ve.map(xe=>({contractNumber:xe.contractNumber,productId:xe.productId,product_id:xe.product_id,productName:xe.productName}))),D(ye),console.log(" Contract details loaded:",ye),console.log(" Contracts with productId:",ve.filter(xe=>xe.productId).length)}catch(O){console.error("Error loading contract details:",O),D({})}},L=async()=>{var J;try{if(!e)return;const O=await ms.getAll({branchId:e,limit:1e3});if((J=O.data)!=null&&J.success&&O.data.data){const ve=O.data.data;console.log(" calculateInventoryStats - allItems from API:",ve.length);const ye={totalItems:ve.length,activeItems:ve.filter(Ne=>Ne.status==="active").length,itemsWithStock:ve.filter(Ne=>Number(Ne.remaining_quantity1)>0).length,totalValue:ve.reduce((Ne,De)=>{const Ee=parseFloat(De.cost_price)||0,Ie=Number(De.remaining_quantity1)||0;return Ne+Ee*Ie},0),categories:{}};ve.forEach(Ne=>{const De=Ne.product_name||"";let Ee="";De.includes("")?Ee="":De.includes("")||De.includes("")?Ee="/":De.includes("")?Ee="":De.includes("")?Ee="":De.includes("")?Ee="":De.includes("")?Ee="":De.includes("")?Ee="":De.includes("")?Ee="":De.includes("")?Ee="":De.includes("")&&(Ee=""),ye.categories[Ee]||(ye.categories[Ee]={count:0,value:0});const Ie=parseFloat(Ne.cost_price)||0,te=Number(Ne.remaining_quantity1)||0;ye.categories[Ee].count+=te,ye.categories[Ee].value+=Ie*te}),console.log(" calculateInventoryStats - contractDetails:",A),console.log(" calculateInventoryStats - allItems length:",ve.length),ye.contractsCount=Object.keys(A).length,ye.itemsWithContracts=ve.filter(Ne=>A[Ne.id]).length,console.log(" Creating soldItems - contractDetails keys:",Object.keys(A)),console.log(" Creating soldItems - allItems IDs:",ve.map(Ne=>Ne.id));const xe=Object.entries(A).map(([Ne,De])=>({id:parseInt(Ne),product_name:De.productName,display_name:De.productName,shop_name:"-",contract_number:De.contractNumber,cost_price:0,receive_date:De.createdAt,remarks:` -  ${De.contractNumber}`,remaining_quantity1:0,received_quantity:1,sold_quantity:1,remaining_quantity2:0,status:"sold",sequence:`S${Ne}`,isSoldItem:!0}));console.log(" Created soldItems:",xe),ye.soldItemsCount=xe.length,ye.totalContractedItems=ye.itemsWithContracts+ye.soldItemsCount;const ke=[...ve,...xe];ye.totalItemsWithSold=ke.length;const ue=ke.sort((Ne,De)=>Ne.receive_date&&De.receive_date?new Date(Ne.receive_date)-new Date(De.receive_date):Ne.display_name&&De.display_name?Ne.display_name.localeCompare(De.display_name,"th"):0);console.log(" Final products state - allItems:",ve.length,"soldItems:",xe.length),console.log(" Final products state - total:",ue.length),n(ue),P(ye)}}catch(O){console.error("Error calculating inventory stats:",O)}},ee=r.filter(J=>J.display_name&&J.display_name.toLowerCase().includes(c.toLowerCase())||J.product_code&&J.product_code.toLowerCase().includes(c.toLowerCase())||J.shop_name&&J.shop_name.toLowerCase().includes(c.toLowerCase())||J.contract_number&&J.contract_number.toLowerCase().includes(c.toLowerCase())),j=c?ee.length:g||ee.length,U=d*h,q=U-h,C=ee,R=c?Math.ceil(Math.max(j,1)/h):y||Math.ceil(Math.max(j,1)/h);k.useEffect(()=>{f(1)},[c]),k.useEffect(()=>{f(1)},[h]),k.useEffect(()=>{S(String(d))},[d]);const F=J=>{const O=Math.max(1,Math.min(R||1,J));f(O)},E=()=>F(1),M=()=>F(R||1),H=()=>F(d-1),G=()=>F(d+1),re=async J=>{var O,ve,ye;try{l(!0);const xe={product_name:J.productName,product_code:J.productCode,shop_name:J.shopName,contract_number:J.contract,cost_price:parseFloat((O=J.costPrice)==null?void 0:O.replace(/,/g,"")),receive_date:J.receiveDate,remarks:J.remarks,branch_id:e,status:"active",remaining_quantity1:1,sold_quantity1:0},ke=await ms.create(xe);if(ke.data.success){const ue=await ms.getAll({branchId:e,page:d,limit:h});if(ue.data.success){const Ne=ue.data.total||((ve=ue.data.pagination)==null?void 0:ve.totalItems)||ue.data.count||0;Ne&&p(Ne);const De=((ye=ue.data.pagination)==null?void 0:ye.totalPages)||0;De&&x(De);const Ie=ue.data.data.map(te=>{const de=_.find(Fe=>Fe.product_id===te.id);return{...te,display_name:(de==null?void 0:de.product_name)||te.product_name}}).sort((te,de)=>te.receive_date&&de.receive_date?new Date(te.receive_date)-new Date(de.receive_date):te.display_name&&de.display_name?te.display_name.localeCompare(de.display_name,"th"):0);n(Ie)}await L(),await z(),lt.fire({icon:"success",title:"!",text:"",confirmButtonText:"",confirmButtonColor:"#10b981"})}else throw new Error(ke.data.message||"Failed to add product")}catch(xe){console.error("Error adding product:",xe),lt.fire({icon:"error",title:"!",text:"",confirmButtonText:"",confirmButtonColor:"#ef4444"})}finally{l(!1)}},he=async J=>{var ve,ye;if((await lt.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"",cancelButtonText:""})).isConfirmed)try{const xe=await ms.delete(J);if(xe.data.success){const ke=await ms.getAll({branchId:e,page:d,limit:h});if(ke.data.success){const ue=ke.data.total||((ve=ke.data.pagination)==null?void 0:ve.totalItems)||ke.data.count||0;ue&&p(ue);const Ne=((ye=ke.data.pagination)==null?void 0:ye.totalPages)||0;Ne&&x(Ne);const Ee=ke.data.data.map(Ie=>{const te=_.find(de=>de.product_id===Ie.id);return{...Ie,display_name:(te==null?void 0:te.product_name)||Ie.product_name}}).sort((Ie,te)=>Ie.receive_date&&te.receive_date?new Date(Ie.receive_date)-new Date(te.receive_date):Ie.display_name&&te.display_name?Ie.display_name.localeCompare(te.display_name,"th"):0);n(Ee)}await L(),await z(),lt.fire({icon:"success",title:"!",text:"",confirmButtonText:"",confirmButtonColor:"#10b981"})}else throw new Error(xe.data.message||"Failed to delete product")}catch(xe){console.error("Error deleting product:",xe),lt.fire({icon:"error",title:"!",text:"",confirmButtonText:"",confirmButtonColor:"#ef4444"})}},oe=J=>{w(J)},ce=async J=>{var O,ve,ye;try{l(!0);const xe={product_name:J.productName||v.product_name,product_code:J.productCode||v.product_code,shop_name:J.shopName||v.shop_name,contract_number:J.contract||v.contract_number,cost_price:parseFloat((O=J.costPrice)==null?void 0:O.replace(/,/g,""))||v.cost_price,receive_date:J.receiveDate||v.receive_date,remarks:J.remarks||v.remarks},ke=await ms.update(v.id,xe);if(ke.data.success){const ue=await ms.getAll({branchId:e,page:d,limit:h});if(ue.data.success){const Ne=ue.data.total||((ve=ue.data.pagination)==null?void 0:ve.totalItems)||ue.data.count||0;Ne&&p(Ne);const De=((ye=ue.data.pagination)==null?void 0:ye.totalPages)||0;De&&x(De);const Ie=ue.data.data.map(te=>{const de=_.find(Fe=>Fe.product_id===te.id);return{...te,display_name:(de==null?void 0:de.product_name)||te.product_name}}).sort((te,de)=>te.receive_date&&de.receive_date?new Date(te.receive_date)-new Date(de.receive_date):te.display_name&&de.display_name?te.display_name.localeCompare(de.display_name,"th"):0);n(Ie)}await L(),await z(),w(null),lt.fire({icon:"success",title:"!",text:"",confirmButtonText:"",confirmButtonColor:"#10b981"})}else throw new Error(ke.data.message||"Failed to update product")}catch(xe){console.error("Error updating product:",xe),lt.fire({icon:"error",title:"!",text:"",confirmButtonText:"",confirmButtonColor:"#ef4444"})}finally{l(!1)}},Q=async()=>{(await lt.fire({title:"",text:"? ",icon:"question",showCancelButton:!0,confirmButtonColor:"#6b7280",cancelButtonColor:"#10b981",confirmButtonText:"",cancelButtonText:""})).isConfirmed&&w(null)};return s?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:"..."})]})}),i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Pt,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"..."})]})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600",children:["   - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(er,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",j," "]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:V.totalItemsWithSold||V.totalItems})]}),i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(er,{className:"w-6 h-6 text-blue-600"})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:" Stock"}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:V.itemsWithStock})]}),i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(er,{className:"w-6 h-6 text-green-600"})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["",V.totalValue.toLocaleString()]})]}),i.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:i.jsx(ii,{className:"w-6 h-6 text-purple-600"})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:" Active"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600",children:V.activeItems})]}),i.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:i.jsx(Vs,{className:"w-6 h-6 text-orange-600"})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:" ()"}),i.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:V.itemsWithContracts})]}),i.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:i.jsx(ii,{className:"w-6 h-6 text-indigo-600"})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:" ()"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:V.soldItemsCount||0})]}),i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(er,{className:"w-6 h-6 text-blue-600"})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:V.totalContractedItems||0})]}),i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(ts,{className:"w-6 h-6 text-green-600"})})]})})]}),Object.keys(V.categories).length>0&&i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(V.categories).sort(([,J],[,O])=>O.count-J.count).map(([J,O])=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:J}),i.jsxs("p",{className:"text-sm text-gray-600",children:[O.count," "]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"font-medium text-gray-900",children:["",O.value.toLocaleString()]}),i.jsx("p",{className:"text-xs text-gray-500",children:""})]})]},J))})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:""}),i.jsxs("p",{className:"text-sm text-gray-600",children:[V.totalItems," "]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"font-medium text-blue-600",children:"100%"}),i.jsx("p",{className:"text-xs text-gray-500",children:""})]})]}),i.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:""}),i.jsxs("p",{className:"text-sm text-gray-600",children:[V.itemsWithContracts," "]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"font-medium text-green-600",children:[V.totalItems>0?(V.itemsWithContracts/V.totalItems*100).toFixed(1):0,"%"]}),i.jsx("p",{className:"text-xs text-gray-500",children:""})]})]}),i.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:""}),i.jsxs("p",{className:"text-sm text-gray-600",children:[V.soldItemsCount||0," "]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"font-medium text-red-600",children:[V.contractsCount>0?((V.soldItemsCount||0)/V.contractsCount*100).toFixed(1):0,"%"]}),i.jsx("p",{className:"text-xs text-gray-500",children:""})]})]}),i.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:""}),i.jsxs("p",{className:"text-sm text-gray-600",children:[V.contractsCount," "]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"font-medium text-purple-600",children:"100%"}),i.jsx("p",{className:"text-xs text-gray-500",children:""})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("div",{className:"mb-4 p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-emerald-700",children:[i.jsx(Vs,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",i.jsx("strong",{children:t==null?void 0:t.name})]})]})}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:v?"":""}),v?i.jsxs("div",{className:"space-y-4",children:[i.jsx(Tw,{onAddProduct:ce,submitting:o,contracts:_,initialData:{productCode:v.product_code||"",productName:v.display_name||v.product_name||"",shopName:v.shop_name||"",contract:v.contract_number||"",costPrice:v.cost_price?v.cost_price.toString():"",receiveDate:v.receive_date?v.receive_date.split("T")[0]:"",remarks:v.remarks||""}}),i.jsx("div",{className:"flex gap-2",children:i.jsx(ae,{onClick:Q,variant:"outline",className:"flex-1",children:""})})]}):i.jsx(Tw,{onAddProduct:re,submitting:o,contracts:_})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"   ...",value:c,onChange:J=>u(J.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs(ae,{variant:"outline",className:"flex items-center gap-2",children:[i.jsx(iu,{className:"w-4 h-4"}),""]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:".../"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:".../"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(J=>i.jsxs($e.tr,{initial:{opacity:0},animate:{opacity:1},className:`transition-colors ${J.isSoldItem?"bg-blue-50 hover:bg-blue-100":"hover:bg-gray-50"}`,children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:J.isSoldItem?i.jsxs("span",{className:"text-blue-600 font-medium",children:["S",J.id]}):J.sequence}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-blue-600 font-medium",children:J.receive_date?new Date(J.receive_date).toLocaleDateString("th-TH"):"-"}):J.receive_date?new Date(J.receive_date).toLocaleDateString("th-TH"):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsxs("span",{className:"text-blue-600 font-medium",children:["S",J.id]}):J.product_code||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:J.display_name,children:J.isSoldItem?i.jsx("span",{className:"text-blue-600 font-medium",children:J.display_name}):J.display_name}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-gray-500",children:"-"}):J.shop_name||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:(()=>{if(J.isSoldItem)return i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"font-medium text-blue-600",children:J.contract_number}),i.jsx("div",{className:"text-xs text-blue-600",children:""})]});const O=A[J.id];return O?i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"font-medium text-blue-600",children:O.contractNumber||""}),O.customerName&&i.jsxs("div",{className:"text-xs text-gray-600",children:[": ",O.customerName]}),O.totalAmount&&i.jsxs("div",{className:"text-xs text-green-600",children:["",parseFloat(O.totalAmount).toLocaleString()]}),i.jsx("div",{className:"text-xs text-blue-600",children:""})]}):J.contract_number&&J.contract_number!=="-"?i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"font-medium text-blue-600",children:J.contract_number}),i.jsx("div",{className:"text-xs text-blue-600",children:""})]}):i.jsx("div",{className:"text-gray-500 text-xs",children:""})})()}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-gray-500",children:"-"}):J.cost_price?J.cost_price.toLocaleString():"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-blue-600 font-medium",children:J.receive_date?new Date(J.receive_date).toLocaleDateString("th-TH"):"-"}):J.sell_date?new Date(J.sell_date).toLocaleDateString("th-TH"):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-gray-500",children:"-"}):J.cost_price?J.cost_price.toLocaleString():"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-blue-600 font-medium",children:"0"}):J.remaining_quantity1}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-gray-600",children:"1"}):J.received_quantity}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-blue-600 font-medium",children:"1"}):J.sold_quantity||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:J.isSoldItem?i.jsx("span",{className:"text-blue-600 font-medium",children:"0"}):J.remaining_quantity2}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:J.remarks,children:J.isSoldItem?i.jsxs("span",{className:"text-blue-600 font-medium",children:[" - ",J.contract_number]}):J.remarks?i.jsx("span",{className:"text-gray-600",children:J.remarks}):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:(()=>{const ve=A[J.id]||J.contract_number&&J.contract_number!=="-";return J.isSoldItem||ve?i.jsx("div",{className:"text-center",children:i.jsx("span",{className:"text-xs text-blue-600 font-medium bg-blue-50 px-2 py-1 rounded",children:""})}):i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>oe(J),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Cs,{className:"w-4 h-4"})}),i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>he(J.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ka,{className:"w-4 h-4"})})]})})()})]},J.id))})]})}),C.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(er,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-500",children:""})]})]}),R>1&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:[" ",q+1,"  ",Math.min(U,j),"  ",j," "]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("select",{value:h,onChange:J=>m(parseInt(J.target.value)),className:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[10,15,20,25,50,100].map(J=>i.jsx("option",{value:J,children:J},J))})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{variant:"outline",size:"sm",onClick:E,disabled:d===1,children:" First"}),i.jsxs(ae,{variant:"outline",size:"sm",onClick:H,disabled:d===1,className:"flex items-center gap-1",children:[i.jsx(W4,{className:"w-4 h-4"})," Back"]}),i.jsx("div",{className:"flex items-center gap-1",children:(()=>{const J=[],O=R,ve=xe=>J.push(i.jsx(ae,{variant:xe===d?"default":"outline",size:"sm",onClick:()=>F(xe),className:"w-8 h-8 p-0",children:xe},xe)),ye=xe=>J.push(i.jsx("span",{className:"px-2 text-gray-500",children:""},xe));if(O<=9)for(let xe=1;xe<=O;xe++)ve(xe);else{ve(1),d>4&&ye("s");const xe=Math.max(2,d-2),ke=Math.min(O-1,d+2);for(let ue=xe;ue<=ke;ue++)ve(ue);d<O-3&&ye("e"),ve(O)}return J})()}),i.jsxs(ae,{variant:"outline",size:"sm",onClick:G,disabled:d===R,className:"flex items-center gap-1",children:["Next ",i.jsx(H4,{className:"w-4 h-4"})]}),i.jsx(ae,{variant:"outline",size:"sm",onClick:M,disabled:d===R,children:"Last "}),i.jsxs("div",{className:"flex items-center gap-2 ml-2 text-sm",children:[i.jsx("span",{children:"Page"}),i.jsx("input",{value:N,onChange:J=>S(J.target.value.replace(/[^0-9]/g,"")),onKeyDown:J=>{J.key==="Enter"&&F(parseInt(N||"1"))},className:"w-16 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"}),i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>F(parseInt(N||"1")),children:"Go"})]})]})]})})]})},Li={getAll:async(e,t,r,n)=>{const s={};return e&&(s.branchId=e),t&&(s.checkerId=t),r&&(s.search=r),n&&n!=="all"&&(s.status=n),s._t=new Date().getTime(),_e.get("/customers",{params:s})},getById:async e=>_e.get(`/customers/${e}`),getByChecker:async(e,t,r)=>{const n={};return t&&(n.search=t),r&&r!=="all"&&(n.status=r),_e.get(`/customers/checker/${e}`,{params:n})},create:async e=>_e.post("/customers",e),update:async(e,t)=>_e.put(`/customers/${e}`,t),delete:async e=>_e.delete(`/customers/${e}`)},b7=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(!1),[c,u]=k.useState(!1),[d,f]=k.useState(null),[h,m]=k.useState(""),[g,p]=k.useState("all"),[v,w]=k.useState(1),[y,x]=k.useState(10),[N,S]=k.useState(!1),[_,b]=k.useState({code:"",title:"",name:"",surname:"",fullName:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:"",status:"active",checkerId:null}),A=[{id:1,code:"CUST001",title:"",name:"",surname:"",full_name:" ",id_card:"1234567890123",nickname:"",age:"35",address:"123 ",moo:"1",road:"",subdistrict:"",district:"",province:"",phone1:"082-111-1111",phone2:"02-123-4567",phone3:"02-987-6543",email:"customer1@example.com",status:"active",branch_id:1,checker_id:1,branch_name:"",checker_name:" ",created_at:"2024-01-01T00:00:00.000Z",updated_at:"2024-01-01T00:00:00.000Z"},{id:2,code:"CUST002",title:"",name:"",surname:"",full_name:" ",id_card:"9876543210987",nickname:"",age:"28",address:"456 ",moo:"2",road:"",subdistrict:"",district:"",province:"",phone1:"089-222-2222",phone2:"02-234-5678",phone3:"",email:"customer2@example.com",status:"active",branch_id:1,checker_id:1,branch_name:"",checker_name:" ",created_at:"2024-01-02T00:00:00.000Z",updated_at:"2024-01-02T00:00:00.000Z"}];k.useEffect(()=>{e?D():(n(A),a(!1))},[e,h,g]),k.useEffect(()=>{if(e){const R=setTimeout(()=>{D()},100);return()=>clearTimeout(R)}},[]);const D=async()=>{var R,F;try{if(a(!0),S(!1),console.log("Loading customers for branch:",e),console.log("Search term:",h),console.log("Filter status:",g),!e){console.log("No selectedBranch, using mock data"),n(A);return}const E=await Li.getAll(e,null,h,g);if(console.log("API Response:",E),console.log("Response data:",E.data),console.log("Response data type:",typeof E.data),console.log("Response data is array:",Array.isArray(E.data)),console.log("Response data keys:",Object.keys(E.data||{})),E&&E.data)if(E.data.success&&Array.isArray(E.data.data)){const M=E.data.data;console.log("Customers data:",M),n(M),console.log("Customers loaded from API:",M)}else if(Array.isArray(E.data)){const M=E.data;console.log("Customers data (direct array):",M),n(M),console.log("Customers loaded from API (direct array):",M)}else console.warn("Invalid response format:",E),n([]);else console.warn("No response data:",E),n([])}catch(E){console.error("Error loading customers from API:",E),console.error("Error details:",(R=E.response)==null?void 0:R.data),console.error("Error status:",(F=E.response)==null?void 0:F.status),S(!0),console.log("Using mock data due to API error"),n(A),we({title:"",description:" API  ",variant:"default"})}finally{a(!1)}},V=async R=>{if(R.preventDefault(),!_.name||!_.phone1||!_.code||!_.idCard){we({title:"",description:", -,  1 ",variant:"destructive"});return}try{l(!0);const F={..._,fullName:`${_.name} ${_.surname}`.trim(),branchId:e};if(d){const M=(await Li.update(d.id,F)).data;n(H=>H.map(G=>G.id===d.id?M:G)),f(null),we({title:"",description:""})}else{const M=(await Li.create(F)).data;n(H=>[M,...H]),we({title:"",description:""})}z(),u(!1)}catch(F){console.error("Error saving customer:",F),we({title:"",description:"",variant:"destructive"})}finally{l(!1)}},P=R=>{f(R),b({code:R.code||"",title:R.title||"",name:R.name||"",surname:R.surname||"",fullName:R.full_name||"",nickname:R.nickname||"",age:R.age||"",idCard:R.id_card||"",address:R.address||"",moo:R.moo||"",road:R.road||"",subdistrict:R.subdistrict||"",district:R.district||"",province:R.province||"",phone1:R.phone1||R.phone||"",phone2:R.phone2||"",phone3:R.phone3||"",email:R.email||"",status:R.status||"active",checkerId:R.checker_id||null}),u(!0)},T=async R=>{if(window.confirm("?"))try{await Li.delete(R),n(F=>F.filter(E=>E.id!==R)),we({title:"",description:""})}catch(F){console.error("Error deleting customer:",F),we({title:"",description:"",variant:"destructive"})}},z=()=>{b({code:"",title:"",name:"",surname:"",fullName:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:"",status:"active",checkerId:null})},L=R=>{switch(R){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"overdue":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},ee=R=>{switch(R){case"active":return"";case"inactive":return"";case"overdue":return"";case"completed":return"";default:return R}},j=Math.ceil(((r==null?void 0:r.length)||0)/y),U=(v-1)*y,q=U+y,C=(r||[]).slice(U,q);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:""})]}),i.jsxs(ae,{onClick:()=>u(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]}),N&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:" API "}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:" "})})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",value:h,onChange:R=>m(R.target.value),placeholder:", , ...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:g,onChange:R=>p(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"active",children:""}),i.jsx("option",{value:"inactive",children:""}),i.jsx("option",{value:"overdue",children:""}),i.jsx("option",{value:"completed",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:y,onChange:R=>x(Number(R.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:10,children:"10"}),i.jsx("option",{value:25,children:"25"}),i.jsx("option",{value:50,children:"50"}),i.jsx("option",{value:100,children:"100"})]})]})]})}),c&&i.jsxs($e.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:d?"":""}),i.jsxs("form",{onSubmit:V,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx("div",{className:"lg:col-span-4",children:i.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3 border-b pb-2",children:""})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"text",value:_.code,onChange:R=>b(F=>({...F,code:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"CUST001",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"text",value:_.idCard,onChange:R=>b(F=>({...F,idCard:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"1234567890123",maxLength:"13",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("div",{className:"flex gap-4",children:["","",""].map(R=>i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"radio",name:"title",value:R,checked:_.title===R,onChange:F=>b(E=>({...E,title:F.target.value}))}),R]},R))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"- *"}),i.jsx("input",{type:"text",value:_.name,onChange:R=>b(F=>({...F,name:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"-",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",value:_.surname,onChange:R=>b(F=>({...F,surname:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",value:_.nickname,onChange:R=>b(F=>({...F,nickname:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"number",value:_.age,onChange:R=>b(F=>({...F,age:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",value:_.address,onChange:R=>b(F=>({...F,address:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",value:_.moo,onChange:R=>b(F=>({...F,moo:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",value:_.road,onChange:R=>b(F=>({...F,road:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"/"}),i.jsx("input",{type:"text",value:_.subdistrict,onChange:R=>b(F=>({...F,subdistrict:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"/"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"/"}),i.jsx("input",{type:"text",value:_.district,onChange:R=>b(F=>({...F,district:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"/"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",value:_.province,onChange:R=>b(F=>({...F,province:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" 1 *"}),i.jsx("input",{type:"tel",value:_.phone1,onChange:R=>b(F=>({...F,phone1:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" 2"}),i.jsx("input",{type:"tel",value:_.phone2,onChange:R=>b(F=>({...F,phone2:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" 3"}),i.jsx("input",{type:"tel",value:_.phone3,onChange:R=>b(F=>({...F,phone3:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"email",value:_.email,onChange:R=>b(F=>({...F,email:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"customer@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:_.status,onChange:R=>b(F=>({...F,status:R.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"active",children:""}),i.jsx("option",{value:"inactive",children:""}),i.jsx("option",{value:"overdue",children:""}),i.jsx("option",{value:"completed",children:""})]})]}),i.jsxs("div",{className:"lg:col-span-4 flex justify-end gap-3",children:[i.jsx(ae,{type:"button",variant:"outline",onClick:()=>{u(!1),f(null),z()},disabled:o,children:""}),i.jsx(ae,{type:"submit",disabled:o,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx(Pt,{className:"w-4 h-4 mr-2 animate-spin"}),"..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),d?"":""]})})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})}),i.jsx("div",{className:"overflow-x-auto",children:s?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx(Pt,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"text-gray-500",children:"..."})]}):r.length===0?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx(gn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-500 mb-4",children:""}),i.jsxs(ae,{onClick:()=>u(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]}):i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky left-0 z-20 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"#"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:""}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"-"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:""}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:""}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:""}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:""}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map((R,F)=>i.jsxs($e.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:F*.05},className:"group hover:bg-gray-50",children:[i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 bg-white sticky left-0 z-10 group-hover:bg-gray-50 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:U+F+1}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:R.code}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:R.full_name}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:R.id_card}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:R.nickname||"-"}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("div",{className:"space-y-1",children:R.primary_phone?i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(rs,{className:"w-3 h-3 text-green-600"}),i.jsx("span",{children:R.primary_phone})]}):R.phone1?i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(rs,{className:"w-3 h-3 text-green-600"}),i.jsx("span",{children:R.phone1})]}):R.phone2?i.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[i.jsx(rs,{className:"w-3 h-3 text-blue-600"}),i.jsx("span",{children:R.phone2})]}):R.phone3?i.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[i.jsx(rs,{className:"w-3 h-3 text-purple-600"}),i.jsx("span",{children:R.phone3})]}):i.jsx("span",{className:"text-gray-400",children:"-"})})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L(R.status)}`,children:ee(R.status)})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>P(R),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Cs,{className:"w-4 h-4"})}),i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>T(R.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ka,{className:"w-4 h-4"})})]})})]},R.id))})]})}),r.length>0&&i.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[i.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[i.jsx(ae,{onClick:()=>w(Math.max(1,v-1)),disabled:v===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),i.jsx(ae,{onClick:()=>w(v+1),disabled:v===j,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:U+1})," to"," ",i.jsx("span",{className:"font-medium",children:Math.min(q,r.length)})," of"," ",i.jsx("span",{className:"font-medium",children:r.length})," entries"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[i.jsx(ae,{onClick:()=>w(1),disabled:v===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"First"}),i.jsx(ae,{onClick:()=>w(Math.max(1,v-1)),disabled:v===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),i.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:["Page ",v," of ",j]}),i.jsx(ae,{onClick:()=>w(v+1),disabled:v===j,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"}),i.jsx(ae,{onClick:()=>w(j),disabled:v===j,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Last"})]})})]})]})]})]})},na={getAll:async e=>{const t=e?{branchId:e}:{};return _e.get("/employees",{params:t})},getById:async e=>_e.get(`/employees/${e}`),create:async e=>_e.post("/employees",e),update:async(e,t)=>_e.put(`/employees/${e}`,t),delete:async e=>_e.delete(`/employees/${e}`)},N7=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(!1),[c,u]=k.useState(!1),[d,f]=k.useState(null),[h,m]=k.useState({name:"",surname:"",fullName:"",position:"",phone:"",email:""});k.useEffect(()=>{g()},[e]),k.useEffect(()=>{if(e){const x=setTimeout(()=>{g()},100);return()=>clearTimeout(x)}},[]);const g=async()=>{try{if(a(!0),!e){console.log("No selectedBranch, setting empty array"),n([]);return}const x=await na.getAll(e);console.log("API Response:",x),console.log("Response data:",x.data);let N=[];x&&x.data&&(x.data.success&&Array.isArray(x.data.data)?N=x.data.data:Array.isArray(x.data)?N=x.data:(console.warn("Invalid response format:",x),N=[])),console.log("Employees data:",N),n(N)}catch(x){console.error("Error loading employees:",x),we({title:"",description:"",variant:"destructive"})}finally{a(!1)}},p=async x=>{if(x.preventDefault(),!h.name||!h.position){we({title:"",description:"",variant:"destructive"});return}try{l(!0);const N={...h,fullName:`${h.name} ${h.surname}`.trim(),branchId:e};if(d){const _=(await na.update(d.id,N)).data;n(b=>b.map(A=>A.id===d.id?_:A)),f(null),we({title:"",description:""})}else{const _=(await na.create(N)).data;n(b=>[_,...b]),we({title:"",description:""})}m({name:"",surname:"",fullName:"",position:"",phone:"",email:""}),u(!1)}catch(N){console.error("Error saving employee:",N),we({title:"",description:"",variant:"destructive"})}finally{l(!1)}},v=x=>{f(x),m({name:x.name||"",surname:x.surname||"",fullName:x.fullName||"",position:x.position||"",phone:x.phone||"",email:x.email||""}),u(!0)},w=async x=>{try{await na.delete(x),n(N=>N.filter(S=>S.id!==x)),we({title:"",description:""})}catch(N){console.error("Error deleting employee:",N),we({title:"",description:"",variant:"destructive"})}},y=()=>{m({name:"",surname:"",fullName:"",position:"",phone:"",email:""}),f(null),u(!1)};return s?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:"..."})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Pt,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"..."})]})})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600",children:[" - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Ws,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",Array.isArray(r)?r.length:0," "]})]}),i.jsxs(ae,{onClick:()=>u(!c),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]})]}),c&&i.jsxs($e.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:d?"":""}),i.jsx(ae,{variant:"outline",size:"sm",onClick:y,children:""})]}),i.jsx("div",{className:"mb-4 p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-emerald-700",children:[i.jsx(Vs,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",i.jsx("strong",{children:t==null?void 0:t.name})]})]})}),i.jsxs("form",{onSubmit:p,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"text",value:h.name,onChange:x=>m(N=>({...N,name:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",value:h.surname,onChange:x=>m(N=>({...N,surname:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"text",value:h.position,onChange:x=>m(N=>({...N,position:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:" , ",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"tel",value:h.phone,onChange:x=>m(N=>({...N,phone:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"081-234-5678"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"email",value:h.email,onChange:x=>m(N=>({...N,email:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"employee@example.com"})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3",children:[i.jsx(ae,{type:"button",variant:"outline",onClick:y,disabled:o,children:""}),i.jsx(ae,{type:"submit",disabled:o,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),d?"":""]})})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})}),i.jsx("div",{className:"p-6",children:!Array.isArray(r)||r.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Ws,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-500 mb-4",children:""}),i.jsxs(ae,{onClick:()=>u(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]}):i.jsx("div",{className:"grid gap-4",children:Array.isArray(r)&&r.map((x,N)=>i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.1},className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:x.fullName}),i.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:x.branchName})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(jI,{className:"w-4 h-4"}),x.position]}),x.phone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(rs,{className:"w-4 h-4"}),x.phone]}),x.email&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(G4,{className:"w-4 h-4"}),x.email]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>v(x),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Cs,{className:"w-4 h-4"})}),i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>w(x.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ka,{className:"w-4 h-4"})})]})]})},x.id))})})]})]})},k7=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(""),[c,u]=k.useState("all"),[d,f]=k.useState(25),[h,m]=k.useState(1),[g,p]=k.useState(!1),[v,w]=k.useState(null),[y,x]=k.useState({name:"",surname:"",fullName:"",phone:"",email:"",position:"collector",branchId:e||1,status:"active"});k.useEffect(()=>{N()},[e,o,c]);const N=async()=>{var T;try{a(!0);const z={};e&&(z.branchId=e),o&&(z.search=o),c&&c!=="all"&&(z.status=c);const L=await _e.get("/employees",{params:z});if((T=L.data)!=null&&T.success){const ee=L.data.data.filter(j=>j.position==="collector"||j.position==="");n(ee)}else n([])}catch(z){console.error("Error loading collectors:",z),we({title:"",description:"",variant:"destructive"}),n([])}finally{a(!1)}},S=async T=>{if(T.preventDefault(),!y.name||!y.fullName){we({title:"",description:"-",variant:"destructive"});return}try{v?(await _e.put(`/employees/${v.id}`,{...y,position:"collector"}),we({title:"",description:""})):(await _e.post("/employees",{...y,position:"collector"}),we({title:"",description:""})),p(!1),w(null),x({name:"",surname:"",fullName:"",phone:"",email:"",position:"collector",branchId:e||1,status:"active"}),N()}catch(z){console.error("Error saving collector:",z),we({title:"",description:"",variant:"destructive"})}},_=T=>{w(T),x({name:T.name||"",surname:T.surname||"",fullName:T.fullName||T.full_name||"",phone:T.phone||"",email:T.email||"",position:"collector",branchId:T.branchId||T.branch_id||e||1,status:T.status||"active"}),p(!0)},b=async T=>{if(confirm(` "${T.fullName||T.full_name}" ?`))try{await _e.delete(`/employees/${T.id}`),we({title:"",description:""}),N()}catch(z){console.error("Error deleting collector:",z),we({title:"",description:"",variant:"destructive"})}},A=()=>{we({title:"",description:" "})},D=()=>{we({title:"",description:" "})},V=T=>{const z={active:{label:"",className:"bg-green-100 text-green-800"},inactive:{label:"",className:"bg-red-100 text-red-800"},suspended:{label:"",className:"bg-yellow-100 text-yellow-800"}},L=z[T]||z.inactive;return i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L.className}`,children:L.label})},P=r;return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600 mt-1",children:[" ",(t==null?void 0:t.name)||""," | : ",r.length," "]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(ae,{onClick:N,variant:"outline",className:"flex items-center gap-2",disabled:s,children:[i.jsx(Pt,{className:`w-4 h-4 ${s?"animate-spin":""}`}),""]}),i.jsxs(ae,{onClick:()=>p(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]}),i.jsxs(ae,{onClick:D,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[i.jsx(Qi,{className:"w-4 h-4 mr-2"}),""]}),i.jsxs(ae,{onClick:A,className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(zs,{className:"w-4 h-4 mr-2"}),""]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:d,onChange:T=>f(parseInt(T.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:10,children:"10 entries"}),i.jsx("option",{value:25,children:"25 entries"}),i.jsx("option",{value:50,children:"50 entries"}),i.jsx("option",{value:100,children:"100 entries"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:c,onChange:T=>u(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"active",children:""}),i.jsx("option",{value:"inactive",children:""}),i.jsx("option",{value:"suspended",children:""})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:", , ...",value:o,onChange:T=>l(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),g&&i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:v?"":""}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),i.jsx("input",{type:"text",value:y.name,onChange:T=>x({...y,name:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:y.surname,onChange:T=>x({...y,surname:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"- *"}),i.jsx("input",{type:"text",value:y.fullName,onChange:T=>x({...y,fullName:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"-",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"tel",value:y.phone,onChange:T=>x({...y,phone:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"081-234-5678"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"email",value:y.email,onChange:T=>x({...y,email:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:y.status,onChange:T=>x({...y,status:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"active",children:""}),i.jsx("option",{value:"inactive",children:""}),i.jsx("option",{value:"suspended",children:""})]})]})]}),i.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[i.jsx(ae,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",children:v?"":""}),i.jsx(ae,{type:"button",variant:"outline",onClick:()=>{p(!1),w(null),x({name:"",surname:"",fullName:"",phone:"",email:"",position:"collector",branchId:e||1,status:"active"})},children:""})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky left-0 z-20 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:i.jsxs("div",{className:"flex items-center gap-2",children:["#",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["-",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(Pt,{className:"w-6 h-6 animate-spin mr-2"}),i.jsx("span",{children:"..."})]})})}):P.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"text-gray-500",children:[i.jsx(gn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:""})]})})}):P.map((T,z)=>i.jsxs($e.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:z*.05},className:"hover:bg-gray-50 group",children:[i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 bg-white sticky left-0 z-10 group-hover:bg-gray-50 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:z+1}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(br,{className:"w-4 h-4 text-gray-400"}),T.fullName||T.full_name]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:""})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(rs,{className:"w-3 h-3 text-gray-400"}),T.phone||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(G4,{className:"w-3 h-3 text-gray-400"}),T.email||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Vs,{className:"w-3 h-3 text-gray-400"}),T.branchName||T.branch_name||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:V(T.status)}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ae,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>_(T),children:[i.jsx(Cs,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>b(T),children:[i.jsx(ka,{className:"w-3 h-3 mr-1"}),""]})]})})]},T.id))})]})}),i.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[i.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[i.jsx(ae,{onClick:()=>m(Math.max(1,h-1)),disabled:h===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),i.jsx(ae,{onClick:()=>m(h+1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:"1"})," to ",i.jsx("span",{className:"font-medium",children:r.length})," of"," ",i.jsx("span",{className:"font-medium",children:r.length})," entries"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[i.jsx(ae,{onClick:()=>m(1),disabled:h===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"First"}),i.jsx(ae,{onClick:()=>m(Math.max(1,h-1)),disabled:h===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),i.jsx(ae,{onClick:()=>m(h+1),className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"}),i.jsx(ae,{onClick:()=>m(1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Last"})]})})]})]})]})]})},Xo={getAll:async(e,t={})=>{try{console.log(" checkersService.getAll called with branchId:",e,"params:",t);const r={branchId:e,...t};r._t=new Date().getTime(),console.log(" Making API call to /checkers with params:",r);const n=await _e.get("/checkers",{params:r});return console.log(" checkersService.getAll response:",n),n}catch(r){throw console.error(" checkersService.getAll error:",r),console.error(" Error response:",r.response),r}},getById:async e=>{try{return(await _e.get(`/checkers/${e}`)).data}catch(t){throw t}},create:async e=>{try{return(await _e.post("/checkers",e)).data}catch(t){throw t}},update:async(e,t)=>{try{return(await _e.put(`/checkers/${e}`,t)).data}catch(r){throw r}},delete:async e=>{try{return(await _e.delete(`/checkers/${e}`)).data}catch(t){throw t}},getCollections:async(e,t={})=>{try{return(await _e.get(`/checkers/${e}/collections`,{params:t})).data}catch(r){throw r}},createCollection:async(e,t)=>{try{return(await _e.post(`/checkers/${e}/collections`,t)).data}catch(r){throw r}},getReports:async(e,t={})=>{try{return(await _e.get(`/checkers/${e}/reports`,{params:t})).data}catch(r){throw r}}},gj=({onBack:e,checker:t})=>{const[r,n]=k.useState("contract"),[s,a]=k.useState("asc"),[o,l]=k.useState(""),[c,u]=k.useState(""),[d,f]=k.useState(""),[h,m]=k.useState(!0),[g,p]=k.useState(null),[v,w]=k.useState([]),[y,x]=k.useState({}),[N,S]=k.useState({}),[_,b]=k.useState(0),[A,D]=k.useState(""),V=k.useCallback(C=>{if(!C||C==="-")return{pBlack:0,pBlue:0};try{const R=new Date(C);if(isNaN(R.getTime()))return{pBlack:0,pBlue:0};const F=new Date,E=F.getMonth()+1,M=F.getFullYear(),H=R.getMonth()+1,G=R.getFullYear();return console.log("CalculatePStatus Debug:",{dueDate:C,dueMonth:H,dueYear:G,currentMonth:E,currentYear:M,today:F.getDate(),dueDay:R.getDate()}),H===E&&G===M?(console.log('  - P  = "P", P  = "1"'),{pBlack:"P",pBlue:"1"}):H<E||G<M?(console.log('  - P  = "P", P  = "1"'),{pBlack:"P",pBlue:"1"}):(console.log("  - P  = 0, P  = 0"),{pBlack:0,pBlue:0})}catch(R){return console.error("Error calculating P status:",R),{pBlack:0,pBlue:0}}},[]),P=k.useCallback(async()=>{var C,R;try{const F=await _e.get("/installments");let E=[];if((C=F.data)!=null&&C.success?E=F.data.data||[]:Array.isArray(F.data)&&(E=F.data),!Array.isArray(E)){console.error("installmentsData is not an array:",E);return}const H=E.filter(oe=>oe.inspectorId===(t==null?void 0:t.id)||oe.inspectorId===parseInt(t==null?void 0:t.id)).filter((oe,ce,Q)=>ce===Q.findIndex(J=>J.id===oe.id)),G={};for(const oe of H)try{const ce=await _e.get(`/installments/${oe.id}/payments`);if((R=ce.data)!=null&&R.success&&ce.data.data){const Q=ce.data.data,J=Q.reduce((Ee,Ie)=>Ee+parseFloat(Ie.amount||0),0),O=Q.filter(Ee=>Ee.status==="paid").reduce((Ee,Ie)=>Ee+parseFloat(Ie.amount||0),0),ve=J-O,ye=new Date,xe=ye.getMonth()+1,ke=ye.getFullYear(),ue=Q.filter(Ee=>{const Ie=new Date(Ee.dueDate);return Ie.getMonth()+1===xe&&Ie.getFullYear()===ke}),Ne=Q.every(Ee=>Ee.status!=="paid"),De=Q.some(Ee=>{const Ie=new Date(Ee.dueDate);return Ie.getMonth()+1>=xe&&Ie.getFullYear()>=ke});if(ue.length>0||Ne&&De){if(Ne&&De&&ue.length===0){const Ee=Q.filter(Ie=>{const te=new Date(Ie.dueDate);return te.getMonth()+1>=xe&&te.getFullYear()>=ke}).sort((Ie,te)=>new Date(Ie.dueDate)-new Date(te.dueDate))[0];if(Ee){const Ie=Ee.dueDate,te=new Date(Ie),de=`${ke}-${String(xe).padStart(2,"0")}`,Fe=new Date(ke,xe-1).toLocaleDateString("th-TH",{year:"numeric",month:"long"});G[de]||(G[de]={monthName:Fe,monthKey:de,installments:[],totalAmount:0,totalCollected:0,totalRemaining:0});const Oe=parseFloat(Ee.amount)||0,Ue=0,et=0,Ve=te.toLocaleDateString("th-TH"),qe={pBlack:0,pBlue:0};console.log("New Contract Debug:",{contract:oe.contractNumber,isNewContract:!0,nextDueDate:Ie,currentMonth:xe,currentYear:ke,pStatus:qe}),G[de].installments.push({id:`${oe.id}-${Ee.id}`,contract:oe.contractNumber||`C${oe.id}`,name:oe.customerFullName||`${oe.customerName||""} ${oe.customerSurname||""}`.trim(),collectionDate:Ve,amountToCollect:Oe,amountCollected:Ue,remainingDebt:ve,napheoRed:0,napheoBlue:et,pBlack:qe.pBlack,pRed:0,pBlue:qe.pBlue,paymentStatus:Ee.status,isNewContract:!0}),G[de].totalAmount+=Oe,G[de].totalCollected+=Ue,G[de].totalRemaining+=ve}}for(const Ee of ue){const Ie=Ee.dueDate,te=new Date(Ie),de=`${te.getFullYear()}-${String(te.getMonth()+1).padStart(2,"0")}`,Fe=te.toLocaleDateString("th-TH",{year:"numeric",month:"long"});G[de]||(G[de]={monthName:Fe,monthKey:de,installments:[],totalAmount:0,totalCollected:0,totalRemaining:0});const Oe=parseFloat(Ee.amount)||0,Ue=Ee.status==="paid"?Oe:0,et=Ee.status==="paid"?1:0,Ve=te.toLocaleDateString("th-TH"),qe=V(Ie);console.log("P Status Debug:",{contract:oe.contractNumber,paymentId:Ee.id,dueDate:Ie,pStatus:qe,status:Ee.status,actualRemainingDebt:ve,currentDate:new Date().toLocaleDateString("th-TH"),currentMonth:xe,currentYear:ke}),G[de].installments.push({id:`${oe.id}-${Ee.id}`,contract:oe.contractNumber||`C${oe.id}`,name:oe.customerFullName||`${oe.customerName||""} ${oe.customerSurname||""}`.trim(),collectionDate:Ve,amountToCollect:Oe,amountCollected:Ue,remainingDebt:ve,napheoRed:0,napheoBlue:et,pBlack:qe.pBlack,pRed:0,pBlue:qe.pBlue,paymentStatus:Ee.status}),G[de].totalAmount+=Oe,G[de].totalCollected+=Ue,G[de].totalRemaining+=ve}}}}catch(ce){console.error("Error fetching payments for installment:",oe.id,ce)}const re=Object.keys(G).sort(),he={};re.forEach(oe=>{he[oe]=G[oe]}),S(he)}catch(F){console.error("Error fetching monthly data:",F),we({title:"",description:"",variant:"destructive"})}},[t==null?void 0:t.id,V]),T=k.useCallback(()=>{b(C=>C+1),m(!0),p(null)},[]);k.useEffect(()=>{const C=localStorage.getItem("selectedContractForChecker");C&&(D(C),localStorage.removeItem("selectedContractForChecker"),lt.fire({icon:"info",title:"",html:`
          <div class="text-left">
            <p></p>
            <p><strong>${C}</strong></p>
          </div>
        `,confirmButtonText:"",confirmButtonColor:"#7c3aed"}))},[]),k.useEffect(()=>{const C=async()=>{var R,F,E,M,H;try{m(!0),p(null);const G=await _e.get("/installments");let re=[];if((R=G.data)!=null&&R.success?re=G.data.data||[]:Array.isArray(G.data)&&(re=G.data),!Array.isArray(re))throw new Error(" Array");const oe=re.filter(ue=>ue.inspectorId===(t==null?void 0:t.id)||ue.inspectorId===parseInt(t==null?void 0:t.id)).filter((ue,Ne,De)=>Ne===De.findIndex(Ee=>Ee.id===ue.id)),ce=[];for(let ue=0;ue<oe.length;ue++){const Ne=oe[ue],De=Ne.dueDate||Ne.collectionDate;let Ee="-";if(De)try{const Oe=new Date(De);isNaN(Oe.getTime())||(Ee=Oe.toLocaleDateString("th-TH"))}catch(Oe){console.error("Error parsing date:",De,Oe)}const Ie=V(De);let te=0,de=0,Fe="pending";try{const Oe=await _e.get(`/installments/${Ne.id}/payments`);(F=Oe.data)!=null&&F.success&&Oe.data.data&&(te=Oe.data.data.reduce((et,Ve)=>et+parseFloat(Ve.amount||0),0),te>0&&(de=1,Fe="paid"))}catch(Oe){console.error("Error fetching payments for installment:",Ne.id,Oe)}ce.push({id:Ne.id,sequence:ue+1,contract:Ne.contractNumber||`C${Ne.id}`,name:Ne.customerFullName||`${Ne.customerName||""} ${Ne.customerSurname||""}`.trim(),collectionDate:Ee,amountToCollect:parseFloat(Ne.installmentAmount)||0,amountCollected:te,remainingDebt:parseFloat(Ne.remainingAmount)||0,napheoRed:0,napheoBlue:de,pBlack:Ie.pBlack,pRed:0,pBlue:Ie.pBlue,paymentStatus:Fe})}w(ce);const Q=ce.reduce((ue,Ne)=>Ne.pBlack==="P"||Ne.pBlack===1?ue+1:ue,0),J=ce.reduce((ue,Ne)=>Ne.pBlue==="1"||Ne.pBlue===1?ue+1:ue,0);let O=0,ve=0,ye=0,xe=0;for(const ue of ce)try{const Ne=await _e.get(`/installments/${ue.id}/payments`);if((E=Ne.data)!=null&&E.success&&Ne.data.data){const De=Ne.data.data,Ee=De.reduce((de,Fe)=>de+parseFloat(Fe.amount||0),0),Ie=De.filter(de=>de.status==="paid").reduce((de,Fe)=>de+parseFloat(Fe.amount||0),0),te=Ee-Ie;O+=te,ve+=Ie,Ie>0&&(ye++,xe++)}}catch(Ne){console.error("Error calculating remaining amount for installment:",ue.id,Ne)}const ke={totalCards:ce.length,cardsToCollect:ce.length,cardsCollected:ye,pGreen:J,pRed:Q,totalPCards:Q+J,pGreenCollected:xe,pRedCollected:0,totalPCardsCollected:xe,totalMoney:O,moneyToCollect:O,moneyCollected:ve};x(ke),await P()}catch(G){console.error("Error fetching installments:",G),p(G.message||""),we({title:"",description:((H=(M=G.response)==null?void 0:M.data)==null?void 0:H.message)||G.message||"",variant:"destructive"}),w([]),x({totalCards:0,cardsToCollect:0,cardsCollected:0,pGreen:0,pRed:0,totalPCards:0,pGreenCollected:0,pRedCollected:0,totalPCardsCollected:0,totalMoney:0,moneyToCollect:0,moneyCollected:0})}finally{m(!1)}};t!=null&&t.id&&C()},[t==null?void 0:t.id,c,_,P,V]),k.useCallback(C=>{r===C?a(s==="asc"?"desc":"asc"):(n(C),a("asc"))},[r,s]),k.useCallback(C=>r!==C?null:s==="asc"?i.jsx(Zt,{className:"w-4 h-4"}):i.jsx(Wt,{className:"w-4 h-4"}),[r,s]);const z=k.useMemo(()=>v.filter((R,F,E)=>F===E.findIndex(M=>M.id===R.id)).filter(R=>{const F=R.contract.toLowerCase().includes(o.toLowerCase())||R.name.toLowerCase().includes(o.toLowerCase()),E=!A||R.contract.toLowerCase().includes(A.toLowerCase());let M=!0;if(c&&c!==""||d&&d!=="")try{const H=new Date(R.collectionDate);if(isNaN(H.getTime()))M=!0;else{const G=H.getMonth()+1,re=H.getFullYear();let he=!0,oe=!0;c&&c!==""&&(he=G===parseInt(c)),d&&d!==""&&(oe=re===parseInt(d)),M=he&&oe}}catch(H){console.error("Error parsing date:",R.collectionDate,H),M=!0}return F&&M&&E}),[v,o,c,d,A]),{totalAmountToCollect:L,totalAmountCollected:ee,totalRemainingDebt:j}=k.useMemo(()=>({totalAmountToCollect:z.reduce((C,R)=>C+(R.amountToCollect||0),0),totalAmountCollected:z.reduce((C,R)=>C+(R.amountCollected||0),0),totalRemainingDebt:z.reduce((C,R)=>C+(R.remainingDebt||0),0)}),[z]),U=k.useMemo(()=>[...z.filter((R,F,E)=>F===E.findIndex(M=>M.id===R.id))].sort((R,F)=>{let E=R[r],M=F[r];return r==="sequence"&&(E=parseInt(E),M=parseInt(M)),s==="asc"?E>M?1:-1:E<M?1:-1}),[z,r,s]),q=k.useCallback(()=>{try{const C={checker:t,summary:y,installments:U,exportDate:new Date().toLocaleDateString("th-TH"),totalAmountToCollect:L,totalAmountCollected:ee,totalRemainingDebt:j},R=JSON.stringify(C,null,2),F=new Blob([R],{type:"application/json"}),E=URL.createObjectURL(F),M=document.createElement("a");M.href=E,M.download=`checker-report-${t==null?void 0:t.id}-${new Date().toISOString().split("T")[0]}.json`,M.click(),URL.revokeObjectURL(E),we({title:"",description:""})}catch(C){console.error("Error exporting data:",C),we({title:"",description:"",variant:"destructive"})}},[t,y,U,L,ee,j]);return t?i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center py-4",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs(ae,{variant:"ghost",size:"sm",onClick:e,className:"text-gray-600 hover:text-gray-900",children:[i.jsx(ai,{className:"w-4 h-4 mr-2"}),""]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-sm text-gray-600",children:[": ",t==null?void 0:t.name," ",t==null?void 0:t.surname]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs(ae,{variant:"outline",size:"sm",onClick:T,disabled:h,children:[i.jsx(Pt,{className:`w-4 h-4 mr-2 ${h?"animate-spin":""}`}),""]}),i.jsxs(ae,{variant:"outline",size:"sm",onClick:q,disabled:h||U.length===0,children:[i.jsx(zs,{className:"w-4 h-4 mr-2"}),""]})]})]})})}),i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g&&i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Zi,{className:"w-5 h-5 text-red-400 mr-3"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:""}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:g})]})]})}),h&&i.jsx("div",{className:"flex items-center justify-center py-20",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Pt,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"..."}),i.jsx("p",{className:"text-sm text-gray-600",children:""})]})}),!h&&i.jsxs(i.Fragment,{children:[i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-12",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:z.length})]}),i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(mr,{className:"w-6 h-6 text-blue-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["",L.toLocaleString()]})]}),i.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:i.jsx(ii,{className:"w-6 h-6 text-orange-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",ee.toLocaleString()]})]}),i.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:i.jsx(Tl,{className:"w-6 h-6 text-green-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["",j.toLocaleString()]})]}),i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:i.jsx(ya,{className:"w-6 h-6 text-red-600"})})]})})]}),i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[(c||d||A)&&i.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[i.jsx(iu,{className:"w-4 h-4"}),i.jsx("span",{children:":"}),c&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:[" ",c]}),d&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:[" ",d]}),A&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:[" ",A]}),i.jsxs("span",{className:"text-blue-600",children:["( ",z.length,"  ",v.length," )"]})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 md:space-x-4",children:[i.jsx("div",{className:"flex-1 max-w-md",children:i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:" ...",value:o,onChange:C=>l(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(iu,{className:"w-4 h-4 text-gray-400"}),i.jsxs("select",{value:c,onChange:C=>u(C.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"1",children:""}),i.jsx("option",{value:"2",children:""}),i.jsx("option",{value:"3",children:""}),i.jsx("option",{value:"4",children:""}),i.jsx("option",{value:"5",children:""}),i.jsx("option",{value:"6",children:""}),i.jsx("option",{value:"7",children:""}),i.jsx("option",{value:"8",children:""}),i.jsx("option",{value:"9",children:""}),i.jsx("option",{value:"10",children:""}),i.jsx("option",{value:"11",children:""}),i.jsx("option",{value:"12",children:""})]}),i.jsxs("select",{value:d,onChange:C=>f(C.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"2024",children:"2024"}),i.jsx("option",{value:"2023",children:"2023"}),i.jsx("option",{value:"2022",children:"2022"}),i.jsx("option",{value:"2021",children:"2021"}),i.jsx("option",{value:"2020",children:"2020"}),i.jsx("option",{value:"2019",children:"2019"}),i.jsx("option",{value:"2018",children:"2018"}),i.jsx("option",{value:"2017",children:"2017"}),i.jsx("option",{value:"2016",children:"2016"}),i.jsx("option",{value:"2015",children:"2015"})]})]}),A&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-md",children:A}),i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>D(""),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:""})]}),(c||d||A)&&i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>{u(""),f(""),D("")},className:"text-gray-600 border-gray-300 hover:bg-gray-50 hover:border-gray-400",children:""})]})]})]}),i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"space-y-6 mb-12",children:Object.keys(N).length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[i.jsx(ya,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-600",children:""})]}):Object.entries(N).filter(([C,R])=>{if((!c||c==="")&&(!d||d===""))return!0;const[F,E]=C.split("-");let M=!0,H=!0;return c&&c!==""&&(M=E===c.padStart(2,"0")),d&&d!==""&&(H=F===d),M&&H}).map(([C,R])=>i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:R.monthName}),i.jsxs("p",{className:"text-sm text-gray-600",children:[R.installments.length,"  | : ",R.totalAmount.toLocaleString()," | : ",R.totalCollected.toLocaleString()," | : ",R.totalRemaining.toLocaleString()]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full",children:[R.installments.length," "]})})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"-"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold",children:""}),i.jsx("div",{className:"text-xs text-gray-500",children:""})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-600 font-bold",children:""}),i.jsx("div",{className:"text-xs text-gray-500",children:""})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-black font-bold",children:"P"}),i.jsx("div",{className:"text-xs text-gray-500",children:""})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-600 font-bold",children:"P"}),i.jsx("div",{className:"text-xs text-gray-500",children:""})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold",children:"P"}),i.jsx("div",{className:"text-xs text-gray-500",children:""})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.installments.map((F,E)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:E+1}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:F.contract}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.name||"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.collectionDate}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600 text-center font-medium",children:F.napheoBlue>0?F.napheoBlue:"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 text-center font-medium",children:F.napheoRed>0?F.napheoRed:"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:F.pBlack&&F.pBlack!==0?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue text-blue-600",children:F.pBlack}):"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:F.pRed>0?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"P"}):"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:F.pBlue&&F.pBlue!==0?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:F.pBlue}):"-"}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-orange-600",children:["",F.amountToCollect.toLocaleString()]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["",F.amountCollected.toLocaleString()]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-red-600",children:["",F.remainingDebt.toLocaleString()]})]},F.id))})]})})]},C))}),i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-8",children:[i.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""})}),i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.totalCards||0," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.cardsToCollect||0," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.cardsCollected||0," "]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:"P "}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P :"}),i.jsxs("span",{className:"text-sm font-medium text-green-600",children:[y.pGreen||0," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P :"}),i.jsxs("span",{className:"text-sm font-medium text-red-600",children:[y.pRed||0," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.totalPCards||0," "]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:"P "}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P  :"}),i.jsxs("span",{className:"text-sm font-medium text-green-600",children:[y.pGreenCollected||0," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"P  :"}),i.jsxs("span",{className:"text-sm font-medium text-red-600",children:[y.pRedCollected||0," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:[y.totalPCardsCollected||0," "]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:["",(y.totalMoney||0).toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:["",(y.moneyToCollect||0).toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:":"}),i.jsxs("span",{className:"text-sm font-medium",children:["",(y.moneyCollected||0).toLocaleString()]})]})]})]})]})})]})]})]})]}):i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Zi,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-600 mb-4",children:""}),i.jsxs(ae,{onClick:e,variant:"outline",children:[i.jsx(ai,{className:"w-4 h-4 mr-2"}),""]})]})})},_7=({selectedBranch:e,currentBranch:t,checker:r,onBack:n,onViewPaymentSchedule:s})=>{const[a,o]=k.useState([]),[l,c]=k.useState(!0),[u,d]=k.useState(""),[f,h]=k.useState("all"),[m,g]=k.useState(25),[p,v]=k.useState(1);k.useEffect(()=>{r!=null&&r.id&&w()},[r==null?void 0:r.id,u,f]);const w=async()=>{var A;try{c(!0);const D={};u&&(D.search=u),f&&f!=="all"&&(D.status=f);const V=await _e.get(`/customers/checker/${r.id}/contracts`,{params:D});if(console.log(" Checker customers API response:",V),(A=V.data)!=null&&A.success){const P=V.data.data||[];console.log(" Customers data:",P),console.log(" First customer guarantor data:",P[0]?{guarantor_name:P[0].guarantor_name,guarantor_id_card:P[0].guarantor_id_card,guarantor_nickname:P[0].guarantor_nickname}:"No customers"),o(P)}else o([])}catch(D){console.error("Error loading customers for checker:",D),we({title:"",description:"",variant:"destructive"}),o([])}finally{c(!1)}},y=()=>{we({title:"",description:""})},x=()=>{we({title:"",description:""})},N=A=>{we({title:"",description:` ${A.full_name}`})},S=A=>{console.log(" viewPaymentSchedule called with customer:",A),console.log(" Customer ID:",A.id),console.log(" Customer full_name:",A.full_name),we({title:"",description:` ${A.full_name}`}),s(A)},_=A=>{const D={active:{label:"",className:"bg-green-100 text-green-800"},overdue:{label:"",className:"bg-red-100 text-red-800"},completed:{label:"",className:"bg-blue-100 text-blue-800"},normal:{label:"",className:"bg-gray-100 text-gray-800"}},V=D[A]||D.active;return i.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${V.className}`,children:V.label})},b=a;return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(ae,{onClick:n,variant:"outline",className:"flex items-center gap-2",children:[i.jsx(ai,{className:"w-4 h-4"}),""]}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[" ",r==null?void 0:r.fullName]}),i.jsxs("p",{className:"text-gray-600 mt-1",children:[" ",(t==null?void 0:t.name)||""," | : ",a.length," "]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(ae,{onClick:w,variant:"outline",className:"flex items-center gap-2",disabled:l,children:[i.jsx(Pt,{className:`w-4 h-4 ${l?"animate-spin":""}`}),""]}),i.jsxs(ae,{onClick:x,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[i.jsx(Qi,{className:"w-4 h-4 mr-2"}),""]}),i.jsxs(ae,{onClick:y,className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(zs,{className:"w-4 h-4 mr-2"}),""]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:m,onChange:A=>g(parseInt(A.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:10,children:"10 entries"}),i.jsx("option",{value:25,children:"25 entries"}),i.jsx("option",{value:50,children:"50 entries"}),i.jsx("option",{value:100,children:"100 entries"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:f,onChange:A=>h(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"active",children:""}),i.jsx("option",{value:"overdue",children:""}),i.jsx("option",{value:"completed",children:""})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:", , , , ...",value:u,onChange:A=>d(A.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky left-0 z-20 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:i.jsxs("div",{className:"flex items-center gap-2",children:["#",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["-",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:["",i.jsxs("div",{className:"flex flex-col",children:[i.jsx(Zt,{className:"w-3 h-3 text-gray-400"}),i.jsx(Wt,{className:"w-3 h-3 text-gray-400"})]})]})}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:"10",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(Pt,{className:"w-6 h-6 animate-spin mr-2"}),i.jsx("span",{children:"..."})]})})}):b.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"10",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"text-gray-500",children:[i.jsx(gn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:""})]})})}):b.map((A,D)=>i.jsxs($e.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:D*.05},className:"hover:bg-gray-50 group",children:[i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 bg-white sticky left-0 z-10 group-hover:bg-gray-50 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:D+1}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:A.contract_numbers||"-"}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(br,{className:"w-4 h-4 text-gray-400"}),A.full_name]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 font-mono",children:A.id_card}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:A.nickname})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Nn,{className:"w-4 h-4 text-gray-400"}),A.guarantor_name||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900 font-mono",children:A.guarantor_id_card||"-"}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:A.guarantor_nickname||"-"})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(rs,{className:"w-3 h-3 text-gray-400"}),A.primary_phone||A.phone1||A.phone2||A.phone3||"-"]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(mr,{className:"w-3 h-3 text-gray-400"}),i.jsx("span",{className:"font-medium",children:A.contract_count||0})]}),A.total_contracts_amount&&i.jsxs("div",{className:"text-xs text-gray-500",children:["",parseFloat(A.total_contracts_amount).toLocaleString()]})]})}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:_(A.status)}),i.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ae,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>S(A),children:[i.jsx(mr,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",onClick:()=>N(A),children:[i.jsx(Cs,{className:"w-3 h-3 mr-1"}),""]})]})})]},A.id))})]})}),i.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[i.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[i.jsx(ae,{onClick:()=>v(Math.max(1,p-1)),disabled:p===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),i.jsx(ae,{onClick:()=>v(p+1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:"1"})," to ",i.jsx("span",{className:"font-medium",children:a.length})," of"," ",i.jsx("span",{className:"font-medium",children:a.length})," entries"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[i.jsx(ae,{onClick:()=>v(1),disabled:p===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"First"}),i.jsx(ae,{onClick:()=>v(Math.max(1,p-1)),disabled:p===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),i.jsx(ae,{onClick:()=>v(p+1),className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"}),i.jsx(ae,{onClick:()=>v(1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Last"})]})})]})]})]})]})},S7=({selectedBranch:e,currentBranch:t,onViewPaymentSchedule:r})=>{const[n,s]=k.useState([]),[a,o]=k.useState(!0),[l,c]=k.useState(""),[u,d]=k.useState(!1),[f,h]=k.useState(null),[m,g]=k.useState(!1),[p,v]=k.useState(null),[w,y]=k.useState(!1),[x,N]=k.useState(!1);k.useEffect(()=>{e&&S()},[e]),k.useEffect(()=>{e&&setTimeout(()=>{S()},100)},[]);const S=async()=>{var ee;try{o(!0);const j={branchId:e};l&&(j.search=l);const U=await Xo.getAll(e,j);let q=[];(ee=U.data)!=null&&ee.success&&Array.isArray(U.data.data)?q=U.data.data:(Array.isArray(U.data)||U.data&&Array.isArray(U.data))&&(q=U.data),console.log("Checkers API response:",U),console.log("Processed checkers data:",q),s(q)}catch(j){console.error("Error loading checkers:",j),we({title:"",description:"",variant:"destructive"})}finally{o(!1)}},_=async ee=>{try{g(!0);const j={...ee,branchId:e},U=await Xo.create(j);s(q=>[...q,U.data]),d(!1),we({title:"! ",description:` ${ee.fullName} `})}catch(j){console.error("Error adding checker:",j),we({title:"",description:"",variant:"destructive"})}finally{g(!1)}},b=async ee=>{try{g(!0);const j=await Xo.update(ee.id,ee);s(U=>U.map(q=>q.id===ee.id?j.data:q)),h(null),we({title:"! ",description:` ${ee.fullName} `})}catch(j){console.error("Error updating checker:",j),we({title:"",description:"",variant:"destructive"})}finally{g(!1)}},A=async ee=>{try{await Xo.delete(ee),s(j=>j.filter(U=>U.id!==ee)),we({title:"",description:""})}catch(j){console.error("Error deleting checker:",j),we({title:"",description:"",variant:"destructive"})}},D=()=>{we({title:"",description:""})},V=ee=>{v(ee),y(!0)},P=()=>{v(null),y(!1)},T=ee=>{v(ee),N(!0)},z=()=>{v(null),N(!1)},L=Array.isArray(n)?n.filter(ee=>ee.fullName.toLowerCase().includes(l.toLowerCase())):[];return i.jsx("div",{className:"space-y-6",children:w&&p?i.jsx(gj,{selectedBranch:e,currentBranch:t,checker:p,onBack:P}):x&&p?i.jsx(_7,{selectedBranch:e,currentBranch:t,checker:p,onBack:z,onViewPaymentSchedule:r}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),i.jsxs("p",{className:"text-gray-600",children:[" - ",t==null?void 0:t.name]})]}),i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Ws,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",L.length," "]})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs(ae,{onClick:D,className:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:[i.jsx(zs,{className:"w-4 h-4 mr-2"})," Excel"]})}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Mg,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Welcome,  "})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm text-gray-600",children:"Search:"}),i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"...",value:l,onChange:ee=>{c(ee.target.value),setTimeout(()=>{S()},500)},className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"flex items-center gap-2",children:["-",i.jsx(Nw,{className:"w-4 h-4 cursor-pointer"})]})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"flex items-center gap-2",children:["Action",i.jsx(Nw,{className:"w-4 h-4 cursor-pointer"})]})})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:"3",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(Pt,{className:"w-6 h-6 animate-spin mr-2"}),i.jsx("span",{children:"..."})]})})}):L.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"3",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"text-gray-500",children:[i.jsx(Ws,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:""})]})})}):L.map((ee,j)=>i.jsxs($e.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:j*.05},className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j+1}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ee.fullName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ae,{size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white",onClick:()=>V(ee),children:[i.jsx(mr,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>T(ee),children:[i.jsx(gn,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",onClick:()=>h(ee),children:[i.jsx(Cs,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>A(ee.id),children:[i.jsx(ka,{className:"w-3 h-3 mr-1"}),""]})]})})]},ee.id))})]})}),i.jsxs("div",{className:"bg-white px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Showing 1 to ",L.length," of ",L.length," entries"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{size:"sm",variant:"outline",disabled:!0,className:"text-gray-400",children:"Previous"}),i.jsx(ae,{size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white",children:"1"}),i.jsx(ae,{size:"sm",variant:"outline",disabled:!0,className:"text-gray-400",children:"Next"})]})]})]}),(u||f)&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:f?"":""}),i.jsxs("form",{onSubmit:ee=>{ee.preventDefault();const j=new FormData(ee.target),U={name:j.get("name"),surname:j.get("surname"),fullName:`${j.get("name")} ${j.get("surname")}`.trim()};f?b({...f,...U}):_(U)},children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",name:"name",defaultValue:(f==null?void 0:f.name)||"",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",name:"surname",defaultValue:(f==null?void 0:f.surname)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),i.jsxs("div",{className:"flex gap-2 mt-6",children:[i.jsx(ae,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700",disabled:m,children:m?i.jsxs(i.Fragment,{children:[i.jsx(Pt,{className:"w-4 h-4 mr-2 animate-spin"}),f?"...":"..."]}):f?"":""}),i.jsx(ae,{type:"button",variant:"outline",onClick:()=>{d(!1),h(null)},className:"flex-1",children:""})]})]})]})}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(ae,{onClick:()=>d(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})})]})})},j7=({selectedBranch:e,currentBranch:t,onViewPaymentSchedule:r})=>{const[n,s]=k.useState([]),[a,o]=k.useState(!0),[l,c]=k.useState(""),[u,d]=k.useState("all"),[f,h]=k.useState(25),[m,g]=k.useState(1),[p,v]=k.useState("all"),[w,y]=k.useState([]);k.useEffect(()=>{e&&(x(),N())},[e,l,u,p]);const x=async()=>{var T;try{const z=await _e.get("/checkers",{params:{branchId:e}});(T=z.data)!=null&&T.success?y(z.data.data||[]):y([])}catch(z){console.error("Error loading checkers:",z),y([])}},N=async()=>{var T,z;try{o(!0);const L=await _e.get("/checkers",{params:{branchId:e}});if((T=L.data)!=null&&T.success){const ee=L.data.data||[];let j=[];for(const U of ee)try{const q={};l&&(q.search=l),u&&u!=="all"&&(q.status=u);const C=await _e.get(`/customers/checker/${U.id}/contracts`,{params:q});if((z=C.data)!=null&&z.success){const R=C.data.data||[];R.length>0&&console.log(" First customer data:",{full_name:R[0].full_name,guarantor_name:R[0].guarantor_name,guarantor_id_card:R[0].guarantor_id_card,guarantor_nickname:R[0].guarantor_nickname,guarantor_phone:R[0].guarantor_phone,guarantor_address:R[0].guarantor_address,address:R[0].address,moo:R[0].moo,road:R[0].road,subdistrict:R[0].subdistrict,district:R[0].district,province:R[0].province});for(const F of R){const E=F.contract_numbers?F.contract_numbers.split(", ").map(M=>M.trim()):[F.code||""];for(const M of E){const H={...F,checker_name:U.fullName,checker_id:U.id,contract_number:M,contract_numbers:M,contract_count:1,total_contracts_amount:F.total_contracts_amount/E.length};if(j.push(H),j.length<=3){const G=[F.address,F.moo?`.${F.moo}`:"",F.road,F.subdistrict?`.${F.subdistrict}`:"",F.district?`.${F.district}`:"",F.province?`.${F.province}`:""].filter(Boolean).join(" ");console.log(" Customer address debug:",{full_name:F.full_name,address:F.address,moo:F.moo,road:F.road,subdistrict:F.subdistrict,district:F.district,province:F.province,fullAddress:G,allFields:Object.keys(F)})}}}}}catch(q){console.error(`Error loading customers for checker ${U.id}:`,q)}p&&p!=="all"&&(j=j.filter(U=>U.checker_id===parseInt(p))),console.log(" All customers data:",j),s(j)}else s([])}catch(L){console.error("Error loading all customers:",L),we({title:"",description:"",variant:"destructive"}),s([])}finally{o(!1)}},S=()=>{we({title:"",description:""})},_=()=>{we({title:"",description:""})},b=T=>{we({title:"",description:` ${T.full_name}`})},A=T=>{r&&r(T)},D=n.filter(T=>{var C,R,F,E,M,H,G,re,he,oe,ce,Q,J,O,ve,ye,xe,ke;if(l==="")return!0;const z=l.toLowerCase(),L=[T.address,T.moo?`.${T.moo}`:"",T.road,T.subdistrict?`.${T.subdistrict}`:"",T.district?`.${T.district}`:"",T.province?`.${T.province}`:""].filter(Boolean).join(" ").toLowerCase(),ee=(T.guarantor_address||"").toLowerCase(),j=[T.phone1,T.phone2,T.phone3].filter(Boolean).join(" "),U=((C=T.contract_number)==null?void 0:C.toLowerCase().includes(z))||((R=T.code)==null?void 0:R.toLowerCase().includes(z))||((F=T.full_name)==null?void 0:F.toLowerCase().includes(z))||((E=T.id_card)==null?void 0:E.includes(l))||((M=T.nickname)==null?void 0:M.toLowerCase().includes(z))||((H=T.address)==null?void 0:H.toLowerCase().includes(z))||((G=T.moo)==null?void 0:G.toLowerCase().includes(z))||((re=T.road)==null?void 0:re.toLowerCase().includes(z))||((he=T.subdistrict)==null?void 0:he.toLowerCase().includes(z))||((oe=T.district)==null?void 0:oe.toLowerCase().includes(z))||((ce=T.province)==null?void 0:ce.toLowerCase().includes(z))||L.includes(z)||((Q=T.phone1)==null?void 0:Q.includes(l))||((J=T.phone2)==null?void 0:J.includes(l))||((O=T.phone3)==null?void 0:O.includes(l))||(j==null?void 0:j.includes(l))||((ve=T.guarantor_name)==null?void 0:ve.toLowerCase().includes(z))||((ye=T.guarantor_id_card)==null?void 0:ye.includes(l))||((xe=T.guarantor_nickname)==null?void 0:xe.toLowerCase().includes(z))||((ke=T.guarantor_phone)==null?void 0:ke.includes(l))||ee.includes(z),q=u==="all"||T.status===u;return U&&q}),V=D.slice((m-1)*f,m*f),P=Math.ceil(D.length/f);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(ae,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center gap-2",children:[i.jsx(ai,{className:"w-4 h-4"}),""]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600 mt-1",children:[" ",(t==null?void 0:t.name)||""," | : ",n.length," "]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(ae,{onClick:N,variant:"outline",className:"flex items-center gap-2",disabled:a,children:[i.jsx(Pt,{className:`w-4 h-4 ${a?"animate-spin":""}`}),""]}),i.jsxs(ae,{onClick:_,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[i.jsx(Qi,{className:"w-4 h-4 mr-2"}),""]}),i.jsxs(ae,{onClick:S,className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(zs,{className:"w-4 h-4 mr-2"}),""]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:f,onChange:T=>h(parseInt(T.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:10,children:"10 entries"}),i.jsx("option",{value:25,children:"25 entries"}),i.jsx("option",{value:50,children:"50 entries"}),i.jsx("option",{value:100,children:"100 entries"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:p,onChange:T=>v(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:""}),w.map(T=>i.jsx("option",{value:T.id,children:T.fullName},T.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:u,onChange:T=>d(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:", /, , , , ...",value:l,onChange:T=>c(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsxs("thead",{className:"bg-gray-50 border-b border-gray-200",children:[i.jsxs("tr",{children:[i.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"#"}),i.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:""}),i.jsx("th",{colSpan:"5",className:"px-4 py-2 text-center text-xs font-medium text-gray-700 uppercase tracking-wider bg-blue-50 border-r",children:""}),i.jsx("th",{colSpan:"5",className:"px-4 py-2 text-center text-xs font-medium text-gray-700 uppercase tracking-wider bg-green-50 border-r",children:""}),i.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:""}),i.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:""}),i.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:""}),i.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ACTION"})]}),i.jsxs("tr",{className:"bg-gray-50",children:[i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-blue-50",children:"-"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-blue-50",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-blue-50",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-blue-50",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-t bg-blue-50",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-green-50",children:"-"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-green-50",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-green-50",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-t bg-green-50",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-t bg-green-50",children:""})]})]}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:"15",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(Pt,{className:"w-6 h-6 animate-spin mr-2"}),i.jsx("span",{children:"..."})]})})}):V.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"15",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"text-gray-500",children:[i.jsx(gn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:""})]})})}):V.map((T,z)=>{var q;const L=[T.address,T.moo?`.${T.moo}`:"",T.road,T.subdistrict?`.${T.subdistrict}`:"",T.district?`.${T.district}`:"",T.province?`.${T.province}`:""].filter(Boolean).join(" ")||"",ee=[T.phone1,T.phone2,T.phone3].filter(Boolean).join(", ")||"",j=T.guarantor_address||"",U=T.guarantor_phone||"";return i.jsxs($e.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:z*.05},className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r",children:(m-1)*f+z+1}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r",children:T.contract_number||T.code||""}),i.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 border-r bg-blue-50/30",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(br,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),i.jsx("span",{className:"font-medium",children:T.full_name||""})]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r bg-blue-50/30",children:T.id_card||""}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r bg-blue-50/30",children:T.nickname?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:T.nickname}):""}),i.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 border-r bg-blue-50/30 max-w-xs",children:i.jsxs("div",{className:"flex items-start gap-1",children:[i.jsx(gl,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-xs leading-relaxed",children:L})]})}),i.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 border-r bg-blue-50/30",children:ee!==""?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(rs,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),i.jsx("span",{className:"text-xs",children:ee})]}):""}),i.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 border-r bg-green-50/30",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(br,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),i.jsx("span",{className:"font-medium",children:T.guarantor_name||""})]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r bg-green-50/30",children:T.guarantor_id_card||""}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r bg-green-50/30",children:T.guarantor_nickname?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:T.guarantor_nickname}):""}),i.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 border-r bg-green-50/30 max-w-xs",children:i.jsxs("div",{className:"flex items-start gap-1",children:[i.jsx(gl,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-xs leading-relaxed",children:j})]})}),i.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 border-r bg-green-50/30",children:U!==""?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(rs,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),i.jsx("span",{className:"text-xs",children:U})]}):""}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Nn,{className:"w-4 h-4 text-gray-400"}),T.checker_name||""]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(mr,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{children:["1 ",((q=T.total_contracts_amount)==null?void 0:q.toLocaleString())||0]})]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T.status===""?"bg-green-100 text-green-800":T.status===""?"bg-red-100 text-red-800":T.status===""?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:T.status||""})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ae,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>A(T),children:[i.jsx(au,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",onClick:()=>b(T),children:[i.jsx(Cs,{className:"w-3 h-3 mr-1"}),""]})]})})]},`${T.id}-${T.contract_number||z}`)})})]})}),P>1&&i.jsxs("div",{className:"bg-white px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:[" ",(m-1)*f+1,"  ",Math.min(m*f,D.length),"  ",D.length," "]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{size:"sm",variant:"outline",onClick:()=>g(T=>Math.max(T-1,1)),disabled:m===1,className:"text-gray-700",children:""}),Array.from({length:P},(T,z)=>z+1).map(T=>i.jsx(ae,{size:"sm",variant:m===T?"default":"outline",onClick:()=>g(T),className:m===T?"bg-purple-600 hover:bg-purple-700 text-white":"",children:T},T)),i.jsx(ae,{size:"sm",variant:"outline",onClick:()=>g(T=>Math.min(T+1,P)),disabled:m===P,className:"text-gray-700",children:""})]})]})]})]})},e2=e=>{if(!e||isNaN(e.getTime()))return"-";const t=e.getDate(),r=e.getMonth()+1,n=e.getFullYear(),s=n>2500,a=s?n:n+543;return console.log(" Date Debug:",{original:e,day:t,month:r,year:n,isThaiYear:s,thaiYear:a,formatted:`${t}/${r}/${a}`}),`${t}/${r}/${a}`},C7=({selectedBranch:e,currentBranch:t})=>{console.log(" SalesIndexPage props:",{selectedBranch:e,currentBranch:t});const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(null),[c,u]=k.useState(""),[d,f]=k.useState(""),[h,m]=k.useState(new Date().getFullYear()),[g,p]=k.useState(5),v=[{value:"01",label:""},{value:"02",label:""},{value:"03",label:""},{value:"04",label:""},{value:"05",label:""},{value:"06",label:""},{value:"07",label:""},{value:"08",label:""},{value:"09",label:""},{value:"10",label:""},{value:"11",label:""},{value:"12",label:""}],w=k.useMemo(()=>{const b=new Date().getFullYear(),A=[];for(let D=b;D>=b-5;D--)A.push(D);return A},[]),y=async()=>{var b;try{a(!0),l(null);let A="/installments";const D=new URLSearchParams;d&&D.append("month",d),h&&D.append("year",h),c&&D.append("search",c),e&&D.append("branchId",e),D.toString()&&(A+=`?${D.toString()}`),console.log(" Calling API:",A);const V=await _e.get(A);if(console.log(" API Response:",V.data),(b=V.data)!=null&&b.success){const P=V.data.data||[];console.log(" API Response Data:",P);const T=P.map((z,L)=>{const ee=parseFloat(z.totalAmount)||0,j=parseFloat(z.downPayment)||0,U=parseFloat(z.monthlyPayment)||0,q=parseInt(z.months)||0,C=j+U*q,R=g,F=C*R/100,E=[z.customerMoo,z.customerRoad,z.customerSubdistrict,z.customerDistrict,z.customerProvince].filter(Boolean).join(" ");return{id:z.id,sequence:L+1,contractDate:z.contractDate?e2(new Date(z.contractDate)):"-",contractNumber:z.contractNumber||`C${z.id}`,customerName:z.customerName||"",customerSurname:z.customerSurname||"",customerFullName:z.customerFullName||`${z.customerName||""} ${z.customerSurname||""}`.trim(),customerAddress:E||z.customerAddress||"-",customerPhone:z.customerPhone1||z.customerPhone||"-",productName:z.productName||z.productDescription||"-",totalPrice:ee,downPayment:j,installmentAmount:U,numberOfInstallments:q,collectionDate:z.collectionDate?e2(new Date(z.collectionDate)):"-",inspectorName:z.inspectorFullName||z.inspectorName||"-",salespersonName:z.salespersonFullName||z.salespersonName||"-",commissionRate:R,commissionAmount:F,grandTotal:C}});console.log(" Processed Data:",T),n(T)}else l("")}catch(A){console.error("Error fetching sales data:",A),l(""),we({title:"",description:"",variant:"destructive"})}finally{a(!1)}},x=(b,A)=>{n(D=>D.map(V=>{if(V.id===b){const P=V.grandTotal*A/100;return{...V,commissionRate:A,commissionAmount:P}}return V}))};k.useEffect(()=>{console.log(" useEffect triggered - fetching sales data"),y()},[d,h,g]);const N=k.useMemo(()=>{if(!r.length)return null;const b=r.length,A=r.reduce((T,z)=>T+z.grandTotal,0),D=r.reduce((T,z)=>T+z.downPayment,0),V=r.reduce((T,z)=>T+z.installmentAmount*z.numberOfInstallments,0),P=r.reduce((T,z)=>T+z.commissionAmount,0);return{totalContracts:b,totalSales:A,totalDownPayments:D,totalInstallments:V,totalCommission:P}},[r]),S=k.useMemo(()=>c?r.filter(b=>b.contractNumber.toLowerCase().includes(c.toLowerCase())||b.customerFullName.toLowerCase().includes(c.toLowerCase())||b.productName.toLowerCase().includes(c.toLowerCase())||b.salespersonName.toLowerCase().includes(c.toLowerCase())):r,[r,c]),_=()=>{var D;const b=window.open("","_blank"),A=`
      <!DOCTYPE html>
      <html>
        <head>
          <title></title>
          <style>
            body { font-family: 'Sarabun', sans-serif; margin: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; font-weight: bold; }
            .header { text-align: center; margin-bottom: 20px; }
            .summary { margin-top: 20px; padding: 10px; background-color: #f9f9f9; }
            .text-right { text-align: right; }
            .text-center { text-align: center; }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1></h1>
            <p>: ${d?(D=v.find(V=>V.value===d))==null?void 0:D.label:""} ${h}</p>
            <p>: ${g}%</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th></th>
                <th>...</th>
                <th></th>
                <th> - </th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th>%</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              ${S.map(V=>`
                <tr>
                  <td class="text-center">${V.sequence}</td>
                  <td>${V.contractDate}</td>
                  <td>${V.contractNumber}</td>
                  <td>${V.customerFullName}</td>
                  <td>${V.customerAddress}</td>
                  <td>${V.customerPhone}</td>
                  <td>${V.productName}</td>
                  <td class="text-right">${V.totalPrice.toLocaleString()}</td>
                  <td class="text-right">${V.downPayment.toLocaleString()}</td>
                  <td class="text-right">${V.installmentAmount.toLocaleString()}</td>
                  <td class="text-center">${V.numberOfInstallments}</td>
                  <td>${V.collectionDate}</td>
                  <td>${V.inspectorName}</td>
                  <td>${V.salespersonName}</td>
                  <td class="text-center">${V.commissionRate}%</td>
                  <td class="text-right">${V.commissionAmount.toLocaleString()}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          
          ${N?`
            <div class="summary">
              <h3></h3>
              <p>: ${N.totalContracts} </p>
              <p>: ${N.totalSales.toLocaleString()}</p>
              <p>: ${N.totalDownPayments.toLocaleString()}</p>
              <p>: ${N.totalInstallments.toLocaleString()}</p>
              <p>: ${N.totalCommission.toLocaleString()}</p>
            </div>
          `:""}
        </body>
      </html>
    `;b.document.write(A),b.document.close(),b.print()};return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"max-w-full mx-auto px-2 sm:px-4 lg:px-6 py-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(mr,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600",children:["",t&&` -  ${t.name}`]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("button",{onClick:_,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(zs,{className:"h-4 w-4"}),i.jsx("span",{children:""})]}),i.jsxs("button",{onClick:()=>{we({title:"",description:"",variant:"default"})},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(em,{className:"h-4 w-4"}),i.jsx("span",{children:""})]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:", , ...",value:c,onChange:b=>u(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("select",{value:d,onChange:b=>f(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),v.map(b=>i.jsx("option",{value:b.value,children:b.label},b.value))]}),i.jsx("select",{value:h,onChange:b=>m(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:w.map(b=>i.jsx("option",{value:b,children:b},b))}),i.jsxs("div",{className:"relative",children:[i.jsx(em,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"number",placeholder:" %",value:g,onChange:b=>p(parseFloat(b.target.value)||0),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",max:"100",step:"0.1"})]}),i.jsxs("button",{onClick:y,disabled:s,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s?i.jsx(Pt,{className:"h-4 w-4 animate-spin"}):i.jsx(iu,{className:"h-4 w-4"}),i.jsx("span",{children:""})]})]})}),N&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3 mb-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.totalContracts})]}),i.jsx(mr,{className:"h-8 w-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",N.totalSales.toLocaleString()]})]}),i.jsx(Tl,{className:"h-8 w-8 text-green-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["",N.totalDownPayments.toLocaleString()]})]}),i.jsx(xl,{className:"h-8 w-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["",N.totalInstallments.toLocaleString()]})]}),i.jsx(er,{className:"h-8 w-8 text-purple-600"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["",N.totalCommission.toLocaleString()]})]}),i.jsx(em,{className:"h-8 w-8 text-orange-600"})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"..."}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" - "}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"%"}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:"16",className:"px-4 py-3 text-center",children:i.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[i.jsx(Pt,{className:"h-5 w-5 animate-spin text-blue-600"}),i.jsx("span",{className:"text-gray-600",children:"..."})]})})}):o?i.jsx("tr",{children:i.jsx("td",{colSpan:"16",className:"px-4 py-3 text-center text-red-600",children:o})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"16",className:"px-4 py-3 text-center text-gray-500",children:""})}):S.map(b=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center text-gray-900",children:b.sequence}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:b.contractDate}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-blue-600",children:b.contractNumber}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:b.customerFullName}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:b.customerAddress}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:b.customerPhone}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:b.productName}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900",children:["",b.totalPrice.toLocaleString()]}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900",children:["",b.downPayment.toLocaleString()]}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900",children:["",b.installmentAmount.toLocaleString()]}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center text-gray-900",children:b.numberOfInstallments}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:b.collectionDate}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:b.inspectorName}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:b.salespersonName}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center text-gray-900",children:[i.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:b.commissionRate,onChange:A=>{const D=parseFloat(A.target.value)||0;x(b.id,D)},className:"w-16 text-center border border-gray-300 rounded px-1 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsx("span",{className:"ml-1",children:"%"})]}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right font-medium text-orange-600",children:["",b.commissionAmount.toLocaleString()]})]},b.id))})]})})})]})})},Ta="/installments",Ni={getCustomerInstallment:async e=>{const t=new URLSearchParams({customerId:e});return _e.get(`${Ta}?${t}`)},getInstallmentPayments:async e=>_e.get(`${Ta}/${e}/payments`),createPayment:async(e,t)=>_e.post(`${Ta}/${e}/payments`,t),updatePayment:async(e,t,r)=>(console.log(" paymentScheduleService.updatePayment:",{installmentId:e,paymentId:t,paymentData:r}),_e.put(`${Ta}/${e}/payments/${t}`,r)),deletePayment:async(e,t)=>_e.delete(`${Ta}/${e}/payments/${t}`),createCollection:async(e,t)=>_e.post(`/checkers/${e}/collections`,t),getCollections:async e=>_e.get(`${Ta}/${e}/collections`),update:async(e,t)=>(console.log(" paymentScheduleService.update:",{installmentId:e,installmentData:t}),_e.put(`${Ta}/${e}`,t)),updateDownPayment:async(e,t)=>(console.log(" paymentScheduleService.updateDownPayment:",{installmentId:e,downPaymentData:t}),_e.put(`${Ta}/${e}/down-payment`,t))},E7=({customer:e,onBack:t,customerData:r})=>{var Ee,Ie;const[n,s]=k.useState(""),[a,o]=k.useState(""),[l,c]=k.useState(""),[u,d]=k.useState(""),[f,h]=k.useState(""),[m,g]=k.useState(""),[p,v]=k.useState(""),[w,y]=k.useState(!1),[x,N]=k.useState(!0),[S,_]=k.useState([]),[b,A]=k.useState(null),[D,V]=k.useState([]),[P,T]=k.useState(!1),[z,L]=k.useState(null),[ee,j]=k.useState({paymentDate:"",receiptNumber:"",amount:"",status:"",discount:"",notes:""}),U=r||e||{id:"F0002",name:" ",nickname:"",phone:"0870379475",address:"43/5 .8 . . .",guarantorName:" ",guarantorNickname:"",guarantorPhone:"",guarantorAddress:"43/5 .8 . . .",productType:" 5  ",totalPrice:12840,model:"",serialNumber:"",downPayment:1500,installmentAmount:756,months:15,collectionDate:"04-05-2564",salesperson:" ",line:"4",inspector:"",status:"completed"},q=async()=>{var te;try{T(!0);const de=await _e.get("/employees");let Fe=[];(te=de.data)!=null&&te.success?Fe=de.data.data||[]:Array.isArray(de.data)&&(Fe=de.data);const Oe=Fe.filter(Ue=>Ue.position&&(Ue.position.toLowerCase().includes("collector")||Ue.position.toLowerCase().includes("")||Ue.position.toLowerCase().includes("")));V(Oe)}catch(de){console.error("Error loading collectors:",de),we({title:"",description:"",variant:"destructive"})}finally{T(!1)}};k.useEffect(()=>{U.id&&(C(),q())},[U.id]);const C=async()=>{var te,de,Fe,Oe;try{N(!0),console.log(" Loading customer data for ID:",U.id),console.log(" Customer info:",U),console.log(" Calling getCustomerInstallment...");const Ue=await Ni.getCustomerInstallment(U.id);if(console.log(" Installment response:",Ue),(te=Ue.data)!=null&&te.success&&Ue.data.data.length>0){const et=Ue.data.data[0];console.log(" Found installment:",et),console.log(" Contract number from API:",et.contractNumber),console.log(" Expected contract number:",U.id),et.contractNumber!==U.id&&(console.warn(" Contract number mismatch!"),console.warn(" Expected:",U.id),console.warn(" Got:",et.contractNumber)),A(et),console.log(" Calling getInstallmentPayments for installment ID:",et.id);const Ve=await Ni.getInstallmentPayments(et.id);console.log(" Payments response:",Ve),(de=Ve.data)!=null&&de.success&&_(Ve.data.data||[])}else console.log(" No installment found for customer:",U.id),_([])}catch(Ue){console.error(" Error loading customer data:",Ue),console.error(" Error details:",(Fe=Ue.response)==null?void 0:Fe.data),console.error(" Error status:",(Oe=Ue.response)==null?void 0:Oe.status),we({title:"",description:`: ${Ue.message}`,variant:"destructive"}),_([])}finally{N(!1)}},R=(te,de,Fe,Oe,Ue,et)=>[(te||"").toString().trim(),de?` ${de}`:"",Fe?`.${Fe}`:"",Oe?`.${Oe}`:"",Ue?`.${Ue}`:"",et?`.${et}`:""].filter(Boolean).join(" ").trim()||"N/A",F=b?{id:b.customerId||U.id||U.code||"N/A",name:b.customerFullName||U.full_name||U.name||"N/A",nickname:b.customerNickname||U.nickname||"N/A",phone:b.customerPhone1||U.phone1||U.phone||"N/A",address:R(b.customerAddress||U.address,b.customerMoo||U.customer_moo,b.customerRoad||U.customer_road,b.customerSubdistrict||U.customer_subdistrict,b.customerDistrict||U.customer_district,b.customerProvince||U.customer_province),guarantorName:b.guarantorName||U.guarantor_name||"N/A",guarantorNickname:b.guarantorNickname||U.guarantor_nickname||"N/A",guarantorPhone:b.guarantorPhone1||U.guarantor_phone||"N/A",guarantorAddress:R(b.guarantorAddress||U.guarantor_address,b.guarantorMoo||U.guarantor_moo,b.guarantorRoad||U.guarantor_road,b.guarantorSubdistrict||U.guarantor_subdistrict,b.guarantorDistrict||U.guarantor_district,b.guarantorProvince||U.guarantor_province),productType:b.productName||U.product_type||U.product_name||"N/A",totalPrice:b.totalAmount?parseFloat(b.totalAmount):0,model:b.productModel||U.model||"N/A",serialNumber:b.productSerialNumber||U.serial_number||"N/A",downPayment:b.downPayment?parseFloat(b.downPayment):0,installmentAmount:b.installmentAmount?parseFloat(b.installmentAmount):0,months:b.months||0,collectionDate:b.collectionDate||"N/A",salesperson:b.salespersonFullName||U.salesperson||"N/A",line:b.line||U.line||"N/A",inspector:b.inspectorFullName||U.inspector||"N/A",status:b.status||U.status||"active",contractNumber:b.contractNumber||"N/A",_debugContractNumber:{fromAPI:b.contractNumber,expected:U.id,isMatch:b.contractNumber===U.id}}:{id:U.id||U.code||"N/A",name:U.full_name||U.name||"N/A",nickname:U.nickname||"N/A",phone:U.phone1||U.phone||"N/A",address:R(U.address,U.customer_moo,U.customer_road,U.customer_subdistrict,U.customer_district,U.customer_province),guarantorName:U.guarantor_name||"N/A",guarantorNickname:U.guarantor_nickname||"N/A",guarantorPhone:U.guarantor_phone||"N/A",guarantorAddress:R(U.guarantor_address,U.guarantor_moo,U.guarantor_road,U.guarantor_subdistrict,U.guarantor_district,U.guarantor_province),productType:U.product_type||U.product_name||"N/A",totalPrice:U.total_contracts_amount?parseFloat(U.total_contracts_amount):0,model:U.model||"N/A",serialNumber:U.serial_number||"N/A",downPayment:U.down_payment?parseFloat(U.down_payment):0,installmentAmount:U.installment_amount?parseFloat(U.installment_amount):0,months:U.months||0,collectionDate:U.collection_date||"N/A",salesperson:U.salesperson||"N/A",line:U.line||"N/A",inspector:U.inspector||"N/A",status:U.status||"active",contractNumber:U.contract_number||"N/A",_debugContractNumber:{fromAPI:U.contract_number,expected:U.id,isMatch:U.contract_number===U.id}},E=S.filter(te=>{var de,Fe;return te.status==="paid"&&!((de=te.notes)!=null&&de.includes(""))&&!((Fe=te.notes)!=null&&Fe.includes(""))}).reduce((te,de)=>te+parseFloat(de.amount||0),0),M=parseFloat(F.downPayment||0),H=E+M,G=Math.max(0,F.totalPrice-H),re=H/F.totalPrice*100;console.log(" Payment calculation debug:"),console.log(" Total paid from API:",E),console.log(" Down payment from contract:",M),console.log(" Total paid with down payment:",H),console.log(" Progress percentage:",re),console.log(" Installments from API:",S),console.log(" Customer installment data:",b),console.log(" Customer info data:",U),console.log(" Mapped customer info:",F),console.log(" Guarantor address from API:",b==null?void 0:b.guarantorAddress),console.log(" Guarantor address from customer info:",U==null?void 0:U.guarantor_address),console.log(" Contract date from API:",b==null?void 0:b.contract_date),console.log(" Created date from API:",b==null?void 0:b.createdAt),console.log(" Collection date from customer info:",F.collectionDate);const he=te=>{if(!te)return{receiptNumber:"-",status:"-",discount:"-"};const de=te.match(/:\s*([^,]+)/),Fe=te.match(/:\s*([^,]+)/),Oe=te.match(/:\s*([^,]+)/);let Ue=Oe?Oe[1].trim():"-";return Ue===""?Ue="":Ue===""&&(Ue=""),{receiptNumber:de?de[1].trim():"-",status:Fe?Fe[1].trim():"-",discount:Ue}},oe=()=>{var te,de;try{const Fe=(S||[]).find(Oe=>(Oe.notes||"").includes("")||(Oe.notes||"").includes(""));if(Fe){const Oe=(Fe.notes||"").includes(":")?(de=(te=Fe.notes.split(":")[1])==null?void 0:te.split(",")[0])==null?void 0:de.trim():"";return{receiptNumber:Fe.receiptNumber||Oe||"-",status:"",discount:""}}}catch(Fe){console.warn("Down payment info parse error:",Fe)}return{receiptNumber:"-",status:"",discount:""}},ce=te=>{if(!te)return"-";try{if(te.includes("T"))return new Date(te).toLocaleDateString("th-TH");const de=new Date(te);return isNaN(de.getTime())?"-":de.toLocaleDateString("th-TH")}catch(de){return console.error(" Error formatting date:",te,de),"-"}},Q=oe(),J=[...parseFloat(F.downPayment||0)>0?[{id:"down-payment",notes:`: ${Q.receiptNumber||"-"}, : , : `,paymentDate:(b==null?void 0:b.contract_date)||(b==null?void 0:b.createdAt)||F.collectionDate,dueDate:(b==null?void 0:b.contract_date)||(b==null?void 0:b.createdAt)||F.collectionDate,amount:parseFloat(F.downPayment||0),status:"paid",isDownPayment:!0}]:[],...S.filter(te=>{var de,Fe;return te.status==="paid"&&!((de=te.notes)!=null&&de.includes(""))&&!((Fe=te.notes)!=null&&Fe.includes(""))}).map((te,de)=>({...te,notes:te.notes||` ${de+2}`,isDownPayment:!1}))];console.log(" Down payment date debug:"),console.log(" Contract date:",b==null?void 0:b.contract_date),console.log(" Created date:",b==null?void 0:b.createdAt),console.log(" Collection date:",F.collectionDate),console.log(" Final payment date:",(Ee=J[0])==null?void 0:Ee.paymentDate),console.log(" Formatted date:",ce((Ie=J[0])==null?void 0:Ie.paymentDate));const O=te=>{const Fe=J.slice(0,te+1).reduce((Oe,Ue)=>Oe+parseFloat(Ue.amount||0),0);return Math.max(0,F.totalPrice-Fe)};S.filter(te=>{var de,Fe;return te.status==="pending"&&!((de=te.notes)!=null&&de.includes(""))&&!((Fe=te.notes)!=null&&Fe.includes(""))}).map((te,de)=>({...te,notes:te.notes||` ${de+2}`,isDownPayment:!1}));const ve=async()=>{if(!n||!a||!l){lt.fire({icon:"warning",title:"",text:",  ",confirmButtonColor:"#3B82F6"});return}if(!b){lt.fire({icon:"error",title:"",text:"",confirmButtonColor:"#EF4444"});return}y(!0);try{const te=S.find(de=>parseFloat(de.amount)===parseFloat(l)&&de.status==="pending");if(te){const de={amount:parseFloat(l),payment_date:n,status:"paid",notes:`: ${a}, : ${m}, : ${p}`,collector_id:f||null};console.log(" Updating existing payment:",{installmentId:b.id,paymentId:te.id,updateData:de,paymentDate:n,paymentDateType:typeof n,collectorId:f}),await Ni.updatePayment(b.id,te.id,de)}else{const de={amount:parseFloat(l),payment_date:n,due_date:n,status:"paid",notes:`: ${a}, : ${m}, : ${p}`,collector_id:f||null};await Ni.createPayment(b.id,de)}await C(),s(""),o(""),c(""),d(""),h(""),g(""),v(""),lt.fire({icon:"success",title:"!",text:` ${parseFloat(l).toLocaleString()} `,confirmButtonColor:"#10B981"})}catch(te){console.error("Error saving payment:",te),lt.fire({icon:"error",title:"",text:"",confirmButtonColor:"#EF4444"})}finally{y(!1)}},ye=async te=>{if((await lt.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#6B7280",confirmButtonText:"",cancelButtonText:""})).isConfirmed&&b)try{await Ni.deletePayment(b.id,te),await C(),we({title:"",description:""})}catch(Fe){console.error("Error deleting payment:",Fe),we({title:"",description:"",variant:"destructive"})}},xe=async te=>{try{if(te==="down-payment"){const de={amount:parseFloat(ee.amount),paymentDate:ee.paymentDate,receiptNumber:ee.receiptNumber,status:ee.status,discount:ee.discount};console.log(" Updating down payment:",{installmentId:b.id,updateData:de}),await Ni.updateDownPayment(b.id,de)}else{const de={amount:parseFloat(ee.amount),payment_date:ee.paymentDate,status:"paid",notes:`: ${ee.receiptNumber}, : ${ee.status}, : ${ee.discount}`,receipt_number:ee.receiptNumber};console.log(" Updating payment:",{installmentId:b.id,paymentId:te,updateData:de}),await Ni.updatePayment(b.id,te,de)}await C(),L(null),j({paymentDate:"",receiptNumber:"",amount:"",status:"",discount:"",notes:""}),we({title:"",description:""})}catch(de){console.error("Error updating payment:",de),we({title:"",description:"",variant:"destructive"})}},ke=te=>{L(te.id);const{receiptNumber:de,status:Fe,discount:Oe}=te.isDownPayment?oe():he(te.notes);j({paymentDate:te.paymentDate?new Date(te.paymentDate).toISOString().split("T")[0]:"",receiptNumber:de!=="-"?de:"",amount:te.amount||"",status:Fe!=="-"?Fe:"",discount:Oe!=="-"&&Oe===""?"":"",notes:te.notes||""}),te.id==="down-payment"&&we({title:"",description:""})},ue=()=>{var Fe,Oe,Ue;const te=`
      <!DOCTYPE html>
      <html>
      <head>
        <title> - ${F.name}</title>
        <style>
          body {
            font-family: 'Sarabun', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            font-size: 14px;
            line-height: 1.6;
          }
          .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
          }
          .header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: bold;
          }
          .header p {
            margin: 5px 0;
            font-size: 16px;
          }
          .customer-info {
            margin-bottom: 30px;
          }
          .customer-info h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
          }
          .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
          }
          .info-section {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
          }
          .info-section h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #555;
          }
          .info-item {
            margin-bottom: 8px;
          }
          .info-label {
            font-weight: bold;
            color: #333;
          }
          .contract-details {
            margin-bottom: 30px;
          }
          .contract-details h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
          }
          .payment-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
          }
          .payment-table th,
          .payment-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
          }
          .payment-table th {
            background-color: #f5f5f5;
            font-weight: bold;
            color: #333;
          }
          .payment-table tr:nth-child(even) {
            background-color: #f9f9f9;
          }
          .summary {
            margin-top: 30px;
            padding: 20px;
            background: #f0f8ff;
            border-radius: 5px;
          }
          .summary h2 {
            margin: 0 0 15px 0;
            font-size: 18px;
            color: #333;
          }
          .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
          }
          .summary-label {
            font-weight: bold;
            color: #333;
          }
          .summary-value {
            color: #555;
          }
          .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 12px;
            color: #666;
            border-top: 1px solid #ddd;
            padding-top: 20px;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <h1></h1>
          <p>  </p>
          <p>: ${new Date().toLocaleDateString("th-TH")}</p>
        </div>

        <div class="customer-info">
          <h2></h2>
          <div class="info-grid">
            <div class="info-section">
              <h3></h3>
              <div class="info-item">
                <span class="info-label">-:</span> ${F.name}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.nickname}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.phone}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.address}
              </div>
            </div>
            <div class="info-section">
              <h3></h3>
              <div class="info-item">
                <span class="info-label">-:</span> ${F.guarantorName}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.guarantorNickname||"-"}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.guarantorPhone||"-"}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.guarantorAddress||"-"}
              </div>
            </div>
          </div>
        </div>

        <div class="contract-details">
          <h2></h2>
          <div class="info-grid">
            <div class="info-section">
              <div class="info-item">
                <span class="info-label">:</span> ${F.contractNumber||(b==null?void 0:b.contractNumber)||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.productType}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.model||"-"}
              </div>
              <div class="info-item">
                <span class="info-label">S/N:</span> ${F.serialNumber||"-"}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${((Fe=F.totalPrice)==null?void 0:Fe.toLocaleString())||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${((Oe=F.downPayment)==null?void 0:Oe.toLocaleString())||"N/A"}
              </div>
            </div>
            <div class="info-section">
              <div class="info-item">
                <span class="info-label">:</span> ${((Ue=F.installmentAmount)==null?void 0:Ue.toLocaleString())||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${F.months||"N/A"} 
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${ce(b==null?void 0:b.startDate)||"N/A"}
              </div>
              <div class="info-item">
                <span class="info-label">:</span> ${ce(b==null?void 0:b.endDate)||"N/A"}
              </div>
            </div>
          </div>
        </div>

        <h2></h2>
        <table class="payment-table">
          <thead>
            <tr>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            ${J.map((et,Ve)=>{var qe,Ke,pt;return`
              <tr>
                <td>${Ve+1}</td>
                <td>${ce(et.paymentDate)}</td>
                <td>${(qe=et.notes)!=null&&qe.includes(":")&&((pt=(Ke=et.notes.split(":")[1])==null?void 0:Ke.split(",")[0])==null?void 0:pt.trim())||"-"}</td>
                <td>${parseFloat(et.amount||0).toLocaleString()}</td>
                <td>${O(Ve).toLocaleString()}</td>
                <td></td>
              </tr>
            `}).join("")}
          </tbody>
        </table>

        <div class="summary">
          <h2></h2>
          <div class="summary-item">
            <span class="summary-label">:</span>
            <span class="summary-value">${J.length} </span>
          </div>
          <div class="summary-item">
            <span class="summary-label">:</span>
            <span class="summary-value">${J.reduce((et,Ve)=>et+parseFloat(Ve.amount||0),0).toLocaleString()}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">:</span>
            <span class="summary-value">${Math.max(0,F.totalPrice-J.reduce((et,Ve)=>et+parseFloat(Ve.amount||0),0)).toLocaleString()}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">:</span>
            <span class="summary-value">${Math.max(0,(F.months||0)-J.length)} </span>
          </div>
        </div>

        <div class="footer">
          <p></p>
          <p>: ${new Date().toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}</p>
        </div>
      </body>
      </html>
    `,de=window.open("","_blank");de.document.write(te),de.document.close(),de.onload=()=>{de.print(),de.close()}},Ne=()=>{const te=Ve=>Ve?new Date(Ve).toLocaleDateString("th-TH"):"",de=J||[],Fe=Ve=>{var xr,St,_n;const qe=de[Ve],Ke=(xr=qe==null?void 0:qe.notes)!=null&&xr.includes(":")?(_n=(St=qe.notes.split(":")[1])==null?void 0:St.split(",")[0])==null?void 0:_n.trim():"",pt=Math.max(0,(F.totalPrice||0)-de.slice(0,Ve+1).reduce((vi,ko)=>vi+parseFloat(ko.amount||0),0));return`
        <tr>
          <td>${Ve+1}</td>
          <td>${qe?te(qe.paymentDate):""}</td>
          <td>${qe?Ke:""}</td>
          <td>${qe?Number(qe.amount||0).toLocaleString():""}</td>
          <td>${qe?Number(pt).toLocaleString():""}</td>
        </tr>
      `},Oe=Ve=>Array.from({length:15}).map((qe,Ke)=>Fe(Ve+Ke)).join(""),Ue=`
    <!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>: ${F.contractNumber||""}</title>
        <style>
          @page { size: 80mm auto; margin: 5mm; }
          body { font-family: 'Sarabun', system-ui, sans-serif; color: #111; display: flex; justify-content: center; }
          .sheet { width: 80mm; margin: 0 auto; }
          .header { display:flex; justify-content:space-between; align-items:baseline; margin-bottom:6px; }
          .brand { font-weight:800; font-size:14px; }
          .addr { font-size:10px; color:#333; }
          .row { display:flex; gap:4px; margin:2px 0; align-items:baseline; }
          .label { width:22mm; font-weight:600; font-size:11px; }
          .value { flex:1; font-size:11px; border-bottom:1px solid #999; padding-bottom:2px; }
          .box { border:1px solid #666; padding:4px; margin-top:6px; }
          .grid { display:grid; grid-template-columns:1fr 1fr; gap:4px; margin-top:6px; }
          table { width:100%; border-collapse:collapse; }
          th, td { border:1px solid #999; font-size:10px; padding:3px; text-align:center; }
          th { background:#f6f6f6; }
        </style>
      </head>
      <body onload="window.print(); setTimeout(() => window.close(), 300);">
        <div class="sheet">
          <div class="header">
            <div>
              <div class="brand"> </div>
              <div class="addr">116  3 . . . 77000</div>
              <div class="addr">. 092-2856965</div>
            </div>
            <div style="font-size:10px;">: ${F.contractNumber||"-"}</div>
          </div>

          <div class="box">
            <div class="row"><div class="label"></div><div class="value">${F.name}  ${F.phone||""}</div></div>
            <div class="row"><div class="label"></div><div class="value">${F.address||""}</div></div>
            <div class="row"><div class="label"></div><div class="value">${F.guarantorName||""}  ${F.guarantorPhone||""}</div></div>
            <div class="row"><div class="label"></div><div class="value">${F.guarantorAddress||""}</div></div>
          </div>

          <div class="box">
            <div class="row"><div class="label"></div><div class="value">${F.productType||""}</div></div>
            <div class="row"><div class="label"></div><div class="value">${Number(F.totalPrice||0).toLocaleString()}</div></div>
            <div class="row"><div class="label"></div><div class="value">${Number(F.downPayment||0).toLocaleString()}</div></div>
            <div class="row"><div class="label">/</div><div class="value">${Number(F.installmentAmount||0).toLocaleString()}</div></div>
            <div class="row"><div class="label"></div><div class="value">${F.months||""} </div></div>
            <div class="row"><div class="label"></div><div class="value">${F.collectionDate||""}</div></div>
            <div class="row"><div class="label"></div><div class="value">${te(b==null?void 0:b.startDate)}</div></div>
          </div>

          <div class="box">
            <div class="grid">
              <div>
                <table>
                  <thead>
                    <tr><th></th><th>//</th><th></th><th></th><th></th></tr>
                  </thead>
                  <tbody>${Oe(0)}</tbody>
                </table>
              </div>
              <div>
                <table>
                  <thead>
                    <tr><th></th><th>//</th><th></th><th></th><th></th></tr>
                  </thead>
                  <tbody>${Oe(15)}</tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </body>
    </html>`,et=window.open("","_blank");et.document.write(Ue),et.document.close()},De=te=>{const de={paid:{label:"",className:"bg-green-100 text-green-800",icon:ts},pending:{label:"",className:"bg-yellow-100 text-yellow-800",icon:$0},overdue:{label:"",className:"bg-red-100 text-red-800",icon:Zi},cancelled:{label:"",className:"bg-gray-100 text-gray-800",icon:Uf},active:{label:"",className:"bg-blue-100 text-blue-800",icon:ts},completed:{label:"",className:"bg-green-100 text-green-800",icon:ts},normal:{label:"",className:"bg-gray-100 text-gray-800",icon:ts}},Fe=de[te]||de.pending,Oe=Fe.icon;return i.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs rounded-full ${Fe.className}`,children:[i.jsx(Oe,{className:"w-3 h-3 mr-1"}),Fe.label]})};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:x?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Pt,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),i.jsx("p",{className:"text-gray-600",children:"..."})]})}):i.jsxs(i.Fragment,{children:[i.jsx($e.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs(ae,{onClick:t,variant:"outline",className:"bg-white hover:bg-gray-50 border-gray-200",children:[i.jsx(ai,{className:"w-4 h-4 mr-2"}),""]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600 mt-1",children:""})]})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs(ae,{onClick:ue,variant:"outline",className:"bg-white hover:bg-gray-50 border-gray-200 text-gray-700",children:[i.jsx(Qi,{className:"w-4 h-4 mr-2"}),""]}),i.jsxs(ae,{onClick:Ne,variant:"outline",className:"bg-white hover:bg-gray-50 border-gray-200 text-gray-700",children:[i.jsx(Qi,{className:"w-4 h-4 mr-2"})," 80mm"]}),De(F.status)]})]})}),i.jsxs("div",{className:"space-y-8",children:[i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4",children:i.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[i.jsx(br,{className:"w-5 h-5 mr-2"}),""]})}),i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(br,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:F.name}),i.jsxs("p",{className:"text-sm text-gray-500",children:[": ",F.contractNumber]}),F._debugContractNumber&&i.jsxs("p",{className:"text-xs text-red-500",children:["Debug: ",F._debugContractNumber.isMatch?"":"","Expected: ",F._debugContractNumber.expected," | Got: ",F._debugContractNumber.fromAPI]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(br,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[": ",F.nickname]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(rs,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.phone})]}),i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx(gl,{className:"w-4 h-4 text-gray-400 mt-0.5"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.address})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[i.jsx(gn,{className:"w-4 h-4 mr-2 text-purple-600"}),""]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(br,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.guarantorName})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(br,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[": ",F.guarantorNickname||"-"]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(rs,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.guarantorPhone||"-"})]}),i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx(gl,{className:"w-4 h-4 text-gray-400 mt-0.5"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.guarantorAddress||"-"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[i.jsx(er,{className:"w-4 h-4 mr-2 text-green-600"}),""]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(er,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:F.productType})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(ii,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[": ",F.totalPrice.toLocaleString()]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(xl,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[": ",F.downPayment.toLocaleString()]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(ya,{className:"w-4 h-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[": ",F.installmentAmount.toLocaleString()," x ",F.months," "]})]})]})]})]})})]})}),i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 px-6 py-4",children:i.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[i.jsx(Sr,{className:"w-5 h-5 mr-2"}),""]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"date",placeholder:"",value:n,onChange:te=>s(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",placeholder:"",value:a,onChange:te=>o(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"number",placeholder:"",value:l,onChange:te=>c(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),P?i.jsxs("div",{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",children:[i.jsx(Pt,{className:"w-4 h-4 animate-spin mr-2"}),"..."]}):i.jsxs("select",{value:f,onChange:te=>h(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",children:[i.jsx("option",{value:"",children:""}),D.map(te=>i.jsxs("option",{value:te.id,children:[te.name," ",te.surname," (",te.position,")"]},te.id))]})]}),i.jsx("div",{className:"flex items-end",children:i.jsx(ae,{onClick:ve,disabled:w,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white transition-all duration-200",children:w?i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"..."]}):i.jsxs("div",{className:"flex items-center",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})})})]}),i.jsx("div",{className:"border-t border-gray-200 pt-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" :"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentStatus",value:"",checked:m==="",onChange:te=>g(te.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:""})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentStatus",value:"",checked:m==="",onChange:te=>g(te.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:""})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentStatus",value:"",checked:m==="",onChange:te=>g(te.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:""})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" :"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"discountStatus",value:"",checked:p==="",onChange:te=>v(te.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:""})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"discountStatus",value:"",checked:p==="",onChange:te=>v(te.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:""})]})]})]})]})})]})]})}),i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-4",children:i.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[i.jsx(mr,{className:"w-5 h-5 mr-2"})," ()"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:J.length>0?J.map((te,de)=>{const{receiptNumber:Fe,status:Oe,discount:Ue}=te.isDownPayment?oe():he(te.notes);let et="";return te.isDownPayment?et="/":et=` ${de+1}`,i.jsxs($e.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:de*.1},className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:et}),te.isDownPayment&&i.jsx("div",{className:"text-xs text-blue-600",children:""}),!te.isDownPayment&&i.jsxs("div",{className:"text-xs text-gray-500",children:[" ",de+1]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z===te.id?i.jsx("input",{type:"date",value:ee.paymentDate,onChange:Ve=>j(qe=>({...qe,paymentDate:Ve.target.value})),className:"w-32 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-900",children:ce(te.paymentDate)}),i.jsx("div",{className:"text-xs text-green-600",children:""})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z===te.id?i.jsx("input",{type:"text",value:ee.receiptNumber,onChange:Ve=>j(qe=>({...qe,receiptNumber:Ve.target.value})),placeholder:"",className:"w-28 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-900",children:Fe}),Fe!=="-"&&i.jsx("div",{className:"text-xs text-blue-600",children:""})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z===te.id?i.jsx("input",{type:"number",value:ee.amount,onChange:Ve=>j(qe=>({...qe,amount:Ve.target.value})),className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01"}):i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm font-medium text-green-600",children:["",parseFloat(te.amount||0).toLocaleString()]}),i.jsx("div",{className:"text-xs text-green-600",children:""})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm text-gray-900",children:["",O(de).toLocaleString()]}),de<J.length-1&&i.jsxs("div",{className:"text-xs text-gray-500",children:[": ",J.length-de-1]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z===te.id?i.jsxs("select",{value:ee.status,onChange:Ve=>j(qe=>({...qe,status:Ve.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""})]}):i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Oe===""?"bg-gray-100 text-gray-800":Oe===""?"bg-yellow-100 text-yellow-800":Oe===""?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:Oe})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z===te.id?i.jsxs("select",{value:ee.discount,onChange:Ve=>j(qe=>({...qe,discount:Ve.target.value})),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""})]}):i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Ue===""?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:Ue})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z===te.id?i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ae,{size:"sm",onClick:()=>xe(te.id),className:"bg-green-600 hover:bg-green-700 text-white",children:""}),i.jsx(ae,{size:"sm",variant:"outline",onClick:()=>{L(null),j({paymentDate:"",receiptNumber:"",amount:"",status:"",discount:"",notes:""})},children:""})]}):i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ae,{size:"sm",variant:"outline",onClick:()=>ke(te),className:"text-blue-600 border-blue-200 hover:bg-blue-50 hover:border-blue-300",children:i.jsx(Cs,{className:"w-3 h-3"})}),!te.isDownPayment&&te.id!=="down-payment"&&i.jsx(ae,{size:"sm",variant:"outline",onClick:()=>ye(te.id),className:"text-red-600 border-red-200 hover:bg-red-50 hover:border-red-300",children:i.jsx(ka,{className:"w-3 h-3"})})]}),te.id==="down-payment"&&i.jsx("div",{className:"text-xs text-blue-600 mt-1",children:""})]})})]},te.id)}):i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-gray-500",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx(mr,{className:"w-8 h-8 mb-2 text-gray-400"}),i.jsx("p",{children:""})]})})})})]})})]})}),i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[i.jsx(Tl,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",H.toLocaleString()]}),i.jsxs("p",{className:"text-sm text-gray-500",children:[" ",F.totalPrice.toLocaleString()]})]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 h-3 rounded-full transition-all duration-500",style:{width:`${Math.min(re,100)}%`}})}),i.jsxs("div",{className:"flex justify-between mt-2 text-sm text-gray-600",children:[i.jsx("span",{children:"0%"}),i.jsxs("span",{children:[Math.round(re),"%"]}),i.jsx("span",{children:"100%"})]}),i.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-blue-800",children:":"}),i.jsxs("span",{className:"text-lg font-bold text-blue-900",children:["",G.toLocaleString()]})]})})]})})]})]})})},T7=e=>{if(!e||isNaN(e.getTime()))return"-";const t=e.getDate(),r=e.getMonth()+1,n=e.getFullYear(),a=n>2500?n:n+543;return`${t.toString().padStart(2,"0")}/${r.toString().padStart(2,"0")}/${a}`},A7=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(null),[c,u]=k.useState(""),[d,f]=k.useState(""),[h,m]=k.useState(new Date().getFullYear()),[g,p]=k.useState(200),v=[{value:"01",label:""},{value:"02",label:""},{value:"03",label:""},{value:"04",label:""},{value:"05",label:""},{value:"06",label:""},{value:"07",label:""},{value:"08",label:""},{value:"09",label:""},{value:"10",label:""},{value:"11",label:""},{value:"12",label:""}],w=k.useMemo(()=>{const _=new Date().getFullYear(),b=[];for(let A=_;A>=_-5;A--)b.push(A);return b},[]),y=async()=>{var _;try{a(!0),l(null);let b="/installments";const A=new URLSearchParams;d&&A.append("month",d),h&&A.append("year",h),c&&A.append("search",c),e&&A.append("branchId",e),A.toString()&&(b+=`?${A.toString()}`),console.log(" Calling API:",b);const D=await _e.get(b);if(console.log(" API Response:",D.data),(_=D.data)!=null&&_.success){const V=D.data.data||[];console.log(" API Response Data:",V);const P=await Promise.all(V.map(async(T,z)=>{var U;let L=null,ee=0,j=0;try{const q=await _e.get(`/installments/${T.id}/payments`);(U=q.data)!=null&&U.success&&(L=q.data.data,ee=L.reduce((R,F)=>R+(F.status==="paid"?parseFloat(F.amount):0),0),j=(parseFloat(T.totalAmount)||0)-ee)}catch{console.log("No payment data for installment:",T.id)}return{id:T.id,sequence:z+1,contractDate:T.contractDate?T7(new Date(T.contractDate)):"-",contractNumber:T.contractNumber||`F${T.id.toString().padStart(4,"0")}`,customerFullName:T.customerFullName||`${T.customerName||""} ${T.customerSurname||""}`.trim()||"-",line:T.line||T.inspectorId||"-",amount:ee,employee:T.salespersonFullName||T.salespersonName||"-",receiptNumber:(L==null?void 0:L.length)>0?`${L[0].id}/${new Date().getFullYear()+543-2500}`:"0",remainingDebt:j,totalAmount:parseFloat(T.totalAmount)||0}}));console.log(" Processed Data:",P),n(P)}else l("")}catch(b){console.error("Error fetching installment data:",b),l(""),we({title:"",description:"",variant:"destructive"})}finally{a(!1)}};k.useEffect(()=>{console.log(" useEffect triggered - fetching installment data"),y()},[d,h]);const x=k.useMemo(()=>c?r.filter(_=>_.contractNumber.toLowerCase().includes(c.toLowerCase())||_.customerFullName.toLowerCase().includes(c.toLowerCase())||_.employee.toLowerCase().includes(c.toLowerCase())):r,[r,c]),N=()=>{var A;const _=window.open("","_blank"),b=`
      <!DOCTYPE html>
      <html>
        <head>
          <title></title>
          <style>
            body { font-family: 'Sarabun', sans-serif; margin: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; font-weight: bold; }
            .header { text-align: center; margin-bottom: 20px; }
            .text-right { text-align: right; }
            .text-center { text-align: center; }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1></h1>
            <p>: ${d?(A=v.find(D=>D.value===d))==null?void 0:A.label:""} ${h}</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>...</th>
                <th></th>
                <th>-</th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              ${x.map(D=>`
                <tr>
                  <td>${D.contractDate}</td>
                  <td>${D.contractNumber}</td>
                  <td>${D.customerFullName}</td>
                  <td class="text-center">${D.line}</td>
                  <td class="text-right">${D.amount.toLocaleString()}</td>
                  <td>${D.employee}</td>
                  <td class="text-center">${D.receiptNumber}</td>
                  <td class="text-right">${D.remainingDebt.toLocaleString()}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </body>
      </html>
    `;_.document.write(b),_.document.close(),_.print()},S=()=>{const b=[["...","","-","","","","",""].join(","),...x.map(P=>[P.contractDate,P.contractNumber,P.customerFullName,P.line,P.amount,P.employee,P.receiptNumber,P.remainingDebt].join(","))].join(`
`),A=new Blob([b],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),V=URL.createObjectURL(A);D.setAttribute("href",V),D.setAttribute("download",`_${d||""}_${h}.csv`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D),we({title:"",description:" Excel ",variant:"default"})};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:i.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[i.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-lg",children:i.jsx(mr,{className:"h-8 w-8 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:""}),i.jsxs("p",{className:"text-gray-600 mt-1",children:[" ",t==null?void 0:t.name]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("button",{onClick:N,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-xl hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[i.jsx(Qi,{className:"h-5 w-5"}),i.jsx("span",{className:"font-semibold",children:""})]}),i.jsxs("button",{onClick:S,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[i.jsx(zs,{className:"h-5 w-5"}),i.jsx("span",{className:"font-semibold",children:" Excel"})]})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx("div",{className:"relative",children:i.jsxs("select",{value:d,onChange:_=>f(_.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 hover:bg-white transition-all duration-200",children:[i.jsx("option",{value:"",children:""}),v.map(_=>i.jsx("option",{value:_.value,children:_.label},_.value))]})}),i.jsx("div",{className:"relative",children:i.jsx("select",{value:h,onChange:_=>m(_.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 hover:bg-white transition-all duration-200",children:w.map(_=>i.jsx("option",{value:_,children:_},_))})}),i.jsxs("button",{onClick:y,className:"flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[i.jsx(an,{className:"h-5 w-5"}),i.jsx("span",{className:"font-semibold",children:""})]}),i.jsxs("div",{className:"flex items-center space-x-3 bg-gray-50 rounded-xl px-4 py-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show"}),i.jsxs("select",{value:g,onChange:_=>p(_.target.value),className:"px-3 py-1 border border-gray-200 rounded-lg text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:50,children:"50"}),i.jsx("option",{value:100,children:"100"}),i.jsx("option",{value:200,children:"200"}),i.jsx("option",{value:500,children:"500"})]}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"entries"})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("span",{className:"text-lg font-semibold text-gray-700",children:"Search:"}),i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(an,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),i.jsx("input",{type:"text",placeholder:", , ...",value:c,onChange:_=>u(_.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 hover:bg-white transition-all duration-200 text-lg"})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-purple-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"... "}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:" "}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:"- "}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:" "}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:" "}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:" "}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:" "}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100 transition-colors duration-200",children:" "})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center",children:i.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[i.jsx(Pt,{className:"h-6 w-6 animate-spin text-blue-600"}),i.jsx("span",{className:"text-gray-600 text-lg",children:"..."})]})})}):o?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-red-600 text-lg",children:o})}):x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-gray-500 text-lg",children:""})}):x.slice(0,g).map((_,b)=>i.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all duration-200",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:_.contractDate}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-red-600 cursor-pointer hover:text-red-800 hover:underline transition-colors duration-200",children:_.contractNumber}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:_.customerFullName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center text-gray-900 font-medium",children:_.line}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-semibold",children:["",_.amount.toLocaleString()]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:_.employee}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center text-gray-900 font-medium",children:_.receiptNumber}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-semibold",children:["",_.remainingDebt.toLocaleString()]})]},_.id))})]})})})]})})},yr=wt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Dr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));yr.displayName="Card";const Zn=wt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Dr("flex flex-col space-y-1.5 p-6",e),...t}));Zn.displayName="CardHeader";const Qn=wt.forwardRef(({className:e,...t},r)=>i.jsx("h3",{ref:r,className:Dr("text-2xl font-semibold leading-none tracking-tight",e),...t}));Qn.displayName="CardTitle";const Os=wt.forwardRef(({className:e,...t},r)=>i.jsx("p",{ref:r,className:Dr("text-sm text-muted-foreground",e),...t}));Os.displayName="CardDescription";const wr=wt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Dr("p-6 pt-0",e),...t}));wr.displayName="CardContent";const F7=wt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Dr("flex items-center p-6 pt-0",e),...t}));F7.displayName="CardFooter";const vj=wt.forwardRef(({className:e,value:t,...r},n)=>i.jsx("div",{ref:n,className:Dr("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:i.jsx("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));vj.displayName="Progress";const P7=Og("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),s0=wt.forwardRef(({className:e,variant:t,...r},n)=>i.jsx("div",{ref:n,role:"alert",className:Dr(P7({variant:t}),e),...r}));s0.displayName="Alert";const D7=wt.forwardRef(({className:e,...t},r)=>i.jsx("h5",{ref:r,className:Dr("mb-1 font-medium leading-none tracking-tight",e),...t}));D7.displayName="AlertTitle";const a0=wt.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:Dr("text-sm [&_p]:leading-relaxed",e),...t}));a0.displayName="AlertDescription";/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Q0={};Q0.version="0.18.5";var yj=1252,I7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],o1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},l1=function(e){I7.indexOf(e)!=-1&&(yj=o1[0]=e)};function R7(){l1(1252)}var gs=function(e){l1(e)};function c1(){gs(1200),R7()}function t2(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function L7(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function wj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var dc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?L7(e.slice(2)):t==254&&r==255?wj(e.slice(2)):t==65279?e.slice(1):e},_d=function(t){return String.fromCharCode(t)},r2=function(t){return String.fromCharCode(t)},Ma,za="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lu(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,s=e.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=za.charAt(a)+za.charAt(o)+za.charAt(l)+za.charAt(c);return t}function On(e){var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=za.indexOf(e.charAt(u++)),o=za.indexOf(e.charAt(u++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=za.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=za.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var rt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),_a=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function oi(e){return rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function n2(e){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var An=function(t){return rt?_a(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function eh(e){if(typeof ArrayBuffer>"u")return An(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function pi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function O7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function u1(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return u1(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Nr=rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:_a(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function M7(e){for(var t=[],r=0,n=e.length+250,s=oi(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=oi(65535),n=65530)}return t.push(s.slice(0,r)),Nr(t)}var sn=/\u0000/g,fc=/[\u0001-\u0006]/g;function nl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function vs(e,t){var r=""+e;return r.length>=t?r:Gt("0",t-r.length)+r}function d1(e,t){var r=""+e;return r.length>=t?r:Gt(" ",t-r.length)+r}function ef(e,t){var r=""+e;return r.length>=t?r:r+Gt(" ",t-r.length)}function B7(e,t){var r=""+Math.round(e);return r.length>=t?r:Gt("0",t-r.length)+r}function $7(e,t){var r=""+e;return r.length>=t?r:Gt("0",t-r.length)+r}var s2=Math.pow(2,32);function So(e,t){if(e>s2||e<-s2)return B7(e,t);var r=Math.round(e);return $7(r,t)}function tf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var a2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function U7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var He={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},i2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},V7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rf(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),l=f*o+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=a):(d=u,l=o)),!r)return[0,n*l,d];var h=Math.floor(n*l/d);return[h,n*l-h*d,d]}function Oi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=K7(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var bj=new Date(1899,11,31,0,0,0),z7=bj.getTime(),W7=new Date(1900,2,1,0,0,0);function Nj(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=W7&&(r+=24*60*60*1e3),(r-(z7+(e.getTimezoneOffset()-bj.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function f1(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function H7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function G7(e){var t=e<0?12:11,r=f1(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function X7(e){var t=f1(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=G7(e):t===10?r=e.toFixed(10).substr(0,12):r=X7(e),f1(H7(r.toUpperCase()))}function no(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ls(14,Nj(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function K7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Y7(e,t,r,n){var s="",a=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return cm[r.m-1][1];case 5:return cm[r.m-1][0];default:return cm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return a2[r.q][0];default:return a2[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?vs(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(s=vs(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?vs(c,u):"";return d}function Wa(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var kj=/%/g;function q7(e,t,r){var n=t.replace(kj,""),s=t.length-n.length;return ua(e,n,r*Math.pow(10,2*s))+Gt("%",s)}function J7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ua(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _j(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_j(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Sj=/# (\?+)( ?)\/( ?)(\d+)/;function Z7(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),o=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?Gt(" ",e[1].length+1+e[4].length):d1(o,e[1].length)+e[2]+"/"+e[3]+vs(l,e[4].length))}function Q7(e,t,r){return r+(t===0?"":""+t)+Gt(" ",e[1].length+2+e[4].length)}var jj=/^#*0*\.([0#]+)/,Cj=/\).*[0#]/,Ej=/\(###\) ###\\?-####/;function tn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function o2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function l2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function e9(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function t9(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Wn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Cj)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wn("n",n,r):"("+Wn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return J7(e,t,r);if(t.indexOf("%")!==-1)return q7(e,t,r);if(t.indexOf("E")!==-1)return _j(t,r);if(t.charCodeAt(0)===36)return"$"+Wn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+So(c,t.length);if(t.match(/^[#?]+$/))return s=So(r,0),s==="0"&&(s=""),s.length>t.length?s:tn(t.substr(0,t.length-s.length))+s;if(a=t.match(Sj))return Z7(a,c,u);if(t.match(/^#+0+$/))return u+So(c,t.length-t.indexOf("0"));if(a=t.match(jj))return s=o2(r,a[1].length).replace(/^([^\.]+)$/,"$1."+tn(a[1])).replace(/\.$/,"."+tn(a[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Gt("0",tn(a[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+o2(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Wa(So(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wn(e,t,-r):Wa(""+(Math.floor(r)+e9(r,a[1].length)))+"."+vs(l2(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Wn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=nl(Wn(e,t.replace(/[\\-]/g,""),r)),o=0,nl(nl(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(Ej))return s=Wn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=rf(c,Math.pow(10,o)-1,!1),s=""+u,d=ua("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=ef(l[2],o),d.length<a[4].length&&(d=tn(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=rf(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?d1(l[1],o)+a[2]+"/"+a[3]+ef(l[2],o):Gt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=So(r,0),t.length<=s.length?s:tn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return tn(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=l2(r,a[1].length),r<0?"-"+Wn(e,t,-r):Wa(t9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?vs(0,3-g.length):"")+g})+"."+vs(o,a[1].length);switch(t){case"###,##0.00":return Wn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Wa(So(c,0));return m!=="0"?u+m:"";case"###,###.00":return Wn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function r9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ua(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function n9(e,t,r){var n=t.replace(kj,""),s=t.length-n.length;return ua(e,n,r*Math.pow(10,2*s))+Gt("%",s)}function Tj(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Tj(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ps(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Cj)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ps("n",n,r):"("+Ps("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return r9(e,t,r);if(t.indexOf("%")!==-1)return n9(e,t,r);if(t.indexOf("E")!==-1)return Tj(t,r);if(t.charCodeAt(0)===36)return"$"+Ps(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+vs(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:tn(t.substr(0,t.length-s.length))+s;if(a=t.match(Sj))return Q7(a,c,u);if(t.match(/^#+0+$/))return u+vs(c,t.length-t.indexOf("0"));if(a=t.match(jj))return s=(""+r).replace(/^([^\.]+)$/,"$1."+tn(a[1])).replace(/\.$/,"."+tn(a[1])),s=s.replace(/\.(\d*)$/,function(g,p){return"."+p+Gt("0",tn(a[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Wa(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ps(e,t,-r):Wa(""+r)+"."+Gt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Ps(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=nl(Ps(e,t.replace(/[\\-]/g,""),r)),o=0,nl(nl(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(Ej))return s=Ps(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=rf(c,Math.pow(10,o)-1,!1),s=""+u,d=ua("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=ef(l[2],o),d.length<a[4].length&&(d=tn(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=rf(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?d1(l[1],o)+a[2]+"/"+a[3]+ef(l[2],o):Gt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:tn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return tn(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ps(e,t,-r):Wa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?vs(0,3-g.length):"")+g})+"."+vs(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Wa(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Ps(e,t.slice(0,t.lastIndexOf(".")),r)+tn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ua(e,t,r){return(r|0)===r?Ps(e,t,r):Wn(e,t,r)}function s9(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Aj=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ll(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":tf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Aj))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function a9(e,t,r,n){for(var s=[],a="",o=0,l="",c="t",u,d,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!tf(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(f=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++o;break;case"\\":var m=e.charAt(++o),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Oi(t,r,e.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Oi(t,r),u==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=Oi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,h="h"):(p.t="t",++o),u==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Aj)){if(u==null&&(u=Oi(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ll(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var v=0,w=0,y;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,c="h",v<1&&(v=1);break;case"s":(y=s[o].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[o].v.match(/[Hh]/)&&(v=1),v<2&&s[o].v.match(/[Mm]/)&&(v=2),v<3&&s[o].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var x="",N;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=Y7(s[o].t.charCodeAt(0),s[o].v,u,w),s[o].t="t";break;case"n":case"?":for(N=o+1;s[N]!=null&&((l=s[N].t)==="?"||l==="D"||(l===" "||l==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[o].v+=s[N].v,s[N]={v:"",t:";"},++N;x+=s[o].v,o=N-1;break;case"G":s[o].t="t",s[o].v=no(t,r);break}var S="",_,b;if(x.length>0){x.charCodeAt(0)==40?(_=t<0&&x.charCodeAt(0)===45?-t:t,b=ua("n",x,_)):(_=t<0&&n>1?-t:t,b=ua("n",x,_),_<0&&s[0]&&s[0].t=="t"&&(b=b.substr(1),s[0].v="-"+s[0].v)),N=b.length-1;var A=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){A=o;break}var D=s.length;if(A===s.length&&b.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(N>=s[o].v.length-1?(N-=s[o].v.length,s[o].v=b.substr(N+1,s[o].v.length)):N<0?s[o].v="":(s[o].v=b.substr(0,N+1),N=-1),s[o].t="t",D=o);N>=0&&D<s.length&&(s[D].v=b.substr(0,N+1)+s[D].v)}else if(A!==s.length&&b.indexOf("E")===-1){for(N=b.indexOf(".")-1,o=A;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===A?s[o].v.indexOf(".")-1:s[o].v.length-1,S=s[o].v.substr(d+1);d>=0;--d)N>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(S=b.charAt(N--)+S);s[o].v=S,s[o].t="t",D=o}for(N>=0&&D<s.length&&(s[D].v=b.substr(0,N+1)+s[D].v),N=b.indexOf(".")+1,o=A;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==A)){for(d=s[o].v.indexOf(".")>-1&&o===A?s[o].v.indexOf(".")+1:0,S=s[o].v.substr(0,d);d<s[o].v.length;++d)N<b.length&&(S+=b.charAt(N++));s[o].v=S,s[o].t="t",D=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(_=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=ua(s[o].t,s[o].v,_),s[o].t="t");var V="";for(o=0;o!==s.length;++o)s[o]!=null&&(V+=s[o].v);return V}var c2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function u2(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function i9(e,t){var r=s9(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(c2),l=r[1].match(c2);return u2(t,o)?[n,r[0]]:u2(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function ls(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:He)[e],n==null&&(n=r.table&&r.table[i2[e]]||He[i2[e]]),n==null&&(n=V7[e]||"General");break}if(tf(n,0))return no(t,r);t instanceof Date&&(t=Nj(t,r.date1904));var s=i9(n,t);if(tf(s[1]))return no(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return a9(s[1],t,r,s[0])}function da(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(He[r]==null){t<0&&(t=r);continue}if(He[r]==e){t=r;break}}t<0&&(t=391)}return He[t]=e,t}function th(e){for(var t=0;t!=392;++t)e[t]!==void 0&&da(e[t],t)}function Ol(){He=U7()}var o9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Fj=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function l9(e){var t=typeof e=="number"?He[e]:e;return t=t.replace(Fj,"(\\d+)"),new RegExp("^"+t+"$")}function c9(e,t,r){var n=-1,s=-1,a=-1,o=-1,l=-1,c=-1;(t.match(Fj)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":a=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:s=m;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var u9=function(){var e={};e.version="1.2.0";function t(){for(var b=0,A=new Array(256),D=0;D!=256;++D)b=D,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,A[D]=b;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(b){var A=0,D=0,V=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)P[V]=b[V];for(V=0;V!=256;++V)for(D=b[V],A=256+V;A<4096;A+=256)D=P[A]=D>>>8^b[D&255];var T=[];for(V=1;V!=16;++V)T[V-1]=typeof Int32Array<"u"?P.subarray(V*256,V*256+256):P.slice(V*256,V*256+256);return T}var s=n(r),a=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],f=s[6],h=s[7],m=s[8],g=s[9],p=s[10],v=s[11],w=s[12],y=s[13],x=s[14];function N(b,A){for(var D=A^-1,V=0,P=b.length;V<P;)D=D>>>8^r[(D^b.charCodeAt(V++))&255];return~D}function S(b,A){for(var D=A^-1,V=b.length-15,P=0;P<V;)D=x[b[P++]^D&255]^y[b[P++]^D>>8&255]^w[b[P++]^D>>16&255]^v[b[P++]^D>>>24]^p[b[P++]]^g[b[P++]]^m[b[P++]]^h[b[P++]]^f[b[P++]]^d[b[P++]]^u[b[P++]]^c[b[P++]]^l[b[P++]]^o[b[P++]]^a[b[P++]]^r[b[P++]];for(V+=15;P<V;)D=D>>>8^r[(D^b[P++])&255];return~D}function _(b,A){for(var D=A^-1,V=0,P=b.length,T=0,z=0;V<P;)T=b.charCodeAt(V++),T<128?D=D>>>8^r[(D^T)&255]:T<2048?(D=D>>>8^r[(D^(192|T>>6&31))&255],D=D>>>8^r[(D^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,z=b.charCodeAt(V++)&1023,D=D>>>8^r[(D^(240|T>>8&7))&255],D=D>>>8^r[(D^(128|T>>2&63))&255],D=D>>>8^r[(D^(128|z>>6&15|(T&3)<<4))&255],D=D>>>8^r[(D^(128|z&63))&255]):(D=D>>>8^r[(D^(224|T>>12&15))&255],D=D>>>8^r[(D^(128|T>>6&63))&255],D=D>>>8^r[(D^(128|T&63))&255]);return~D}return e.table=r,e.bstr=N,e.buf=S,e.str=_,e}(),ze=function(){var t={};t.version="1.2.1";function r(I,X){for(var B=I.split("/"),W=X.split("/"),K=0,Y=0,se=Math.min(B.length,W.length);K<se;++K){if(Y=B[K].length-W[K].length)return Y;if(B[K]!=W[K])return B[K]<W[K]?-1:1}return B.length-W.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var X=I.lastIndexOf("/");return X===-1?I:I.slice(0,X+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var X=I.lastIndexOf("/");return X===-1?I:I.slice(X+1)}function a(I,X){typeof X=="string"&&(X=new Date(X));var B=X.getHours();B=B<<6|X.getMinutes(),B=B<<5|X.getSeconds()>>>1,I.write_shift(2,B);var W=X.getFullYear()-1980;W=W<<4|X.getMonth()+1,W=W<<5|X.getDate(),I.write_shift(2,W)}function o(I){var X=I.read_shift(2)&65535,B=I.read_shift(2)&65535,W=new Date,K=B&31;B>>>=5;var Y=B&15;B>>>=4,W.setMilliseconds(0),W.setFullYear(B+1980),W.setMonth(Y-1),W.setDate(K);var se=X&31;X>>>=5;var ge=X&63;return X>>>=6,W.setHours(X),W.setMinutes(ge),W.setSeconds(se<<1),W}function l(I){Tr(I,0);for(var X={},B=0;I.l<=I.length-4;){var W=I.read_shift(2),K=I.read_shift(2),Y=I.l+K,se={};switch(W){case 21589:B=I.read_shift(1),B&1&&(se.mtime=I.read_shift(4)),K>5&&(B&2&&(se.atime=I.read_shift(4)),B&4&&(se.ctime=I.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}I.l=Y,X[W]=se}return X}var c;function u(){return c||(c={})}function d(I,X){if(I[0]==80&&I[1]==75)return Z(I,X);if((I[0]|32)==109&&(I[1]|32)==105)return RE(I,X);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var B=3,W=512,K=0,Y=0,se=0,ge=0,ne=0,ie=[],le=I.slice(0,512);Tr(le,0);var Se=f(le);switch(B=Se[0],B){case 3:W=512;break;case 4:W=4096;break;case 0:if(Se[1]==0)return Z(I,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}W!==512&&(le=I.slice(0,W),Tr(le,28));var Pe=I.slice(0,W);h(le,B);var Le=le.read_shift(4,"i");if(B===3&&Le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Le);le.l+=4,se=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ge=le.read_shift(4,"i"),K=le.read_shift(4,"i"),ne=le.read_shift(4,"i"),Y=le.read_shift(4,"i");for(var Ce=-1,Re=0;Re<109&&(Ce=le.read_shift(4,"i"),!(Ce<0));++Re)ie[Re]=Ce;var Je=m(I,W);v(ne,Y,Je,W,ie);var Rt=y(Je,se,ie,W);Rt[se].name="!Directory",K>0&&ge!==z&&(Rt[ge].name="!MiniFAT"),Rt[ie[0]].name="!FAT",Rt.fat_addrs=ie,Rt.ssz=W;var Lt={},Rr=[],Ul=[],Vl=[];x(se,Rt,Je,Rr,K,Lt,Ul,ge),g(Ul,Vl,Rr),Rr.shift();var zl={FileIndex:Ul,FullPaths:Vl};return X&&X.raw&&(zl.raw={header:Pe,sectors:Je}),zl}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(L,"Header Signature: "),I.l+=16;var X=I.read_shift(2,"u");return[I.read_shift(2,"u"),X]}function h(I,X){var B=9;switch(I.l+=2,B=I.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,X){for(var B=Math.ceil(I.length/X)-1,W=[],K=1;K<B;++K)W[K-1]=I.slice(K*X,(K+1)*X);return W[B-1]=I.slice(B*X),W}function g(I,X,B){for(var W=0,K=0,Y=0,se=0,ge=0,ne=B.length,ie=[],le=[];W<ne;++W)ie[W]=le[W]=W,X[W]=B[W];for(;ge<le.length;++ge)W=le[ge],K=I[W].L,Y=I[W].R,se=I[W].C,ie[W]===W&&(K!==-1&&ie[K]!==K&&(ie[W]=ie[K]),Y!==-1&&ie[Y]!==Y&&(ie[W]=ie[Y])),se!==-1&&(ie[se]=W),K!==-1&&W!=ie[W]&&(ie[K]=ie[W],le.lastIndexOf(K)<ge&&le.push(K)),Y!==-1&&W!=ie[W]&&(ie[Y]=ie[W],le.lastIndexOf(Y)<ge&&le.push(Y));for(W=1;W<ne;++W)ie[W]===W&&(Y!==-1&&ie[Y]!==Y?ie[W]=ie[Y]:K!==-1&&ie[K]!==K&&(ie[W]=ie[K]));for(W=1;W<ne;++W)if(I[W].type!==0){if(ge=W,ge!=ie[ge])do ge=ie[ge],X[W]=X[ge]+"/"+X[W];while(ge!==0&&ie[ge]!==-1&&ge!=ie[ge]);ie[W]=-1}for(X[0]+="/",W=1;W<ne;++W)I[W].type!==2&&(X[W]+="/")}function p(I,X,B){for(var W=I.start,K=I.size,Y=[],se=W;B&&K>0&&se>=0;)Y.push(X.slice(se*T,se*T+T)),K-=T,se=Ei(B,se*4);return Y.length===0?pe(0):Nr(Y).slice(0,I.size)}function v(I,X,B,W,K){var Y=z;if(I===z){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var se=B[I],ge=(W>>>2)-1;if(!se)return;for(var ne=0;ne<ge&&(Y=Ei(se,ne*4))!==z;++ne)K.push(Y);v(Ei(se,W-4),X-1,B,W,K)}}function w(I,X,B,W,K){var Y=[],se=[];K||(K=[]);var ge=W-1,ne=0,ie=0;for(ne=X;ne>=0;){K[ne]=!0,Y[Y.length]=ne,se.push(I[ne]);var le=B[Math.floor(ne*4/W)];if(ie=ne*4&ge,W<4+ie)throw new Error("FAT boundary crossed: "+ne+" 4 "+W);if(!I[le])break;ne=Ei(I[le],ie)}return{nodes:Y,data:N2([se])}}function y(I,X,B,W){var K=I.length,Y=[],se=[],ge=[],ne=[],ie=W-1,le=0,Se=0,Pe=0,Le=0;for(le=0;le<K;++le)if(ge=[],Pe=le+X,Pe>=K&&(Pe-=K),!se[Pe]){ne=[];var Ce=[];for(Se=Pe;Se>=0;){Ce[Se]=!0,se[Se]=!0,ge[ge.length]=Se,ne.push(I[Se]);var Re=B[Math.floor(Se*4/W)];if(Le=Se*4&ie,W<4+Le)throw new Error("FAT boundary crossed: "+Se+" 4 "+W);if(!I[Re]||(Se=Ei(I[Re],Le),Ce[Se]))break}Y[Pe]={nodes:ge,data:N2([ne])}}return Y}function x(I,X,B,W,K,Y,se,ge){for(var ne=0,ie=W.length?2:0,le=X[I].data,Se=0,Pe=0,Le;Se<le.length;Se+=128){var Ce=le.slice(Se,Se+128);Tr(Ce,64),Pe=Ce.read_shift(2),Le=y1(Ce,0,Pe-ie),W.push(Le);var Re={name:Le,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},Je=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Je!==0&&(Re.ct=N(Ce,Ce.l-8));var Rt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Rt!==0&&(Re.mt=N(Ce,Ce.l-8)),Re.start=Ce.read_shift(4,"i"),Re.size=Ce.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=z,Re.name=""),Re.type===5?(ne=Re.start,K>0&&ne!==z&&(X[ne].name="!StreamData")):Re.size>=4096?(Re.storage="fat",X[Re.start]===void 0&&(X[Re.start]=w(B,Re.start,X.fat_addrs,X.ssz)),X[Re.start].name=Re.name,Re.content=X[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:ne!==z&&Re.start!==z&&X[ne]&&(Re.content=p(Re,X[ne].data,(X[ge]||{}).data))),Re.content&&Tr(Re.content,0),Y[Le]=Re,se.push(Re)}}function N(I,X){return new Date((En(I,X+4)/1e7*Math.pow(2,32)+En(I,X)/1e7-11644473600)*1e3)}function S(I,X){return u(),d(c.readFileSync(I),X)}function _(I,X){var B=X&&X.type;switch(B||rt&&Buffer.isBuffer(I)&&(B="buffer"),B||"base64"){case"file":return S(I,X);case"base64":return d(An(On(I)),X);case"binary":return d(An(I),X)}return d(I,X)}function b(I,X){var B=X||{},W=B.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=W+"/",I.FileIndex[0]={name:W,type:5}),B.CLSID&&(I.FileIndex[0].clsid=B.CLSID),A(I)}function A(I){var X="Sh33tJ5";if(!ze.find(I,"/"+X)){var B=pe(4);B[0]=55,B[1]=B[3]=50,B[2]=54,I.FileIndex.push({name:X,type:2,content:B,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+X),D(I)}}function D(I,X){b(I);for(var B=!1,W=!1,K=I.FullPaths.length-1;K>=0;--K){var Y=I.FileIndex[K];switch(Y.type){case 0:W?B=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(Y.R*Y.L*Y.C)&&(B=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!X)){var se=new Date(1987,1,19),ge=0,ne=Object.create?Object.create(null):{},ie=[];for(K=0;K<I.FullPaths.length;++K)ne[I.FullPaths[K]]=!0,I.FileIndex[K].type!==0&&ie.push([I.FullPaths[K],I.FileIndex[K]]);for(K=0;K<ie.length;++K){var le=n(ie[K][0]);W=ne[le],W||(ie.push([le,{name:s(le).replace("/",""),type:1,clsid:j,ct:se,mt:se,content:null}]),ne[le]=!0)}for(ie.sort(function(Le,Ce){return r(Le[0],Ce[0])}),I.FullPaths=[],I.FileIndex=[],K=0;K<ie.length;++K)I.FullPaths[K]=ie[K][0],I.FileIndex[K]=ie[K][1];for(K=0;K<ie.length;++K){var Se=I.FileIndex[K],Pe=I.FullPaths[K];if(Se.name=s(Pe).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||j,K===0)Se.C=ie.length>1?1:-1,Se.size=0,Se.type=5;else if(Pe.slice(-1)=="/"){for(ge=K+1;ge<ie.length&&n(I.FullPaths[ge])!=Pe;++ge);for(Se.C=ge>=ie.length?-1:ge,ge=K+1;ge<ie.length&&n(I.FullPaths[ge])!=n(Pe);++ge);Se.R=ge>=ie.length?-1:ge,Se.type=1}else n(I.FullPaths[K+1]||"")==n(Pe)&&(Se.R=K+1),Se.type=2}}}function V(I,X){var B=X||{};if(B.fileType=="mad")return LE(I,B);switch(D(I),B.fileType){case"zip":return TE(I,B)}var W=function(Le){for(var Ce=0,Re=0,Je=0;Je<Le.FileIndex.length;++Je){var Rt=Le.FileIndex[Je];if(Rt.content){var Lt=Rt.content.length;Lt>0&&(Lt<4096?Ce+=Lt+63>>6:Re+=Lt+511>>9)}}for(var Rr=Le.FullPaths.length+3>>2,Ul=Ce+7>>3,Vl=Ce+127>>7,zl=Ul+Re+Rr+Vl,yi=zl+127>>7,uh=yi<=109?0:Math.ceil((yi-109)/127);zl+yi+uh+127>>7>yi;)uh=++yi<=109?0:Math.ceil((yi-109)/127);var qs=[1,uh,yi,Vl,Rr,Re,Ce,0];return Le.FileIndex[0].size=Ce<<6,qs[7]=(Le.FileIndex[0].start=qs[0]+qs[1]+qs[2]+qs[3]+qs[4]+qs[5])+(qs[6]+7>>3),qs}(I),K=pe(W[7]<<9),Y=0,se=0;{for(Y=0;Y<8;++Y)K.write_shift(1,ee[Y]);for(Y=0;Y<8;++Y)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),Y=0;Y<3;++Y)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,W[2]),K.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:z),K.write_shift(4,W[3]),K.write_shift(-4,W[1]?W[0]-1:z),K.write_shift(4,W[1]),Y=0;Y<109;++Y)K.write_shift(-4,Y<W[2]?W[1]+Y:-1)}if(W[1])for(se=0;se<W[1];++se){for(;Y<236+se*127;++Y)K.write_shift(-4,Y<W[2]?W[1]+Y:-1);K.write_shift(-4,se===W[1]-1?z:se+1)}var ge=function(Le){for(se+=Le;Y<se-1;++Y)K.write_shift(-4,Y+1);Le&&(++Y,K.write_shift(-4,z))};for(se=Y=0,se+=W[1];Y<se;++Y)K.write_shift(-4,U.DIFSECT);for(se+=W[2];Y<se;++Y)K.write_shift(-4,U.FATSECT);ge(W[3]),ge(W[4]);for(var ne=0,ie=0,le=I.FileIndex[0];ne<I.FileIndex.length;++ne)le=I.FileIndex[ne],le.content&&(ie=le.content.length,!(ie<4096)&&(le.start=se,ge(ie+511>>9)));for(ge(W[6]+7>>3);K.l&511;)K.write_shift(-4,U.ENDOFCHAIN);for(se=Y=0,ne=0;ne<I.FileIndex.length;++ne)le=I.FileIndex[ne],le.content&&(ie=le.content.length,!(!ie||ie>=4096)&&(le.start=se,ge(ie+63>>6)));for(;K.l&511;)K.write_shift(-4,U.ENDOFCHAIN);for(Y=0;Y<W[4]<<2;++Y){var Se=I.FullPaths[Y];if(!Se||Se.length===0){for(ne=0;ne<17;++ne)K.write_shift(4,0);for(ne=0;ne<3;++ne)K.write_shift(4,-1);for(ne=0;ne<12;++ne)K.write_shift(4,0);continue}le=I.FileIndex[Y],Y===0&&(le.start=le.size?le.start-1:z);var Pe=Y===0&&B.root||le.name;if(ie=2*(Pe.length+1),K.write_shift(64,Pe,"utf16le"),K.write_shift(2,ie),K.write_shift(1,le.type),K.write_shift(1,le.color),K.write_shift(-4,le.L),K.write_shift(-4,le.R),K.write_shift(-4,le.C),le.clsid)K.write_shift(16,le.clsid,"hex");else for(ne=0;ne<4;++ne)K.write_shift(4,0);K.write_shift(4,le.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,le.start),K.write_shift(4,le.size),K.write_shift(4,0)}for(Y=1;Y<I.FileIndex.length;++Y)if(le=I.FileIndex[Y],le.size>=4096)if(K.l=le.start+1<<9,rt&&Buffer.isBuffer(le.content))le.content.copy(K,K.l,0,le.size),K.l+=le.size+511&-512;else{for(ne=0;ne<le.size;++ne)K.write_shift(1,le.content[ne]);for(;ne&511;++ne)K.write_shift(1,0)}for(Y=1;Y<I.FileIndex.length;++Y)if(le=I.FileIndex[Y],le.size>0&&le.size<4096)if(rt&&Buffer.isBuffer(le.content))le.content.copy(K,K.l,0,le.size),K.l+=le.size+63&-64;else{for(ne=0;ne<le.size;++ne)K.write_shift(1,le.content[ne]);for(;ne&63;++ne)K.write_shift(1,0)}if(rt)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function P(I,X){var B=I.FullPaths.map(function(ne){return ne.toUpperCase()}),W=B.map(function(ne){var ie=ne.split("/");return ie[ie.length-(ne.slice(-1)=="/"?2:1)]}),K=!1;X.charCodeAt(0)===47?(K=!0,X=B[0].slice(0,-1)+X):K=X.indexOf("/")!==-1;var Y=X.toUpperCase(),se=K===!0?B.indexOf(Y):W.indexOf(Y);if(se!==-1)return I.FileIndex[se];var ge=!Y.match(fc);for(Y=Y.replace(sn,""),ge&&(Y=Y.replace(fc,"!")),se=0;se<B.length;++se)if((ge?B[se].replace(fc,"!"):B[se]).replace(sn,"")==Y||(ge?W[se].replace(fc,"!"):W[se]).replace(sn,"")==Y)return I.FileIndex[se];return null}var T=64,z=-2,L="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],j="00000000000000000000000000000000",U={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:L,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:j,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(I,X,B){u();var W=V(I,B);c.writeFileSync(X,W)}function C(I){for(var X=new Array(I.length),B=0;B<I.length;++B)X[B]=String.fromCharCode(I[B]);return X.join("")}function R(I,X){var B=V(I,X);switch(X&&X.type||"buffer"){case"file":return u(),c.writeFileSync(X.filename,B),B;case"binary":return typeof B=="string"?B:C(B);case"base64":return lu(typeof B=="string"?B:C(B));case"buffer":if(rt)return Buffer.isBuffer(B)?B:_a(B);case"array":return typeof B=="string"?An(B):B}return B}var F;function E(I){try{var X=I.InflateRaw,B=new X;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)F=I;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function M(I,X){if(!F)return $l(I,X);var B=F.InflateRaw,W=new B,K=W._processChunk(I.slice(I.l),W._finishFlushFlag);return I.l+=W.bytesRead,K}function H(I){return F?F.deflateRawSync(I):Ke(I)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function oe(I){var X=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(X>>16|X>>8|X)&255}for(var ce=typeof Uint8Array<"u",Q=ce?new Uint8Array(256):[],J=0;J<256;++J)Q[J]=oe(J);function O(I,X){var B=Q[I&255];return X<=8?B>>>8-X:(B=B<<8|Q[I>>8&255],X<=16?B>>>16-X:(B=B<<8|Q[I>>16&255],B>>>24-X))}function ve(I,X){var B=X&7,W=X>>>3;return(I[W]|(B<=6?0:I[W+1]<<8))>>>B&3}function ye(I,X){var B=X&7,W=X>>>3;return(I[W]|(B<=5?0:I[W+1]<<8))>>>B&7}function xe(I,X){var B=X&7,W=X>>>3;return(I[W]|(B<=4?0:I[W+1]<<8))>>>B&15}function ke(I,X){var B=X&7,W=X>>>3;return(I[W]|(B<=3?0:I[W+1]<<8))>>>B&31}function ue(I,X){var B=X&7,W=X>>>3;return(I[W]|(B<=1?0:I[W+1]<<8))>>>B&127}function Ne(I,X,B){var W=X&7,K=X>>>3,Y=(1<<B)-1,se=I[K]>>>W;return B<8-W||(se|=I[K+1]<<8-W,B<16-W)||(se|=I[K+2]<<16-W,B<24-W)||(se|=I[K+3]<<24-W),se&Y}function De(I,X,B){var W=X&7,K=X>>>3;return W<=5?I[K]|=(B&7)<<W:(I[K]|=B<<W&255,I[K+1]=(B&7)>>8-W),X+3}function Ee(I,X,B){var W=X&7,K=X>>>3;return B=(B&1)<<W,I[K]|=B,X+1}function Ie(I,X,B){var W=X&7,K=X>>>3;return B<<=W,I[K]|=B&255,B>>>=8,I[K+1]=B,X+8}function te(I,X,B){var W=X&7,K=X>>>3;return B<<=W,I[K]|=B&255,B>>>=8,I[K+1]=B&255,I[K+2]=B>>>8,X+16}function de(I,X){var B=I.length,W=2*B>X?2*B:X+5,K=0;if(B>=X)return I;if(rt){var Y=n2(W);if(I.copy)I.copy(Y);else for(;K<I.length;++K)Y[K]=I[K];return Y}else if(ce){var se=new Uint8Array(W);if(se.set)se.set(I);else for(;K<B;++K)se[K]=I[K];return se}return I.length=W,I}function Fe(I){for(var X=new Array(I),B=0;B<I;++B)X[B]=0;return X}function Oe(I,X,B){var W=1,K=0,Y=0,se=0,ge=0,ne=I.length,ie=ce?new Uint16Array(32):Fe(32);for(Y=0;Y<32;++Y)ie[Y]=0;for(Y=ne;Y<B;++Y)I[Y]=0;ne=I.length;var le=ce?new Uint16Array(ne):Fe(ne);for(Y=0;Y<ne;++Y)ie[K=I[Y]]++,W<K&&(W=K),le[Y]=0;for(ie[0]=0,Y=1;Y<=W;++Y)ie[Y+16]=ge=ge+ie[Y-1]<<1;for(Y=0;Y<ne;++Y)ge=I[Y],ge!=0&&(le[Y]=ie[ge+16]++);var Se=0;for(Y=0;Y<ne;++Y)if(Se=I[Y],Se!=0)for(ge=O(le[Y],W)>>W-Se,se=(1<<W+4-Se)-1;se>=0;--se)X[ge|se<<Se]=Se&15|Y<<4;return W}var Ue=ce?new Uint16Array(512):Fe(512),et=ce?new Uint16Array(32):Fe(32);if(!ce){for(var Ve=0;Ve<512;++Ve)Ue[Ve]=0;for(Ve=0;Ve<32;++Ve)et[Ve]=0}(function(){for(var I=[],X=0;X<32;X++)I.push(5);Oe(I,et,32);var B=[];for(X=0;X<=143;X++)B.push(8);for(;X<=255;X++)B.push(9);for(;X<=279;X++)B.push(7);for(;X<=287;X++)B.push(8);Oe(B,Ue,288)})();var qe=function(){for(var X=ce?new Uint8Array(32768):[],B=0,W=0;B<he.length-1;++B)for(;W<he[B+1];++W)X[W]=B;for(;W<32768;++W)X[W]=29;var K=ce?new Uint8Array(259):[];for(B=0,W=0;B<re.length-1;++B)for(;W<re[B+1];++W)K[W]=B;function Y(ge,ne){for(var ie=0;ie<ge.length;){var le=Math.min(65535,ge.length-ie),Se=ie+le==ge.length;for(ne.write_shift(1,+Se),ne.write_shift(2,le),ne.write_shift(2,~le&65535);le-- >0;)ne[ne.l++]=ge[ie++]}return ne.l}function se(ge,ne){for(var ie=0,le=0,Se=ce?new Uint16Array(32768):[];le<ge.length;){var Pe=Math.min(65535,ge.length-le);if(Pe<10){for(ie=De(ne,ie,+(le+Pe==ge.length)),ie&7&&(ie+=8-(ie&7)),ne.l=ie/8|0,ne.write_shift(2,Pe),ne.write_shift(2,~Pe&65535);Pe-- >0;)ne[ne.l++]=ge[le++];ie=ne.l*8;continue}ie=De(ne,ie,+(le+Pe==ge.length)+2);for(var Le=0;Pe-- >0;){var Ce=ge[le];Le=(Le<<5^Ce)&32767;var Re=-1,Je=0;if((Re=Se[Le])&&(Re|=le&-32768,Re>le&&(Re-=32768),Re<le))for(;ge[Re+Je]==ge[le+Je]&&Je<250;)++Je;if(Je>2){Ce=K[Je],Ce<=22?ie=Ie(ne,ie,Q[Ce+1]>>1)-1:(Ie(ne,ie,3),ie+=5,Ie(ne,ie,Q[Ce-23]>>5),ie+=3);var Rt=Ce<8?0:Ce-4>>2;Rt>0&&(te(ne,ie,Je-re[Ce]),ie+=Rt),Ce=X[le-Re],ie=Ie(ne,ie,Q[Ce]>>3),ie-=3;var Lt=Ce<4?0:Ce-2>>1;Lt>0&&(te(ne,ie,le-Re-he[Ce]),ie+=Lt);for(var Rr=0;Rr<Je;++Rr)Se[Le]=le&32767,Le=(Le<<5^ge[le])&32767,++le;Pe-=Je-1}else Ce<=143?Ce=Ce+48:ie=Ee(ne,ie,1),ie=Ie(ne,ie,Q[Ce]),Se[Le]=le&32767,++le}ie=Ie(ne,ie,0)-1}return ne.l=(ie+7)/8|0,ne.l}return function(ne,ie){return ne.length<8?Y(ne,ie):se(ne,ie)}}();function Ke(I){var X=pe(50+Math.floor(I.length*1.1)),B=qe(I,X);return X.slice(0,B)}var pt=ce?new Uint16Array(32768):Fe(32768),xr=ce?new Uint16Array(32768):Fe(32768),St=ce?new Uint16Array(128):Fe(128),_n=1,vi=1;function ko(I,X){var B=ke(I,X)+257;X+=5;var W=ke(I,X)+1;X+=5;var K=xe(I,X)+4;X+=4;for(var Y=0,se=ce?new Uint8Array(19):Fe(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,ie=ce?new Uint8Array(8):Fe(8),le=ce?new Uint8Array(8):Fe(8),Se=se.length,Pe=0;Pe<K;++Pe)se[G[Pe]]=Y=ye(I,X),ne<Y&&(ne=Y),ie[Y]++,X+=3;var Le=0;for(ie[0]=0,Pe=1;Pe<=ne;++Pe)le[Pe]=Le=Le+ie[Pe-1]<<1;for(Pe=0;Pe<Se;++Pe)(Le=se[Pe])!=0&&(ge[Pe]=le[Le]++);var Ce=0;for(Pe=0;Pe<Se;++Pe)if(Ce=se[Pe],Ce!=0){Le=Q[ge[Pe]]>>8-Ce;for(var Re=(1<<7-Ce)-1;Re>=0;--Re)St[Le|Re<<Ce]=Ce&7|Pe<<3}var Je=[];for(ne=1;Je.length<B+W;)switch(Le=St[ue(I,X)],X+=Le&7,Le>>>=3){case 16:for(Y=3+ve(I,X),X+=2,Le=Je[Je.length-1];Y-- >0;)Je.push(Le);break;case 17:for(Y=3+ye(I,X),X+=3;Y-- >0;)Je.push(0);break;case 18:for(Y=11+ue(I,X),X+=7;Y-- >0;)Je.push(0);break;default:Je.push(Le),ne<Le&&(ne=Le);break}var Rt=Je.slice(0,B),Lt=Je.slice(B);for(Pe=B;Pe<286;++Pe)Rt[Pe]=0;for(Pe=W;Pe<30;++Pe)Lt[Pe]=0;return _n=Oe(Rt,pt,286),vi=Oe(Lt,xr,30),X}function qu(I,X){if(I[0]==3&&!(I[1]&3))return[oi(X),2];for(var B=0,W=0,K=n2(X||1<<18),Y=0,se=K.length>>>0,ge=0,ne=0;!(W&1);){if(W=ye(I,B),B+=3,W>>>1)W>>1==1?(ge=9,ne=5):(B=ko(I,B),ge=_n,ne=vi);else{B&7&&(B+=8-(B&7));var ie=I[B>>>3]|I[(B>>>3)+1]<<8;if(B+=32,ie>0)for(!X&&se<Y+ie&&(K=de(K,Y+ie),se=K.length);ie-- >0;)K[Y++]=I[B>>>3],B+=8;continue}for(;;){!X&&se<Y+32767&&(K=de(K,Y+32767),se=K.length);var le=Ne(I,B,ge),Se=W>>>1==1?Ue[le]:pt[le];if(B+=Se&15,Se>>>=4,!(Se>>>8&255))K[Y++]=Se;else{if(Se==256)break;Se-=257;var Pe=Se<8?0:Se-4>>2;Pe>5&&(Pe=0);var Le=Y+re[Se];Pe>0&&(Le+=Ne(I,B,Pe),B+=Pe),le=Ne(I,B,ne),Se=W>>>1==1?et[le]:xr[le],B+=Se&15,Se>>>=4;var Ce=Se<4?0:Se-2>>1,Re=he[Se];for(Ce>0&&(Re+=Ne(I,B,Ce),B+=Ce),!X&&se<Le&&(K=de(K,Le+100),se=K.length);Y<Le;)K[Y]=K[Y-Re],++Y}}}return X?[K,B+7>>>3]:[K.slice(0,Y),B+7>>>3]}function $l(I,X){var B=I.slice(I.l||0),W=qu(B,X);return I.l+=W[1],W[0]}function Sn(I,X){if(I)typeof console<"u"&&console.error(X);else throw new Error(X)}function Z(I,X){var B=I;Tr(B,0);var W=[],K=[],Y={FileIndex:W,FullPaths:K};b(Y,{root:X.root});for(var se=B.length-4;(B[se]!=80||B[se+1]!=75||B[se+2]!=5||B[se+3]!=6)&&se>=0;)--se;B.l=se+4,B.l+=4;var ge=B.read_shift(2);B.l+=6;var ne=B.read_shift(4);for(B.l=ne,se=0;se<ge;++se){B.l+=20;var ie=B.read_shift(4),le=B.read_shift(4),Se=B.read_shift(2),Pe=B.read_shift(2),Le=B.read_shift(2);B.l+=8;var Ce=B.read_shift(4),Re=l(B.slice(B.l+Se,B.l+Se+Pe));B.l+=Se+Pe+Le;var Je=B.l;B.l=Ce+4,Ir(B,ie,le,Y,Re),B.l=Je}return Y}function Ir(I,X,B,W,K){I.l+=2;var Y=I.read_shift(2),se=I.read_shift(2),ge=o(I);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var ne=I.read_shift(4),ie=I.read_shift(4),le=I.read_shift(4),Se=I.read_shift(2),Pe=I.read_shift(2),Le="",Ce=0;Ce<Se;++Ce)Le+=String.fromCharCode(I[I.l++]);if(Pe){var Re=l(I.slice(I.l,I.l+Pe));(Re[21589]||{}).mt&&(ge=Re[21589].mt),((K||{})[21589]||{}).mt&&(ge=K[21589].mt)}I.l+=Pe;var Je=I.slice(I.l,I.l+ie);switch(se){case 8:Je=M(I,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Rt=!1;Y&8&&(ne=I.read_shift(4),ne==134695760&&(ne=I.read_shift(4),Rt=!0),ie=I.read_shift(4),le=I.read_shift(4)),ie!=X&&Sn(Rt,"Bad compressed size: "+X+" != "+ie),le!=B&&Sn(Rt,"Bad uncompressed size: "+B+" != "+le),ch(W,Le,Je,{unsafe:!0,mt:ge})}function TE(I,X){var B=X||{},W=[],K=[],Y=pe(1),se=B.compression?8:0,ge=0,ne=0,ie=0,le=0,Se=0,Pe=I.FullPaths[0],Le=Pe,Ce=I.FileIndex[0],Re=[],Je=0;for(ne=1;ne<I.FullPaths.length;++ne)if(Le=I.FullPaths[ne].slice(Pe.length),Ce=I.FileIndex[ne],!(!Ce.size||!Ce.content||Le=="Sh33tJ5")){var Rt=le,Lt=pe(Le.length);for(ie=0;ie<Le.length;++ie)Lt.write_shift(1,Le.charCodeAt(ie)&127);Lt=Lt.slice(0,Lt.l),Re[Se]=u9.buf(Ce.content,0);var Rr=Ce.content;se==8&&(Rr=H(Rr)),Y=pe(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,ge),Y.write_shift(2,se),Ce.mt?a(Y,Ce.mt):Y.write_shift(4,0),Y.write_shift(-4,Re[Se]),Y.write_shift(4,Rr.length),Y.write_shift(4,Ce.content.length),Y.write_shift(2,Lt.length),Y.write_shift(2,0),le+=Y.length,W.push(Y),le+=Lt.length,W.push(Lt),le+=Rr.length,W.push(Rr),Y=pe(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,ge),Y.write_shift(2,se),Y.write_shift(4,0),Y.write_shift(-4,Re[Se]),Y.write_shift(4,Rr.length),Y.write_shift(4,Ce.content.length),Y.write_shift(2,Lt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,Rt),Je+=Y.l,K.push(Y),Je+=Lt.length,K.push(Lt),++Se}return Y=pe(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Se),Y.write_shift(2,Se),Y.write_shift(4,Je),Y.write_shift(4,le),Y.write_shift(2,0),Nr([Nr(W),Nr(K),Y])}var Ju={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function AE(I,X){if(I.ctype)return I.ctype;var B=I.name||"",W=B.match(/\.([^\.]+)$/);return W&&Ju[W[1]]||X&&(W=(B=X).match(/[\.\\]([^\.\\])+$/),W&&Ju[W[1]])?Ju[W[1]]:"application/octet-stream"}function FE(I){for(var X=lu(I),B=[],W=0;W<X.length;W+=76)B.push(X.slice(W,W+76));return B.join(`\r
`)+`\r
`}function PE(I){var X=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ie){var le=ie.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],W=X.split(`\r
`),K=0;K<W.length;++K){var Y=W[K];if(Y.length==0){B.push("");continue}for(var se=0;se<Y.length;){var ge=76,ne=Y.slice(se,se+ge);ne.charAt(ge-1)=="="?ge--:ne.charAt(ge-2)=="="?ge-=2:ne.charAt(ge-3)=="="&&(ge-=3),ne=Y.slice(se,se+ge),se+=ge,se<Y.length&&(ne+="="),B.push(ne)}}return B.join(`\r
`)}function DE(I){for(var X=[],B=0;B<I.length;++B){for(var W=I[B];B<=I.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+I[++B];X.push(W)}for(var K=0;K<X.length;++K)X[K]=X[K].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return An(X.join(`\r
`))}function IE(I,X,B){for(var W="",K="",Y="",se,ge=0;ge<10;++ge){var ne=X[ge];if(!ne||ne.match(/^\s*$/))break;var ie=ne.match(/^(.*?):\s*([^\s].*)$/);if(ie)switch(ie[1].toLowerCase()){case"content-location":W=ie[2].trim();break;case"content-type":Y=ie[2].trim();break;case"content-transfer-encoding":K=ie[2].trim();break}}switch(++ge,K.toLowerCase()){case"base64":se=An(On(X.slice(ge).join("")));break;case"quoted-printable":se=DE(X.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var le=ch(I,W.slice(B.length),se,{unsafe:!0});Y&&(le.ctype=Y)}function RE(I,X){if(C(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=X&&X.root||"",W=(rt&&Buffer.isBuffer(I)?I.toString("binary"):C(I)).split(`\r
`),K=0,Y="";for(K=0;K<W.length;++K)if(Y=W[K],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),B||(B=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),Y.slice(0,B.length)!=B););var se=(W[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ge="--"+(se[1]||""),ne=[],ie=[],le={FileIndex:ne,FullPaths:ie};b(le);var Se,Pe=0;for(K=0;K<W.length;++K){var Le=W[K];Le!==ge&&Le!==ge+"--"||(Pe++&&IE(le,W.slice(Se,K),B),Se=K)}return le}function LE(I,X){var B=X||{},W=B.boundary||"SheetJS";W="------="+W;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],Y=I.FullPaths[0],se=Y,ge=I.FileIndex[0],ne=1;ne<I.FullPaths.length;++ne)if(se=I.FullPaths[ne].slice(Y.length),ge=I.FileIndex[ne],!(!ge.size||!ge.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Je){return"_x"+Je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Je){return"_u"+Je.charCodeAt(0).toString(16)+"_"});for(var ie=ge.content,le=rt&&Buffer.isBuffer(ie)?ie.toString("binary"):C(ie),Se=0,Pe=Math.min(1024,le.length),Le=0,Ce=0;Ce<=Pe;++Ce)(Le=le.charCodeAt(Ce))>=32&&Le<128&&++Se;var Re=Se>=Pe*4/5;K.push(W),K.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+se),K.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),K.push("Content-Type: "+AE(ge,se)),K.push(""),K.push(Re?PE(le):FE(le))}return K.push(W+`--\r
`),K.join(`\r
`)}function OE(I){var X={};return b(X,I),X}function ch(I,X,B,W){var K=W&&W.unsafe;K||b(I);var Y=!K&&ze.find(I,X);if(!Y){var se=I.FullPaths[0];X.slice(0,se.length)==se?se=X:(se.slice(-1)!="/"&&(se+="/"),se=(se+X).replace("//","/")),Y={name:s(X),type:2},I.FileIndex.push(Y),I.FullPaths.push(se),K||ze.utils.cfb_gc(I)}return Y.content=B,Y.size=B?B.length:0,W&&(W.CLSID&&(Y.clsid=W.CLSID),W.mt&&(Y.mt=W.mt),W.ct&&(Y.ct=W.ct)),Y}function ME(I,X){b(I);var B=ze.find(I,X);if(B){for(var W=0;W<I.FileIndex.length;++W)if(I.FileIndex[W]==B)return I.FileIndex.splice(W,1),I.FullPaths.splice(W,1),!0}return!1}function BE(I,X,B){b(I);var W=ze.find(I,X);if(W){for(var K=0;K<I.FileIndex.length;++K)if(I.FileIndex[K]==W)return I.FileIndex[K].name=s(B),I.FullPaths[K]=B,!0}return!1}function $E(I){D(I,!0)}return t.find=P,t.read=_,t.parse=d,t.write=R,t.writeFile=q,t.utils={cfb_new:OE,cfb_add:ch,cfb_del:ME,cfb_mov:BE,cfb_gc:$E,ReadShift:Tc,CheckField:eC,prep_blob:Tr,bconcat:Nr,use_zlib:E,_deflateRaw:Ke,_inflateRaw:$l,consts:U},t}();function d9(e){return typeof e=="string"?eh(e):Array.isArray(e)?O7(e):e}function Vu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=eh(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ms(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([d9(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=pi(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function f9(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Yt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function d2(e,t){for(var r=[],n=Yt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function rh(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function nh(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function h9(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var nf=new Date(1899,11,30,0,0,0);function pr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=nf.getTime()+(e.getTimezoneOffset()-nf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Pj=new Date,m9=nf.getTime()+(Pj.getTimezoneOffset()-nf.getTimezoneOffset())*6e4,f2=Pj.getTimezoneOffset();function sh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+m9),t.getTimezoneOffset()!==f2&&t.setTime(t.getTime()+(t.getTimezoneOffset()-f2)*6e4),t}function p9(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var h2=new Date("2017-02-19T19:06:09.000Z"),Dj=isNaN(h2.getFullYear())?new Date("2/19/17"):h2,x9=Dj.getFullYear()==2017;function At(e,t){var r=new Date(e);if(x9)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Dj.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function so(e,t){if(rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ms(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ms(wj(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ms(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ms(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Ft(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ft(e[r]));return t}function Gt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ns(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var g9=["january","february","march","april","may","june","july","august","september","october","november","december"];function wl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&g9.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var v9=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(s),o.push(a[l]);return o}}();function Ij(e){return e?e.content&&e.type?so(e.content,!0):e.data?dc(e.data):e.asNodeBuffer&&rt?dc(e.asNodeBuffer().toString("binary")):e.asBinary?dc(e.asBinary()):e._data&&e._data.getContent?dc(so(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Rj(e){if(!e)return null;if(e.data)return t2(e.data);if(e.asNodeBuffer&&rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?t2(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function y9(e){return e&&e.name.slice(-4)===".bin"?Rj(e):Ij(e)}function Kn(e,t){for(var r=e.FullPaths||Yt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function h1(e,t){var r=Kn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function or(e,t,r){if(!r)return y9(h1(e,t));if(!t)return null;try{return or(e,t)}catch{return null}}function Fn(e,t,r){if(!r)return Ij(h1(e,t));if(!t)return null;try{return Fn(e,t)}catch{return null}}function Lj(e,t,r){if(!r)return Rj(h1(e,t));if(!t)return null;try{return Lj(e,t)}catch{return null}}function m2(e){for(var t=e.FullPaths||Yt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function tt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return rt?n=_a(r):n=M7(r),ze.utils.cfb_add(e,t,n)}ze.utils.cfb_add(e,t,r)}else e.file(t,r)}function m1(){return ze.utils.cfb_new()}function Oj(e,t){switch(t.type){case"base64":return ze.read(e,{type:"base64"});case"binary":return ze.read(e,{type:"binary"});case"buffer":case"array":return ze.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function hc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var nr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,w9=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,p2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,b9=/<[^>]*>/g,Jr=nr.match(p2)?p2:b9,N9=/<\w*:/,k9=/<(\/?)\w+:/;function Ye(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(w9),l=0,c="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,r||(n[d.toLowerCase()]=c);else{var m=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[m]&&d.slice(l-3,l)=="ext")continue;n[m]=c,r||(n[m.toLowerCase()]=c)}}return n}function Ks(e){return e.replace(k9,"<$1")}var Mj={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},p1=rh(Mj),ut=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(l,c){return Mj[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,o)+r(s.slice(o+3))}}(),x1=/[&<>'"]/g,_9=/[\u0000-\u0008\u000b-\u001f]/g;function vt(e){var t=e+"";return t.replace(x1,function(r){return p1[r]}).replace(_9,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function x2(e){return vt(e).replace(/ /g,"_x0020_")}var Bj=/[\u0000-\u001f]/g;function g1(e){var t=e+"";return t.replace(x1,function(r){return p1[r]}).replace(/\n/g,"<br/>").replace(Bj,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function S9(e){var t=e+"";return t.replace(x1,function(r){return p1[r]}).replace(Bj,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var g2=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function j9(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Et(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function um(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function v2(e){var t=oi(2*e.length),r,n,s=1,a=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function y2(e){return _a(e,"binary").toString("utf8")}var Sd="foo bar baz",bt=rt&&(y2(Sd)==um(Sd)&&y2||v2(Sd)==um(Sd)&&v2)||um,Ms=rt?function(e){return _a(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},uu=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),$j=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),C9=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),E9=/<\/?(?:vt:)?variant>/g,T9=/<(?:vt:)([^>]*)>([\s\S]*)</;function w2(e,t){var r=Ye(e),n=e.match(C9(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var o=a.replace(E9,"").match(T9);o&&s.push({v:bt(o[2]),t:o[1]})}),s}var Uj=/(^\s|\s$|\n)/;function Ar(e,t){return"<"+e+(t.match(Uj)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function du(e){return Yt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Te(e,t,r){return"<"+e+(r!=null?du(r):"")+(t!=null?(t.match(Uj)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function qp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function A9(e,t){switch(typeof e){case"string":var r=Te("vt:lpwstr",vt(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Te((e|0)==e?"vt:i4":"vt:r8",vt(String(e)));case"boolean":return Te("vt:bool",e?"true":"false")}if(e instanceof Date)return Te("vt:filetime",qp(e));throw new Error("Unable to serialize "+e)}function v1(e){if(rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return bt(pi(u1(e)));throw new Error("Bad input format: expected Buffer or string")}var fu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,fr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},go=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Cn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function F9(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function P9(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,o=n?-t:t;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var b2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},N2=rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:_a(t)})):b2(e)}:b2,k2=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(sa(e,s)));return n.join("").replace(sn,"")},y1=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(sn,""):k2(e,t,r)}:k2,_2=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Vj=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):_2(e,t,r)}:_2,S2=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Ao(e,s)));return n.join("")},zu=rt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):S2(t,r,n)}:S2,zj=function(e,t){var r=En(e,t);return r>0?zu(e,t+4,t+4+r-1):""},Wj=zj,Hj=function(e,t){var r=En(e,t);return r>0?zu(e,t+4,t+4+r-1):""},Gj=Hj,Xj=function(e,t){var r=2*En(e,t);return r>0?zu(e,t+4,t+4+r-1):""},Kj=Xj,Yj=function(t,r){var n=En(t,r);return n>0?y1(t,r+4,r+4+n):""},qj=Yj,Jj=function(e,t){var r=En(e,t);return r>0?zu(e,t+4,t+4+r):""},Zj=Jj,Qj=function(e,t){return F9(e,t)},sf=Qj,w1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rt&&(Wj=function(t,r){if(!Buffer.isBuffer(t))return zj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Gj=function(t,r){if(!Buffer.isBuffer(t))return Hj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Kj=function(t,r){if(!Buffer.isBuffer(t))return Xj(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},qj=function(t,r){if(!Buffer.isBuffer(t))return Yj(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Zj=function(t,r){if(!Buffer.isBuffer(t))return Jj(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},sf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Qj(t,r)},w1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ao=function(e,t){return e[t]},sa=function(e,t){return e[t+1]*256+e[t]},D9=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},En=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ei=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},I9=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Tc(e,t){var r="",n,s,a=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(sa(this,u)),u+=2;e*=2;break;case"utf8":r=zu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=y1(this,this.l,this.l+e);break;case"wstr":return Tc.call(this,e,"dbcs");case"lpstr-ansi":r=Wj(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":r=Gj(this,this.l),e=4+En(this,this.l);break;case"lpwstr":r=Kj(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),r=qj(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),r=Zj(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Ao(this,this.l+e++))!==0;)a.push(_d(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=sa(this,this.l+e))!==0;)a.push(_d(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ao(this,u),this.l=u+1,l=Tc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(_d(sa(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ao(this,u),this.l=u+1,l=Tc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(_d(Ao(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Ao(this,this.l),this.l++,n;case 2:return n=(t==="i"?D9:sa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ei:I9)(this,this.l),this.l+=4,n):(s=En(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=sf(this,this.l):s=sf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Vj(this,this.l,e);break}}return this.l+=e,r}var R9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},L9=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},O9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function M9(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)O9(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,R9(this,t,this.l);break;case 8:if(n=8,r==="f"){P9(this,t,this.l);break}case 16:break;case-4:n=4,L9(this,t,this.l);break}return this.l+=n,this}function eC(e,t){var r=Vj(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Tr(e,t){e.l=t,e.read_shift=Tc,e.chk=eC,e.write_shift=M9}function qr(e,t){e.l+=t}function pe(e){var t=oi(e);return Tr(t,0),t}function Sa(e,t,r){if(e){var n,s,a;Tr(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=vu[l]||vu[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,l))return}}}function wn(){var e=[],t=rt?256:2048,r=function(u){var d=pe(u);return Tr(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},o=function(){return s(),Nr(e)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function be(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=vu[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=e.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&w1(r)&&e.push(r)}}function Ac(e,t,r){var n=Ft(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function j2(e,t,r){var n=Ft(e);return n.s=Ac(n.s,t.s,r),n.e=Ac(n.e,t.s,r),n}function Fc(e,t){if(e.cRel&&e.c<0)for(e=Ft(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ft(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Xe(e);return!e.cRel&&e.cRel!=null&&(r=U9(r)),!e.rRel&&e.rRel!=null&&(r=B9(r)),r}function dm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Bt(e.s.c)+":"+(e.e.cRel?"":"$")+Bt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+tr(e.s.r)+":"+(e.e.rRel?"":"$")+tr(e.e.r):Fc(e.s,t.biff)+":"+Fc(e.e,t.biff)}function b1(e){return parseInt($9(e),10)-1}function tr(e){return""+(e+1)}function B9(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $9(e){return e.replace(/\$(\d+)$/,"$1")}function N1(e){for(var t=V9(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Bt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function U9(e){return e.replace(/^([A-Z])/,"$$$1")}function V9(e){return e.replace(/^\$([A-Z])/,"$1")}function z9(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function $t(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Xe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function kn(e){var t=e.indexOf(":");return t==-1?{s:$t(e),e:$t(e)}:{s:$t(e.slice(0,t)),e:$t(e.slice(t+1))}}function Qe(e,t){return typeof t>"u"||typeof t=="number"?Qe(e.s,e.e):(typeof e!="string"&&(e=Xe(e)),typeof t!="string"&&(t=Xe(t)),e==t?e:e+":"+t)}function dt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function C2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ls(e.z,r?pr(t):t)}catch{}try{return e.w=ls((e.XF||{}).numFmtId||(r?14:0),r?pr(t):t)}catch{return""+t}}function wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ja[e.v]||e.v:t==null?C2(e,e.v):C2(e,t))}function xi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function tC(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?$t(n.origin):n.origin;o=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=dt(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},g=o+f,p=l+h;if(u.s.r>g&&(u.s.r=g),u.s.c>p&&(u.s.c=p),u.e.r<g&&(u.e.r=g),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||He[14],n.cellDates?(m.t="d",m.w=ls(m.z,pr(m.v))):(m.t="n",m.v=pr(m.v),m.w=ls(m.z,m.v))):m.t="s";if(s)a[g]||(a[g]=[]),a[g][p]&&a[g][p].z&&(m.z=a[g][p].z),a[g][p]=m;else{var v=Xe({c:p,r:g});a[v]&&a[v].z&&(m.z=a[v].z),a[v]=m}}}return u.s.c<1e7&&(a["!ref"]=Qe(u)),a}function Ml(e,t){return tC(null,e,t)}function W9(e){return e.read_shift(4,"i")}function ks(e,t){return t||(t=pe(4)),t.write_shift(4,e),t}function Xr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function kr(e,t){var r=!1;return t==null&&(r=!0,t=pe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function H9(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function G9(e,t){return t||(t=pe(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function k1(e,t){var r=e.l,n=e.read_shift(1),s=Xr(e),a=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push(H9(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function X9(e,t){var r=!1;return t==null&&(r=!0,t=pe(15+4*e.t.length)),t.write_shift(1,0),kr(e.t,t),r?t.slice(0,t.l):t}var K9=k1;function Y9(e,t){var r=!1;return t==null&&(r=!0,t=pe(23+4*e.t.length)),t.write_shift(1,1),kr(e.t,t),t.write_shift(4,1),G9({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function cs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vo(e,t){return t==null&&(t=pe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function yo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function wo(e,t){return t==null&&(t=pe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var q9=Xr,rC=kr;function _1(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function af(e,t){var r=!1;return t==null&&(r=!0,t=pe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var J9=Xr,Jp=_1,S1=af;function j1(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?sf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ei(t,0)>>2;return r?s/100:s}function nC(e,t){t==null&&(t=pe(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function sC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Z9(e,t){return t||(t=pe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var bo=sC,Bl=Z9;function Gr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ao(e,t){return(t||pe(8)).write_shift(8,e,"f")}function Q9(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Ui[s];u&&(t.rgb=mu(u));break;case 2:t.rgb=mu([o,l,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function of(e,t){if(t||(t=pe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function eB(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function tB(e,t){t||(t=pe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function aC(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function rB(e){return aC(e,1)}function nB(e){return aC(e,2)}var C1=2,dn=3,jd=11,E2=12,lf=19,Cd=64,sB=65,aB=71,iB=4108,oB=4126,gr=80,iC=81,lB=[gr,iC],Zp={1:{n:"CodePage",t:C1},2:{n:"Category",t:gr},3:{n:"PresentationFormat",t:gr},4:{n:"ByteCount",t:dn},5:{n:"LineCount",t:dn},6:{n:"ParagraphCount",t:dn},7:{n:"SlideCount",t:dn},8:{n:"NoteCount",t:dn},9:{n:"HiddenCount",t:dn},10:{n:"MultimediaClipCount",t:dn},11:{n:"ScaleCrop",t:jd},12:{n:"HeadingPairs",t:iB},13:{n:"TitlesOfParts",t:oB},14:{n:"Manager",t:gr},15:{n:"Company",t:gr},16:{n:"LinksUpToDate",t:jd},17:{n:"CharacterCount",t:dn},19:{n:"SharedDoc",t:jd},22:{n:"HyperlinksChanged",t:jd},23:{n:"AppVersion",t:dn,p:"version"},24:{n:"DigSig",t:sB},26:{n:"ContentType",t:gr},27:{n:"ContentStatus",t:gr},28:{n:"Language",t:gr},29:{n:"Version",t:gr},255:{},2147483648:{n:"Locale",t:lf},2147483651:{n:"Behavior",t:lf},1919054434:{}},Qp={1:{n:"CodePage",t:C1},2:{n:"Title",t:gr},3:{n:"Subject",t:gr},4:{n:"Author",t:gr},5:{n:"Keywords",t:gr},6:{n:"Comments",t:gr},7:{n:"Template",t:gr},8:{n:"LastAuthor",t:gr},9:{n:"RevNumber",t:gr},10:{n:"EditTime",t:Cd},11:{n:"LastPrinted",t:Cd},12:{n:"CreatedDate",t:Cd},13:{n:"ModifiedDate",t:Cd},14:{n:"PageCount",t:dn},15:{n:"WordCount",t:dn},16:{n:"CharCount",t:dn},17:{n:"Thumbnail",t:aB},18:{n:"Application",t:gr},19:{n:"DocSecurity",t:dn},255:{},2147483648:{n:"Locale",t:lf},2147483651:{n:"Behavior",t:lf},1919054434:{}},T2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function uB(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var dB=uB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ui=Ft(dB),ja={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},oC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ex={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ed={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function E1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fB(e){var t=E1();if(!e||!e.match)return t;var r={};if((e.match(Jr)||[]).forEach(function(n){var s=Ye(n);switch(s[0].replace(N9,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[ex[s.ContentType]]!==void 0&&t[ex[s.ContentType]].push(s.PartName);break}}),t.xmlns!==fr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function lC(e,t){var r=h9(ex),n=[],s;n[n.length]=nr,n[n.length]=Te("Types",null,{xmlns:fr.CT,"xmlns:xsd":fr.xsd,"xmlns:xsi":fr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Te("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Te("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Ed[c][t.bookType]||Ed[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ed[c][t.bookType]||Ed[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hu(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Pc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Jr)||[]).forEach(function(s){var a=Ye(s);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:hc(a.Target,t);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}function sl(e){var t=[nr,Te("Relationships",null,{xmlns:fr.RELS})];return Yt(e["!id"]).forEach(function(r){t[t.length]=Te("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function gt(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,a?s.TargetMode=a:[nt.HLINK,nt.XPATH,nt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var hB="application/vnd.oasis.opendocument.spreadsheet";function mB(e,t){for(var r=v1(e),n,s;n=fu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ye(n[0],!1),s.path=="/"&&s.type!==hB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function pB(e){var t=[nr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function A2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function xB(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function gB(e){var t=[nr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(A2(e[r][0],e[r][1])),t.push(xB("",e[r][0]));return t.push(A2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function cC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Q0.version+"</meta:generator></office:meta></office:document-meta>"}var ss=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vB=function(){for(var e=new Array(ss.length),t=0;t<ss.length;++t){var r=ss[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function uC(e){var t={};e=bt(e);for(var r=0;r<ss.length;++r){var n=ss[r],s=e.match(vB[r]);s!=null&&s.length>0&&(t[n[1]]=ut(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=At(t[n[1]]))}return t}function fm(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=vt(t),n[n.length]=r?Te(e,t,r):Ar(e,t))}function dC(e,t){var r=t||{},n=[nr,Te("cp:coreProperties",null,{"xmlns:cp":fr.CORE_PROPS,"xmlns:dc":fr.dc,"xmlns:dcterms":fr.dcterms,"xmlns:dcmitype":fr.dcmitype,"xmlns:xsi":fr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&fm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:qp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&fm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:qp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=ss.length;++a){var o=ss[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&fm(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],fC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hC(e,t,r,n){var s=[];if(typeof e=="string")s=w2(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var o=typeof t=="string"?w2(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function yB(e,t,r){var n={};return t||(t={}),e=bt(e),Vi.forEach(function(s){var a=(e.match(uu(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=ut(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&hC(n.HeadingPairs,n.TitlesOfParts,t,r),t}function mC(e){var t=[],r=Te;return e||(e={}),e.Application="SheetJS",t[t.length]=nr,t[t.length]=Te("Properties",null,{xmlns:fr.EXT_PROPS,"xmlns:vt":fr.vt}),Vi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=vt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+vt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var wB=/<[^>]+>[^<]*/g;function bB(e,t){var r={},n="",s=e.match(wB);if(s)for(var a=0;a!=s.length;++a){var o=s[a],l=Ye(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ut(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=ut(d);break;case"bool":r[n]=Et(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=At(d);break;case"cy":case"error":r[n]=ut(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function pC(e){var t=[nr,Te("Properties",null,{xmlns:fr.CUST_PROPS,"xmlns:vt":fr.vt})];if(!e)return t.join("");var r=1;return Yt(e).forEach(function(s){++r,t[t.length]=Te("property",A9(e[s],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:vt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var tx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},hm;function NB(e,t,r){hm||(hm=rh(tx)),t=hm[t]||t,e[t]=r}function kB(e,t){var r=[];return Yt(tx).map(function(n){for(var s=0;s<ss.length;++s)if(ss[s][1]==n)return ss[s];for(s=0;s<Vi.length;++s)if(Vi[s][1]==n)return Vi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ar(tx[n[1]]||n[1],s))}}),Te("DocumentProperties",r.join(""),{xmlns:Cn.o})}function _B(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Yt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<ss.length;++o)if(a==ss[o][1])return;for(o=0;o<Vi.length;++o)if(a==Vi[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Te(x2(a),l,{"dt:dt":c}))}}),t&&Yt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Te(x2(a),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Cn.o+'">'+s.join("")+"</"+n+">"}function T1(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function SB(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=pe(8);return o.write_shift(4,n),o.write_shift(4,s),o}function xC(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function gC(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function vC(e,t,r){return t===31?gC(e):xC(e,t,r)}function rx(e,t,r){return vC(e,t,r===!1?0:4)}function jB(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return vC(e,t,0)}function CB(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(sn,""),e.l-s&2&&(e.l+=2)}return r}function EB(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(sn,"");return r}function TB(e){var t=e.l,r=cf(e,iC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=cf(e,dn);return[r,n]}function AB(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(TB(e));return r}function F2(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(sn,"").replace(fc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function yC(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function FB(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function cf(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==E2&&n!==t&&lB.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===E2?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return xC(e,n,4).replace(sn,"");case 31:return gC(e);case 64:return T1(e);case 65:return yC(e);case 71:return FB(e);case 80:return rx(e,n,!a.raw).replace(sn,"");case 81:return jB(e,n).replace(sn,"");case 4108:return AB(e);case 4126:case 4127:return n==4127?CB(e):EB(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function P2(e,t){var r=pe(4),n=pe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=pe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=SB(t);break;case 31:case 80:for(n=pe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Nr([r,n])}function D2(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0,l=0,c=-1,u={};for(o=0;o!=s;++o){var d=e.read_shift(4),f=e.read_shift(4);a[o]=[d,f+r]}a.sort(function(y,x){return y[1]-x[1]});var h={};for(o=0;o!=s;++o){if(e.l!==a[o][1]){var m=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],m=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],m=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(m=!1,e.l=a[o][1]),m)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[a[o][0]];if(h[g.n]=cf(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:gs(l=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(a[o][0]===1){if(l=h.CodePage=cf(e,C1),gs(l),c!==-1){var p=e.l;e.l=a[c][1],u=F2(e,l),e.l=p}}else if(a[o][0]===0){if(l===0){c=o,e.l=a[o+1][1];continue}u=F2(e,l)}else{var v=u[a[o][0]],w;switch(e[e.l]){case 65:e.l+=4,w=yC(e);break;case 30:e.l+=4,w=rx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=rx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=qt(e,4);break;case 64:e.l+=4,w=At(T1(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=w}}return e.l=r+n,h}var wC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function PB(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function I2(e,t,r){var n=pe(8),s=[],a=[],o=8,l=0,c=pe(8),u=pe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),o+=8+c.length,!t){u=pe(8),u.write_shift(4,0),s.unshift(u);var d=[pe(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=pe(4+4+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Nr(d),a.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(wC.indexOf(e[l][0])>-1||fC.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var g=r[m];if(g.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=P2(g.t,h)}else{var v=PB(h);v==-1&&(v=31,h=String(h)),c=P2(v,h)}a.push(c),u=pe(8),u.write_shift(4,t?m:2+l),s.push(u),o+=8+c.length}var w=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,w),w+=a[l].length;return n.write_shift(4,o),n.write_shift(4,a.length),Nr([n].concat(s).concat(a))}function R2(e,t,r){var n=e.content;if(!n)return{};Tr(n,0);var s,a,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==ze.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=D2(n,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=a,s===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=D2(n,null)}catch{}for(m in g)h[m]=g[m];return h.FMTID=[a,o],h}function L2(e,t,r,n,s,a){var o=pe(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ze.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=I2(e,r,n);if(l.push(c),s){var u=I2(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Nr(l)}function Aa(e,t){return e.read_shift(t),null}function DB(e,t){t||(t=pe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function IB(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function qt(e,t){return e.read_shift(t)===1}function rn(e,t){return t||(t=pe(2)),t.write_shift(2,+!!e),t}function lr(e){return e.read_shift(2,"u")}function Yn(e,t){return t||(t=pe(2)),t.write_shift(2,e),t}function bC(e,t){return IB(e,t,lr)}function RB(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function NC(e,t,r){return r||(r=pe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Wu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function LB(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*o),n&&(e.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function OB(e){var t=e.t||"",r=pe(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var n=pe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Nr(s)}function io(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Hu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):io(e,n,r)}function No(e,t,r){if(r.biff>5)return Hu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function kC(e,t,r){return r||(r=pe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function MB(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function BB(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(sn,"");return n&&(e.l+=24),s}function $B(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(sn,"");return r+o}function UB(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return BB(e);case"0303000000000000c000000000000046":return $B(e);default:throw new Error("Unsupported Moniker "+r)}}function Td(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(sn,""):"";return r}function O2(e,t){t||(t=pe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function VB(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,o,l,c,u="",d,f;s&16&&(a=Td(e,r-e.l)),s&128&&(o=Td(e,r-e.l)),(s&257)===257&&(l=Td(e,r-e.l)),(s&257)===1&&(c=UB(e,r-e.l)),s&8&&(u=Td(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=T1(e)),e.l=r;var h=o||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),a&&(m.Tooltip=a),m}function zB(e){var t=pe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)n=n.slice(1),O2(n,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&O2(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function _C(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function SC(e,t){var r=_C(e);return r[3]=0,r}function Ys(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function oo(e,t,r,n){return n||(n=pe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function WB(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function HB(e,t,r){return t===0?"":No(e,t,r)}function GB(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,a,o]}function jC(e){var t=e.read_shift(2),r=j1(e);return[t,r]}function XB(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Wu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function ah(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function CC(e,t){return t||(t=pe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function EC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var KB=EC;function TC(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function YB(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function qB(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Mr(e){e.l+=2,e.l+=e.read_shift(2)}var JB={0:Mr,4:Mr,5:Mr,6:Mr,7:qB,8:Mr,9:Mr,10:Mr,11:Mr,12:Mr,13:YB,14:Mr,15:Mr,16:Mr,17:Mr,18:Mr,19:Mr,20:Mr,21:TC};function ZB(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(JB[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Ad(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function A1(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=pe(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function QB(e,t){return t===0||e.read_shift(2),1200}function e$(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=No(e,0,r);return e.read_shift(t+n-e.l),s}function t$(e,t){var r=!t||t.biff==8,n=pe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function r$(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function n$(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=Wu(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:a,name:o}}function s$(e,t){var r=!t||t.biff>=8?2:1,n=pe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function a$(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0;o!=s&&e.l<r;++o)a.push(LB(e));return a.Count=n,a.Unique=s,a}function i$(e,t){var r=pe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=OB(e[s]);var a=Nr([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function o$(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function l$(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function c$(e){var t=WB(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function u$(e){return e.read_shift(2),e.read_shift(4)}function M2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function d$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function f$(){var e=pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function h$(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function m$(e){var t=pe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function p$(){}function x$(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Wu(e,0,r),n}function g$(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=pe(s);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function v$(e){var t=Ys(e);return t.isst=e.read_shift(4),t}function y$(e,t,r,n){var s=pe(10);return oo(e,t,n,s),s.write_shift(4,r),s}function w$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Ys(e);r.biff==2&&e.l++;var a=Hu(e,n-e.l,r);return s.val=a,s}function b$(e,t,r,n,s){var a=!s||s.biff==8,o=pe(6+2+ +a+(1+a)*r.length);return oo(e,t,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function N$(e,t,r){var n=e.read_shift(2),s=No(e,0,r);return[n,s]}function k$(e,t,r,n){var s=r&&r.biff==5;n||(n=pe(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var _$=No;function B2(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:l},e:{r:o,c}}}function S$(e,t){var r=t.biff==8||!t.biff?4:2,n=pe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function j$(e){var t=e.read_shift(2),r=e.read_shift(2),n=jC(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function C$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(jC(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:a}}function E$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:a}}function T$(e,t,r,n){var s={},a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=cB[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function A$(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=T$(e,t,n.fStyle,r),n}function $2(e,t,r,n){var s=r&&r.biff==5;n||(n=pe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function F$(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function P$(e){var t=pe(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function U2(e,t,r){var n=Ys(e);(r.biff==2||t==9)&&++e.l;var s=RB(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function D$(e,t,r,n,s,a){var o=pe(8);return oo(e,t,n,o),NC(r,a,o),o}function I$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ys(e),s=Gr(e);return n.val=s,n}function R$(e,t,r,n){var s=pe(14);return oo(e,t,n,s),ao(r,s),s}var V2=HB;function L$(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=io(e,a),l=[];n>e.l;)l.push(Hu(e));return[a,s,o,l]}function z2(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=XB(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var O$=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function W2(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=io(e,o,r);s&32&&(u=O$[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:ZW(e,d,r,l);return{chKey:a,Name:u,itab:c,rgce:f}}function AC(e,t,r){if(r.biff<8)return M$(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(GB(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function M$(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Wu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function B$(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=io(e,n,r),o=io(e,s,r);return[a,o]}function $$(e,t,r){var n=EC(e);e.l++;var s=e.read_shift(1);return t-=8,[QW(e,t,r),s,n]}function H2(e,t,r){var n=KB(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,qW(e,t,r)]}function U$(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function V$(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=No(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,o,a]}}function z$(e,t,r){return V$(e,t,r)}function W$(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ah(e));return r}function H$(e){var t=pe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)CC(e[r],t);return t}function G$(e,t,r){if(r&&r.biff<8)return K$(e,t,r);var n=TC(e),s=ZB(e,t-22,n[1]);return{cmo:n,ft:s}}var X$={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function K$(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((X$[n]||qr)(e,t,r)),{cmo:[s,n,a],ft:o}}function Y$(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=MB(e,6,r);var l=e.read_shift(2);e.read_shift(2),lr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=io(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function q$(e,t){var r=ah(e);e.l+=16;var n=VB(e,t-24);return[r,n]}function J$(e){var t=pe(24),r=$t(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Nr([t,zB(e[1])])}function Z$(e,t){e.read_shift(2);var r=ah(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(sn,""),[r,n]}function Q$(e){var t=e[1].Tooltip,r=pe(10+2*(t.length+1));r.write_shift(2,2048);var n=$t(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function eU(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=T2[r]||r,r=e.read_shift(2),t[1]=T2[r]||r,t}function tU(e){return e||(e=pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function rU(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(SC(e));return r}function nU(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(SC(e));return r}function sU(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function FC(e,t,r){if(!r.cellStyles)return qr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function aU(e,t){var r=pe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function iU(e,t){var r={};return t<32||(e.l+=16,r.header=Gr(e),r.footer=Gr(e),e.l+=2),r}function oU(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function lU(e){for(var t=pe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var cU=Ys,uU=bC,dU=Hu;function fU(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function hU(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ys(e);++e.l;var s=No(e,t-7,r);return n.t="str",n.val=s,n}function mU(e){var t=Ys(e);++e.l;var r=Gr(e);return t.t="n",t.val=r,t}function pU(e,t,r){var n=pe(15);return Yu(n,e,t),n.write_shift(8,r,"f"),n}function xU(e){var t=Ys(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function gU(e,t,r){var n=pe(9);return Yu(n,e,t),n.write_shift(2,r),n}function vU(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function yU(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function wU(e,t,r){var n=e.l+t,s=Ys(e),a=e.read_shift(2),o=io(e,a,r);return e.l=n,s.t="str",s.val=o,s}var bU=[2,3,48,49,131,139,140,245],nx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=oi(1);switch(c.type){case"base64":d=An(On(l));break;case"binary":d=An(l);break;case"buffer":case"array":d=l;break}Tr(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,v=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(v=d.read_shift(2));var w=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var x=[],N={},S=Math.min(d.length,f==2?521:v-10-(m?264:0)),_=g?32:11;d.l<S&&d[d.l]!=13;)switch(N={},N.name=Ma.utils.decode(y,d.slice(d.l,d.l+_)).replace(/[\u0000\r\n].*$/g,""),d.l+=_,N.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),f==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&x.push(N),f!=2&&(d.l+=g?13:14),N.type){case"B":(!m||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var b=0,A=0;for(u[0]=[],A=0;A!=x.length;++A)u[0][A]=x[A].name;for(;p-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,u[++b]=[],A=0,A=0;A!=x.length;++A){var D=d.slice(d.l,d.l+x[A].len);d.l+=x[A].len,Tr(D,0);var V=Ma.utils.decode(y,D);switch(x[A].type){case"C":V.trim().length&&(u[b][A]=V.replace(/\s+$/,""));break;case"D":V.length===8?u[b][A]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):u[b][A]=V;break;case"F":u[b][A]=parseFloat(V.trim());break;case"+":case"I":u[b][A]=g?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":u[b][A]=!0;break;case"N":case"F":u[b][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[b][A]="##MEMO##"+(g?parseInt(V.trim(),10):D.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(u[b][A]=+V||0);break;case"@":u[b][A]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":u[b][A]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":u[b][A]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[b][A]=-D.read_shift(-8,"f");break;case"B":if(m&&x[A].len==8){u[b][A]=D.read_shift(8,"f");break}case"G":case"P":D.l+=x[A].len;break;case"0":if(x[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[A].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=x,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Ml(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(l,c){try{return xi(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&gs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=wn(),f=ff(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),g=l["!cols"]||[],p=0,v=0,w=0,y=1;for(p=0;p<h.length;++p){if(((g[p]||{}).DBF||{}).name){h[p]=g[p].DBF.name,++w;continue}if(h[p]!=null){if(++w,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(v=0;v<1024;++v)if(h.indexOf(h[p]+"_"+v)==-1){h[p]+="_"+v;break}}}}var x=dt(l["!ref"]),N=[],S=[],_=[];for(p=0;p<=x.e.c-x.s.c;++p){var b="",A="",D=0,V=[];for(v=0;v<m.length;++v)m[v][p]!=null&&V.push(m[v][p]);if(V.length==0||h[p]==null){N[p]="?";continue}for(v=0;v<V.length;++v){switch(typeof V[v]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=V[v]instanceof Date?"D":"C";break;default:A="C"}D=Math.max(D,String(V[v]).length),b=b&&b!=A?"C":A}D>250&&(D=250),A=((g[p]||{}).DBF||{}).type,A=="C"&&g[p].DBF.len>D&&(D=g[p].DBF.len),b=="B"&&A=="N"&&(b="N",_[p]=g[p].DBF.dec,D=g[p].DBF.len),S[p]=b=="C"||A=="N"?D:a[b]||0,y+=S[p],N[p]=b}var P=d.next(32);for(P.write_shift(4,318902576),P.write_shift(4,m.length),P.write_shift(2,296+32*w),P.write_shift(2,y),p=0;p<4;++p)P.write_shift(4,0);for(P.write_shift(4,0|(+t[yj]||3)<<8),p=0,v=0;p<h.length;++p)if(h[p]!=null){var T=d.next(32),z=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,z,"sbcs"),T.write_shift(1,N[p]=="?"?"C":N[p],"sbcs"),T.write_shift(4,v),T.write_shift(1,S[p]||a[N[p]]||0),T.write_shift(1,_[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),v+=S[p]||a[N[p]]||0}var L=d.next(264);for(L.write_shift(4,13),p=0;p<65;++p)L.write_shift(4,0);for(p=0;p<m.length;++p){var ee=d.next(y);for(ee.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(N[v]){case"L":ee.write_shift(1,m[p][v]==null?63:m[p][v]?84:70);break;case"B":ee.write_shift(8,m[p][v]||0,"f");break;case"N":var j="0";for(typeof m[p][v]=="number"&&(j=m[p][v].toFixed(_[v]||0)),w=0;w<S[v]-j.length;++w)ee.write_shift(1,32);ee.write_shift(1,j,"sbcs");break;case"D":m[p][v]?(ee.write_shift(4,("0000"+m[p][v].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(m[p][v].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+m[p][v].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var U=String(m[p][v]!=null?m[p][v]:"").slice(0,S[v]);for(ee.write_shift(1,U,"sbcs"),w=0;w<S[v]-U.length;++w)ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),PC=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Yt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var g=e[m];return typeof g=="number"?r2(g):g},n=function(h,m,g){var p=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?h:r2(p)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return a(On(h),m);case"binary":return a(h,m);case"buffer":return a(rt&&Buffer.isBuffer(h)?h.toString("binary"):pi(h),m);case"array":return a(so(h),m)}throw new Error("Unrecognized type "+m.type)}function a(h,m){var g=h.split(/[\n\r]+/),p=-1,v=-1,w=0,y=0,x=[],N=[],S=null,_={},b=[],A=[],D=[],V=0,P;for(+m.codepage>=0&&gs(+m.codepage);w!==g.length;++w){V=0;var T=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=T.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),L=z[0],ee;if(T.length>0)switch(L){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&N.push(T.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,U=!1,q=!1,C=!1,R=-1,F=-1;for(y=1;y<z.length;++y)switch(z[y].charAt(0)){case"A":break;case"X":v=parseInt(z[y].slice(1))-1,U=!0;break;case"Y":for(p=parseInt(z[y].slice(1))-1,U||(v=0),P=x.length;P<=p;++P)x[P]=[];break;case"K":ee=z[y].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(Ns(ee))?isNaN(wl(ee).getDate())||(ee=At(ee)):(ee=Ns(ee),S!==null&&Ll(S)&&(ee=sh(ee))),j=!0;break;case"E":C=!0;var E=al(z[y].slice(1),{r:p,c:v});x[p][v]=[x[p][v],E];break;case"S":q=!0,x[p][v]=[x[p][v],"S5S"];break;case"G":break;case"R":R=parseInt(z[y].slice(1))-1;break;case"C":F=parseInt(z[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}if(j&&(x[p][v]&&x[p][v].length==2?x[p][v][0]=ee:x[p][v]=ee,S=null),q){if(C)throw new Error("SYLK shared formula cannot have own formula");var M=R>-1&&x[R][F];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");x[p][v][1]=qC(M[1],{r:p-R,c:v-F})}break;case"F":var H=0;for(y=1;y<z.length;++y)switch(z[y].charAt(0)){case"X":v=parseInt(z[y].slice(1))-1,++H;break;case"Y":for(p=parseInt(z[y].slice(1))-1,P=x.length;P<=p;++P)x[P]=[];break;case"M":V=parseInt(z[y].slice(1))/20;break;case"F":break;case"G":break;case"P":S=N[parseInt(z[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=z[y].slice(1).split(" "),P=parseInt(D[0],10);P<=parseInt(D[1],10);++P)V=parseInt(D[2],10),A[P-1]=V===0?{hidden:!0}:{wch:V},li(A[P-1]);break;case"C":v=parseInt(z[y].slice(1))-1,A[v]||(A[v]={});break;case"R":p=parseInt(z[y].slice(1))-1,b[p]||(b[p]={}),V>0?(b[p].hpt=V,b[p].hpx=Nl(V)):V===0&&(b[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}H<1&&(S=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}}return b.length>0&&(_["!rows"]=b),A.length>0&&(_["!cols"]=A),m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),[x,_]}function o(h,m){var g=s(h,m),p=g[0],v=g[1],w=Ml(p,m);return Yt(v).forEach(function(y){w[y]=v[y]}),w}function l(h,m){return xi(o(h,m),m)}function c(h,m,g,p){var v="C;Y"+(g+1)+";X"+(p+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+L1(h.f,{r:g,c:p}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(h,m){m.forEach(function(g,p){var v="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?v+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=pu(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=xu(g.wpx)),typeof g.wch=="number"&&(v+=Math.round(g.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function d(h,m){m.forEach(function(g,p){var v="F;";g.hidden?v+="M0;":g.hpt?v+="M"+20*g.hpt+";":g.hpx&&(v+="M"+20*gu(g.hpx)+";"),v.length>2&&h.push(v+"R"+(p+1))})}function f(h,m){var g=["ID;PWXL;N;E"],p=[],v=dt(h["!ref"]),w,y=Array.isArray(h),x=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&u(g,h["!cols"]),h["!rows"]&&d(g,h["!rows"]),g.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var N=v.s.r;N<=v.e.r;++N)for(var S=v.s.c;S<=v.e.c;++S){var _=Xe({r:N,c:S});w=y?(h[N]||[])[S]:h[_],!(!w||w.v==null&&(!w.f||w.F))&&p.push(c(w,h,N,S))}return g.join(x)+x+p.join(x)+x+"E"+x}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),DC=function(){function e(a,o){switch(o.type){case"base64":return t(On(a),o);case"binary":return t(a,o);case"buffer":return t(rt&&Buffer.isBuffer(a)?a.toString("binary"):pi(a),o);case"array":return t(so(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),m=h[0],g=h[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(Ns(g))?isNaN(wl(g).getDate())?f[c][u]=g:f[c][u]=At(g):f[c][u]=Ns(g),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(a,o){return Ml(e(a,o),o)}function n(a,o){return xi(r(a,o),o)}var s=function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=dt(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){o(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var p=Xe({r:m,c:g});if(f=h?(c[m]||[])[g]:c[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,v,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ls(f.z||He[14],pr(At(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var w=`\r
`,y=u.join(w);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),IC=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),g=-1,p=-1,v=0,w=[];v!==m.length;++v){var y=m[v].trim().split(":");if(y[0]==="cell"){var x=$t(y[1]);if(w.length<=x.r)for(g=w.length;g<=x.r;++g)w[g]||(w[g]=[]);switch(g=x.r,p=x.c,y[2]){case"t":w[g][p]=e(y[3]);break;case"v":w[g][p]=+y[3];break;case"vtf":var N=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[g][p]=!!+y[4];break;default:w[g][p]=+y[4];break}y[2]=="vtf"&&(w[g][p]=[w[g][p],N])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function n(f,h){return Ml(r(f,h),h)}function s(f,h){return xi(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],g,p="",v=kn(f["!ref"]),w=Array.isArray(f),y=v.s.r;y<=v.e.r;++y)for(var x=v.s.c;x<=v.e.c;++x)if(p=Xe({r:y,c:x}),g=w?(f[y]||[])[x]:f[p],!(!g||g.v==null||g.t==="z")){switch(m=["cell",p,"t"],g.t){case"s":case"str":m.push(t(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=t(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var N=pr(At(g.v));m[2]="vtc",m[3]="nd",m[4]=""+N,m[5]=g.w||ls(g.z||He[14],N);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,o,l,o,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),bl=function(){function e(d,f,h,m,g){g.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(Ns(d))?isNaN(wl(d).getDate())?f[h][m]=d:f[h][m]=At(d):f[h][m]=Ns(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var g=d.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var v=10,w=0,y=0;y<=p;++y)w=g[y].indexOf(" "),w==-1?w=g[y].length:w++,v=Math.max(v,w);for(y=0;y<=p;++y){m[y]=[];var x=0;for(e(g[y].slice(0,v).trim(),m,y,x,h),x=1;x<=(g[y].length-v)/10+1;++x)e(g[y].slice(v+(x-1)*10,v+x*10).trim(),m,y,x,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},h=!1,m=0,g=0;m<d.length;++m)(g=d.charCodeAt(m))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m]);if(!g.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m])}return g.sort(function(p,v){return p[0]-v[0]||n[p[1]]-n[v[1]]}),r[g.pop()[1]]||44}function a(d,f){var h=f||{},m="",g=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=s(d.slice(0,1024)):h&&h.FS?m=h.FS:m=s(d.slice(0,1024));var v=0,w=0,y=0,x=0,N=0,S=m.charCodeAt(0),_=!1,b=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var D=h.dateNF!=null?l9(h.dateNF):null;function V(){var P=d.slice(x,N),T={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)T.t="z";else if(h.raw)T.t="s",T.v=P;else if(P.trim().length===0)T.t="s",T.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(T.t="s",T.v=P.slice(2,-1).replace(/""/g,'"')):Lz(P)?(T.t="n",T.f=P.slice(1)):(T.t="s",T.v=P);else if(P=="TRUE")T.t="b",T.v=!0;else if(P=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=Ns(P)))T.t="n",h.cellText!==!1&&(T.w=P),T.v=y;else if(!isNaN(wl(P).getDate())||D&&P.match(D)){T.z=h.dateNF||He[14];var z=0;D&&P.match(D)&&(P=c9(P,h.dateNF,P.match(D)||[]),z=1),h.cellDates?(T.t="d",T.v=At(P,z)):(T.t="n",T.v=pr(At(P,z))),h.cellText!==!1&&(T.w=ls(T.z,T.v instanceof Date?pr(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=P;if(T.t=="z"||(h.dense?(g[v]||(g[v]=[]),g[v][w]=T):g[Xe({c:w,r:v})]=T),x=N+1,A=d.charCodeAt(x),p.e.c<w&&(p.e.c=w),p.e.r<v&&(p.e.r=v),b==S)++w;else if(w=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;N<d.length;++N)switch(b=d.charCodeAt(N)){case 34:A===34&&(_=!_);break;case S:case 10:case 13:if(!_&&V())break e;break}return N-x>0&&V(),g["!ref"]=Qe(p),g}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Ml(t(d,f),f)}function l(d,f){var h="",m=f.type=="string"?[0,0,0,0]:W1(d,f);switch(f.type){case"base64":h=On(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Ma<"u"?h=Ma.utils.decode(f.codepage,d):h=rt&&Buffer.isBuffer(d)?d.toString("binary"):pi(d);break;case"array":h=so(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=bt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=bt(h):f.type=="binary"&&typeof Ma<"u"&&f.codepage&&(h=Ma.utils.decode(f.codepage,Ma.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?IC.to_sheet(f.type=="string"?h:bt(h),f):o(h,f)}function c(d,f){return xi(l(d,f),f)}function u(d){for(var f=[],h=dt(d["!ref"]),m,g=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var v=[],w=h.s.c;w<=h.e.c;++w){var y=Xe({r:p,c:w});if(m=g?(d[p]||[])[w]:d[y],!m||m.v==null){v.push("          ");continue}for(var x=(m.w||(wa(m),m.w)||"").slice(0,10);x.length<10;)x+=" ";v.push(x+(w===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function NU(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=PC.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return bl.to_workbook(e,t)}}var zi=function(){function e(E,M,H){if(E){Tr(E,E.l||0);for(var G=H.Enum||R;E.l<E.length;){var re=E.read_shift(2),he=G[re]||G[65535],oe=E.read_shift(2),ce=E.l+oe,Q=he.f&&he.f(E,oe,H);if(E.l=ce,M(Q,he,re))return}}}function t(E,M){switch(M.type){case"base64":return r(An(On(E)),M);case"binary":return r(An(E),M);case"buffer":case"array":return r(E,M)}throw"Unsupported type "+M.type}function r(E,M){if(!E)return E;var H=M||{},G=H.dense?[]:{},re="Sheet1",he="",oe=0,ce={},Q=[],J=[],O={s:{r:0,c:0},e:{r:0,c:0}},ve=H.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)H.Enum=R,e(E,function(ue,Ne,De){switch(De){case 0:H.vers=ue,ue>=4096&&(H.qpro=!0);break;case 6:O=ue;break;case 204:ue&&(he=ue);break;case 222:he=ue;break;case 15:case 51:H.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:De==14&&(ue[2]&112)==112&&(ue[2]&15)>1&&(ue[2]&15)<15&&(ue[1].z=H.dateNF||He[14],H.cellDates&&(ue[1].t="d",ue[1].v=sh(ue[1].v))),H.qpro&&ue[3]>oe&&(G["!ref"]=Qe(O),ce[re]=G,Q.push(re),G=H.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},oe=ue[3],re=he||"Sheet"+(oe+1),he="");var Ee=H.dense?(G[ue[0].r]||[])[ue[0].c]:G[Xe(ue[0])];if(Ee){Ee.t=ue[1].t,Ee.v=ue[1].v,ue[1].z!=null&&(Ee.z=ue[1].z),ue[1].f!=null&&(Ee.f=ue[1].f);break}H.dense?(G[ue[0].r]||(G[ue[0].r]=[]),G[ue[0].r][ue[0].c]=ue[1]):G[Xe(ue[0])]=ue[1];break}},H);else if(E[2]==26||E[2]==14)H.Enum=F,E[2]==14&&(H.qpro=!0,E.l=0),e(E,function(ue,Ne,De){switch(De){case 204:re=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>oe&&(G["!ref"]=Qe(O),ce[re]=G,Q.push(re),G=H.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},oe=ue[3],re="Sheet"+(oe+1)),ve>0&&ue[0].r>=ve)break;H.dense?(G[ue[0].r]||(G[ue[0].r]=[]),G[ue[0].r][ue[0].c]=ue[1]):G[Xe(ue[0])]=ue[1],O.e.c<ue[0].c&&(O.e.c=ue[0].c),O.e.r<ue[0].r&&(O.e.r=ue[0].r);break;case 27:ue[14e3]&&(J[ue[14e3][0]]=ue[14e3][1]);break;case 1537:J[ue[0]]=ue[1],ue[0]==oe&&(re=ue[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(G["!ref"]=Qe(O),ce[he||re]=G,Q.push(he||re),!J.length)return{SheetNames:Q,Sheets:ce};for(var ye={},xe=[],ke=0;ke<J.length;++ke)ce[Q[ke]]?(xe.push(J[ke]||Q[ke]),ye[J[ke]]=ce[J[ke]]||ce[Q[ke]]):(xe.push(J[ke]),ye[J[ke]]={"!ref":"A1"});return{SheetNames:xe,Sheets:ye}}function n(E,M){var H=M||{};if(+H.codepage>=0&&gs(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var G=wn(),re=dt(E["!ref"]),he=Array.isArray(E),oe=[];Ae(G,0,a(1030)),Ae(G,6,c(re));for(var ce=Math.min(re.e.r,8191),Q=re.s.r;Q<=ce;++Q)for(var J=tr(Q),O=re.s.c;O<=re.e.c;++O){Q===re.s.r&&(oe[O]=Bt(O));var ve=oe[O]+J,ye=he?(E[Q]||[])[O]:E[ve];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?Ae(G,13,m(Q,O,ye.v)):Ae(G,14,p(Q,O,ye.v));else{var xe=wa(ye);Ae(G,15,f(Q,O,xe.slice(0,239)))}}return Ae(G,1),G.end()}function s(E,M){var H=M||{};if(+H.codepage>=0&&gs(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var G=wn();Ae(G,0,o(E));for(var re=0,he=0;re<E.SheetNames.length;++re)(E.Sheets[E.SheetNames[re]]||{})["!ref"]&&Ae(G,27,C(E.SheetNames[re],he++));var oe=0;for(re=0;re<E.SheetNames.length;++re){var ce=E.Sheets[E.SheetNames[re]];if(!(!ce||!ce["!ref"])){for(var Q=dt(ce["!ref"]),J=Array.isArray(ce),O=[],ve=Math.min(Q.e.r,8191),ye=Q.s.r;ye<=ve;++ye)for(var xe=tr(ye),ke=Q.s.c;ke<=Q.e.c;++ke){ye===Q.s.r&&(O[ke]=Bt(ke));var ue=O[ke]+xe,Ne=J?(ce[ye]||[])[ke]:ce[ue];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")Ae(G,23,V(ye,ke,oe,Ne.v));else{var De=wa(Ne);Ae(G,22,b(ye,ke,oe,De.slice(0,239)))}}++oe}}return Ae(G,1),G.end()}function a(E){var M=pe(2);return M.write_shift(2,E),M}function o(E){var M=pe(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var H=0,G=0,re=0,he=0;he<E.SheetNames.length;++he){var oe=E.SheetNames[he],ce=E.Sheets[oe];if(!(!ce||!ce["!ref"])){++re;var Q=kn(ce["!ref"]);H<Q.e.r&&(H=Q.e.r),G<Q.e.c&&(G=Q.e.c)}}return H>8191&&(H=8191),M.write_shift(2,H),M.write_shift(1,re),M.write_shift(1,G),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function l(E,M,H){var G={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&H.qpro?(G.s.c=E.read_shift(1),E.l++,G.s.r=E.read_shift(2),G.e.c=E.read_shift(1),E.l++,G.e.r=E.read_shift(2),G):(G.s.c=E.read_shift(2),G.s.r=E.read_shift(2),M==12&&H.qpro&&(E.l+=2),G.e.c=E.read_shift(2),G.e.r=E.read_shift(2),M==12&&H.qpro&&(E.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function c(E){var M=pe(8);return M.write_shift(2,E.s.c),M.write_shift(2,E.s.r),M.write_shift(2,E.e.c),M.write_shift(2,E.e.r),M}function u(E,M,H){var G=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(G[0].c=E.read_shift(1),G[3]=E.read_shift(1),G[0].r=E.read_shift(2),E.l+=2):(G[2]=E.read_shift(1),G[0].c=E.read_shift(2),G[0].r=E.read_shift(2)),G}function d(E,M,H){var G=E.l+M,re=u(E,M,H);if(re[1].t="s",H.vers==20768){E.l++;var he=E.read_shift(1);return re[1].v=E.read_shift(he,"utf8"),re}return H.qpro&&E.l++,re[1].v=E.read_shift(G-E.l,"cstr"),re}function f(E,M,H){var G=pe(7+H.length);G.write_shift(1,255),G.write_shift(2,M),G.write_shift(2,E),G.write_shift(1,39);for(var re=0;re<G.length;++re){var he=H.charCodeAt(re);G.write_shift(1,he>=128?95:he)}return G.write_shift(1,0),G}function h(E,M,H){var G=u(E,M,H);return G[1].v=E.read_shift(2,"i"),G}function m(E,M,H){var G=pe(7);return G.write_shift(1,255),G.write_shift(2,M),G.write_shift(2,E),G.write_shift(2,H,"i"),G}function g(E,M,H){var G=u(E,M,H);return G[1].v=E.read_shift(8,"f"),G}function p(E,M,H){var G=pe(13);return G.write_shift(1,255),G.write_shift(2,M),G.write_shift(2,E),G.write_shift(8,H,"f"),G}function v(E,M,H){var G=E.l+M,re=u(E,M,H);if(re[1].v=E.read_shift(8,"f"),H.qpro)E.l=G;else{var he=E.read_shift(2);N(E.slice(E.l,E.l+he),re),E.l+=he}return re}function w(E,M,H){var G=M&32768;return M&=-32769,M=(G?E:0)+(M>=8192?M-16384:M),(G?"":"$")+(H?Bt(M):tr(M))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(E,M){Tr(E,0);for(var H=[],G=0,re="",he="",oe="",ce="";E.l<E.length;){var Q=E[E.l++];switch(Q){case 0:H.push(E.read_shift(8,"f"));break;case 1:he=w(M[0].c,E.read_shift(2),!0),re=w(M[0].r,E.read_shift(2),!1),H.push(he+re);break;case 2:{var J=w(M[0].c,E.read_shift(2),!0),O=w(M[0].r,E.read_shift(2),!1);he=w(M[0].c,E.read_shift(2),!0),re=w(M[0].r,E.read_shift(2),!1),H.push(J+O+":"+he+re)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(E.read_shift(2));break;case 6:{for(var ve="";Q=E[E.l++];)ve+=String.fromCharCode(Q);H.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ce=H.pop(),oe=H.pop(),H.push(["AND","OR"][Q-20]+"("+oe+","+ce+")");break;default:if(Q<32&&x[Q])ce=H.pop(),oe=H.pop(),H.push(oe+x[Q]+ce);else if(y[Q]){if(G=y[Q][1],G==69&&(G=E[E.l++]),G>H.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+H.join("|")+"|");return}var ye=H.slice(-G);H.length-=G,H.push(y[Q][0]+"("+ye.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}H.length==1?M[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function S(E){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=E.read_shift(2),M[3]=E[E.l++],M[0].c=E[E.l++],M}function _(E,M){var H=S(E);return H[1].t="s",H[1].v=E.read_shift(M-4,"cstr"),H}function b(E,M,H,G){var re=pe(6+G.length);re.write_shift(2,E),re.write_shift(1,H),re.write_shift(1,M),re.write_shift(1,39);for(var he=0;he<G.length;++he){var oe=G.charCodeAt(he);re.write_shift(1,oe>=128?95:oe)}return re.write_shift(1,0),re}function A(E,M){var H=S(E);H[1].v=E.read_shift(2);var G=H[1].v>>1;if(H[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return H[1].v=G,H}function D(E,M){var H=S(E),G=E.read_shift(4),re=E.read_shift(4),he=E.read_shift(2);if(he==65535)return G===0&&re===3221225472?(H[1].t="e",H[1].v=15):G===0&&re===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var oe=he&32768;return he=(he&32767)-16446,H[1].v=(1-oe*2)*(re*Math.pow(2,he+32)+G*Math.pow(2,he)),H}function V(E,M,H,G){var re=pe(14);if(re.write_shift(2,E),re.write_shift(1,H),re.write_shift(1,M),G==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var he=0,oe=0,ce=0,Q=0;return G<0&&(he=1,G=-G),oe=Math.log2(G)|0,G/=Math.pow(2,oe-31),Q=G>>>0,Q&2147483648||(G/=2,++oe,Q=G>>>0),G-=Q,Q|=2147483648,Q>>>=0,G*=Math.pow(2,32),ce=G>>>0,re.write_shift(4,ce),re.write_shift(4,Q),oe+=16383+(he?32768:0),re.write_shift(2,oe),re}function P(E,M){var H=D(E);return E.l+=M-14,H}function T(E,M){var H=S(E),G=E.read_shift(4);return H[1].v=G>>6,H}function z(E,M){var H=S(E),G=E.read_shift(8,"f");return H[1].v=G,H}function L(E,M){var H=z(E);return E.l+=M-10,H}function ee(E,M){return E[E.l+M-1]==0?E.read_shift(M,"cstr"):""}function j(E,M){var H=E[E.l++];H>M-1&&(H=M-1);for(var G="";G.length<H;)G+=String.fromCharCode(E[E.l++]);return G}function U(E,M,H){if(!(!H.qpro||M<21)){var G=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var re=E.read_shift(M-21,"cstr");return[G,re]}}function q(E,M){for(var H={},G=E.l+M;E.l<G;){var re=E.read_shift(2);if(re==14e3){for(H[re]=[0,""],H[re][0]=E.read_shift(2);E[E.l];)H[re][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return H}function C(E,M){var H=pe(5+E.length);H.write_shift(2,14e3),H.write_shift(2,M);for(var G=0;G<E.length;++G){var re=E.charCodeAt(G);H[H.l++]=re>127?95:re}return H[H.l++]=0,H}var R={0:{n:"BOF",f:lr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:j},65535:{n:""}},F={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:L},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:U},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function kU(e){var t={},r=e.match(Jr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Ye(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=o1[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var _U=function(){var e=uu("t"),t=uu("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:ut(o[1])},c=a.match(t);return c&&(l.s=kU(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),SU=function(){var t=/(\r\n|\n)/g;function r(s,a,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),o.push("</b>")),s.i&&(a.push("<i>"),o.push("</i>")),s.strike&&(a.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),jU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,CU=/<(?:\w+:)?r>/,EU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function F1(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ut(bt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=bt(e),r&&(n.h=g1(n.t))):e.match(CU)&&(n.r=bt(e),n.t=ut(bt((e.replace(EU,"").match(jU)||[]).join("").replace(Jr,""))),r&&(n.h=SU(_U(n.r)))),n):{t:""}}var TU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,AU=/<(?:\w+:)?(?:si|sstItem)>/g,FU=/<\/(?:\w+:)?(?:si|sstItem)>/;function PU(e,t){var r=[],n="";if(!e)return r;var s=e.match(TU);if(s){n=s[2].replace(AU,"").split(FU);for(var a=0;a!=n.length;++a){var o=F1(n[a].trim(),t);o!=null&&(r[r.length]=o)}s=Ye(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var DU=/^\s|\s$|[\t\n\r]/;function RC(e,t){if(!t.bookSST)return"";var r=[nr];r[r.length]=Te("sst",null,{xmlns:go[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(DU)&&(a+=' xml:space="preserve"'),a+=">"+vt(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function IU(e){return[e.read_shift(4),e.read_shift(4)]}function RU(e,t){var r=[],n=!1;return Sa(e,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function LU(e,t){return t||(t=pe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var OU=X9;function MU(e){var t=wn();be(t,159,LU(e));for(var r=0;r<e.length;++r)be(t,19,OU(e[r]));return be(t,160),t.end()}function LC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function fa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function BU(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=fa(e,4),t.U=fa(e,4),t.W=fa(e,4),t}function $U(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function UU(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($U(e));return t}function VU(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function zU(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=fa(e,4),t.U=fa(e,4),t.W=fa(e,4),t}function WU(e){var t=zU(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function OC(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function MC(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function HU(e){var t=fa(e);switch(t.Minor){case 2:return[t.Minor,GU(e)];case 3:return[t.Minor,XU()];case 4:return[t.Minor,KU(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function GU(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=OC(e,r),s=MC(e,e.length-e.l);return{t:"Std",h:n,v:s}}function XU(){throw new Error("File is password-protected: ECMA-376 Extensible")}function KU(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Jr,function(a){var o=Ye(a);switch(Ks(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function YU(e,t){var r={},n=r.EncryptionVersionInfo=fa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=OC(e,s),t-=s,r.EncryptionVerifier=MC(e,t),r}function qU(e){var t={},r=t.EncryptionVersionInfo=fa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function P1(e){var t=0,r,n=LC(e),s=n.length+1,a,o,l,c,u;for(r=oi(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var BC=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},a=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=LC(o),c=a(l),u=l.length,d=oi(16),f=0;f!=16;++f)d[f]=0;var h,m,g;for((u&1)===1&&(h=c>>8,d[u]=s(e[0],h),--u,h=c&255,m=l[l.length-1],d[u]=s(m,h));u>0;)--u,h=c>>8,d[u]=s(l[u],h),--u,h=c&255,d[u]=s(l[u],h);for(u=15,g=15-l.length;g>0;)h=c>>8,d[u]=s(e[g],h),--u,--g,h=c&255,d[u]=s(l[u],h),--u,--g;return d}}(),JU=function(e,t,r,n,s){s||(s=t),n||(n=BC(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,s[a]=o,++r;return[s,r,n]},ZU=function(e){var t=0,r=BC(e);return function(n){var s=JU("",n,t,r);return t=s[1],s[0]}};function QU(e,t,r,n){var s={key:lr(e),verificationBytes:lr(e)};return r.password&&(s.verifier=P1(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=ZU(r.password)),s}function eV(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=qU(e):n.Data=YU(e,t),n}function tV(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?eV(e,t-2,n):QU(e,r.biff>=8?t:t-2,r,n),n}var $C=function(){function e(s,a){switch(a.type){case"base64":return t(On(s),a);case"binary":return t(s,a);case"buffer":return t(rt&&Buffer.isBuffer(s)?s.toString("binary"):pi(s),a);case"array":return t(so(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var o=a||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,g,p=-1;g=h.exec(d);){switch(g[0]){case"\\cell":var v=d.slice(m,h.lastIndex-g[0].length);if(v[0]==" "&&(v=v.slice(1)),++p,v.length){var w={v,t:"s"};Array.isArray(l)?l[f][p]=w:l[Xe({r:f,c:p})]=w}break}m=h.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Qe(u),l}function r(s,a){return xi(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=dt(s["!ref"]),l,c=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Xe({r:u,c:d});l=c?(s[u]||[])[d]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(wa(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function rV(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function mu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function nV(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),o=s-a;if(o===0)return[0,0,t];var l=0,c=0,u=s+a;switch(c=o/(u>1?2-u:u),s){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function sV(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,o=[a,a,a],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function uf(e,t){if(t===0)return e;var r=nV(rV(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),mu(sV(r))}var UC=6,aV=15,iV=1,Wr=UC;function pu(e){return Math.floor((e+Math.round(128/Wr)/256)*Wr)}function xu(e){return Math.floor((e-5)/Wr*100+.5)/100}function df(e){return Math.round((e*Wr+5)/Wr*256)/256}function mm(e){return df(xu(pu(e)))}function D1(e){var t=Math.abs(e-mm(e)),r=Wr;if(t>.005)for(Wr=iV;Wr<aV;++Wr)Math.abs(e-mm(e))<=t&&(t=Math.abs(e-mm(e)),r=Wr);Wr=r}function li(e){e.width?(e.wpx=pu(e.width),e.wch=xu(e.wpx),e.MDW=Wr):e.wpx?(e.wch=xu(e.wpx),e.width=df(e.wch),e.MDW=Wr):typeof e.wch=="number"&&(e.width=df(e.wch),e.wpx=pu(e.width),e.MDW=Wr),e.customWidth&&delete e.customWidth}var oV=96,VC=oV;function gu(e){return e*96/VC}function Nl(e){return e*VC/96}var lV={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function cV(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Jr)||[]).forEach(function(o){var l=Ye(o);switch(Ks(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Et(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Et(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function uV(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Jr)||[]).forEach(function(o){var l=Ye(o);switch(Ks(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function dV(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Jr)||[]).forEach(function(o){var l=Ye(o);switch(Ks(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=bt(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Et(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Et(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Et(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Et(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Et(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Et(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Et(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=o1[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Et(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Ui[s.color.index];s.color.index==81&&(c=Ui[1]),c||(c=Ui[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=uf(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function fV(e,t,r){t.NumberFmt=[];for(var n=Yt(He),s=0;s<n.length;++s)t.NumberFmt[n[s]]=He[n[s]];var a=e[0].match(Jr);if(a)for(s=0;s<a.length;++s){var o=Ye(a[s]);switch(Ks(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ut(bt(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}da(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function hV(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Te("numFmt",null,{numFmtId:n,formatCode:vt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Te("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Fd=["numFmtId","fillId","fontId","borderId","xfId"],Pd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function mV(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Jr)||[]).forEach(function(a){var o=Ye(a),l=0;switch(Ks(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Fd.length;++l)n[Fd[l]]&&(n[Fd[l]]=parseInt(n[Fd[l]],10));for(l=0;l<Pd.length;++l)n[Pd[l]]&&(n[Pd[l]]=Et(n[Pd[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Et(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function pV(e){var t=[];return t[t.length]=Te("cellXfs",null),e.forEach(function(r){t[t.length]=Te("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Te("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var xV=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&fV(f,d,u),(f=l.match(s))&&dV(f,d,c,u),(f=l.match(n))&&uV(f,d,c,u),(f=l.match(a))&&cV(f,d,c,u),(f=l.match(r))&&mV(f,d,u),d}}();function zC(e,t){var r=[nr,Te("styleSheet",null,{xmlns:go[0],"xmlns:vt":fr.vt})],n;return e.SSF&&(n=hV(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pV(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function gV(e,t){var r=e.read_shift(2),n=Xr(e);return[r,n]}function vV(e,t,r){r||(r=pe(6+4*t.length)),r.write_shift(2,e),kr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function yV(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=eB(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Q9(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Xr(e),n}function wV(e,t){t||(t=pe(25+4*32)),t.write_shift(2,e.sz*20),tB(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),of(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),kr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var bV=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],pm,NV=qr;function G2(e,t){t||(t=pe(4*3+8*7+16*1)),pm||(pm=rh(bV));var r=pm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(of({auto:1},t),of({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function kV(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function WC(e,t,r){r||(r=pe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function sc(e,t){return t||(t=pe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var _V=qr;function SV(e,t){return t||(t=pe(51)),t.write_shift(1,0),sc(null,t),sc(null,t),sc(null,t),sc(null,t),sc(null,t),t.length>t.l?t.slice(0,t.l):t}function jV(e,t){return t||(t=pe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),af(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function CV(e,t,r){var n=pe(2052);return n.write_shift(4,e),af(t,n),af(r,n),n.length>n.l?n.slice(0,n.l):n}function EV(e,t,r){var n={};n.NumberFmt=[];for(var s in He)n.NumberFmt[s]=He[s];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Sa(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],da(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=uf(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d),o=!0;break;case 38:a.pop(),o=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function TV(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(be(e,615,ks(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&be(e,44,vV(s,t[s]))}),be(e,616))}}function AV(e){var t=1;be(e,611,ks(t)),be(e,43,wV({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),be(e,612)}function FV(e){var t=2;be(e,603,ks(t)),be(e,45,G2({patternType:"none"})),be(e,45,G2({patternType:"gray125"})),be(e,604)}function PV(e){var t=1;be(e,613,ks(t)),be(e,46,SV()),be(e,614)}function DV(e){var t=1;be(e,626,ks(t)),be(e,47,WC({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),be(e,627)}function IV(e,t){be(e,617,ks(t.length)),t.forEach(function(r){be(e,47,WC(r,0))}),be(e,618)}function RV(e){var t=1;be(e,619,ks(t)),be(e,48,jV({xfId:0,builtinId:0,name:"Normal"})),be(e,620)}function LV(e){var t=0;be(e,505,ks(t)),be(e,506)}function OV(e){var t=0;be(e,508,CV(t,"TableStyleMedium9","PivotStyleMedium4")),be(e,509)}function MV(e,t){var r=wn();return be(r,278),TV(r,e.SSF),AV(r),FV(r),PV(r),DV(r),IV(r,t.cellXfs),RV(r),LV(r),OV(r),be(r,279),r.end()}var BV=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $V(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Jr)||[]).forEach(function(s){var a=Ye(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[BV.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function UV(){}function VV(){}var zV=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,WV=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,HV=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function GV(e,t,r){t.themeElements={};var n;[["clrScheme",zV,$V],["fontScheme",WV,UV],["fmtScheme",HV,VV]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var XV=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function HC(e,t){(!e||e.length===0)&&(e=I1());var r,n={};if(!(r=e.match(XV)))throw new Error("themeElements not found in theme");return GV(r[0],n,t),n.raw=e,n}function I1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[nr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KV(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=Oj(a,{type:"array"})}catch{return}var l=Fn(o,"theme/theme/theme1.xml",!0);if(l)return HC(l,r)}}function YV(e){return e.read_shift(4)}function qV(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=JV(e,4);break;case 2:t.xclrValue=_C(e);break;case 3:t.xclrValue=YV(e);break;case 4:e.l+=4;break}return e.l+=8,t}function JV(e,t){return qr(e,t)}function ZV(e,t){return qr(e,t)}function QV(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=qV(e);break;case 6:n[1]=ZV(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function ez(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(QV(e,r-e.l));return{ixfe:n,ext:a}}function tz(e,t){t.forEach(function(r){switch(r[0]){}})}function rz(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Xr(e)}}function nz(e){var t=pe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),kr(e.name,t),t.slice(0,t.l)}function sz(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function az(e){var t=pe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function iz(e,t){var r=pe(8+2*t.length);return r.write_shift(4,e),kr(t,r),r.slice(0,r.l)}function oz(e){return e.l+=4,e.read_shift(4)!=0}function lz(e,t){var r=pe(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function cz(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],o=!1,l=2;return Sa(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(d),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!u.T){if(!o||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function uz(){var e=wn();return be(e,332),be(e,334,ks(1)),be(e,335,nz({name:"XLDAPR",version:12e4,flags:3496657072})),be(e,336),be(e,339,iz(1,"XLDAPR")),be(e,52),be(e,35,ks(514)),be(e,4096,ks(0)),be(e,4097,Yn(1)),be(e,36),be(e,53),be(e,340),be(e,337,lz(1,!0)),be(e,51,az([[1,0]])),be(e,338),be(e,333),e.end()}function dz(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,o;return e.replace(Jr,function(l){var c=Ye(l);switch(Ks(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function GC(){var e=[nr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function fz(e){var t=[];if(!e)return t;var r=1;return(e.match(Jr)||[]).forEach(function(n){var s=Ye(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function hz(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Xe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function mz(e,t,r){var n=[];return Sa(e,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function pz(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Sa(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function xz(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ko=1024;function XC(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Te("xml",null,{"xmlns:v":Cn.v,"xmlns:o":Cn.o,"xmlns:x":Cn.x,"xmlns:mv":Cn.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ko<e*1e3;)Ko+=1e3;return t.forEach(function(a){var o=$t(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Te("v:fill",c,l),d={on:"t",obscured:"t"};++Ko,s=s.concat(["<v:shape"+du({id:"_x0000_s"+Ko,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Te("v:shadow",null,d),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ar("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ar("x:AutoFill","False"),Ar("x:Row",String(o.r)),Ar("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function X2(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(o){var l=$t(o.ref);if(s?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[o.ref],!a){a={t:"z"},s?e[l.r][l.c]=a:e[o.ref]=a;var c=dt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Qe(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function gz(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Ye(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=$t(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&F1(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function KC(e){var t=[nr,Te("comments",null,{xmlns:go[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=vt(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(vt(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Ar("t",vt(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(Ar("t",vt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function vz(e,t){var r=[],n=!1,s={},a=0;return e.replace(Jr,function(l,c){var u=Ye(l);switch(Ks(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function yz(e,t,r){var n=[nr,Te("ThreadedComments",null,{xmlns:fr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Te("threadedComment",Ar("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function wz(e,t){var r=[],n=!1;return e.replace(Jr,function(a){var o=Ye(a);switch(Ks(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function bz(e){var t=[nr,Te("personList",null,{xmlns:fr.TCMNT,"xmlns:x":go[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Nz(e){var t={};t.iauthor=e.read_shift(4);var r=bo(e);return t.rfx=r.s,t.ref=Xe(r.s),e.l+=16,t}function kz(e,t){return t==null&&(t=pe(36)),t.write_shift(4,e[1].iauthor),Bl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var _z=Xr;function Sz(e){return kr(e.slice(0,54))}function jz(e,t){var r=[],n=[],s={},a=!1;return Sa(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function Cz(e){var t=wn(),r=[];return be(t,628),be(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),be(t,632,Sz(s.a)))})}),be(t,631),be(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:$t(n[0]),e:$t(n[0])};be(t,635,kz([a,s])),s.t&&s.t.length>0&&be(t,637,Y9(s)),be(t,636),delete s.iauthor})}),be(t,634),be(t,629),t.end()}var Ez="application/vnd.ms-office.vbaProject";function Tz(e){var t=ze.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ze.utils.cfb_add(t,s,e.FileIndex[n].content)}}),ze.write(t)}function Az(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&ze.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var YC=["xlsb","xlsm","xlam","biff8","xla"];function Fz(){return{"!type":"dialog"}}function Pz(){return{"!type":"dialog"}}function Dz(){return{"!type":"macro"}}function Iz(){return{"!type":"macro"}}var al=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,o){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,s+(l?"":"$")+Bt(d)+(c?"":"$")+tr(u)}return function(s,a){return t=a,s.replace(e,r)}}(),R1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,L1=function(){return function(t,r){return t.replace(R1,function(n,s,a,o,l,c){var u=N1(o)-(a?0:r.c),d=b1(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+h})}}();function qC(e,t){return e.replace(R1,function(r,n,s,a,o,l){return n+(s=="$"?s+a:Bt(N1(a)+t.c))+(o=="$"?o+l:tr(b1(l)+t.r))})}function Rz(e,t,r){var n=kn(t),s=n.s,a=$t(r),o={r:a.r-s.r,c:a.c-s.c};return qC(e,o)}function Lz(e){return e.length!=1}function K2(e){return e.replace(/_xlfn\./g,"")}function sr(e){e.l+=1}function ci(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function JC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ZC(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),o=ci(e,2),l=ci(e,2);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ZC(e){var t=ci(e,2),r=ci(e,2),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Oz(e,t,r){if(r.biff<8)return ZC(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=ci(e,2),o=ci(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function QC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Mz(e);var n=e.read_shift(r&&r.biff==12?4:2),s=ci(e,2);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Mz(e){var t=ci(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Bz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $z(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Uz(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function Uz(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function Vz(e,t,r){var n=(e[e.l++]&96)>>5,s=JC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function zz(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=JC(e,a,r);return[n,s,o]}function Wz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Hz(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function Gz(e,t,r){var n=(e[e.l++]&96)>>5,s=Oz(e,t-1,r);return[n,s]}function Xz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Y2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Kz(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Yz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function qz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Jz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Zz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function eE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Qz(e){return e.read_shift(2),eE(e)}function eW(e){return e.read_shift(2),eE(e)}function tW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=QC(e,0,r);return[n,s]}function rW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=$z(e,0,r);return[n,s]}function nW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=QC(e,0,r);return[n,s,a]}function sW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[oH[s],nE[s],n]}function aW(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:iW(e);return[s,(a[0]===0?nE:iH)[a[1]]]}function iW(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function oW(e,t,r){e.l+=r&&r.biff==2?3:4}function lW(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function cW(e){return e.l++,ja[e.read_shift(1)]}function uW(e){return e.l++,e.read_shift(2)}function dW(e){return e.l++,e.read_shift(1)!==0}function fW(e){return e.l++,Gr(e)}function hW(e,t,r){return e.l++,Wu(e,t-1,r)}function mW(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=qt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ja[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Gr(e);break;case 2:r[1]=No(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function pW(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?bo:ah)(e));return s}function xW(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=mW(e,r.biff);return o}function gW(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function vW(e,t,r){if(r.biff==5)return yW(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function yW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function wW(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function bW(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function NW(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function kW(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var _W=qr,SW=qr,jW=qr;function Gu(e,t,r){return e.l+=2,[Bz(e)]}function O1(e){return e.l+=6,[]}var CW=Gu,EW=O1,TW=O1,AW=Gu;function tE(e){return e.l+=2,[lr(e),e.read_shift(2)&1]}var FW=Gu,PW=tE,DW=O1,IW=Gu,RW=Gu,LW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function OW(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),o=LW[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:a}}function MW(e){return e.l+=2,[e.read_shift(4)]}function BW(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $W(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function UW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zW(e){return e.l+=4,[0,0]}var q2={1:{n:"PtgExp",f:lW},2:{n:"PtgTbl",f:jW},3:{n:"PtgAdd",f:sr},4:{n:"PtgSub",f:sr},5:{n:"PtgMul",f:sr},6:{n:"PtgDiv",f:sr},7:{n:"PtgPower",f:sr},8:{n:"PtgConcat",f:sr},9:{n:"PtgLt",f:sr},10:{n:"PtgLe",f:sr},11:{n:"PtgEq",f:sr},12:{n:"PtgGe",f:sr},13:{n:"PtgGt",f:sr},14:{n:"PtgNe",f:sr},15:{n:"PtgIsect",f:sr},16:{n:"PtgUnion",f:sr},17:{n:"PtgRange",f:sr},18:{n:"PtgUplus",f:sr},19:{n:"PtgUminus",f:sr},20:{n:"PtgPercent",f:sr},21:{n:"PtgParen",f:sr},22:{n:"PtgMissArg",f:sr},23:{n:"PtgStr",f:hW},26:{n:"PtgSheet",f:BW},27:{n:"PtgEndSheet",f:$W},28:{n:"PtgErr",f:cW},29:{n:"PtgBool",f:dW},30:{n:"PtgInt",f:uW},31:{n:"PtgNum",f:fW},32:{n:"PtgArray",f:Xz},33:{n:"PtgFunc",f:sW},34:{n:"PtgFuncVar",f:aW},35:{n:"PtgName",f:gW},36:{n:"PtgRef",f:tW},37:{n:"PtgArea",f:Vz},38:{n:"PtgMemArea",f:wW},39:{n:"PtgMemErr",f:_W},40:{n:"PtgMemNoMem",f:SW},41:{n:"PtgMemFunc",f:bW},42:{n:"PtgRefErr",f:NW},43:{n:"PtgAreaErr",f:Wz},44:{n:"PtgRefN",f:rW},45:{n:"PtgAreaN",f:Gz},46:{n:"PtgMemAreaN",f:UW},47:{n:"PtgMemNoMemN",f:VW},57:{n:"PtgNameX",f:vW},58:{n:"PtgRef3d",f:nW},59:{n:"PtgArea3d",f:zz},60:{n:"PtgRefErr3d",f:kW},61:{n:"PtgAreaErr3d",f:Hz},255:{}},WW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},HW={1:{n:"PtgElfLel",f:tE},2:{n:"PtgElfRw",f:IW},3:{n:"PtgElfCol",f:CW},6:{n:"PtgElfRwV",f:RW},7:{n:"PtgElfColV",f:AW},10:{n:"PtgElfRadical",f:FW},11:{n:"PtgElfRadicalS",f:DW},13:{n:"PtgElfColS",f:EW},15:{n:"PtgElfColSV",f:TW},16:{n:"PtgElfRadicalLel",f:PW},25:{n:"PtgList",f:OW},29:{n:"PtgSxName",f:MW},255:{}},GW={0:{n:"PtgAttrNoop",f:zW},1:{n:"PtgAttrSemi",f:Zz},2:{n:"PtgAttrIf",f:qz},4:{n:"PtgAttrChoose",f:Kz},8:{n:"PtgAttrGoto",f:Yz},16:{n:"PtgAttrSum",f:oW},32:{n:"PtgAttrBaxcel",f:Y2},33:{n:"PtgAttrBaxcel",f:Y2},64:{n:"PtgAttrSpace",f:Qz},65:{n:"PtgAttrSpaceSemi",f:eW},128:{n:"PtgAttrIfError",f:Jz},255:{}};function Xu(e,t,r,n){if(n.biff<8)return qr(e,t);for(var s=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=xW(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=pW(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&a.push(qr(e,t)),a}function Ku(e,t,r){for(var n=e.l+t,s,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],s=q2[a]||q2[WW[a]],(a===24||a===25)&&(s=(a===24?HW:GW)[e[e.l+1]]),!s||!s.f?qr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function XW(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var KW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function YW(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function rE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function J2(e,t,r){var n=rE(e,t,r);return n=="#REF"?n:YW(n,r)}function Vr(e,t,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,u,d,f=0,h=0,m,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,v="",w=0,y=e[0].length;w<y;++w){var x=e[0][w];switch(x[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:v=Gt(" ",e[0][p][1][1]);break;case 1:v=Gt("\r",e[0][p][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+v,p=-1}l.push(u+KW[x[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ac(x[1][1],o,s),l.push(Fc(d,a));break;case"PtgRefN":d=r?Ac(x[1][1],r,s):x[1][1],l.push(Fc(d,a));break;case"PtgRef3d":f=x[1][1],d=Ac(x[1][2],o,s),g=J2(n,f,s),l.push(g+"!"+Fc(d,a));break;case"PtgFunc":case"PtgFuncVar":var N=x[1][0],S=x[1][1];N||(N=0),N&=127;var _=N==0?[]:l.slice(-N);l.length-=N,S==="User"&&(S=_.shift()),l.push(S+"("+_.join(",")+")");break;case"PtgBool":l.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(x[1]);break;case"PtgNum":l.push(String(x[1]));break;case"PtgStr":l.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(x[1]);break;case"PtgAreaN":m=j2(x[1][1],r?{s:r}:o,s),l.push(dm(m,s));break;case"PtgArea":m=j2(x[1][1],o,s),l.push(dm(m,s));break;case"PtgArea3d":f=x[1][1],m=x[1][2],g=J2(n,f,s),l.push(g+"!"+dm(m,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var b=(n.names||[])[h-1]||(n[0]||[])[h],A=b?b.Name:"SH33TJSNAME"+String(h);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),l.push(A);break;case"PtgNameX":var D=x[1][1];h=x[1][2];var V;if(s.biff<=5)D<0&&(D=-D),n[D]&&(V=n[D][h]);else{var P="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][h]&&n[D][h].itab>0&&(P=n.SheetNames[n[D][h].itab-1]+"!"):P=n.SheetNames[h-1]+"!"),n[D]&&n[D][h])P+=n[D][h].Name;else if(n[0]&&n[0][h])P+=n[0][h].Name;else{var T=(rE(n,D,s)||"").split(";;");T[h-1]?P=T[h-1]:P+="SH33TJSERRX"}l.push(P);break}V||(V={Name:"SH33TJSERRY"}),l.push(V.Name);break;case"PtgParen":var z="(",L=")";if(p>=0){switch(v="",e[0][p][1][0]){case 2:z=Gt(" ",e[0][p][1][1])+z;break;case 3:z=Gt("\r",e[0][p][1][1])+z;break;case 4:L=Gt(" ",e[0][p][1][1])+L;break;case 5:L=Gt("\r",e[0][p][1][1])+L;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(z+l.pop()+L);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var ee={c:r.c,r:r.r};if(n.sharedf[Xe(d)]){var j=n.sharedf[Xe(d)];l.push(Vr(j,o,ee,n,s))}else{var U=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Vr(u[1],o,ee,n,s)),U=!0;break}U||l.push(x[1])}break;case"PtgArray":l.push("{"+XW(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&q.indexOf(e[0][w][0])==-1){x=e[0][p];var C=!0;switch(x[1][0]){case 4:C=!1;case 0:v=Gt(" ",x[1][1]);break;case 5:C=!1;case 1:v=Gt("\r",x[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}l.push((C?v:"")+l.pop()+(C?"":v)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function qW(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],qr(e,t-2)];var l=Ku(e,o,r);return t!==o+s&&(a=Xu(e,t-o-s,l,r)),e.l=n,[l,a]}function JW(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],qr(e,t-2)];var l=Ku(e,o,r);return t!==o+s&&(a=Xu(e,t-o-s,l,r)),e.l=n,[l,a]}function ZW(e,t,r,n){var s=e.l+t,a=Ku(e,n,r),o;return s!==e.l&&(o=Xu(e,s-e.l,a,r)),[a,o]}function QW(e,t,r){var n=e.l+t,s,a=e.read_shift(2),o=Ku(e,a,r);return a==65535?[[],qr(e,t-2)]:(t!==a+2&&(s=Xu(e,n-a-2,o,r)),[o,s])}function eH(e){var t;if(sa(e,e.l+6)!==65535)return[Gr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function tH(e){if(e==null){var t=pe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ao(e);return ao(0)}function xm(e,t,r){var n=e.l+t,s=Ys(e);r.biff==2&&++e.l;var a=eH(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=JW(e,n-e.l,r);return{cell:s,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function rH(e,t,r,n,s){var a=oo(t,r,s),o=tH(e.v),l=pe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=pe(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Nr([a,o,l,u]);return f}function ih(e,t,r){var n=e.read_shift(4),s=Ku(e,n,r),a=e.read_shift(4),o=a>0?Xu(e,a,s,r):null;return[s,o]}var nH=ih,oh=ih,sH=ih,aH=ih,iH={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},nE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},oH={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Z2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function lH(e){var t="of:="+e.replace(R1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function gm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function cH(e){return e.replace(/\./,"!")}var Dc={},il={},Ic=typeof Map<"u";function M1(e,t,r){var n=0,s=e.length;if(r){if(Ic?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Ic?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Ic?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function lh(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Wr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=xu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=df(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Wi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function gi(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){da(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function sE(e,t,r,n,s,a){try{n.cellNF&&(e.z=He[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=At(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(He[t]==null&&da(o9[t]||"General",t),e.t==="e")e.w=e.w||ja[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v);else if(e.t==="d"){var o=pr(e.v);(o|0)===o?e.w=o.toString(10):e.w=cu(o)}else{if(e.v===void 0)return"";e.w=no(e.v,il)}else e.t==="d"?e.w=ls(t,pr(e.v),il):e.w=ls(t,e.v,il)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=uf(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=uf(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function uH(e,t,r){if(e&&e["!ref"]){var n=dt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function dH(e,t){var r=dt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Qe(r))}var fH=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hH=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,mH=/<(?:\w:)?hyperlink [^>]*>/mg,pH=/"(\w*:\w*)"/,xH=/<(?:\w:)?col\b[^>]*[\/]?>/g,gH=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vH=/<(?:\w:)?pageMargins[^>]*\/>/g,aE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yH=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,wH=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function bH(e,t,r,n,s,a,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(hH);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(aE);h?B1(h[0],l,s,r):(h=u.match(yH))&&kH(h[0],h[1]||"",l,s,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=u.slice(m,m+50).match(pH);g&&dH(l,g[1])}var p=u.match(wH);p&&p[1]&&LH(p[1],s);var v=[];if(t.cellStyles){var w=u.match(xH);w&&FH(v,w)}f&&BH(f[1],l,t,c,a,o);var y=d.match(gH);y&&(l["!autofilter"]=DH(y[0]));var x=[],N=d.match(fH);if(N)for(m=0;m!=N.length;++m)x[m]=dt(N[m].slice(N[m].indexOf('"')+1));var S=d.match(mH);S&&EH(l,S,n);var _=d.match(vH);if(_&&(l["!margins"]=TH(Ye(_[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Qe(c)),t.sheetRows>0&&l["!ref"]){var b=dt(l["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>c.e.r&&(b.e.r=c.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>c.e.c&&(b.e.c=c.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Qe(b))}return v.length>0&&(l["!cols"]=v),x.length>0&&(l["!merges"]=x),l}function NH(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Qe(e[r])+'"/>';return t+"</mergeCells>"}function B1(e,t,r,n){var s=Ye(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ut(bt(s.codeName)))}function kH(e,t,r,n,s){B1(e.slice(0,e.indexOf(">")),r,n,s)}function _H(e,t,r,n,s){var a=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,o.codeName=Ms(vt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Te("outlinePr",null,u)}!a&&!l||(s[s.length]=Te("sheetPr",l,o))}var SH=["objects","scenarios","selectLockedCells","selectUnlockedCells"],jH=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function CH(e){var t={sheet:1};return SH.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),jH.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=P1(e.password).toString(16).toUpperCase()),Te("sheetProtection",null,t)}function EH(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Ye(bt(t[s]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+ut(a.location))):(a.Target="#"+ut(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=dt(a.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Xe({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function TH(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function AH(e){return Wi(e),Te("pageMargins",null,e)}function FH(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Ye(t[n],!0);s.hidden&&(s.hidden=Et(s.hidden));var a=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,D1(s.width)),li(s);a<=o;)e[a++]=Ft(s)}}function PH(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Te("col",null,lh(s,n)));return r[r.length]="</cols>",r.join("")}function DH(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function IH(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Qe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=kn(s);o.s.r==o.e.r&&(o.e.r=kn(t["!ref"]).e.r,s=Qe(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Te("autoFilter",null,{ref:s})}var RH=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function LH(e,t){t.Views||(t.Views=[{}]),(e.match(RH)||[]).forEach(function(r,n){var s=Ye(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Et(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function OH(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,s),{})}function MH(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ja[e.v];break;case"d":n&&n.cellDates?s=At(e.v,-1).toISOString():(e=Ft(e),e.t="n",s=""+(e.v=pr(At(e.v)))),typeof e.z>"u"&&(e.z=He[14]);break;default:s=e.v;break}var l=Ar("v",vt(s)),c={r:t},u=gi(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Ar("v",""+M1(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Te("f",vt(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Te("c",l,c)}var BH=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=uu("v"),o=uu("f");return function(c,u,d,f,h,m){for(var g=0,p="",v=[],w=[],y=0,x=0,N=0,S="",_,b,A=0,D=0,V,P,T=0,z=0,L=Array.isArray(m.CellXf),ee,j=[],U=[],q=Array.isArray(u),C=[],R={},F=!1,E=!!d.sheetStubs,M=c.split(t),H=0,G=M.length;H!=G;++H){p=M[H].trim();var re=p.length;if(re!==0){var he=0;e:for(g=0;g<re;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(b=Ye(p.slice(he,g),!0),A=b.r!=null?parseInt(b.r,10):A+1,D=-1,d.sheetRows&&d.sheetRows<A)continue;R={},F=!1,b.ht&&(F=!0,R.hpt=parseFloat(b.ht),R.hpx=Nl(R.hpt)),b.hidden=="1"&&(F=!0,R.hidden=!0),b.outlineLevel!=null&&(F=!0,R.level=+b.outlineLevel),F&&(C[A-1]=R)}break;case"<":he=g;break}if(he>=g)break;if(b=Ye(p.slice(he,g),!0),A=b.r!=null?parseInt(b.r,10):A+1,D=-1,!(d.sheetRows&&d.sheetRows<A)){f.s.r>A-1&&(f.s.r=A-1),f.e.r<A-1&&(f.e.r=A-1),d&&d.cellStyles&&(R={},F=!1,b.ht&&(F=!0,R.hpt=parseFloat(b.ht),R.hpx=Nl(R.hpt)),b.hidden=="1"&&(F=!0,R.hidden=!0),b.outlineLevel!=null&&(F=!0,R.level=+b.outlineLevel),F&&(C[A-1]=R)),v=p.slice(g).split(e);for(var oe=0;oe!=v.length&&v[oe].trim().charAt(0)=="<";++oe);for(v=v.slice(oe),g=0;g!=v.length;++g)if(p=v[g].trim(),p.length!==0){if(w=p.match(r),y=g,x=0,N=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,w!=null&&w.length===2){for(y=0,S=w[1],x=0;x!=S.length&&!((N=S.charCodeAt(x)-64)<1||N>26);++x)y=26*y+N;--y,D=y}else++D;for(x=0;x!=p.length&&p.charCodeAt(x)!==62;++x);if(++x,b=Ye(p.slice(0,x),!0),b.r||(b.r=Xe({r:A-1,c:D})),S=p.slice(x),_={t:""},(w=S.match(a))!=null&&w[1]!==""&&(_.v=ut(w[1])),d.cellFormula){if((w=S.match(o))!=null&&w[1]!==""){if(_.f=ut(bt(w[1])).replace(/\r\n/g,`
`),d.xlfn||(_.f=K2(_.f)),w[0].indexOf('t="array"')>-1)_.F=(S.match(s)||[])[1],_.F.indexOf(":")>-1&&j.push([dt(_.F),_.F]);else if(w[0].indexOf('t="shared"')>-1){P=Ye(w[0]);var ce=ut(bt(w[1]));d.xlfn||(ce=K2(ce)),U[parseInt(P.si,10)]=[P,ce,b.r]}}else(w=S.match(/<f[^>]*\/>/))&&(P=Ye(w[0]),U[P.si]&&(_.f=Rz(U[P.si][1],U[P.si][2],b.r)));var Q=$t(b.r);for(x=0;x<j.length;++x)Q.r>=j[x][0].s.r&&Q.r<=j[x][0].e.r&&Q.c>=j[x][0].s.c&&Q.c<=j[x][0].e.c&&(_.F=j[x][1])}if(b.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(E)_.t="z";else continue;else _.t=b.t||"n";switch(f.s.c>D&&(f.s.c=D),f.e.c<D&&(f.e.c=D),_.t){case"n":if(_.v==""||_.v==null){if(!E)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!E)continue;_.t="z"}else V=Dc[parseInt(_.v,10)],_.v=V.t,_.r=V.r,d.cellHTML&&(_.h=V.h);break;case"str":_.t="s",_.v=_.v!=null?bt(_.v):"",d.cellHTML&&(_.h=g1(_.v));break;case"inlineStr":w=S.match(n),_.t="s",w!=null&&(V=F1(w[1]))?(_.v=V.t,d.cellHTML&&(_.h=V.h)):_.v="";break;case"b":_.v=Et(_.v);break;case"d":d.cellDates?_.v=At(_.v,1):(_.v=pr(At(_.v,1)),_.t="n");break;case"e":(!d||d.cellText!==!1)&&(_.w=_.v),_.v=oC[_.v];break}if(T=z=0,ee=null,L&&b.s!==void 0&&(ee=m.CellXf[b.s],ee!=null&&(ee.numFmtId!=null&&(T=ee.numFmtId),d.cellStyles&&ee.fillId!=null&&(z=ee.fillId))),sE(_,T,z,d,h,m),d.cellDates&&L&&_.t=="n"&&Ll(He[T])&&(_.t="d",_.v=sh(_.v)),b.cm&&d.xlmeta){var J=(d.xlmeta.Cell||[])[+b.cm-1];J&&J.type=="XLDAPR"&&(_.D=!0)}if(q){var O=$t(b.r);u[O.r]||(u[O.r]=[]),u[O.r][O.c]=_}else u[b.r]=_}}}}C.length>0&&(u["!rows"]=C)}}();function $H(e,t,r,n){var s=[],a=[],o=dt(e["!ref"]),l="",c,u="",d=[],f=0,h=0,m=e["!rows"],g=Array.isArray(e),p={r:u},v,w=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=Bt(h);for(f=o.s.r;f<=o.e.r;++f){for(a=[],u=tr(f),h=o.s.c;h<=o.e.c;++h){c=d[h]+u;var y=g?(e[f]||[])[h]:e[c];y!==void 0&&(l=MH(y,c,e,t))!=null&&a.push(l)}(a.length>0||m&&m[f])&&(p={r:u},m&&m[f]&&(v=m[f],v.hidden&&(p.hidden=1),w=-1,v.hpx?w=gu(v.hpx):v.hpt&&(w=v.hpt),w>-1&&(p.ht=w,p.customHeight=1),v.level&&(p.outlineLevel=v.level)),s[s.length]=Te("row",a.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},v=m[f],v.hidden&&(p.hidden=1),w=-1,v.hpx?w=gu(v.hpx):v.hpt&&(w=v.hpt),w>-1&&(p.ht=w,p.customHeight=1),v.level&&(p.outlineLevel=v.level),s[s.length]=Te("row","",p));return s.join("")}function iE(e,t,r,n){var s=[nr,Te("worksheet",null,{xmlns:go[0],"xmlns:r":fr.r})],a=r.SheetNames[e],o=0,l="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=dt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Qe(d)}n||(n={}),c["!comments"]=[];var f=[];_H(c,r,e,t,s),s[s.length]=Te("dimension",null,{ref:u}),s[s.length]=OH(c,t,e,r),t.sheetFormat&&(s[s.length]=Te("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=PH(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=$H(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=CH(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=IH(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=NH(c["!merges"]));var h=-1,m,g=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=gt(n,-1,vt(p[1].Target).replace(/#.*$/,""),nt.HLINK),m["r:id"]="rId"+g),(h=p[1].Target.indexOf("#"))>-1&&(m.location=vt(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=vt(p[1].Tooltip)),s[s.length]=Te("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=AH(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ar("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=gt(n,-1,"../drawings/drawing"+(e+1)+".xml",nt.DRAW),s[s.length]=Te("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=gt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",nt.VML),s[s.length]=Te("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function UH(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function VH(e,t,r){var n=pe(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=gu(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Xe(u)];g&&(f<0&&(f=m),h=m)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function zH(e,t,r,n){var s=VH(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&be(e,0,s)}var WH=bo,HH=Bl;function GH(){}function XH(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=q9(e),r}function KH(e,t,r){r==null&&(r=pe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return of({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),rC(e,r),r.slice(0,r.l)}function YH(e){var t=cs(e);return[t]}function qH(e,t,r){return r==null&&(r=pe(8)),vo(t,r)}function JH(e){var t=yo(e);return[t]}function ZH(e,t,r){return r==null&&(r=pe(4)),wo(t,r)}function QH(e){var t=cs(e),r=e.read_shift(1);return[t,r,"b"]}function eG(e,t,r){return r==null&&(r=pe(9)),vo(t,r),r.write_shift(1,e.v?1:0),r}function tG(e){var t=yo(e),r=e.read_shift(1);return[t,r,"b"]}function rG(e,t,r){return r==null&&(r=pe(5)),wo(t,r),r.write_shift(1,e.v?1:0),r}function nG(e){var t=cs(e),r=e.read_shift(1);return[t,r,"e"]}function sG(e,t,r){return r==null&&(r=pe(9)),vo(t,r),r.write_shift(1,e.v),r}function aG(e){var t=yo(e),r=e.read_shift(1);return[t,r,"e"]}function iG(e,t,r){return r==null&&(r=pe(8)),wo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function oG(e){var t=cs(e),r=e.read_shift(4);return[t,r,"s"]}function lG(e,t,r){return r==null&&(r=pe(12)),vo(t,r),r.write_shift(4,t.v),r}function cG(e){var t=yo(e),r=e.read_shift(4);return[t,r,"s"]}function uG(e,t,r){return r==null&&(r=pe(8)),wo(t,r),r.write_shift(4,t.v),r}function dG(e){var t=cs(e),r=Gr(e);return[t,r,"n"]}function fG(e,t,r){return r==null&&(r=pe(16)),vo(t,r),ao(e.v,r),r}function oE(e){var t=yo(e),r=Gr(e);return[t,r,"n"]}function hG(e,t,r){return r==null&&(r=pe(12)),wo(t,r),ao(e.v,r),r}function mG(e){var t=cs(e),r=j1(e);return[t,r,"n"]}function pG(e,t,r){return r==null&&(r=pe(12)),vo(t,r),nC(e.v,r),r}function xG(e){var t=yo(e),r=j1(e);return[t,r,"n"]}function gG(e,t,r){return r==null&&(r=pe(8)),wo(t,r),nC(e.v,r),r}function vG(e){var t=cs(e),r=k1(e);return[t,r,"is"]}function yG(e){var t=cs(e),r=Xr(e);return[t,r,"str"]}function wG(e,t,r){return r==null&&(r=pe(12+4*e.v.length)),vo(t,r),kr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function bG(e){var t=yo(e),r=Xr(e);return[t,r,"str"]}function NG(e,t,r){return r==null&&(r=pe(8+4*e.v.length)),wo(t,r),kr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function kG(e,t,r){var n=e.l+t,s=cs(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"b"];if(r.cellFormula){e.l+=2;var l=oh(e,n-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=n;return o}function _G(e,t,r){var n=e.l+t,s=cs(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"e"];if(r.cellFormula){e.l+=2;var l=oh(e,n-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=n;return o}function SG(e,t,r){var n=e.l+t,s=cs(e);s.r=r["!row"];var a=Gr(e),o=[s,a,"n"];if(r.cellFormula){e.l+=2;var l=oh(e,n-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=n;return o}function jG(e,t,r){var n=e.l+t,s=cs(e);s.r=r["!row"];var a=Xr(e),o=[s,a,"str"];if(r.cellFormula){e.l+=2;var l=oh(e,n-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=n;return o}var CG=bo,EG=Bl;function TG(e,t){return t==null&&(t=pe(4)),t.write_shift(4,e),t}function AG(e,t){var r=e.l+t,n=bo(e),s=_1(e),a=Xr(e),o=Xr(e),l=Xr(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:l};return o&&(c.Tooltip=o),c}function FG(e,t){var r=pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Bl({s:$t(e[0]),e:$t(e[0])},r),S1("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return kr(s||"",r),kr(e[1].Tooltip||"",r),kr("",r),r.slice(0,r.l)}function PG(){}function DG(e,t,r){var n=e.l+t,s=sC(e),a=e.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=nH(e,n-e.l,r);o[1]=l}else e.l=n;return o}function IG(e,t,r){var n=e.l+t,s=bo(e),a=[s];if(r.cellFormula){var o=aH(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}function RG(e,t,r){r==null&&(r=pe(18));var n=lh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var lE=["left","right","top","bottom","header","footer"];function LG(e){var t={};return lE.forEach(function(r){t[r]=Gr(e)}),t}function OG(e,t){return t==null&&(t=pe(6*8)),Wi(e),lE.forEach(function(r){ao(e[r],t)}),t}function MG(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function BG(e,t,r){r==null&&(r=pe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $G(e){var t=pe(24);return t.write_shift(4,4),t.write_shift(4,1),Bl(e,t),t}function UG(e,t){return t==null&&(t=pe(16*4+2)),t.write_shift(2,e.password?P1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function VG(){}function zG(){}function WG(e,t,r,n,s,a,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,g,p,v,w,y,x,N,S,_=[];l.biff=12,l["!row"]=0;var b=0,A=!1,D=[],V={},P=l.supbooks||s.supbooks||[[]];if(P.sharedf=V,P.arrayf=D,P.SheetNames=s.SheetNames||s.Sheets.map(function(q){return q.name}),!l.supbooks&&(l.supbooks=P,s.Names))for(var T=0;T<s.Names.length;++T)P[0][T+1]=s.Names[T];var z=[],L=[],ee=!1;vu[16]={n:"BrtShortReal",f:oE};var j;if(Sa(e,function(C,R,F){if(!h)switch(F){case 148:u=C;break;case 0:m=C,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),N=tr(v=m.r),l["!row"]=m.r,(C.hidden||C.hpt||C.level!=null)&&(C.hpt&&(C.hpx=Nl(C.hpt)),L[C.r]=C);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:C[2]},C[2]){case"n":g.v=C[1];break;case"s":x=Dc[C[1]],g.v=x.t,g.r=x.r;break;case"b":g.v=!!C[1];break;case"e":g.v=C[1],l.cellText!==!1&&(g.w=ja[g.v]);break;case"str":g.t="s",g.v=C[1];break;case"is":g.t="s",g.v=C[1].t;break}if((p=o.CellXf[C[0].iStyleRef])&&sE(g,p.numFmtId,null,l,a,o),w=C[0].c==-1?w+1:C[0].c,l.dense?(c[v]||(c[v]=[]),c[v][w]=g):c[Bt(w)+N]=g,l.cellFormula){for(A=!1,b=0;b<D.length;++b){var E=D[b];m.r>=E[0].s.r&&m.r<=E[0].e.r&&w>=E[0].s.c&&w<=E[0].e.c&&(g.F=Qe(E[0]),A=!0)}!A&&C.length>3&&(g.f=C[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>w&&(d.s.c=w),d.e.r<m.r&&(d.e.r=m.r),d.e.c<w&&(d.e.c=w),l.cellDates&&p&&g.t=="n"&&Ll(He[p.numFmtId])){var M=Oi(g.v);M&&(g.t="d",g.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}j&&(j.type=="XLDAPR"&&(g.D=!0),j=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;g={t:"z",v:void 0},w=C[0].c==-1?w+1:C[0].c,l.dense?(c[v]||(c[v]=[]),c[v][w]=g):c[Bt(w)+N]=g,d.s.r>m.r&&(d.s.r=m.r),d.s.c>w&&(d.s.c=w),d.e.r<m.r&&(d.e.r=m.r),d.e.c<w&&(d.e.c=w),j&&(j.type=="XLDAPR"&&(g.D=!0),j=void 0);break;case 176:_.push(C);break;case 49:j=((l.xlmeta||{}).Cell||[])[C-1];break;case 494:var H=n["!id"][C.relId];for(H?(C.Target=H.Target,C.loc&&(C.Target+="#"+C.loc),C.Rel=H):C.relId==""&&(C.Target="#"+C.loc),v=C.rfx.s.r;v<=C.rfx.e.r;++v)for(w=C.rfx.s.c;w<=C.rfx.e.c;++w)l.dense?(c[v]||(c[v]=[]),c[v][w]||(c[v][w]={t:"z",v:void 0}),c[v][w].l=C):(y=Xe({c:w,r:v}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=C);break;case 426:if(!l.cellFormula)break;D.push(C),S=l.dense?c[v][w]:c[Bt(w)+N],S.f=Vr(C[1],d,{r:m.r,c:w},P,l),S.F=Qe(C[0]);break;case 427:if(!l.cellFormula)break;V[Xe(C[0].s)]=C[1],S=l.dense?c[v][w]:c[Bt(w)+N],S.f=Vr(C[1],d,{r:m.r,c:w},P,l);break;case 60:if(!l.cellStyles)break;for(;C.e>=C.s;)z[C.e--]={width:C.w/256,hidden:!!(C.flags&1),level:C.level},ee||(ee=!0,D1(C.w/256)),li(z[C.e+1]);break;case 161:c["!autofilter"]={ref:Qe(C)};break;case 476:c["!margins"]=C;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),C.name&&(s.Sheets[r].CodeName=C.name),(C.above||C.left)&&(c["!outline"]={above:C.above,left:C.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),C.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!R.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+F.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Qe(u||d)),l.sheetRows&&c["!ref"]){var U=dt(c["!ref"]);l.sheetRows<=+U.e.r&&(U.e.r=l.sheetRows-1,U.e.r>d.e.r&&(U.e.r=d.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>d.e.c&&(U.e.c=d.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Qe(U))}return _.length>0&&(c["!merges"]=_),z.length>0&&(c["!cols"]=z),L.length>0&&(c["!rows"]=L),c}function HG(e,t,r,n,s,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Ft(t),t.z=t.z||He[14],t.v=pr(At(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=gi(s.cellXfs,t,s),t.l&&a["!links"].push([Xe(c),t.l]),t.c&&a["!comments"].push([Xe(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=M1(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?be(e,18,uG(t,c)):be(e,7,lG(t,c))):(c.t="str",o?be(e,17,NG(t,c)):be(e,6,wG(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?be(e,13,gG(t,c)):be(e,2,pG(t,c)):o?be(e,16,hG(t,c)):be(e,5,fG(t,c)),!0;case"b":return c.t="b",o?be(e,15,rG(t,c)):be(e,4,eG(t,c)),!0;case"e":return c.t="e",o?be(e,14,iG(t,c)):be(e,3,sG(t,c)),!0}return o?be(e,12,ZH(t,c)):be(e,1,qH(t,c)),!0}function GG(e,t,r,n){var s=dt(t["!ref"]||"A1"),a,o="",l=[];be(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){o=tr(d),zH(e,t,s,d);var f=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(l[h]=Bt(h)),a=l[h]+o;var m=c?(t[d]||[])[h]:t[a];if(!m){f=!1;continue}f=HG(e,m,d,h,n,t,f)}}be(e,146)}function XG(e,t){!t||!t["!merges"]||(be(e,177,TG(t["!merges"].length)),t["!merges"].forEach(function(r){be(e,176,EG(r))}),be(e,178))}function KG(e,t){!t||!t["!cols"]||(be(e,390),t["!cols"].forEach(function(r,n){r&&be(e,60,RG(n,r))}),be(e,391))}function YG(e,t){!t||!t["!ref"]||(be(e,648),be(e,649,$G(dt(t["!ref"]))),be(e,650))}function qG(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=gt(r,-1,n[1].Target.replace(/#.*$/,""),nt.HLINK);be(e,494,FG(n,s))}}),delete t["!links"]}function JG(e,t,r,n){if(t["!comments"].length>0){var s=gt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",nt.VML);be(e,551,S1("rId"+s)),t["!legacy"]=s}}function ZG(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Qe(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=kn(a);l.s.r==l.e.r&&(l.e.r=kn(t["!ref"]).e.r,a=Qe(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),be(e,161,Bl(dt(a))),be(e,162)}}function QG(e,t,r){be(e,133),be(e,137,BG(t,r)),be(e,138),be(e,134)}function eX(e,t){t["!protect"]&&be(e,535,UG(t["!protect"]))}function tX(e,t,r,n){var s=wn(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=dt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],be(s,129),(r.vbaraw||o["!outline"])&&be(s,147,KH(l,o["!outline"])),be(s,148,HH(c)),QG(s,o,r.Workbook),KG(s,o),GG(s,o,e,t),eX(s,o),ZG(s,o,r,e),XG(s,o),qG(s,o,n),o["!margins"]&&be(s,476,OG(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&YG(s,o),JG(s,o,e,n),be(s,130),s.end()}function rX(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=ut((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function nX(e,t,r,n,s,a){var o=a||{"!type":"chart"};if(!e)return a;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=rX(f);d.s.r=d.s.c=0,d.e.c=l,u=Bt(l),h[0].forEach(function(m,g){o[u+tr(g)]={t:"n",v:m,z:h[1]},c=g}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=Qe(d)),o}function sX(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(aE);return l&&B1(l[0],a,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function aX(e,t){e.l+=10;var r=Xr(e);return{name:r}}function iX(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Sa(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var $1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oX=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],lX=[],cX=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Q2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Et(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function eb(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Et(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function cE(e){eb(e.WBProps,$1),eb(e.CalcPr,cX),Q2(e.WBView,oX),Q2(e.Sheets,lX),il.date1904=Et(e.WBProps.date1904)}function uX(e){return!e.Workbook||!e.Workbook.WBProps?"false":Et(e.Workbook.WBProps.date1904)?"true":"false"}var dX="][*?/\\".split("");function uE(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return dX.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function fX(e,t,r){e.forEach(function(n,s){uE(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function hX(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];fX(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)uH(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var mX=/<\w+:workbook/;function pX(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},o=0;if(e.replace(Jr,function(c,u){var d=Ye(c);switch(Ks(d[0])){case"<?xml":break;case"<workbook":c.match(mX)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$1.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Et(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=bt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=ut(bt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=bt(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Et(d.hidden||"0")&&(a.Hidden=!0),o=u+c.length;break;case"</definedName>":a.Ref=ut(bt(e.slice(o,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),go.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return cE(r),r}function dE(e){var t=[nr];t[t.length]=Te("workbook",null,{xmlns:go[0],"xmlns:r":fr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&($1.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Te("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:vt(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Te("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Te("definedName",vt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function xX(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Jp(e),r.name=Xr(e),r}function gX(e,t){return t||(t=pe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),S1(e.strRelID,t),kr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function vX(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Xr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function yX(e,t){t||(t=pe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),rC(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function wX(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function bX(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=J9(e),o=sH(e,0,r),l=_1(e);e.l=n;var c={Name:a,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function NX(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],vu[16]={n:"BrtFRTArchID$",f:wX},Sa(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Vr(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),cE(r),r.Names=a,r.supbooks=o,r}function kX(e,t){be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};be(e,156,gX(s))}be(e,144)}function _X(e,t){t||(t=pe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return kr("SheetJS",t),kr(Q0.version,t),kr(Q0.version,t),kr("7262",t),t.length>t.l?t.slice(0,t.l):t}function SX(e,t){t||(t=pe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function jX(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(be(e,135),be(e,158,SX(s)),be(e,136))}}function CX(e,t){var r=wn();return be(r,131),be(r,128,_X()),be(r,153,yX(e.Workbook&&e.Workbook.WBProps||null)),jX(r,e),kX(r,e),be(r,132),r.end()}function EX(e,t,r){return t.slice(-4)===".bin"?NX(e,r):pX(e,r)}function TX(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?WG(e,n,r,s,a,o,l):bH(e,n,r,s,a,o,l)}function AX(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?iX(e,n,r,s,a):sX(e,n,r,s,a)}function FX(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?Dz():Iz()}function PX(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?Fz():Pz()}function DX(e,t,r,n){return t.slice(-4)===".bin"?EV(e,r,n):xV(e,r,n)}function IX(e,t,r){return HC(e,r)}function RX(e,t,r){return t.slice(-4)===".bin"?RU(e,r):PU(e,r)}function LX(e,t,r){return t.slice(-4)===".bin"?jz(e,r):gz(e,r)}function OX(e,t,r){return t.slice(-4)===".bin"?mz(e):fz(e)}function MX(e,t,r,n){return r.slice(-4)===".bin"?pz(e,t,r,n):void 0}function BX(e,t,r){return t.slice(-4)===".bin"?cz(e,t,r):dz(e,t,r)}function $X(e,t,r){return(t.slice(-4)===".bin"?CX:dE)(e)}function UX(e,t,r,n,s){return(t.slice(-4)===".bin"?tX:iE)(e,r,n,s)}function VX(e,t,r){return(t.slice(-4)===".bin"?MV:zC)(e,r)}function zX(e,t,r){return(t.slice(-4)===".bin"?MU:RC)(e,r)}function WX(e,t,r){return(t.slice(-4)===".bin"?Cz:KC)(e)}function HX(e){return(e.slice(-4)===".bin"?uz:GC)()}var fE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function fs(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var s=e.match(fE),a,o,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(hE),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function GX(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(fE),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(hE),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Rc;function XX(e,t){var r=Rc[e]||ut(e);return r==="General"?no(t):ls(r,t)}function KX(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Et(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=At(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ut(t)]=s}function YX(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ja[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v):e.w=no(e.v):e.w=XX(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Rc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ll(n)){var s=Oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function qX(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=lV[n.Pattern]||n.Pattern)}e[t.ID]=t}function JX(e,t,r,n,s,a,o,l,c,u){var d="General",f=n.StyleID,h={};u=u||{};var m=[],g=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&m.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Et(e);break;case"String":n.t="s",n.r=g2(ut(e)),n.v=e.indexOf("<")>-1?ut(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(At(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ut(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=oC[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=g2(t||e));break}if(YX(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=ut(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=al(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=al("RC:RC",s):n.ArrayRange&&(n.F=al(n.ArrayRange,s),c.push([dt(n.F),n.F]))}else for(g=0;g<c.length;++g)s.r>=c[g][0].s.r&&s.r<=c[g][0].e.r&&s.c>=c[g][0].s.c&&s.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(m.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function ZX(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function vm(e,t){var r=t||{};Ol();var n=dc(v1(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=bt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Ft(r);return o.type="string",bl.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ne){s.indexOf("<"+Ne)>=0&&(a=!0)}),a)return OK(n,r);Rc={"General Number":"General","General Date":He[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":He[15],"Short Date":He[14],"Long Time":He[19],"Medium Time":He[18],"Short Time":He[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:He[2],Standard:He[4],Percent:He[10],Scientific:He[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},m="",g={},p={},v=fs('<Data ss:Type="String">'),w=0,y=0,x=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},_={},b="",A=0,D=[],V={},P={},T=0,z=[],L=[],ee={},j=[],U,q=!1,C=[],R=[],F={},E=0,M=0,H={Sheets:[],WBProps:{date1904:!1}},G={};fu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";l=fu.exec(n);)switch(l[3]=(re=l[3]).toLowerCase()){case"data":if(re=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?JX(n.slice(w,l.index),b,v,c[c.length-1][0]=="comment"?ee:g,{c:y,r:x},S,j[y],p,C,r):(b="",v=fs(l[0]),w=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(L.length>0&&(g.c=L),(!r.sheetRows||r.sheetRows>x)&&g.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][y]=g):h[Bt(y)+tr(x)]=g),g.HRef&&(g.l={Target:ut(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(E=y+(parseInt(g.MergeAcross,10)|0),M=x+(parseInt(g.MergeDown,10)|0),D.push({s:{c:y,r:x},e:{c:E,r:M}})),!r.sheetStubs)g.MergeAcross?y=E+1:++y;else if(g.MergeAcross||g.MergeDown){for(var he=y;he<=E;++he)for(var oe=x;oe<=M;++oe)(he>y||oe>x)&&(r.dense?(h[oe]||(h[oe]=[]),h[oe][he]={t:"z"}):h[Bt(he)+tr(oe)]={t:"z"});y=E+1}else++y;else g=GX(l[0]),g.Index&&(y=+g.Index-1),y<N.s.c&&(N.s.c=y),y>N.e.c&&(N.e.c=y),l[0].slice(-2)==="/>"&&++y,L=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(x<N.s.r&&(N.s.r=x),x>N.e.r&&(N.e.r=x),l[0].slice(-2)==="/>"&&(p=fs(l[0]),p.Index&&(x=+p.Index-1)),y=0,++x):(p=fs(l[0]),p.Index&&(x=+p.Index-1),F={},(p.AutoFitHeight=="0"||p.Height)&&(F.hpx=parseInt(p.Height,10),F.hpt=gu(F.hpx),R[x]=F),p.Hidden=="1"&&(F.hidden=!0,R[x]=F));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(m),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(h["!ref"]=Qe(N),r.sheetRows&&r.sheetRows<=N.e.r&&(h["!fullref"]=h["!ref"],N.e.r=r.sheetRows-1,h["!ref"]=Qe(N))),D.length&&(h["!merges"]=D),j.length>0&&(h["!cols"]=j),R.length>0&&(h["!rows"]=R),d[m]=h}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,c.push([l[3],!1]),u=fs(l[0]),m=ut(u.Name),h=r.dense?[]:{},D=[],C=[],R=[],G={name:m,Hidden:0},H.Sheets.push(G);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),j=[],q=!1}break;case"style":l[1]==="/"?qX(S,_,r):_=fs(l[0]);break;case"numberformat":_.nf=ut(fs(l[0]).Format||"General"),Rc[_.nf]&&(_.nf=Rc[_.nf]);for(var ce=0;ce!=392&&He[ce]!=_.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(He[ce]==null){da(_.nf,ce);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(U=fs(l[0]),U.Hidden&&(U.hidden=!0,delete U.Hidden),U.Width&&(U.wpx=parseInt(U.Width,10)),!q&&U.wpx>10){q=!0,Wr=UC;for(var Q=0;Q<j.length;++Q)j[Q]&&li(j[Q])}q&&li(U),j[U.Index-1||j.length]=U;for(var J=0;J<+U.Span;++J)j[j.length]=Ft(U);break;case"namedrange":if(l[1]==="/")break;H.Names||(H.Names=[]);var O=Ye(l[0]),ve={Name:O.Name,Ref:al(O.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(ve.Sheet=H.Sheets.length-1),H.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?b+=n.slice(A,l.index):A=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=fs(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?NB(V,re,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));ZX(ee),L.push(ee)}else c.push([l[3],!1]),u=fs(l[0]),ee={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ye=fs(l[0]);h["!autofilter"]={ref:al(ye.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return ab(n,r);var xe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:xe=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:xe=!1}break;case"excelworkbook":switch(l[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:xe=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:xe=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else T=l.index+l[0].length;break;case"header":h["!margins"]||Wi(h["!margins"]={},"xlml"),isNaN(+Ye(l[0]).Margin)||(h["!margins"].header=+Ye(l[0]).Margin);break;case"footer":h["!margins"]||Wi(h["!margins"]={},"xlml"),isNaN(+Ye(l[0]).Margin)||(h["!margins"].footer=+Ye(l[0]).Margin);break;case"pagemargins":var ke=Ye(l[0]);h["!margins"]||Wi(h["!margins"]={},"xlml"),isNaN(+ke.Top)||(h["!margins"].top=+ke.Top),isNaN(+ke.Left)||(h["!margins"].left=+ke.Left),isNaN(+ke.Right)||(h["!margins"].right=+ke.Right),isNaN(+ke.Bottom)||(h["!margins"].bottom=+ke.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:xe=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:xe=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:xe=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:xe=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:xe=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:xe=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:xe=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:xe=!1}break;case"smarttags":break;default:xe=!1;break}if(xe||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?KX(P,re,z,n.slice(T,l.index)):(z=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ue={};return!r.bookSheets&&!r.bookProps&&(ue.Sheets=d),ue.SheetNames=f,ue.Workbook=H,ue.SSF=Ft(He),ue.Props=V,ue.Custprops=P,ue}function sx(e,t){switch(V1(t=t||{}),t.type||"base64"){case"base64":return vm(On(e),t);case"binary":case"buffer":case"file":return vm(e,t);case"array":return vm(pi(e),t)}}function QX(e,t){var r=[];return e.Props&&r.push(kB(e.Props,t)),e.Custprops&&r.push(_B(e.Props,e.Custprops)),r.join("")}function eK(){return""}function tK(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Te("NumberFormat",null,{"ss:Format":vt(He[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Te("Style",a.join(""),o))}),Te("Styles",r.join(""))}function mE(e){return Te("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+L1(e.Ref,{r:0,c:0})})}function rK(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(mE(s)))}return Te("Names",r.join(""))}function nK(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(mE(l)))}return a.join("")}function sK(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Te("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Te("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Te("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Te("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ar("ProtectContents","True")),e["!protect"].objects&&s.push(Ar("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ar("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ar("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ar("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Te("WorksheetOptions",s.join(""),{xmlns:Cn.x})}function aK(e){return e.map(function(t){var r=j9(t.t||""),n=Te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Te("Comment",n,{"ss:Author":t.a})}).join("")}function iK(e,t,r,n,s,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+vt(L1(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=$t(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=vt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=vt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=ja[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||He[14]);break;case"s":f="String",h=S9(e.v||"");break}var m=gi(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var g=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=aK(e.c)),Te("Cell",p,l)}function oK(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Nl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function lK(e,t,r,n){if(!e["!ref"])return"";var s=dt(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(v,w){li(v);var y=!!v.width,x=lh(w,v),N={"ss:Index":w+1};y&&(N["ss:Width"]=pu(x.width)),v.hidden&&(N["ss:Hidden"]="1"),l.push(Te("Column",null,N))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[oK(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>f)&&!(a[o].s.r>u)&&!(a[o].e.c<f)&&!(a[o].e.r<u)){(a[o].s.c!=f||a[o].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},g=Xe(m),p=c?(e[u]||[])[f]:e[g];d.push(iK(p,g,e,t,r,n,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function cK(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],o=a?nK(a,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?lK(a,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(sK(a,t,e,r)),n.join("")}function uK(e,t){t||(t={}),e.SSF||(e.SSF=Ft(He)),e.SSF&&(Ol(),th(e.SSF),t.revssf=nh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(QX(e,t)),r.push(eK()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Te("Worksheet",cK(n,t,e),{"ss:Name":vt(e.SheetNames[n])}));return r[2]=tK(e,t),r[3]=rK(e),nr+Te("Workbook",r.join(""),{xmlns:Cn.ss,"xmlns:o":Cn.o,"xmlns:x":Cn.x,"xmlns:ss":Cn.ss,"xmlns:dt":Cn.dt,"xmlns:html":Cn.html})}function dK(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=rB(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=nB(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var fK=[60,1084,2066,2165,2175];function hK(e,t,r,n,s){var a=n,o=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=a;for(var c=sa(r,r.l),u=ax[c],d=0;u!=null&&fK.indexOf(c)>-1;)a=sa(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+a),o.push(l),r.l+=4+a,u=ax[c=sa(r,r.l)];var f=Nr(o);Tr(f,0);var h=0;f.lens=[];for(var m=0;m<o.length;++m)f.lens.push(h),h+=o[m].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function Fs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=He[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ja[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v):e.w=no(e.v):e.w=ls(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Ll(He[n]||String(n))){var s=Oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Dd(e,t,r){return{v:e,ixfe:t,t:r}}function mK(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},o={},l=null,c=[],u="",d={},f,h="",m,g,p,v,w={},y=[],x,N,S=[],_=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},D=function(Ke){return Ke<8?Ui[Ke]:Ke<64&&_[Ke-8]||Ui[Ke]},V=function(Ke,pt,xr){var St=pt.XF.data;if(!(!St||!St.patternType||!xr||!xr.cellStyles)){pt.s={},pt.s.patternType=St.patternType;var _n;(_n=mu(D(St.icvFore)))&&(pt.s.fgColor={rgb:_n}),(_n=mu(D(St.icvBack)))&&(pt.s.bgColor={rgb:_n})}},P=function(Ke,pt,xr){if(!(F>1)&&!(xr.sheetRows&&Ke.r>=xr.sheetRows)){if(xr.cellStyles&&pt.XF&&pt.XF.data&&V(Ke,pt,xr),delete pt.ixfe,delete pt.XF,f=Ke,h=Xe(Ke),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ke.r<o.s.r&&(o.s.r=Ke.r),Ke.c<o.s.c&&(o.s.c=Ke.c),Ke.r+1>o.e.r&&(o.e.r=Ke.r+1),Ke.c+1>o.e.c&&(o.e.c=Ke.c+1),xr.cellFormula&&pt.f){for(var St=0;St<y.length;++St)if(!(y[St][0].s.c>Ke.c||y[St][0].s.r>Ke.r)&&!(y[St][0].e.c<Ke.c||y[St][0].e.r<Ke.r)){pt.F=Qe(y[St][0]),(y[St][0].s.c!=Ke.c||y[St][0].s.r!=Ke.r)&&delete pt.f,pt.f&&(pt.f=""+Vr(y[St][1],o,Ke,C,T));break}}xr.dense?(s[Ke.r]||(s[Ke.r]=[]),s[Ke.r][Ke.c]=pt):s[h]=pt}},T={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var z,L=[],ee=[],j=[],U=[],q=!1,C=[];C.SheetNames=T.snames,C.sharedf=T.sharedf,C.arrayf=T.arrayf,C.names=[],C.XTI=[];var R=0,F=0,E=0,M=[],H=[],G;T.codepage=1200,gs(1200);for(var re=!1;e.l<e.length-1;){var he=e.l,oe=e.read_shift(2);if(oe===0&&R===10)break;var ce=e.l===e.length?0:e.read_shift(2),Q=ax[oe];if(Q&&Q.f){if(t.bookSheets&&R===133&&oe!==133)break;if(R=oe,Q.r===2||Q.r==12){var J=e.read_shift(2);if(ce-=2,!T.enc&&J!==oe&&((J&255)<<8|J>>8)!==oe)throw new Error("rt mismatch: "+J+"!="+oe);Q.r==12&&(e.l+=10,ce-=10)}var O={};if(oe===10?O=Q.f(e,ce,T):O=hK(oe,Q,e,ce,T),F==0&&[9,521,1033,2057].indexOf(R)===-1)continue;switch(oe){case 34:r.opts.Date1904=b.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=O;break;case 66:var ve=Number(O);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}gs(T.codepage=ve),re=!0;break;case 317:T.rrtabid=O;break;case 25:T.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:T.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(s["!type"]="dialog"),O.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),O.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:S.push(O);break;case 430:C.push([O]),C[C.length-1].XTI=[];break;case 35:case 547:C[C.length-1].push(O);break;case 24:case 536:G={Name:O.Name,Ref:Vr(O.rgce,o,null,C,T)},O.itab>0&&(G.Sheet=O.itab-1),C.names.push(G),C[0]||(C[0]=[],C[0].XTI=[]),C[C.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(H[O.itab-1]={ref:Qe(O.rgce[0][0][1][2])});break;case 22:T.ExternCount=O;break;case 23:C.length==0&&(C[0]=[],C[0].XTI=[]),C[C.length-1].XTI=C[C.length-1].XTI.concat(O),C.XTI=C.XTI.concat(O);break;case 2196:if(T.biff<8)break;G!=null&&(G.Comment=O[1]);break;case 18:s["!protect"]=O;break;case 19:O!==0&&T.WTF&&console.error("Password verifier: "+O);break;case 133:a[O.pos]=O,T.snames.push(O.name);break;case 10:{if(--F)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Qe(o),t.sheetRows&&t.sheetRows<=o.e.r){var ye=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Qe(o),o.e.r=ye}o.e.r++,o.e.c++}L.length>0&&(s["!merges"]=L),ee.length>0&&(s["!objects"]=ee),j.length>0&&(s["!cols"]=j),U.length>0&&(s["!rows"]=U),b.Sheets.push(A)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[oe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),T.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(T.biff=5,re=!0,gs(T.codepage=28591)),T.biff==8&&O.BIFFVer==0&&O.dt==16&&(T.biff=2),F++)break;if(s=t.dense?[]:{},T.biff<8&&!re&&(re=!0,gs(T.codepage=t.codepage||1252)),T.biff<5||O.BIFFVer==0&&O.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var xe={pos:e.l-ce,name:u};a[xe.pos]=xe,T.snames.push(u)}else u=(a[he]||{name:""}).name;O.dt==32&&(s["!type"]="chart"),O.dt==64&&(s["!type"]="macro"),L=[],ee=[],T.arrayf=y=[],j=[],U=[],q=!1,A={Hidden:(a[he]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[O.r]||[])[O.c]:s[Xe({c:O.c,r:O.r})])&&++O.c,x={ixfe:O.ixfe,XF:S[O.ixfe]||{},v:O.val,t:"n"},E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:O.c,r:O.r},x,t);break;case 5:case 517:x={ixfe:O.ixfe,XF:S[O.ixfe],v:O.val,t:O.t},E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:O.c,r:O.r},x,t);break;case 638:x={ixfe:O.ixfe,XF:S[O.ixfe],v:O.rknum,t:"n"},E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:O.c,r:O.r},x,t);break;case 189:for(var ke=O.c;ke<=O.C;++ke){var ue=O.rkrec[ke-O.c][0];x={ixfe:ue,XF:S[ue],v:O.rkrec[ke-O.c][1],t:"n"},E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:ke,r:O.r},x,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){l=O;break}if(x=Dd(O.val,O.cell.ixfe,O.tt),x.XF=S[x.ixfe],t.cellFormula){var Ne=O.formula;if(Ne&&Ne[0]&&Ne[0][0]&&Ne[0][0][0]=="PtgExp"){var De=Ne[0][0][1][0],Ee=Ne[0][0][1][1],Ie=Xe({r:De,c:Ee});w[Ie]?x.f=""+Vr(O.formula,o,O.cell,C,T):x.F=((t.dense?(s[De]||[])[Ee]:s[Ie])||{}).F}else x.f=""+Vr(O.formula,o,O.cell,C,T)}E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P(O.cell,x,t),l=O}break;case 7:case 519:if(l)l.val=O,x=Dd(O,l.cell.ixfe,"s"),x.XF=S[x.ixfe],t.cellFormula&&(x.f=""+Vr(l.formula,o,l.cell,C,T)),E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P(l.cell,x,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(O);var te=Xe(O[0].s);if(m=t.dense?(s[O[0].s.r]||[])[O[0].s.c]:s[te],t.cellFormula&&m){if(!l||!te||!m)break;m.f=""+Vr(O[1],o,O[0],C,T),m.F=Qe(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;w[Xe(l.cell)]=O[0],m=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Xe(l.cell)],(m||{}).f=""+Vr(O[0],o,f,C,T)}}break;case 253:x=Dd(c[O.isst].t,O.ixfe,"s"),c[O.isst].h&&(x.h=c[O.isst].h),x.XF=S[x.ixfe],E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:O.c,r:O.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:O.ixfe,XF:S[O.ixfe],t:"z"},E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:O.c,r:O.r},x,t));break;case 190:if(t.sheetStubs)for(var de=O.c;de<=O.C;++de){var Fe=O.ixfe[de-O.c];x={ixfe:Fe,XF:S[Fe],t:"z"},E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:de,r:O.r},x,t)}break;case 214:case 516:case 4:x=Dd(O.val,O.ixfe,"s"),x.XF=S[x.ixfe],E>0&&(x.z=M[x.ixfe>>8&63]),Fs(x,t,r.opts.Date1904),P({c:O.c,r:O.r},x,t);break;case 0:case 512:F===1&&(o=O);break;case 252:c=O;break;case 1054:if(T.biff==4){M[E++]=O[1];for(var Oe=0;Oe<E+163&&He[Oe]!=O[1];++Oe);Oe>=163&&da(O[1],E+163)}else da(O[1],O[0]);break;case 30:{M[E++]=O;for(var Ue=0;Ue<E+163&&He[Ue]!=O;++Ue);Ue>=163&&da(O,E+163)}break;case 229:L=L.concat(O);break;case 93:ee[O.cmo[0]]=T.lastobj=O;break;case 438:T.lastobj.TxO=O;break;case 127:T.lastobj.ImData=O;break;case 440:for(v=O[0].s.r;v<=O[0].e.r;++v)for(p=O[0].s.c;p<=O[0].e.c;++p)m=t.dense?(s[v]||[])[p]:s[Xe({c:p,r:v})],m&&(m.l=O[1]);break;case 2048:for(v=O[0].s.r;v<=O[0].e.r;++v)for(p=O[0].s.c;p<=O[0].e.c;++p)m=t.dense?(s[v]||[])[p]:s[Xe({c:p,r:v})],m&&m.l&&(m.l.Tooltip=O[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;m=t.dense?(s[O[0].r]||[])[O[0].c]:s[Xe(O[0])];var et=ee[O[2]];m||(t.dense?(s[O[0].r]||(s[O[0].r]=[]),m=s[O[0].r][O[0].c]={t:"z"}):m=s[Xe(O[0])]={t:"z"},o.e.r=Math.max(o.e.r,O[0].r),o.s.r=Math.min(o.s.r,O[0].r),o.e.c=Math.max(o.e.c,O[0].c),o.s.c=Math.min(o.s.c,O[0].c)),m.c||(m.c=[]),g={a:O[1],t:et.TxO.t},m.c.push(g)}break;case 2173:tz(S[O.ixfe],O.ext);break;case 125:{if(!T.cellStyles)break;for(;O.e>=O.s;)j[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},q||(q=!0,D1(O.w/256)),li(j[O.e+1])}break;case 520:{var Ve={};O.level!=null&&(U[O.r]=Ve,Ve.level=O.level),O.hidden&&(U[O.r]=Ve,Ve.hidden=!0),O.hpt&&(U[O.r]=Ve,Ve.hpt=O.hpt,Ve.hpx=Nl(O.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Wi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[oe]]=O;break;case 161:s["!margins"]||Wi(s["!margins"]={}),s["!margins"].header=O.header,s["!margins"].footer=O.footer;break;case 574:O.RTL&&(b.Views[0].RTL=!0);break;case 146:_=O;break;case 2198:z=O;break;case 140:N=O;break;case 442:u?A.CodeName=O||A.name:b.WBProps.CodeName=O||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+oe.toString(16)),e.l+=ce}return r.SheetNames=Yt(a).sort(function(qe,Ke){return Number(qe)-Number(Ke)}).map(function(qe){return a[qe].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&H.forEach(function(qe,Ke){r.Sheets[r.SheetNames[Ke]]["!autofilter"]=qe}),r.Strings=c,r.SSF=Ft(He),T.enc&&(r.Encryption=T.enc),z&&(r.Themes=z),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),C.names.length>0&&(b.Names=C.names),r.Workbook=b,r}var Lc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pK(e,t,r){var n=ze.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=R2(n,Zp,Lc.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var o=ze.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=R2(o,Qp,Lc.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(hC(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function xK(e,t){var r=[],n=[],s=[],a=0,o,l=d2(Zp,"n"),c=d2(Qp,"n");if(e.Props)for(o=Yt(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=Yt(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Custprops[o[a]]]);var u=[];for(a=0;a<s.length;++a)wC.indexOf(s[a][0])>-1||fC.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&ze.utils.cfb_add(t,"/SummaryInformation",L2(n,Lc.SI,c,Qp)),(r.length||u.length)&&ze.utils.cfb_add(t,"/DocumentSummaryInformation",L2(r,Lc.DSI,l,Zp,u.length?u:null,Lc.UDI))}function pE(e,t){t||(t={}),V1(t),c1(),t.codepage&&l1(t.codepage);var r,n;if(e.FullPaths){if(ze.find(e,"/encryption"))throw new Error("File is password-protected");r=ze.find(e,"!CompObj"),n=ze.find(e,"/Workbook")||ze.find(e,"/Book")}else{switch(t.type){case"base64":e=An(On(e));break;case"binary":e=An(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Tr(e,0),n={content:e}}var s,a;if(r&&dK(r),t.bookProps&&!t.bookSheets)s={};else{var o=rt?"buffer":"array";if(n&&n.content)s=mK(n.content,t);else if((a=ze.find(e,"PerfectOffice_MAIN"))&&a.content)s=zi.to_workbook(a.content,(t.type=o,t));else if((a=ze.find(e,"NativeContent_MAIN"))&&a.content)s=zi.to_workbook(a.content,(t.type=o,t));else throw(a=ze.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ze.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Tz(e))}var l={};return e.FullPaths&&pK(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function gK(e,t){var r=t||{},n=ze.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ze.utils.cfb_add(n,s,xE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&xK(e,n),r.biff==8&&e.vbaraw&&Az(n,ze.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var vu={0:{f:UH},1:{f:YH},2:{f:mG},3:{f:nG},4:{f:QH},5:{f:dG},6:{f:yG},7:{f:oG},8:{f:jG},9:{f:SG},10:{f:kG},11:{f:_G},12:{f:JH},13:{f:xG},14:{f:aG},15:{f:tG},16:{f:oE},17:{f:bG},18:{f:cG},19:{f:k1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bX},40:{},42:{},43:{f:yV},44:{f:gV},45:{f:NV},46:{f:_V},47:{f:kV},48:{},49:{f:W9},50:{},51:{f:sz},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:FC},62:{f:vG},63:{f:hz},64:{f:VG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:MG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:XH},148:{f:WH,p:16},151:{f:PG},152:{},153:{f:vX},154:{},155:{},156:{f:xX},157:{},158:{},159:{T:1,f:IU},160:{T:-1},161:{T:1,f:bo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:CG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:rz},336:{T:-1},337:{f:oz,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:AC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DG},427:{f:IG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:LG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:GH},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:AG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:_z},633:{T:1},634:{T:-1},635:{T:1,f:Nz},636:{T:-1},637:{f:K9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:aX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ax={6:{f:xm},10:{f:Aa},12:{f:lr},13:{f:lr},14:{f:qt},15:{f:qt},16:{f:Gr},17:{f:qt},18:{f:qt},19:{f:lr},20:{f:V2},21:{f:V2},23:{f:AC},24:{f:W2},25:{f:qt},26:{},27:{},28:{f:z$},29:{},34:{f:qt},35:{f:z2},38:{f:Gr},39:{f:Gr},40:{f:Gr},41:{f:Gr},42:{f:qt},43:{f:qt},47:{f:tV},49:{f:x$},51:{f:lr},60:{},61:{f:d$},64:{f:qt},65:{f:p$},66:{f:lr},77:{},80:{},81:{},82:{},85:{f:lr},89:{},90:{},91:{},92:{f:e$},93:{f:G$},94:{},95:{f:qt},96:{},97:{},99:{f:qt},125:{f:FC},128:{f:F$},129:{f:r$},130:{f:lr},131:{f:qt},132:{f:qt},133:{f:n$},134:{},140:{f:eU},141:{f:lr},144:{},146:{f:nU},151:{},152:{},153:{},154:{},155:{},156:{f:lr},157:{},158:{},160:{f:uU},161:{f:iU},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:C$},190:{f:E$},193:{f:Aa},197:{},198:{},199:{},200:{},201:{},202:{f:qt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:lr},220:{},221:{f:qt},222:{},224:{f:A$},225:{f:QB},226:{f:Aa},227:{},229:{f:W$},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:a$},253:{f:v$},255:{f:o$},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:bC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qt},353:{f:Aa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:L$},431:{f:qt},432:{},433:{},434:{},437:{},438:{f:Y$},439:{f:qt},440:{f:q$},441:{},442:{f:Hu},443:{},444:{f:lr},445:{},446:{},448:{f:Aa},449:{f:u$,r:2},450:{f:Aa},512:{f:B2},513:{f:cU},515:{f:I$},516:{f:w$},517:{f:U2},519:{f:dU},520:{f:l$},523:{},545:{f:H2},549:{f:M2},566:{},574:{f:h$},638:{f:j$},659:{},1048:{},1054:{f:N$},1084:{},1212:{f:$$},2048:{f:Z$},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ad},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Aa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sU,r:12},2173:{f:ez,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:B$,r:12},2197:{},2198:{f:KV,r:12},2199:{},2200:{},2201:{},2202:{f:U$,r:12},2203:{f:Aa},2204:{},2205:{},2206:{},2207:{},2211:{f:c$},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:lr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:oU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:rU},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:B2},1:{},2:{f:xU},3:{f:mU},4:{f:hU},5:{f:U2},7:{f:vU},8:{},9:{f:Ad},11:{},22:{f:lr},30:{f:_$},31:{},32:{},33:{f:H2},36:{},37:{f:M2},50:{f:yU},62:{},52:{},67:{},68:{f:lr},69:{},86:{},126:{},127:{f:fU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:wU},223:{},234:{},354:{},421:{},518:{f:xm},521:{f:Ad},536:{f:W2},547:{f:z2},561:{},579:{},1030:{f:xm},1033:{f:Ad},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ae(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&w1(r)&&e.push(r)}}function vK(e,t,r,n){var s=n||(r||[]).length||0;if(s<=8224)return Ae(e,t,r,s);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Yu(e,t,r){return e||(e=pe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function yK(e,t,r,n){var s=pe(9);return Yu(s,e,t),NC(r,n||"b",s),s}function wK(e,t,r){var n=pe(8+2*r.length);return Yu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function bK(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?pr(At(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Ae(e,2,gU(r,n,s)):Ae(e,3,pU(r,n,s));return;case"b":case"e":Ae(e,5,yK(r,n,t.v,t.t));return;case"s":case"str":Ae(e,4,wK(r,n,(t.v||"").slice(0,255)));return}Ae(e,1,Yu(null,r,n))}function NK(e,t,r,n){var s=Array.isArray(t),a=dt(t["!ref"]||"A1"),o,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Qe(a)}for(var u=a.s.r;u<=a.e.r;++u){l=tr(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Bt(d)),o=c[d]+l;var f=s?(t[u]||[])[d]:t[o];f&&bK(e,f,u,d)}}}function kK(e,t){for(var r=t||{},n=wn(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ae(n,r.biff==4?1033:r.biff==3?521:9,A1(e,16,r)),NK(n,e.Sheets[e.SheetNames[s]],s,r),Ae(n,10),n.end()}function _K(e,t,r){Ae(e,49,g$({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function SK(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ae(e,1054,k$(s,t[s],r))})}function jK(e,t){var r=pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ae(e,2151,r),r=pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),CC(dt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ae(e,2152,r)}function CK(e,t){for(var r=0;r<16;++r)Ae(e,224,$2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ae(e,224,$2(n,0,t))})}function EK(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ae(e,440,J$(n)),n[1].Tooltip&&Ae(e,2048,Q$(n))}delete t["!links"]}function TK(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Ae(e,125,aU(lh(s,n),s))})}}function AK(e,t,r,n,s){var a=16+gi(s.cellXfs,t,s);if(t.v==null&&!t.bf){Ae(e,513,oo(r,n,a));return}if(t.bf)Ae(e,6,rH(t,r,n,s,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?pr(At(t.v)):t.v;Ae(e,515,R$(r,n,o,a));break;case"b":case"e":Ae(e,517,D$(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var l=M1(s.Strings,t.v,s.revStrings);Ae(e,253,y$(r,n,l,a))}else Ae(e,516,b$(r,n,(t.v||"").slice(0,255),a,s));break;default:Ae(e,513,oo(r,n,a))}}function FK(e,t,r){var n=wn(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],m=dt(a["!ref"]||"A1"),g=u?65536:16384;if(m.e.c>255||m.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}Ae(n,2057,A1(r,16,t)),Ae(n,13,Yn(1)),Ae(n,12,Yn(100)),Ae(n,15,rn(!0)),Ae(n,17,rn(!1)),Ae(n,16,ao(.001)),Ae(n,95,rn(!0)),Ae(n,42,rn(!1)),Ae(n,43,rn(!1)),Ae(n,130,Yn(1)),Ae(n,128,P$([0,0])),Ae(n,131,rn(!1)),Ae(n,132,rn(!1)),u&&TK(n,a["!cols"]),Ae(n,512,S$(m,t)),u&&(a["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=tr(p);for(var v=m.s.c;v<=m.e.c;++v){p===m.s.r&&(h[v]=Bt(v)),d=h[v]+f;var w=c?(a[p]||[])[v]:a[d];w&&(AK(n,w,p,v,t),u&&w.l&&a["!links"].push([d,w.l]))}}var y=l.CodeName||l.name||s;return u&&Ae(n,574,m$((o.Views||[])[0])),u&&(a["!merges"]||[]).length&&Ae(n,229,H$(a["!merges"])),u&&EK(n,a),Ae(n,442,kC(y)),u&&jK(n,a),Ae(n,10),n.end()}function PK(e,t,r){var n=wn(),s=(e||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Ae(n,2057,A1(e,5,r)),r.bookType=="xla"&&Ae(n,135),Ae(n,225,l?Yn(1200):null),Ae(n,193,DB(2)),c&&Ae(n,191),c&&Ae(n,192),Ae(n,226),Ae(n,92,t$("SheetJS",r)),Ae(n,66,Yn(l?1200:1252)),l&&Ae(n,353,Yn(0)),l&&Ae(n,448),Ae(n,317,lU(e.SheetNames.length)),l&&e.vbaraw&&Ae(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Ae(n,442,kC(u))}Ae(n,156,Yn(17)),Ae(n,25,rn(!1)),Ae(n,18,rn(!1)),Ae(n,19,Yn(0)),l&&Ae(n,431,rn(!1)),l&&Ae(n,444,Yn(0)),Ae(n,61,f$()),Ae(n,64,rn(!1)),Ae(n,141,Yn(0)),Ae(n,34,rn(uX(e)=="true")),Ae(n,14,rn(!0)),l&&Ae(n,439,rn(!1)),Ae(n,218,Yn(0)),_K(n,e,r),SK(n,e.SSF,r),CK(n,r),l&&Ae(n,352,rn(!1));var d=n.end(),f=wn();l&&Ae(f,140,tU()),l&&r.Strings&&vK(f,252,i$(r.Strings)),Ae(f,10);var h=f.end(),m=wn(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var v=d.length+g+h.length;for(p=0;p<e.SheetNames.length;++p){var w=a[p]||{};Ae(m,133,s$({pos:v,hs:w.Hidden||0,dt:0,name:e.SheetNames[p]},r)),v+=t[p].length}var y=m.end();if(g!=y.length)throw new Error("BS8 "+g+" != "+y.length);var x=[];return d.length&&x.push(d),y.length&&x.push(y),h.length&&x.push(h),Nr(x)}function DK(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ft(He)),e&&e.SSF&&(Ol(),th(e.SSF),r.revssf=nh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,z1(r),r.cellXfs=[],gi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=FK(s,r,e);return n.unshift(PK(e,n,r)),Nr(n)}function xE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=kn(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return DK(e,t);case 4:case 3:case 2:return kK(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function tb(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=s.index,l=a&&a.index||e.length,c=v9(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<c.length;++o){var p=c[o].trim(),v=p.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var w=p.split(/<\/t[dh]>/i);for(l=0;l<w.length;++l){var y=w[l].trim();if(y.match(/<t[dh]/i)){for(var x=y,N=0;x.charAt(0)=="<"&&(N=x.indexOf(">"))>-1;)x=x.slice(N+1);for(var S=0;S<g.length;++S){var _=g[S];_.s.c==d&&_.s.r<u&&u<=_.e.r&&(d=_.e.c+1,S=-1)}var b=Ye(y.slice(0,y.indexOf(">")));h=b.colspan?+b.colspan:1,((f=+b.rowspan)>1||h>1)&&g.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var A=b.t||b["data-t"]||"";if(!x.length){d+=h;continue}if(x=$j(x),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!x.length){d+=h;continue}var D={t:"s",v:x};r.raw||!x.trim().length||A=="s"||(x==="TRUE"?D={t:"b",v:!0}:x==="FALSE"?D={t:"b",v:!1}:isNaN(Ns(x))?isNaN(wl(x).getDate())||(D={t:"d",v:At(x)},r.cellDates||(D={t:"n",v:pr(D.v)}),D.z=r.dateNF||He[14]):D={t:"n",v:Ns(x)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=D):n[Xe({r:u,c:d})]=D,d+=h}}}}return n["!ref"]=Qe(m),g.length&&(n["!merges"]=g),n}function IK(e,t,r,n){for(var s=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>o)&&!(s[u].e.r<r||s[u].e.c<o)){if(s[u].s.r<r||s[u].s.c<o){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=Xe({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||g1(f.w||(wa(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+d,a.push(Te("td",h,m))}}var g="<tr>";return g+a.join("")+"</tr>"}var RK='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',LK="</body></html>";function OK(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return xi(tb(r[0],t),t);var n=G1();return r.forEach(function(s,a){X1(n,tb(s,t),"Sheet"+(a+1))}),n}function MK(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function gE(e,t){var r=t||{},n=r.header!=null?r.header:RK,s=r.footer!=null?r.footer:LK,a=[n],o=kn(e["!ref"]);r.dense=Array.isArray(e),a.push(MK(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(IK(e,o,l,r));return a.push("</table>"+s),a.join("")}function vE(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?$t(n.origin):n.origin;s=o.r,a=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=kn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),g=0,p=0,v=0,w=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&p<c;++g){var N=l[g];if(rb(N)){if(n.display)continue;m[p]={hidden:!0}}var S=N.children;for(v=w=0;v<S.length;++v){var _=S[v];if(!(n.display&&rb(_))){var b=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):$j(_.innerHTML),A=_.getAttribute("data-z")||_.getAttribute("z");for(h=0;h<f.length;++h){var D=f[h];D.s.c==w+a&&D.s.r<p+s&&p+s<=D.e.r&&(w=D.e.c+1-a,h=-1)}x=+_.getAttribute("colspan")||1,((y=+_.getAttribute("rowspan")||1)>1||x>1)&&f.push({s:{r:p+s,c:w+a},e:{r:p+s+(y||1)-1,c:w+a+(x||1)-1}});var V={t:"s",v:b},P=_.getAttribute("data-t")||_.getAttribute("t")||"";b!=null&&(b.length==0?V.t=P||"z":n.raw||b.trim().length==0||P=="s"||(b==="TRUE"?V={t:"b",v:!0}:b==="FALSE"?V={t:"b",v:!1}:isNaN(Ns(b))?isNaN(wl(b).getDate())||(V={t:"d",v:At(b)},n.cellDates||(V={t:"n",v:pr(V.v)}),V.z=n.dateNF||He[14]):V={t:"n",v:Ns(b)})),V.z===void 0&&A!=null&&(V.z=A);var T="",z=_.getElementsByTagName("A");if(z&&z.length)for(var L=0;L<z.length&&!(z[L].hasAttribute("href")&&(T=z[L].getAttribute("href"),T.charAt(0)!="#"));++L);T&&T.charAt(0)!="#"&&(V.l={Target:T}),n.dense?(e[p+s]||(e[p+s]=[]),e[p+s][w+a]=V):e[Xe({c:w+a,r:p+s})]=V,u.e.c<w+a&&(u.e.c=w+a),w+=x}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+s),e["!ref"]=Qe(u),p>=c&&(e["!fullref"]=Qe((u.e.r=l.length-g+p-1+s,u))),e}function yE(e,t){var r=t||{},n=r.dense?[]:{};return vE(n,e,t)}function BK(e,t){return xi(yE(e,t),t)}function rb(e){var t="",r=$K(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function $K(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function UK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ut(t.replace(/<[^>]*>/g,""));return[r]}var nb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function wE(e,t){var r=t||{},n=v1(e),s=[],a,o,l={name:""},c="",u=0,d,f,h={},m=[],g=r.dense?[]:{},p,v,w={value:""},y="",x=0,N=[],S=-1,_=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,D={},V=[],P={},T=0,z=0,L=[],ee=1,j=1,U=[],q={Names:[]},C={},R=["",""],F=[],E={},M="",H=0,G=!1,re=!1,he=0;for(fu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=fu.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?g["!ref"]=Qe(b):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(g["!fullref"]=g["!ref"],b.e.r=r.sheetRows-1,g["!ref"]=Qe(b)),V.length&&(g["!merges"]=V),L.length&&(g["!rows"]=L),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=g,re=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Ye(p[0],!1),S=_=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,g=r.dense?[]:{},V=[],L=[],re=!0);break;case"table-row-group":p[1]==="/"?--A:++A;break;case"table-row":case"":if(p[1]==="/"){S+=ee,ee=1;break}if(f=Ye(p[0],!1),f.?S=f.-1:S==-1&&(S=0),ee=+f["number-rows-repeated"]||1,ee<10)for(he=0;he<ee;++he)A>0&&(L[S+he]={level:A});_=-1;break;case"covered-table-cell":p[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(g[S]||(g[S]=[]),g[S][_]={t:"z"}):g[Xe({r:S,c:_})]={t:"z"}),y="",N=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++_,w=Ye(p[0],!1),j=parseInt(w["number-columns-repeated"]||"1",10),v={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(v.f=Z2(ut(w.formula))),(w.||w["value-type"])=="string"&&(v.t="s",v.v=ut(w["string-value"]||""),r.dense?(g[S]||(g[S]=[]),g[S][_]=v):g[Xe({r:S,c:_})]=v),_+=j-1;else if(p[1]!=="/"){++_,y="",x=0,N=[],j=1;var oe=ee?S+ee-1:S;if(_>b.e.c&&(b.e.c=_),_<b.s.c&&(b.s.c=_),S<b.s.r&&(b.s.r=S),oe>b.e.r&&(b.e.r=oe),w=Ye(p[0],!1),F=[],E={},v={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=ut(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(T=parseInt(w["number-matrix-rows-spanned"],10)||0,z=parseInt(w["number-matrix-columns-spanned"],10)||0,P={s:{r:S,c:_},e:{r:S+T-1,c:_+z-1}},v.F=Qe(P),U.push([P,v.F])),w.formula)v.f=Z2(w.formula);else for(he=0;he<U.length;++he)S>=U[he][0].s.r&&S<=U[he][0].e.r&&_>=U[he][0].s.c&&_<=U[he][0].e.c&&(v.F=U[he][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(T=parseInt(w["number-rows-spanned"],10)||0,z=parseInt(w["number-columns-spanned"],10)||0,P={s:{r:S,c:_},e:{r:S+T-1,c:_+z-1}},V.push(P)),w["number-columns-repeated"]&&(j=parseInt(w["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Et(w["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(w.value);break;case"percentage":v.t="n",v.v=parseFloat(w.value);break;case"currency":v.t="n",v.v=parseFloat(w.value);break;case"date":v.t="d",v.v=At(w["date-value"]),r.cellDates||(v.t="n",v.v=pr(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=p9(w["time-value"])/86400,r.cellDates&&(v.t="d",v.v=sh(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(w.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",w["string-value"]!=null&&(y=ut(w["string-value"]),N=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(G=!1,v.t==="s"&&(v.v=y||"",N.length&&(v.R=N),G=x==0),C.Target&&(v.l=C),F.length>0&&(v.c=F,F=[]),y&&r.cellText!==!1&&(v.w=y),G&&(v.t="z",delete v.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var ce=0;ce<ee;++ce){if(j=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(g[S+ce]||(g[S+ce]=[]),g[S+ce][_]=ce==0?v:Ft(v);--j>0;)g[S+ce][_+j]=Ft(v);else for(g[Xe({r:S+ce,c:_})]=v;--j>0;)g[Xe({r:S+ce,c:_+j})]=Ft(v);b.e.c<=_&&(b.e.c=_)}j=parseInt(w["number-columns-repeated"]||"1",10),_+=j-1,j=0,v={},y="",N=[]}C={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a;E.t=y,N.length&&(E.R=N),E.a=M,F.push(E)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);M="",H=0,y="",x=0,N=[];break;case"creator":p[1]==="/"?M=n.slice(H,p.index):H=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);y="",x=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(D[l.name]=c,(a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Ye(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ye(p[0],!1),c+=nb[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ye(p[0],!1),c+=nb[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=Ye(p[0],!1),R=gm(o["cell-range-address"]);var Q={Name:o.name,Ref:R[0]+"!"+R[1]};re&&(Q.Sheet=m.length),q.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!w||!w["string-value"])){var J=UK(n.slice(x,p.index));y=(y.length>0?y+`
`:"")+J[0]}else Ye(p[0],!1),x=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{R=gm(Ye(p[0])["target-range-address"]),h[R[0]]["!autofilter"]={ref:R[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(C=Ye(p[0],!1),!C.href)break;C.Target=ut(C.href),delete C.href,C.Target.charAt(0)=="#"&&C.Target.indexOf(".")>-1?(R=gm(C.Target.slice(1)),C.Target="#"+R[0]+"!"+R[1]):C.Target.match(/^\.\.[\\\/]/)&&(C.Target=C.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var O={Sheets:h,SheetNames:m,Workbook:q};return r.bookSheets&&delete O.Sheets,O}function sb(e,t){t=t||{},Kn(e,"META-INF/manifest.xml")&&mB(or(e,"META-INF/manifest.xml"),t);var r=Fn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=wE(bt(r),t);return Kn(e,"meta.xml")&&(n.Props=uC(or(e,"meta.xml"))),n}function ab(e,t){return wE(e,t)}var VK=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+du({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return nr+t}}(),ib=function(){var e=function(a){return vt(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,l){var c=[];c.push('      <table:table table:name="'+vt(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=kn(a["!ref"]||"A1"),h=a["!merges"]||[],m=0,g=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",v=a["!rows"]||[];for(u=0;u<f.s.r;++u)p=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var w=!1,y={},x="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(w=!0),y["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,y["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(w){c.push(r);continue}var N=Xe({r:u,c:d}),S=g?(a[u]||[])[d]:a[N];if(S&&S.f&&(y["table:formula"]=vt(lH(S.f)),S.F&&S.F.slice(0,N.length)==N)){var _=kn(S.F);y["table:number-matrix-columns-spanned"]=_.e.c-_.s.c+1,y["table:number-matrix-rows-spanned"]=_.e.r-_.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":x=S.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=S.v?"true":"false";break;case"n":x=S.w||String(S.v||0),y["office:value-type"]="float",y["office:value"]=S.v||0;break;case"s":case"str":x=S.v==null?"":S.v,y["office:value-type"]="string";break;case"d":x=S.w||At(S.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=At(S.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(t);continue}var b=e(x);if(S.l&&S.l.Target){var A=S.l.Target;A=A.charAt(0)=="#"?"#"+cH(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),b=Te("text:a",b,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+Te("table:table-cell",Te("text:p",b,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;li(f),f.ods=l;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var c=[nr],u=du({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=du({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(cC().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function bE(e,t){if(t.bookType=="fods")return ib(e,t);var r=m1(),n="",s=[],a=[];return n="mimetype",tt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",tt(r,n,ib(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",tt(r,n,VK(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",tt(r,n,nr+cC()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",tt(r,n,gB(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",tt(r,n,pB(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function lo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ix(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):bt(pi(e))}function zK(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):An(Ms(e))}function WK(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ui(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function ob(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function HK(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function GK(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function yu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function xt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Kt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ft(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=yu(e,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=yu(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Cr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(xt(n*8+s.type)),s.type==2&&t.push(xt(s.data.length)),t.push(s.data))})}),ui(t)}function U1(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Hn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=yu(e,n),a=ft(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Kt(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=ft(l.data),u=Kt(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(o.merge=Kt(a[3][0].data)>>>0>0),r.push(o)}return r}function jo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:xt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:xt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:xt(o.data.length)}],n[2].push({data:Cr(o.meta),type:2})});var a=Cr(n);t.push(xt(a.length)),t.push(a),s.forEach(function(o){return t.push(o)})}),ui(t)}function XK(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=yu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ui(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=ui(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Gn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(XK(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ui(t)}function Co(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=xt(n),o=a.length;t.push(a),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return ui(t)}function KK(e,t,r,n){var s=lo(e),a=s.getUint32(4,!0),o=(n>1?12:8)+ob(a&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(l=s.getUint32(o,!0),o+=4),o+=ob(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(o,!0),o+=4),a&32&&(u=s.getFloat64(o,!0),o+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function YK(e,t,r){var n=lo(e),s=n.getUint32(8,!0),a=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=HK(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(o=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function ym(e,t){var r=new Uint8Array(32),n=lo(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,GK(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function wm(e,t){var r=new Uint8Array(32),n=lo(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function qK(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return KK(e,t,r,e[0]);case 5:return YK(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ur(e){var t=ft(e);return yu(t[1][0].data)}function lb(e,t){var r=ft(t.data),n=Kt(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(o){var l=ft(o.data),c=Kt(l[1][0].data)>>>0;switch(n){case 1:a[c]=ix(l[3][0].data);break;case 8:{var u=e[Ur(l[9][0].data)][0],d=ft(u.data),f=e[Ur(d[1][0].data)][0],h=Kt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=ft(f.data);a[c]=m[3].map(function(g){return ix(g.data)}).join("")}break}}),a}function JK(e,t){var r,n,s,a,o,l,c,u,d,f,h,m,g,p,v=ft(e),w=Kt(v[1][0].data)>>>0,y=Kt(v[2][0].data)>>>0,x=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&Kt(v[8][0].data)>0||!1,N,S;if((a=(s=v[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(l=(o=v[7])==null?void 0:o[0])==null?void 0:l.data,S=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=v[4])==null?void 0:d[0])!=null&&f.data&&t!=1)N=(m=(h=v[4])==null?void 0:h[0])==null?void 0:m.data,S=(p=(g=v[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=x?4:1,b=lo(N),A=[],D=0;D<N.length/2;++D){var V=b.getUint16(D*2,!0);V<65535&&A.push([D,V])}if(A.length!=y)throw"Expected ".concat(y," cells, found ").concat(A.length);var P=[];for(D=0;D<A.length-1;++D)P[A[D][0]]=S.subarray(A[D][1]*_,A[D+1][1]*_);return A.length>=1&&(P[A[A.length-1][0]]=S.subarray(A[A.length-1][1]*_)),{R:w,cells:P}}function ZK(e,t){var r,n=ft(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Kt(n[7][0].data)>>>0>0?1:0:-1,a=U1(n[5],function(o){return JK(o,s)});return{nrows:Kt(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function QK(e,t,r){var n,s=ft(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Kt(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Kt(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Qe(a);var o=ft(s[4][0].data),l=lb(e,e[Ur(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?lb(e,e[Ur(o[17][0].data)][0]):[],u=ft(o[3][0].data),d=0;u[1].forEach(function(f){var h=ft(f.data),m=e[Ur(h[2][0].data)][0],g=Kt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=ZK(e,m);p.data.forEach(function(v,w){v.forEach(function(y,x){var N=Xe({r:d+w,c:x}),S=qK(y,l,c);S&&(r[N]=S)})}),d+=p.nrows})}function eY(e,t){var r=ft(t.data),n={"!ref":"A1"},s=e[Ur(r[2][0].data)],a=Kt(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return QK(e,s[0],n),n}function tY(e,t){var r,n=ft(t.data),s={name:(r=n[1])!=null&&r[0]?ix(n[1][0].data):"",sheets:[]},a=U1(n[2],Ur);return a.forEach(function(o){e[o].forEach(function(l){var c=Kt(l.meta[1][0].data);c==6e3&&s.sheets.push(eY(e,l))})}),s}function rY(e,t){var r=G1(),n=ft(t.data),s=U1(n[1],Ur);if(s.forEach(function(a){e[a].forEach(function(o){var l=Kt(o.meta[1][0].data);if(l==2){var c=tY(e,o);c.sheets.forEach(function(u,d){X1(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function bm(e){var t,r,n,s,a={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Gn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Hn(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Kt(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(c){a[c].forEach(function(u){var d=Kt(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return rY(a,l)}function nY(e,t,r){var n,s,a,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&Kt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=lo(e[7][0].data),d=0,f=[],h=lo(e[4][0].data),m=0,g=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),h.setUint16(p*2,m,!0);var v,w;switch(typeof t[p]){case"string":v=ym({t:"s",v:t[p]},r),w=wm({t:"s",v:t[p]},r);break;case"number":v=ym({t:"n",v:t[p]},r),w=wm({t:"n",v:t[p]},r);break;case"boolean":v=ym({t:"b",v:t[p]},r),w=wm({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(v),d+=v.length,g.push(w),m+=w.length,++c}for(e[2][0].data=xt(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=ui(f),e[3][0].data=ui(g),c}function sY(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=kn(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Qe(n)));var a=ff(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(M){return M.forEach(function(H){typeof H=="string"&&o.push(H)})});var l={},c=[],u=ze.read(t.numbers,{type:"base64"});u.FileIndex.map(function(M,H){return[M,u.FullPaths[H]]}).forEach(function(M){var H=M[0],G=M[1];if(H.type==2&&H.name.match(/\.iwa/)){var re=H.content,he=Gn(re),oe=Hn(he);oe.forEach(function(ce){c.push(ce.id),l[ce.id]={deps:[],location:G,type:Kt(ce.messages[0].meta[1][0].data)}})}}),c.sort(function(M,H){return M-H});var d=c.filter(function(M){return M>1}).map(function(M){return[M,xt(M)]});u.FileIndex.map(function(M,H){return[M,u.FullPaths[H]]}).forEach(function(M){var H=M[0];if(M[1],!!H.name.match(/\.iwa/)){var G=Hn(Gn(H.content));G.forEach(function(re){re.messages.forEach(function(he){d.forEach(function(oe){re.messages.some(function(ce){return Kt(ce.meta[1][0].data)!=11006&&WK(ce.data,oe[1])})&&l[oe[0]].deps.push(re.id)})})})}});for(var f=ze.find(u,l[1].location),h=Hn(Gn(f.content)),m,g=0;g<h.length;++g){var p=h[g];p.id==1&&(m=p)}var v=Ur(ft(m.messages[0].data)[1][0].data);for(f=ze.find(u,l[v].location),h=Hn(Gn(f.content)),g=0;g<h.length;++g)p=h[g],p.id==v&&(m=p);for(v=Ur(ft(m.messages[0].data)[2][0].data),f=ze.find(u,l[v].location),h=Hn(Gn(f.content)),g=0;g<h.length;++g)p=h[g],p.id==v&&(m=p);for(v=Ur(ft(m.messages[0].data)[2][0].data),f=ze.find(u,l[v].location),h=Hn(Gn(f.content)),g=0;g<h.length;++g)p=h[g],p.id==v&&(m=p);var w=ft(m.messages[0].data);{w[6][0].data=xt(n.e.r+1),w[7][0].data=xt(n.e.c+1);var y=Ur(w[46][0].data),x=ze.find(u,l[y].location),N=Hn(Gn(x.content));{for(var S=0;S<N.length&&N[S].id!=y;++S);if(N[S].id!=y)throw"Bad ColumnRowUIDMapArchive";var _=ft(N[S].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var b=0;b<=n.e.c;++b){var A=[];A[1]=A[2]=[{type:0,data:xt(b+420690)}],_[1].push({type:2,data:Cr(A)}),_[2].push({type:0,data:xt(b)}),_[3].push({type:0,data:xt(b)})}_[4]=[],_[5]=[],_[6]=[];for(var D=0;D<=n.e.r;++D)A=[],A[1]=A[2]=[{type:0,data:xt(D+726270)}],_[4].push({type:2,data:Cr(A)}),_[5].push({type:0,data:xt(D)}),_[6].push({type:0,data:xt(D)});N[S].messages[0].data=Cr(_)}x.content=Co(jo(N)),x.size=x.content.length,delete w[46];var V=ft(w[4][0].data);{V[7][0].data=xt(n.e.r+1);var P=ft(V[1][0].data),T=Ur(P[2][0].data);x=ze.find(u,l[T].location),N=Hn(Gn(x.content));{if(N[0].id!=T)throw"Bad HeaderStorageBucket";var z=ft(N[0].messages[0].data);for(D=0;D<a.length;++D){var L=ft(z[2][0].data);L[1][0].data=xt(D),L[4][0].data=xt(a[D].length),z[2][D]={type:z[2][0].type,data:Cr(L)}}N[0].messages[0].data=Cr(z)}x.content=Co(jo(N)),x.size=x.content.length;var ee=Ur(V[2][0].data);x=ze.find(u,l[ee].location),N=Hn(Gn(x.content));{if(N[0].id!=ee)throw"Bad HeaderStorageBucket";for(z=ft(N[0].messages[0].data),b=0;b<=n.e.c;++b)L=ft(z[2][0].data),L[1][0].data=xt(b),L[4][0].data=xt(n.e.r+1),z[2][b]={type:z[2][0].type,data:Cr(L)};N[0].messages[0].data=Cr(z)}x.content=Co(jo(N)),x.size=x.content.length;var j=Ur(V[4][0].data);(function(){for(var M=ze.find(u,l[j].location),H=Hn(Gn(M.content)),G,re=0;re<H.length;++re){var he=H[re];he.id==j&&(G=he)}var oe=ft(G.messages[0].data);{oe[3]=[];var ce=[];o.forEach(function(O,ve){ce[1]=[{type:0,data:xt(ve)}],ce[2]=[{type:0,data:xt(1)}],ce[3]=[{type:2,data:zK(O)}],oe[3].push({type:2,data:Cr(ce)})})}G.messages[0].data=Cr(oe);var Q=jo(H),J=Co(Q);M.content=J,M.size=M.content.length})();var U=ft(V[3][0].data);{var q=U[1][0];delete U[2];var C=ft(q.data);{var R=Ur(C[2][0].data);(function(){for(var M=ze.find(u,l[R].location),H=Hn(Gn(M.content)),G,re=0;re<H.length;++re){var he=H[re];he.id==R&&(G=he)}var oe=ft(G.messages[0].data);{delete oe[6],delete U[7];var ce=new Uint8Array(oe[5][0].data);oe[5]=[];for(var Q=0,J=0;J<=n.e.r;++J){var O=ft(ce);Q+=nY(O,a[J],o),O[1][0].data=xt(J),oe[5].push({data:Cr(O),type:2})}oe[1]=[{type:0,data:xt(n.e.c+1)}],oe[2]=[{type:0,data:xt(n.e.r+1)}],oe[3]=[{type:0,data:xt(Q)}],oe[4]=[{type:0,data:xt(n.e.r+1)}]}G.messages[0].data=Cr(oe);var ve=jo(H),ye=Co(ve);M.content=ye,M.size=M.content.length})()}q.data=Cr(C)}V[3][0].data=Cr(U)}w[4][0].data=Cr(V)}m.messages[0].data=Cr(w);var F=jo(h),E=Co(F);return f.content=E,f.size=f.content.length,u}function NE(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function V1(e){NE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function z1(e){NE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function aY(e){return nt.WS.indexOf(e)>-1?"sheet":e==nt.CS?"chart":e==nt.DS?"dialog":e==nt.MS?"macro":e&&e.length?e:"sheet"}function iY(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,aY(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function oY(e,t,r,n,s,a,o,l,c,u,d,f){try{a[n]=Pc(Fn(e,r,!0),t);var h=or(e,t),m;switch(l){case"sheet":m=TX(h,t,s,c,a[n],u,d,f);break;case"chart":if(m=AX(h,t,s,c,a[n],u,d,f),!m||!m["!drawel"])break;var g=hc(m["!drawel"].Target,t),p=hu(g),v=xz(Fn(e,g,!0),Pc(Fn(e,p,!0),g)),w=hc(v,g),y=hu(w);m=nX(Fn(e,w,!0),w,c,Pc(Fn(e,y,!0),w),u,m);break;case"macro":m=FX(h,t,s,c,a[n],u,d,f);break;case"dialog":m=PX(h,t,s,c,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=m;var x=[];a&&a[n]&&Yt(a[n]).forEach(function(N){var S="";if(a[n][N].Type==nt.CMNT){S=hc(a[n][N].Target,t);var _=LX(or(e,S,!0),S,c);if(!_||!_.length)return;X2(m,_,!1)}a[n][N].Type==nt.TCMNT&&(S=hc(a[n][N].Target,t),x=x.concat(vz(or(e,S,!0),c)))}),x&&x.length&&X2(m,x,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function zn(e){return e.charAt(0)=="/"?e.slice(1):e}function lY(e,t){if(Ol(),t=t||{},V1(t),Kn(e,"META-INF/manifest.xml")||Kn(e,"objectdata.xml"))return sb(e,t);if(Kn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof bm<"u"){if(e.FileIndex)return bm(e);var r=ze.utils.cfb_new();return m2(e).forEach(function(L){tt(r,L,Lj(e,L))}),bm(r)}throw new Error("Unsupported NUMBERS file")}if(!Kn(e,"[Content_Types].xml"))throw Kn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Kn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=m2(e),s=fB(Fn(e,"[Content_Types].xml")),a=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",or(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!or(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Dc=[],s.sst)try{Dc=RX(or(e,zn(s.sst)),s.sst,t)}catch(L){if(t.WTF)throw L}t.cellStyles&&s.themes.length&&(c=IX(Fn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=DX(or(e,zn(s.style)),s.style,c,t))}s.links.map(function(L){try{var ee=Pc(Fn(e,hu(zn(L))),L);return MX(or(e,zn(L)),ee,L,t)}catch{}});var d=EX(or(e,zn(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=or(e,zn(s.coreprops[0]),!0),h&&(f=uC(h)),s.extprops.length!==0&&(h=or(e,zn(s.extprops[0]),!0),h&&yB(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=Fn(e,zn(s.custprops[0]),!0),h&&(m=bB(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(ee){return ee.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=m),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var p={};t.bookDeps&&s.calcchain&&(p=OX(or(e,zn(s.calcchain)),s.calcchain));var v=0,w={},y,x;{var N=d.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var S=0;S!=N.length;++S)f.SheetNames[S]=N[S].name}var _=a?"bin":"xml",b=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,b+1)+"_rels/"+s.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");Kn(e,A)||(A="xl/_rels/workbook."+_+".rels");var D=Pc(Fn(e,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=BX(or(e,zn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=wz(or(e,zn(s.people[0])),t)),D&&(D=iY(D,d.Sheets));var V=or(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var P="sheet";if(D&&D[v]?(y="xl/"+D[v][1].replace(/[\/]?xl\//,""),Kn(e,y)||(y=D[v][1]),Kn(e,y)||(y=A.replace(/_rels\/.*$/,"")+D[v][1]),P=D[v][2]):(y="xl/worksheets/sheet"+(v+1-V)+"."+_,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,z=0;z!=t.sheets.length;++z)typeof t.sheets[z]=="number"&&t.sheets[z]==v&&(T=1),typeof t.sheets[z]=="string"&&t.sheets[z].toLowerCase()==f.SheetNames[v].toLowerCase()&&(T=1);if(!T)continue e}}oY(e,y,x,f.SheetNames[v],v,w,o,P,t,d,c,u)}return g={Directory:s,Workbook:d,Props:f,Custprops:m,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Dc,Styles:u,Themes:c,SSF:Ft(He)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(L,ee){L=L.replace(/^Root Entry[\/]/,""),g.keys.push(L),g.files[L]=e.FileIndex[ee]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=or(e,zn(s.vba[0]),!0):s.defaults&&s.defaults.bin===Ez&&(g.vbaraw=or(e,"xl/vbaProject.bin",!0))),g}function cY(e,t){var r=t||{},n="Workbook",s=ze.find(e,n);try{if(n="/!DataSpaces/Version",s=ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(BU(s.content),n="/!DataSpaces/DataSpaceMap",s=ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=UU(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=VU(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);WU(s.content)}catch{}if(n="/EncryptionInfo",s=ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=HU(s.content);if(n="/EncryptedPackage",s=ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function uY(e,t){return t.bookType=="ods"?bE(e,t):t.bookType=="numbers"?sY(e,t):t.bookType=="xlsb"?dY(e,t):fY(e,t)}function dY(e,t){Ko=1024,e&&!e.SSF&&(e.SSF=Ft(He)),e&&e.SSF&&(Ol(),th(e.SSF),t.revssf=nh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ic?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=YC.indexOf(t.bookType)>-1,s=E1();z1(t=t||{});var a=m1(),o="",l=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",tt(a,o,dC(e.Props,t)),s.coreprops.push(o),gt(t.rels,2,o,nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,tt(a,o,mC(e.Props)),s.extprops.push(o),gt(t.rels,3,o,nt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",tt(a,o,pC(e.Custprops)),s.custprops.push(o),gt(t.rels,4,o,nt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,tt(a,o,UX(l-1,o,t,e,d)),s.sheets.push(o),gt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(f){var m=f["!comments"],g=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,tt(a,p,WX(m,p)),s.comments.push(p),gt(d,-1,"../comments"+l+"."+r,nt.CMNT),g=!0),f["!legacy"]&&g&&tt(a,"xl/drawings/vmlDrawing"+l+".vml",XC(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&tt(a,hu(o),sl(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,tt(a,o,zX(t.Strings,o,t)),s.strs.push(o),gt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),o="xl/workbook."+r,tt(a,o,$X(e,o)),s.workbooks.push(o),gt(t.rels,1,o,nt.WB),o="xl/theme/theme1.xml",tt(a,o,I1(e.Themes,t)),s.themes.push(o),gt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),o="xl/styles."+r,tt(a,o,VX(e,o,t)),s.styles.push(o),gt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",tt(a,o,e.vbaraw),s.vba.push(o),gt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),o="xl/metadata."+r,tt(a,o,HX(o)),s.metadata.push(o),gt(t.wbrels,-1,"metadata."+r,nt.XLMETA),tt(a,"[Content_Types].xml",lC(s,t)),tt(a,"_rels/.rels",sl(t.rels)),tt(a,"xl/_rels/workbook."+r+".rels",sl(t.wbrels)),delete t.revssf,delete t.ssf,a}function fY(e,t){Ko=1024,e&&!e.SSF&&(e.SSF=Ft(He)),e&&e.SSF&&(Ol(),th(e.SSF),t.revssf=nh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ic?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=YC.indexOf(t.bookType)>-1,s=E1();z1(t=t||{});var a=m1(),o="",l=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",tt(a,o,dC(e.Props,t)),s.coreprops.push(o),gt(t.rels,2,o,nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,tt(a,o,mC(e.Props)),s.extprops.push(o),gt(t.rels,3,o,nt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",tt(a,o,pC(e.Custprops)),s.custprops.push(o),gt(t.rels,4,o,nt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,tt(a,o,iE(l-1,t,e,f)),s.sheets.push(o),gt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(h){var g=h["!comments"],p=!1,v="";if(g&&g.length>0){var w=!1;g.forEach(function(y){y[1].forEach(function(x){x.T==!0&&(w=!0)})}),w&&(v="xl/threadedComments/threadedComment"+l+"."+r,tt(a,v,yz(g,d,t)),s.threadedcomments.push(v),gt(f,-1,"../threadedComments/threadedComment"+l+"."+r,nt.TCMNT)),v="xl/comments"+l+"."+r,tt(a,v,KC(g)),s.comments.push(v),gt(f,-1,"../comments"+l+"."+r,nt.CMNT),p=!0}h["!legacy"]&&p&&tt(a,"xl/drawings/vmlDrawing"+l+".vml",XC(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&tt(a,hu(o),sl(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,tt(a,o,RC(t.Strings,t)),s.strs.push(o),gt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),o="xl/workbook."+r,tt(a,o,dE(e)),s.workbooks.push(o),gt(t.rels,1,o,nt.WB),o="xl/theme/theme1.xml",tt(a,o,I1(e.Themes,t)),s.themes.push(o),gt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),o="xl/styles."+r,tt(a,o,zC(e,t)),s.styles.push(o),gt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",tt(a,o,e.vbaraw),s.vba.push(o),gt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),o="xl/metadata."+r,tt(a,o,GC()),s.metadata.push(o),gt(t.wbrels,-1,"metadata."+r,nt.XLMETA),d.length>1&&(o="xl/persons/person.xml",tt(a,o,bz(d)),s.people.push(o),gt(t.wbrels,-1,"persons/person.xml",nt.PEOPLE)),tt(a,"[Content_Types].xml",lC(s,t)),tt(a,"_rels/.rels",sl(t.rels)),tt(a,"xl/_rels/workbook."+r+".rels",sl(t.wbrels)),delete t.revssf,delete t.ssf,a}function W1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=On(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function hY(e,t){return ze.find(e,"EncryptedPackage")?cY(e,t):pE(e,t)}function mY(e,t){var r,n=e,s=t||{};return s.type||(s.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Oj(n,s),lY(r,s)}function kE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return sx(e.slice(r),t);default:break e}return bl.to_workbook(e,t)}function pY(e,t){var r="",n=W1(e,t);switch(t.type){case"base64":r=On(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=so(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=bt(r)),t.type="binary",kE(r,t)}function xY(e,t){var r=e;return t.type=="base64"&&(r=On(r)),r=Ma.utils.decode(1200,r.slice(2),"str"),t.type="binary",kE(r,t)}function gY(e){return e.match(/[^\x00-\x7F]/)?Ms(e):e}function Nm(e,t,r,n){return n?(r.type="string",bl.to_workbook(e,r)):bl.to_workbook(t,r)}function ox(e,t){c1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ox(new Uint8Array(e),(r=Ft(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),il={},r.dateNF&&(il.dateNF=r.dateNF),r.type||(r.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=rt?"buffer":"binary",n=f9(e),typeof Uint8Array<"u"&&!rt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=gY(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Ft(r),r.type="array",ox(u1(n),r)}switch((s=W1(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return hY(ze.read(n,r),r);break;case 9:if(s[1]<=8)return pE(n,r);break;case 60:return sx(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return NU(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return DC.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?mY(n,r):Nm(e,n,r,a);case 239:return s[3]===60?sx(n,r):Nm(e,n,r,a);case 255:if(s[1]===254)return xY(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return zi.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return zi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return nx.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return $C.to_workbook(n,r);break;case 10:case 13:case 32:return pY(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bU.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?nx.to_workbook(n,r):Nm(e,n,r,a)}function _E(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Vu(t.file,ze.write(e,{type:rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ze.write(e,t)}function vY(e,t){var r=Ft(t||{}),n=uY(e,r);return yY(n,r)}function yY(e,t){var r={},n=rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?ze.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(eh(s))}return t.password&&typeof encrypt_agile<"u"?_E(encrypt_agile(s,t.password),t):t.type==="file"?Vu(t.file,s):t.type=="string"?bt(s):s}function wY(e,t){var r=t||{},n=gK(e,r);return _E(n,r)}function Ds(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return lu(Ms(n));case"binary":return Ms(n);case"string":return e;case"file":return Vu(t.file,n,"utf8");case"buffer":return rt?_a(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ds(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bY(e,t){switch(t.type){case"base64":return lu(e);case"binary":return e;case"string":return e;case"file":return Vu(t.file,e,"binary");case"buffer":return rt?_a(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Id(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?lu(r):t.type=="string"?bt(r):r;case"file":return Vu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function SE(e,t){c1(),hX(e);var r=Ft(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=SE(e,r);return r.type="array",eh(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ds(uK(e,r),r);case"slk":case"sylk":return Ds(PC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ds(gE(e.Sheets[e.SheetNames[s]],r),r);case"txt":return bY(jE(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ds(H1(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ds(DC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Id(nx.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ds(bl.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ds($C.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ds(IC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ds(bE(e,r),r);case"wk1":return Id(zi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Id(zi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Id(xE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),wY(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vY(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function NY(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function kY(e,t,r){var n=r||{};return n.type="file",n.file=t,NY(n),SE(e,n)}function _Y(e,t,r,n,s,a,o,l){var c=tr(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var g=o?e[r][m]:e[n[m]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;a[m]!=null&&(h[a[m]]=u);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[m]!=null){if(p==null)if(g.t=="e"&&p===null)h[a[m]]=null;else if(u!==void 0)h[a[m]]=u;else if(d&&p===null)h[a[m]]=null;else continue;else h[a[m]]=d&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?p:wa(g,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function ff(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=dt(d);break;case"number":c=dt(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=tr(c.s.r),h=[],m=[],g=0,p=0,v=Array.isArray(e),w=c.s.r,y=0,x={};v&&!e[w]&&(e[w]=[]);var N=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(N[y]||{}).hidden)switch(h[y]=Bt(y),r=v?e[w][y]:e[h[y]+f],n){case 1:a[y]=y-c.s.c;break;case 2:a[y]=h[y];break;case 3:a[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=wa(r,null,u),p=x[o]||0,!p)x[o]=1;else{do l=o+"_"+p++;while(x[l]);x[o]=p,x[l]=1}a[y]=l}for(w=c.s.r+s;w<=c.e.r;++w)if(!(S[w]||{}).hidden){var _=_Y(e,c,w,h,n,a,v,u);(_.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[g++]=_.row)}return m.length=g,m}var cb=/"/g;function SY(e,t,r,n,s,a,o,l){for(var c=!0,u=[],d="",f=tr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=l.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:wa(m,null,l));for(var g=0,p=0;g!==d.length;++g)if((p=d.charCodeAt(g))===s||p===a||p===34||l.forceQuotes){d='"'+d.replace(cb,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(cb,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function H1(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=dt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(f[g]=Bt(g));for(var p=0,v=s.s.r;v<=s.e.r;++v)(m[v]||{}).hidden||(d=SY(e,s,v,f,o,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function jE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=H1(e,t);return r}function jY(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=dt(e["!ref"]),a="",o=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=Bt(l);for(var d=s.s.r;d<=s.e.r;++d)for(a=tr(d),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+a,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function CE(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?$t(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(a["!ref"]){var f=dt(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+s)}else o==-1&&(o=0,d.e.r=t.length-1+s);var h=n.header||[],m=0;t.forEach(function(p,v){Yt(p).forEach(function(w){(m=h.indexOf(w))==-1&&(h[m=h.length]=w);var y=p[w],x="z",N="",S=Xe({c:l+m,r:o+v+s});u=wu(a,S),y&&typeof y=="object"&&!(y instanceof Date)?a[S]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",n.cellDates||(x="n",y=pr(y)),N=n.dateNF||He[14]):y===null&&n.nullError&&(x="e",y=0),u?(u.t=x,u.v=y,delete u.w,delete u.R,N&&(u.z=N)):a[S]=u={t:x,v:y},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var g=tr(o);if(s)for(m=0;m<h.length;++m)a[Bt(m+l)+g]={t:"s",v:h[m]};return a["!ref"]=Qe(d),a}function CY(e,t){return CE(null,e,t)}function wu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=$t(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?wu(e,Xe(t)):wu(e,Xe({r:t,c:r||0}))}function EY(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function G1(){return{SheetNames:[],Sheets:{}}}function X1(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(uE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function TY(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=EY(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function AY(e,t){return e.z=t,e}function EE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function FY(e,t,r){return EE(e,"#"+t,r)}function PY(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function DY(e,t,r,n){for(var s=typeof t!="string"?t:dt(t),a=typeof t=="string"?t:Qe(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=wu(e,o,l);c.t="n",c.F=a,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Br={encode_col:Bt,encode_row:tr,encode_cell:Xe,encode_range:Qe,decode_col:N1,decode_row:b1,split_cell:z9,decode_cell:$t,decode_range:kn,format_cell:wa,sheet_add_aoa:tC,sheet_add_json:CE,sheet_add_dom:vE,aoa_to_sheet:Ml,json_to_sheet:CY,table_to_sheet:yE,table_to_book:BK,sheet_to_csv:H1,sheet_to_txt:jE,sheet_to_json:ff,sheet_to_html:gE,sheet_to_formulae:jY,sheet_to_row_object_array:ff,sheet_get_cell:wu,book_new:G1,book_append_sheet:X1,book_set_sheet_visibility:TY,cell_set_number_format:AY,cell_set_hyperlink:EE,cell_set_internal_link:FY,cell_add_comment:PY,sheet_set_array_formula:DY,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class IY{constructor(){this.requiredSheets=["Branches","Checkers","Customers","Products","Installments","Payments","Collections"]}async readExcelFile(t){return new Promise((r,n)=>{const s=new FileReader;s.onload=a=>{try{const o=new Uint8Array(a.target.result),l=ox(o,{type:"array"}),c={};this.requiredSheets.forEach(u=>{if(l.SheetNames.includes(u)){const d=l.Sheets[u],f=Br.sheet_to_json(d,{header:1,defval:""});if(f.length>1){const h=f[0],m=f.slice(1);c[u]=m.map(g=>{const p={};return h.forEach((v,w)=>{p[v]=g[w]||""}),p}).filter(g=>{const p=Object.keys(g)[0];return g[p]&&g[p].toString().trim()!==""})}else c[u]=[]}else c[u]=[]}),r(c)}catch(o){n(new Error(` Excel : ${o.message}`))}},s.onerror=()=>{n(new Error(""))},s.readAsArrayBuffer(t)})}validateData(t){const r=[];if(this.requiredSheets.forEach(n=>{(!t[n]||t[n].length===0)&&["Installments","Customers"].includes(n)&&r.push(`Sheet "${n}" `)}),t.Branches&&t.Branches.length>0&&t.Branches.forEach((n,s)=>{(!n.branch_code||!n.branch_name)&&r.push(`Branches  ${s+2}:  branch_code  branch_name`)}),t.Customers&&t.Customers.length>0){const n=new Set,s=new Set;t.Customers.forEach((a,o)=>{const l=o+2;(!a.customer_code||!a.name||!a.id_card)&&r.push(`Customers  ${l}:  customer_code, name  id_card`),a.customer_code&&(n.has(a.customer_code)&&r.push(`Customers  ${l}: customer_code "${a.customer_code}" `),n.add(a.customer_code)),a.id_card&&(s.has(a.id_card)&&r.push(`Customers  ${l}: id_card "${a.id_card}" `),s.add(a.id_card)),a.id_card&&a.id_card.length!==13&&r.push(`Customers  ${l}: id_card  13 `)})}if(t.Installments&&t.Installments.length>0){const n=new Set;t.Installments.forEach((s,a)=>{const o=a+2;(!s.contract_number||!s.customer_code||!s.total_amount)&&r.push(`Installments  ${o}:  contract_number, customer_code  total_amount`),s.contract_number&&(n.has(s.contract_number)&&r.push(`Installments  ${o}: contract_number "${s.contract_number}" `),n.add(s.contract_number)),s.total_amount&&isNaN(parseFloat(s.total_amount))&&r.push(`Installments  ${o}: total_amount `),s.installment_amount&&isNaN(parseFloat(s.installment_amount))&&r.push(`Installments  ${o}: installment_amount `),s.start_date&&!this.isValidDate(s.start_date)&&r.push(`Installments  ${o}: start_date  ( YYYY-MM-DD)`),s.end_date&&!this.isValidDate(s.end_date)&&r.push(`Installments  ${o}: end_date  ( YYYY-MM-DD)`)})}return t.Payments&&t.Payments.length>0&&t.Payments.forEach((n,s)=>{const a=s+2;(!n.contract_number||!n.amount||!n.due_date)&&r.push(`Payments  ${a}:  contract_number, amount  due_date`),n.amount&&isNaN(parseFloat(n.amount))&&r.push(`Payments  ${a}: amount `),n.due_date&&!this.isValidDate(n.due_date)&&r.push(`Payments  ${a}: due_date  ( YYYY-MM-DD)`),n.payment_date&&n.payment_date!==""&&!this.isValidDate(n.payment_date)&&r.push(`Payments  ${a}: payment_date  ( YYYY-MM-DD)`)}),r}isValidDate(t){if(!t)return!1;const r=new Date(t);return r instanceof Date&&!isNaN(r)&&t.match(/^\d{4}-\d{2}-\d{2}$/)}async importData(t,r){const n={success:0,errors:[],summary:{}};try{if(t.Branches&&t.Branches.length>0){r==null||r(" import ...");const s=await this.importBranches(t.Branches);n.summary.branches=s}if(t.Checkers&&t.Checkers.length>0){r==null||r(" import ...");const s=await this.importCheckers(t.Checkers);n.summary.checkers=s}if(t.Customers&&t.Customers.length>0){r==null||r(" import ...");const s=await this.importCustomers(t.Customers);n.summary.customers=s}if(t.Products&&t.Products.length>0){r==null||r(" import ...");const s=await this.importProducts(t.Products);n.summary.products=s}if(t.Installments&&t.Installments.length>0){r==null||r(" import ...");const s=await this.importInstallments(t.Installments);n.summary.installments=s}if(t.Payments&&t.Payments.length>0){r==null||r(" import ...");const s=await this.importPayments(t.Payments);n.summary.payments=s}if(t.Collections&&t.Collections.length>0){r==null||r(" import ...");const s=await this.importCollections(t.Collections);n.summary.collections=s}r==null||r("Import !"),n.success=1}catch(s){n.errors.push(` import: ${s.message}`)}return n}async importBranches(t){const r={success:0,errors:[]};for(const n of t)try{const s=await _e.post("/branches",{name:n.branch_name,address:n.address||"",phone:n.phone||"",manager:n.manager||""});s.data.success?r.success++:r.errors.push(` ${n.branch_code}: ${s.data.message}`)}catch(s){r.errors.push(` ${n.branch_code}: ${s.message}`)}return r}async importCustomers(t){const r={success:0,errors:[]};for(const n of t)try{const s=await _e.post("/customers",{code:n.customer_code,name:n.name,surname:n.surname||"",full_name:`${n.name} ${n.surname||""}`.trim(),id_card:n.id_card,nickname:n.nickname||"",phone:n.phone||"",email:n.email||"",address:n.address||"",guarantor_name:n.guarantor_name||"",guarantor_id_card:n.guarantor_id_card||"",guarantor_phone:n.guarantor_phone||"",guarantor_address:n.guarantor_address||""});s.data.success?r.success++:r.errors.push(` ${n.customer_code}: ${s.data.message}`)}catch(s){r.errors.push(` ${n.customer_code}: ${s.message}`)}return r}async importInstallments(t){const r={success:0,errors:[]};for(const n of t)try{const s=await _e.post("/installments",{contract_number:n.contract_number,customer_code:n.customer_code,product_name:n.product_name,total_amount:parseFloat(n.total_amount),installment_amount:parseFloat(n.installment_amount),installment_period:parseInt(n.installment_period),start_date:n.start_date,end_date:n.end_date,status:n.status||"active"});s.data.success?r.success++:r.errors.push(` ${n.contract_number}: ${s.data.message}`)}catch(s){r.errors.push(` ${n.contract_number}: ${s.message}`)}return r}async importPayments(t){const r={success:0,errors:[]};for(const n of t)try{const s=await _e.post("/payments",{contract_number:n.contract_number,amount:parseFloat(n.amount),due_date:n.due_date,payment_date:n.payment_date||null,status:n.status||"pending",notes:n.notes||""});s.data.success?r.success++:r.errors.push(` ${n.contract_number}: ${s.data.message}`)}catch(s){r.errors.push(` ${n.contract_number}: ${s.message}`)}return r}async importCollections(t){const r={success:0,errors:[]};for(const n of t)try{const s=await _e.post("/payment-collections",{contract_number:n.contract_number,checker_code:n.checker_code,amount:parseFloat(n.amount_collected),payment_date:n.collection_date,notes:n.notes||""});s.data.success?r.success++:r.errors.push(` ${n.contract_number}: ${s.data.message}`)}catch(s){r.errors.push(` ${n.contract_number}: ${s.message}`)}return r}generateTemplate(){const t=Br.book_new(),r=[["branch_code*","branch_name*","address","phone","manager"],["BR001","","123   10110","02-123-4567"," "],["BR002","","456   10240","02-234-5678"," "]],n=Br.aoa_to_sheet(r);Br.book_append_sheet(t,n,"Branches");const s=[["checker_code*","name*","surname","phone","email","branch_code*"],["CHK001","","","081-111-1111","anuchit@example.com","BR001"],["CHK002","","","081-222-2222","udomsak@example.com","BR001"]],a=Br.aoa_to_sheet(s);Br.book_append_sheet(t,a,"Checkers");const o=[["customer_code*","name*","surname","id_card*","nickname","phone","email","address","guarantor_name","guarantor_id_card","guarantor_phone","guarantor_address","branch_code*","checker_code*"],["CUST001","","","1234567890123","","082-111-1111","customer1@example.com","123  "," ","9876543210987","082-222-2222","456  ","BR001","CHK001"]],l=Br.aoa_to_sheet(o);Br.book_append_sheet(t,l,"Customers");const c=[["product_code*","product_name*","description","price*","branch_code*"],["PROD001"," Samsung Galaxy S21"," Samsung","25000.00","BR001"]],u=Br.aoa_to_sheet(c);Br.book_append_sheet(t,u,"Products");const d=[["contract_number*","customer_code*","product_code","product_name*","total_amount*","installment_amount*","installment_period*","start_date*","end_date*","status*","branch_code*","salesperson_name"],["CT2401001","CUST001","PROD001"," Samsung Galaxy S21","25000.00","2500.00","10","2024-01-01","2024-10-01","active","BR001",""]],f=Br.aoa_to_sheet(d);Br.book_append_sheet(t,f,"Installments");const h=[["contract_number*","payment_sequence*","amount*","due_date*","payment_date","status*","notes"],["CT2401001","1","2500.00","2024-01-01","2024-01-01","paid"," 1"],["CT2401001","2","2500.00","2024-02-01","2024-02-01","paid"," 2"],["CT2401001","3","2500.00","2024-03-01","","pending",""],["CT2401001","4","2500.00","2024-04-01","","pending",""]],m=Br.aoa_to_sheet(h);Br.book_append_sheet(t,m,"Payments");const g=[["contract_number*","payment_sequence*","checker_code*","amount_collected*","collection_date*","notes"],["CT2401001","1","CHK001","2500.00","2024-01-01"," 1"],["CT2401001","2","CHK001","2500.00","2024-02-01"," 2"]],p=Br.aoa_to_sheet(g);return Br.book_append_sheet(t,p,"Collections"),t}downloadTemplate(){const t=this.generateTemplate();kY(t,"import_template.xlsx")}}const ac=new IY,RY=({onBack:e})=>{const[t,r]=k.useState(null),[n,s]=k.useState(!1),[a,o]=k.useState(0),[l,c]=k.useState(""),[u,d]=k.useState([]),[f,h]=k.useState(null),[m,g]=k.useState("select"),p=k.useRef(null),v=S=>{const _=S.target.files[0];_&&(_.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||_.type==="application/vnd.ms-excel"?(r(_),d([]),h(null),g("validate"),w(_)):we({title:"",description:" Excel (.xlsx  .xls)",variant:"destructive"}))},w=async S=>{try{s(!0),c("..."),o(20);const _=await ac.readExcelFile(S);o(50),c("...");const b=ac.validateData(_);o(100),c(""),b.length>0?(d(b),g("validate")):(d([]),g("ready"))}catch(_){we({title:"",description:_.message,variant:"destructive"}),g("select")}finally{s(!1),o(0),c("")}},y=async()=>{if(t)try{s(!0),g("import"),o(0);const S=await ac.readExcelFile(t),_=await ac.importData(S,b=>{c(b),o(A=>Math.min(A+10,90))});o(100),c("Import !"),h(_),g("complete"),_.success&&we({title:"Import ",description:" import ",variant:"default"})}catch(S){we({title:" Import",description:S.message,variant:"destructive"}),g("ready")}finally{s(!1)}},x=()=>{ac.downloadTemplate(),we({title:"",description:" template ",variant:"default"})},N=()=>{r(null),s(!1),o(0),c(""),d([]),h(null),g("select"),p.current&&(p.current.value="")};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[i.jsxs(ae,{variant:"ghost",size:"sm",onClick:e,className:"flex items-center gap-2",children:[i.jsx(ai,{className:"h-4 w-4"}),""]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import "}),i.jsx("p",{className:"text-gray-600 mt-2",children:" Excel"})]})]}),i.jsxs(yr,{className:"mb-6",children:[i.jsxs(Zn,{children:[i.jsxs(Qn,{className:"flex items-center gap-2",children:[i.jsx(zs,{className:"h-5 w-5 text-blue-600"})," 1:  Template"]}),i.jsx(Os,{children:" template Excel "})]}),i.jsx(wr,{children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(ae,{onClick:x,className:"flex items-center gap-2",variant:"outline",children:[i.jsx(tm,{className:"h-4 w-4"})," Template Excel"]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("p",{children:"  template  7 sheets: Branches, Checkers, Customers, Products, Installments, Payments, Collections"}),i.jsx("p",{children:"  * "}),i.jsx("p",{children:" : YYYY-MM-DD"})]})]})})]}),i.jsxs(yr,{className:"mb-6",children:[i.jsxs(Zn,{children:[i.jsxs(Qn,{className:"flex items-center gap-2",children:[i.jsx($p,{className:"h-5 w-5 text-green-600"})," 2: "]}),i.jsx(Os,{children:" Excel  import"})]}),i.jsx(wr,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[i.jsx("input",{ref:p,type:"file",accept:".xlsx,.xls",onChange:v,className:"hidden",id:"file-upload"}),i.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center gap-4",children:[i.jsx(tm,{className:"h-12 w-12 text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-medium text-gray-900",children:" Excel"}),i.jsx("p",{className:"text-sm text-gray-500",children:" .xlsx  .xls "})]})]})]}),t&&i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg",children:[i.jsx(tm,{className:"h-5 w-5 text-blue-600"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium text-blue-900",children:t.name}),i.jsxs("p",{className:"text-sm text-blue-600",children:[": ",(t.size/1024/1024).toFixed(2)," MB"]})]}),i.jsx(ae,{variant:"ghost",size:"sm",onClick:N,className:"text-blue-600 hover:text-blue-800",children:""})]})]})})]}),n&&i.jsx(yr,{className:"mb-6",children:i.jsx(wr,{className:"pt-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Pt,{className:"h-5 w-5 animate-spin text-blue-600"}),i.jsx("span",{className:"font-medium",children:l})]}),i.jsx(vj,{value:a,className:"w-full"})]})})}),u.length>0&&i.jsxs(yr,{className:"mb-6 border-red-200",children:[i.jsxs(Zn,{children:[i.jsxs(Qn,{className:"flex items-center gap-2 text-red-600",children:[i.jsx(Uf,{className:"h-5 w-5"}),""]}),i.jsx(Os,{children:" import"})]}),i.jsx(wr,{children:i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:u.map((S,_)=>i.jsxs(s0,{variant:"destructive",children:[i.jsx(Qd,{className:"h-4 w-4"}),i.jsx(a0,{children:S})]},_))})})]}),m==="ready"&&i.jsxs(yr,{className:"mb-6 border-green-200",children:[i.jsxs(Zn,{children:[i.jsxs(Qn,{className:"flex items-center gap-2 text-green-600",children:[i.jsx(ts,{className:"h-5 w-5"}),"  Import"]}),i.jsx(Os,{children:"  import "})]}),i.jsx(wr,{children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(ae,{onClick:y,disabled:n,className:"flex items-center gap-2",children:[n?i.jsx(Pt,{className:"h-4 w-4 animate-spin"}):i.jsx($p,{className:"h-4 w-4"})," Import "]}),i.jsxs(s0,{children:[i.jsx(Sw,{className:"h-4 w-4"}),i.jsx(a0,{children:" import  "})]})]})})]}),f&&i.jsxs(yr,{className:"mb-6",children:[i.jsx(Zn,{children:i.jsxs(Qn,{className:"flex items-center gap-2",children:[i.jsx(ts,{className:"h-5 w-5 text-green-600"})," Import"]})}),i.jsx(wr,{children:i.jsxs("div",{className:"space-y-4",children:[f.summary&&i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(f.summary).map(([S,_])=>i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:S}),i.jsxs("p",{className:"text-lg font-bold text-green-600",children:[_.success," "]}),_.errors&&_.errors.length>0&&i.jsxs("p",{className:"text-sm text-red-600",children:[_.errors.length," "]})]},S))}),f.errors&&f.errors.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"font-medium text-red-600",children:":"}),i.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:f.errors.map((S,_)=>i.jsx(s0,{variant:"destructive",children:i.jsx(a0,{className:"text-sm",children:S})},_))})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx(ae,{onClick:N,variant:"outline",children:"Import "}),i.jsx(ae,{onClick:e,children:""})]})]})})]}),i.jsxs(yr,{children:[i.jsx(Zn,{children:i.jsxs(Qn,{className:"flex items-center gap-2",children:[i.jsx(Sw,{className:"h-5 w-5 text-blue-600"}),""]})}),i.jsx(wr,{children:i.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:":"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[i.jsx("li",{children:' Sheet "Installments" '}),i.jsx("li",{children:' Sheet "Payments"  ()'}),i.jsx("li",{children:' Sheet "Collections" '})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:":"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[i.jsx("li",{children:": YYYY-MM-DD ( 2024-01-15)"}),i.jsx("li",{children:":  ( 25000.50)"}),i.jsx("li",{children:": paid, pending, overdue, cancelled"}),i.jsx("li",{children:": active, completed, cancelled, overdue"})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:":"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[i.jsx("li",{children:" template"}),i.jsx("li",{children:" * "}),i.jsx("li",{children:" (customer_code, contract_number) "}),i.jsx("li",{children:" 13 "})]})]})]})})]})]})})};class LY{async getAll(t=null){try{const r=t?{branch_id:t}:{},n=await _e.get("/admin-users",{params:r});return n.data.success&&n.data.data?{data:n.data.data,total:n.data.total}:{data:[],total:0}}catch(r){throw console.error("Error fetching admin users:",r),new Error("")}}async getById(t){try{return(await _e.get(`/admin-users/${t}`)).data}catch(r){throw console.error("Error fetching admin user:",r),new Error("")}}async create(t){var r,n;try{return(await _e.post("/admin-users",{username:t.username,email:t.email,password:t.password,full_name:t.full_name,role:t.role,branch_id:t.branch_id,permissions:t.permissions||[],is_active:t.is_active!==void 0?t.is_active:!0})).data}catch(s){throw console.error("Error creating admin user:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("")}}async update(t,r){var n,s;try{return(await _e.put(`/admin-users/${t}`,{username:r.username,email:r.email,full_name:r.full_name,role:r.role,branch_id:r.branch_id,permissions:r.permissions||[],is_active:r.is_active})).data}catch(a){throw console.error("Error updating admin user:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("")}}async delete(t){var r,n;try{return(await _e.delete(`/admin-users/${t}`)).data}catch(s){throw console.error("Error deleting admin user:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("")}}async toggleStatus(t,r){try{return(await _e.patch(`/admin-users/${t}/status`,{is_active:r})).data}catch(n){throw console.error("Error toggling user status:",n),new Error("")}}async resetPassword(t){try{return(await _e.post(`/admin-users/${t}/reset-password`)).data.new_password}catch(r){throw console.error("Error resetting password:",r),new Error("")}}async changePassword(t,r,n){var s,a;try{return(await _e.post(`/admin-users/${t}/change-password`,{current_password:r,new_password:n})).data}catch(o){throw console.error("Error changing password:",o),(a=(s=o.response)==null?void 0:s.data)!=null&&a.message?new Error(o.response.data.message):new Error("")}}async getAvailablePermissions(){try{return(await _e.get("/admin-users/permissions")).data}catch(t){return console.error("Error fetching permissions:",t),{data:[{id:"dashboard.view",name:"",category:"dashboard"},{id:"branches.view",name:"",category:"branches"},{id:"branches.create",name:"",category:"branches"},{id:"branches.edit",name:"",category:"branches"},{id:"branches.delete",name:"",category:"branches"},{id:"customers.view",name:"",category:"customers"},{id:"customers.create",name:"",category:"customers"},{id:"customers.edit",name:"",category:"customers"},{id:"customers.delete",name:"",category:"customers"},{id:"products.view",name:"",category:"products"},{id:"products.create",name:"",category:"products"},{id:"products.edit",name:"",category:"products"},{id:"products.delete",name:"",category:"products"},{id:"contracts.view",name:"",category:"contracts"},{id:"contracts.create",name:"",category:"contracts"},{id:"contracts.edit",name:"",category:"contracts"},{id:"contracts.delete",name:"",category:"contracts"},{id:"payments.view",name:"",category:"payments"},{id:"payments.create",name:"",category:"payments"},{id:"payments.edit",name:"",category:"payments"},{id:"reports.view",name:"",category:"reports"},{id:"reports.export",name:"",category:"reports"},{id:"settings.view",name:"",category:"settings"},{id:"settings.edit",name:"",category:"settings"},{id:"users.view",name:"",category:"users"},{id:"users.create",name:"",category:"users"},{id:"users.edit",name:"",category:"users"},{id:"users.delete",name:"",category:"users"}]}}}getRoles(){return[{id:"super_admin",name:"Super Admin",description:""},{id:"admin",name:"Admin",description:""},{id:"manager",name:"Manager",description:""},{id:"user",name:"User",description:""}]}async checkPermission(t,r){try{return(await _e.get(`/admin-users/${t}/permissions/${r}`)).data.has_permission}catch(n){return console.error("Error checking permission:",n),!1}}async getCurrentUser(){try{return(await _e.get("/admin-users/me")).data}catch(t){throw console.error("Error fetching current user:",t),new Error("")}}async updateProfile(t){var r,n;try{return(await _e.put("/admin-users/me",t)).data}catch(s){throw console.error("Error updating profile:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("")}}}const Ra=new LY,Ti={getAll:async(e={})=>{try{return(await _e.get("/branches",{params:e})).data}catch(t){throw t}},getById:async e=>{try{return(await _e.get(`/branches/${e}`)).data}catch(t){throw t}},create:async e=>{try{return(await _e.post("/branches",e)).data}catch(t){throw t}},update:async(e,t)=>{try{return(await _e.put(`/branches/${e}`,t)).data}catch(r){throw r}},delete:async e=>{try{return(await _e.delete(`/branches/${e}`)).data}catch(t){throw t}},getStatistics:async e=>{try{return(await _e.get(`/branches/${e}/statistics`)).data}catch(t){throw t}},getCheckers:async(e,t={})=>{try{return(await _e.get(`/branches/${e}/checkers`,{params:t})).data}catch(r){throw r}},getCustomers:async(e,t={})=>{try{return(await _e.get(`/branches/${e}/customers`,{params:t})).data}catch(r){throw r}},getInstallments:async(e,t={})=>{try{return(await _e.get(`/branches/${e}/installments`,{params:t})).data}catch(r){throw r}},getCollections:async(e,t={})=>{try{return(await _e.get(`/branches/${e}/collections`,{params:t})).data}catch(r){throw r}}},OY=({user:e,onSubmit:t,onCancel:r,currentBranch:n})=>{const[s,a]=k.useState({username:"",email:"",password:"",confirmPassword:"",full_name:"",role:"user",branch_id:"",permissions:[],is_active:!0}),[o,l]=k.useState(!1),[c,u]=k.useState(!1),[d,f]=k.useState(!1),[h,m]=k.useState([]),[g,p]=k.useState([]),[v,w]=k.useState({}),y=Ra.getRoles();k.useEffect(()=>{x(),N(),e&&a({username:e.username||"",email:e.email||"",password:"",confirmPassword:"",full_name:e.full_name||"",role:e.role||"user",branch_id:e.branch_id||"",permissions:e.permissions||[],is_active:e.is_active!==void 0?e.is_active:!0})},[e]);const x=async()=>{try{const P=await Ti.getAll();m(P.data||[])}catch(P){console.error("Error loading branches:",P)}},N=async()=>{try{const P=await Ra.getAvailablePermissions();p(P.data||[])}catch(P){console.error("Error loading permissions:",P)}},S=P=>{const{name:T,value:z,type:L,checked:ee}=P.target;a(j=>({...j,[T]:L==="checkbox"?ee:z})),v[T]&&w(j=>({...j,[T]:""}))},_=(P,T)=>{a(z=>({...z,permissions:T?[...z.permissions,P]:z.permissions.filter(L=>L!==P)}))},b=()=>{const P={};return s.username.trim()?s.username.length<3&&(P.username=" 3 "):P.username="",s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(P.email=""):P.email="",e||(s.password?s.password.length<6&&(P.password=" 6 "):P.password="",s.password!==s.confirmPassword&&(P.confirmPassword="")),s.full_name.trim()||(P.full_name="-"),w(P),Object.keys(P).length===0},A=async P=>{if(P.preventDefault(),!!b()){f(!0);try{await t(s)}catch(T){console.error("Error submitting form:",T)}finally{f(!1)}}},D=g.reduce((P,T)=>(P[T.category]||(P[T.category]=[]),P[T.category].push(T),P),{}),V=P=>({dashboard:"",branches:"",customers:"",products:"",contracts:"",payments:"",reports:"",settings:"",users:""})[P]||P;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(ae,{variant:"ghost",size:"sm",onClick:r,className:"flex items-center gap-2",children:[i.jsx(ai,{className:"h-4 w-4"}),""]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"":""}),i.jsx("p",{className:"text-gray-600 mt-2",children:e?"":""})]})]}),i.jsxs("form",{onSubmit:A,className:"space-y-6",children:[i.jsxs(yr,{children:[i.jsxs(Zn,{children:[i.jsxs(Qn,{className:"flex items-center gap-2",children:[i.jsx(br,{className:"h-5 w-5"}),""]}),i.jsx(Os,{children:""})]}),i.jsxs(wr,{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"text",name:"username",value:s.username,onChange:S,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.username?"border-red-500":"border-gray-300"}`,placeholder:""}),v.username&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.username})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"email",name:"email",value:s.email,onChange:S,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.email?"border-red-500":"border-gray-300"}`,placeholder:""}),v.email&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.email})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"- *"}),i.jsx("input",{type:"text",name:"full_name",value:s.full_name,onChange:S,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.full_name?"border-red-500":"border-gray-300"}`,placeholder:"-"}),v.full_name&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.full_name})]}),!e&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:o?"text":"password",name:"password",value:s.password,onChange:S,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.password?"border-red-500":"border-gray-300"}`,placeholder:""}),i.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?i.jsx(Op,{className:"h-4 w-4"}):i.jsx(au,{className:"h-4 w-4"})})]}),v.password&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.password})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:c?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:S,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${v.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:""}),i.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?i.jsx(Op,{className:"h-4 w-4"}):i.jsx(au,{className:"h-4 w-4"})})]}),v.confirmPassword&&i.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.confirmPassword})]})]})]})]}),i.jsxs(yr,{children:[i.jsxs(Zn,{children:[i.jsxs(Qn,{className:"flex items-center gap-2",children:[i.jsx(Nn,{className:"h-5 w-5"}),""]}),i.jsx(Os,{children:""})]}),i.jsxs(wr,{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("select",{name:"role",value:s.role,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:y.map(P=>i.jsxs("option",{value:P.id,children:[P.name," - ",P.description]},P.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{name:"branch_id",value:s.branch_id,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),h.map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:"is_active",name:"is_active",checked:s.is_active,onChange:S,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:""})]})]})]}),i.jsxs(yr,{children:[i.jsxs(Zn,{children:[i.jsxs(Qn,{className:"flex items-center gap-2",children:[i.jsx(eo,{className:"h-5 w-5"}),""]}),i.jsx(Os,{children:" "})]}),i.jsx(wr,{children:i.jsx("div",{className:"space-y-6",children:Object.entries(D).map(([P,T])=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:V(P)}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:T.map(z=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:z.id,checked:s.permissions.includes(z.id),onChange:L=>_(z.id,L.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("label",{htmlFor:z.id,className:"text-sm text-gray-700",children:z.name})]},z.id))})]},P))})})]}),i.jsxs("div",{className:"flex items-center justify-end gap-4",children:[i.jsx(ae,{type:"button",variant:"outline",onClick:r,children:""}),i.jsxs(ae,{type:"submit",disabled:d,className:"flex items-center gap-2",children:[d?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):i.jsx(II,{className:"h-4 w-4"}),e?"":"",""]})]})]})]})},MY=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(""),[c,u]=k.useState(!1),[d,f]=k.useState(null);k.useState([]),k.useEffect(()=>{h()},[e]);const h=async()=>{try{a(!0);const A=(await Ra.getAll(e)).data||[];n(A)}catch(b){console.error("Error loading admin users:",b),we({title:"",description:"",variant:"destructive"})}finally{a(!1)}},m=()=>{f(null),u(!0)},g=b=>{f(b),u(!0)},p=async b=>{if(window.confirm("?"))try{await Ra.delete(b),we({title:"",description:"",variant:"default"}),h()}catch{we({title:"",description:"",variant:"destructive"})}},v=async(b,A)=>{try{await Ra.toggleStatus(b,!A),we({title:"",description:`${A?"":""}`,variant:"default"}),h()}catch{we({title:"",description:"",variant:"destructive"})}},w=async b=>{if(window.confirm("?"))try{const A=await Ra.resetPassword(b);we({title:"",description:` : ${A}`,variant:"default"})}catch{we({title:"",description:"",variant:"destructive"})}},y=async b=>{try{d?(await Ra.update(d.id,b),we({title:"",description:"",variant:"default"})):(await Ra.create(b),we({title:"",description:"",variant:"default"})),u(!1),f(null),h()}catch(A){we({title:"",description:A.message||"",variant:"destructive"})}},x=r.filter(b=>{var A,D,V,P;return((A=b.username)==null?void 0:A.toLowerCase().includes(o.toLowerCase()))||((D=b.email)==null?void 0:D.toLowerCase().includes(o.toLowerCase()))||((V=b.full_name)==null?void 0:V.toLowerCase().includes(o.toLowerCase()))||((P=b.role)==null?void 0:P.toLowerCase().includes(o.toLowerCase()))}),N=b=>{switch(b){case"super_admin":return i.jsx(kw,{className:"h-4 w-4 text-yellow-600"});case"admin":return i.jsx(RI,{className:"h-4 w-4 text-blue-600"});case"manager":return i.jsx(Nn,{className:"h-4 w-4 text-green-600"});case"user":return i.jsx(br,{className:"h-4 w-4 text-gray-600"});default:return i.jsx(br,{className:"h-4 w-4 text-gray-600"})}},S=b=>{switch(b){case"super_admin":return"Super Admin";case"admin":return"Admin";case"manager":return"Manager";case"user":return"User";default:return"User"}},_=b=>{switch(b){case"super_admin":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"admin":return"bg-blue-100 text-blue-800 border-blue-200";case"manager":return"bg-green-100 text-green-800 border-green-200";case"user":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return c?i.jsx(OY,{user:d,onSubmit:y,onCancel:()=>{u(!1),f(null)},currentBranch:t}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:" Admin"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"  "})]}),i.jsxs(ae,{onClick:m,className:"flex items-center gap-2",children:[i.jsx(BI,{className:"h-4 w-4"}),""]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx(yr,{children:i.jsx(wr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:i.jsx(gn,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})})}),i.jsx(yr,{children:i.jsx(wr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:i.jsx(jw,{className:"h-6 w-6 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(b=>b.is_active).length})]})]})})}),i.jsx(yr,{children:i.jsx(wr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:i.jsx(Mp,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(b=>!b.is_active).length})]})]})})}),i.jsx(yr,{children:i.jsx(wr,{className:"p-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:i.jsx(kw,{className:"h-6 w-6 text-yellow-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Admin"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(b=>["admin","super_admin"].includes(b.role)).length})]})]})})})]}),i.jsx(yr,{children:i.jsx(wr,{className:"p-6",children:i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs("div",{className:"relative flex-1",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),i.jsx("input",{type:"text",placeholder:"...",value:o,onChange:b=>l(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})})}),i.jsxs(yr,{children:[i.jsxs(Zn,{children:[i.jsx(Qn,{children:""}),i.jsxs(Os,{children:[" ",x.length," "]})]}),i.jsx(wr,{children:s?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):x.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(gn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-500",children:""})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:""}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:""}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:""}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:""}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:""}),i.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:""})]})}),i.jsx("tbody",{children:x.map(b=>{var A,D;return i.jsxs($e.tr,{initial:{opacity:0},animate:{opacity:1},className:"border-b border-gray-100 hover:bg-gray-50",children:[i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-medium",children:((A=b.full_name)==null?void 0:A.charAt(0))||((D=b.username)==null?void 0:D.charAt(0))||"U"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:b.full_name||b.username}),i.jsx("p",{className:"text-sm text-gray-500",children:b.email}),i.jsxs("p",{className:"text-xs text-gray-400",children:["@",b.username]})]})]})}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[N(b.role),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${_(b.role)}`,children:S(b.role)})]})}),i.jsx("td",{className:"py-4 px-4",children:i.jsx("span",{className:"text-sm text-gray-900",children:b.branch_name||""})}),i.jsx("td",{className:"py-4 px-4",children:i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.is_active?"":""})}),i.jsx("td",{className:"py-4 px-4",children:i.jsx("span",{className:"text-sm text-gray-500",children:b.last_login?new Date(b.last_login).toLocaleDateString("th-TH"):""})}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>g(b),className:"text-blue-600 hover:text-blue-800",children:i.jsx(Cs,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>v(b.id,b.is_active),className:b.is_active?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800",children:b.is_active?i.jsx(Mp,{className:"h-4 w-4"}):i.jsx(jw,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>w(b.id),className:"text-orange-600 hover:text-orange-800",children:i.jsx(eo,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>p(b.id),className:"text-red-600 hover:text-red-800",children:i.jsx(ka,{className:"h-4 w-4"})})]})})]},b.id)})})]})})})]})]})},Rd=({title:e,icon:t,children:r})=>{const n=t;return i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(n,{className:"w-5 h-5 text-purple-600"}),e]}),r]})},it=({label:e,value:t,onChange:r,placeholder:n,type:s="text",required:a=!1})=>i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsx("input",{type:s,value:t,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:n,required:a})]}),Eo=({label:e,value:t,onChange:r,options:n,placeholder:s,required:a=!1})=>{const[o,l]=k.useState(""),[c,u]=k.useState(!1),[d,f]=k.useState(n);console.log(` SearchableSelectField [${e}]:`,{optionsCount:(n==null?void 0:n.length)||0,options:n,value:t,isOpen:c,searchTerm:o,optionsType:typeof n,isArray:Array.isArray(n),optionsSample:n==null?void 0:n.slice(0,3),optionsKeys:n!=null&&n[0]?Object.keys(n[0]):[],optionsStatuses:n==null?void 0:n.map(m=>({id:m.id,status:m.status,qty:m.remaining_quantity1,name:m.product_name||m.name})),optionsWithData:n==null?void 0:n.filter(m=>m.product_name||m.name),optionsWithoutData:n==null?void 0:n.filter(m=>!m.product_name&&!m.name),optionsWithDataAndActive:n==null?void 0:n.filter(m=>m.status==="active"&&(m.product_name||m.name)),optionsWithDataAndQty:n==null?void 0:n.filter(m=>Number(m.remaining_quantity1)>0&&(m.product_name||m.name))}),k.useEffect(()=>{console.log(` SearchableSelectField [${e}] useEffect:`,{options:n,searchTerm:o,optionsLength:(n==null?void 0:n.length)||0,optionsSample:n==null?void 0:n.slice(0,3),optionsKeys:n!=null&&n[0]?Object.keys(n[0]):[],optionsWithData:n==null?void 0:n.filter(g=>g.product_name||g.name),optionsWithoutData:n==null?void 0:n.filter(g=>!g.product_name&&!g.name),optionsWithDataAndActive:n==null?void 0:n.filter(g=>g.status==="active"&&(g.product_name||g.name)),optionsWithDataAndQty:n==null?void 0:n.filter(g=>Number(g.remaining_quantity1)>0&&(g.product_name||g.name))});const m=n.filter(g=>{var p,v,w,y,x,N,S,_,b;return((p=g.displayName)==null?void 0:p.toLowerCase().includes(o.toLowerCase()))||((v=g.name)==null?void 0:v.toLowerCase().includes(o.toLowerCase()))||((w=g.product_name)==null?void 0:w.toLowerCase().includes(o.toLowerCase()))||((y=g.full_name)==null?void 0:y.toLowerCase().includes(o.toLowerCase()))||((x=g.fullName)==null?void 0:x.toLowerCase().includes(o.toLowerCase()))||((N=g.phone)==null?void 0:N.toLowerCase().includes(o.toLowerCase()))||((S=g.nickname)==null?void 0:S.toLowerCase().includes(o.toLowerCase()))||((_=g.product_code)==null?void 0:_.toLowerCase().includes(o.toLowerCase()))||((b=g.surname)==null?void 0:b.toLowerCase().includes(o.toLowerCase()))});console.log(` SearchableSelectField [${e}] filtered:`,{filteredCount:m.length,filtered:m,filteredSample:m.slice(0,3),searchTerm:o,filteredWithData:m.filter(g=>g.product_name||g.name),filteredWithoutData:m.filter(g=>!g.product_name&&!g.name),filteredWithDataAndActive:m.filter(g=>g.status==="active"&&(g.product_name||g.name)),filteredWithDataAndQty:m.filter(g=>Number(g.remaining_quantity1)>0&&(g.product_name||g.name))}),f(m)},[o,n]);const h=n.find(m=>m.id===t);return i.jsxs("div",{className:"relative",children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:c?o:(h==null?void 0:h.displayName)||(h==null?void 0:h.name)||(h==null?void 0:h.product_name)||(h==null?void 0:h.full_name)||(h==null?void 0:h.fullName)||(h==null?void 0:h.nickname)||"",onChange:m=>{c&&l(m.target.value)},onFocus:()=>{u(!0),l("")},onBlur:()=>{setTimeout(()=>u(!1),200)},placeholder:s,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",required:a}),i.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:i.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),c&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[console.log(` SearchableSelectField [${e}] rendering dropdown with:`,{filteredOptionsCount:(d==null?void 0:d.length)||0,filteredOptions:d,filteredOptionsSample:d==null?void 0:d.slice(0,3),filteredOptionsKeys:d!=null&&d[0]?Object.keys(d[0]):[],searchTerm:o,isOpen:c,filteredOptionsWithData:d==null?void 0:d.filter(m=>m.product_name||m.name),filteredOptionsWithoutData:d==null?void 0:d.filter(m=>!m.product_name&&!m.name),originalOptions:n,originalOptionsCount:(n==null?void 0:n.length)||0,originalOptionsWithData:n==null?void 0:n.filter(m=>m.product_name||m.name),originalOptionsWithoutData:n==null?void 0:n.filter(m=>!m.product_name&&!m.name),originalOptionsWithDataAndActive:n==null?void 0:n.filter(m=>m.status==="active"&&(m.product_name||m.name)),originalOptionsWithDataAndQty:n==null?void 0:n.filter(m=>Number(m.remaining_quantity1)>0&&(m.product_name||m.name))}),d.length>0?d.map(m=>i.jsxs("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",onClick:()=>{r({target:{value:m.id}}),u(!1),l("")},children:[i.jsx("div",{className:"font-medium",children:m.displayName||m.name||m.product_name||m.full_name||m.fullName||m.nickname}),m.phone&&i.jsx("div",{className:"text-xs text-gray-500",children:m.phone}),m.product_code&&i.jsx("div",{className:"text-xs text-gray-500",children:m.product_code}),m.surname&&i.jsx("div",{className:"text-xs text-gray-500",children:m.surname}),m.position&&i.jsx("div",{className:"text-xs text-gray-400",children:m.position})]},m.id)):i.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:""})]})]})]})},ub=({label:e,value:t,onChange:r,options:n})=>i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:e}),i.jsx("div",{className:"flex gap-4",children:n.map(s=>i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"radio",name:e,value:s,checked:t===s,onChange:a=>r(a.target.value)}),s]},s))})]}),BY=({customers:e=[],products:t=[],employees:r=[],onSubmit:n,selectedBranch:s,currentBranch:a,submitting:o=!1})=>{const[l,c]=k.useState([]),[u,d]=k.useState(!1),[f,h]=k.useState([]),[m,g]=k.useState(!1),[p,v]=k.useState([]),[w,y]=k.useState(!1),[x,N]=k.useState([]),[S,_]=k.useState(!1),[b,A]=k.useState([]),[D,V]=k.useState(!1);console.log("ContractForm props:",{customersCount:(e==null?void 0:e.length)||0,inventoryCount:(t==null?void 0:t.length)||0,employeesCount:(r==null?void 0:r.length)||0,selectedBranch:s,currentBranch:a,customers:e}),console.log(" ContractForm selectedBranch check:",{selectedBranch:s,hasSelectedBranch:!!s,type:typeof s}),console.log(" ContractForm state:",{allCustomersCount:(l==null?void 0:l.length)||0,allInventoryCount:(f==null?void 0:f.length)||0,allEmployeesCount:(p==null?void 0:p.length)||0,allCheckersCount:(x==null?void 0:x.length)||0,allCollectorsCount:(b==null?void 0:b.length)||0,loadingCustomers:u,loadingInventory:m,loadingEmployees:w,loadingCheckers:S,loadingCollectors:D,allInventorySample:f==null?void 0:f.slice(0,3),allInventoryStatuses:f==null?void 0:f.map(j=>({id:j.id,status:j.status,qty:j.remaining_quantity1})),inventoryForProductSelect:f==null?void 0:f.map(j=>({...j,displayName:j.product_name||j.name||"",searchText:`${j.product_name||""} ${j.product_code||""}`.trim()})),inventoryWithData:f==null?void 0:f.filter(j=>j.product_name||j.name),inventoryWithoutData:f==null?void 0:f.filter(j=>!j.product_name&&!j.name),activeInventory:f==null?void 0:f.filter(j=>j.status==="active"),inventoryWithQty:f==null?void 0:f.filter(j=>Number(j.remaining_quantity1)>0)}),console.log("ContractForm allCheckers data:",x),k.useEffect(()=>{(async()=>{var U;if(s)try{d(!0),console.log("Loading customers from API for branch:",s);const q=await Li.getAll(s);console.log("Customers API response:",q);let C=[];(U=q.data)!=null&&U.success&&Array.isArray(q.data.data)?C=q.data.data:(Array.isArray(q.data)||q.data&&Array.isArray(q.data))&&(C=q.data),console.log("Processed customers data:",C),c(C)}catch(q){console.error("Error loading customers:",q),we({title:"",description:"",variant:"destructive"}),c([])}finally{d(!1)}})()},[s]),k.useEffect(()=>{(async()=>{var U,q,C,R,F,E;if(s)try{g(!0),console.log(" Loading inventory from API for branch:",s),console.log(" API call params:",{branchId:s,limit:1e3});const M=await ms.getAll({branchId:s,limit:1e3});console.log(" Inventory API response:",M),console.log(" Inventory API response.data:",M.data),console.log(" Inventory API response.data.success:",(U=M.data)==null?void 0:U.success),console.log(" Inventory API response.data.data:",(q=M.data)==null?void 0:q.data),console.log(" Inventory API response.data.data length:",(R=(C=M.data)==null?void 0:C.data)==null?void 0:R.length);let H=[];(F=M.data)!=null&&F.success&&Array.isArray(M.data.data)?(H=M.data.data,console.log(" Using response.data.data format")):Array.isArray(M.data)?(H=M.data,console.log(" Using response.data array format")):M.data&&Array.isArray(M.data)?(H=M.data,console.log(" Using response.data array format (fallback)")):console.log(" Unknown response format:",M),console.log(" Processed inventory data:",H),console.log(" Processed inventory data length:",H.length),console.log(" Pagination info:",(E=M.data)==null?void 0:E.pagination),H.length>0&&console.log(" Sample inventory item:",H[0]),console.log(" All inventory items count:",H.length),console.log(" Active inventory items:",H.filter(G=>G.status==="active").length),console.log(" Items with stock > 0:",H.filter(G=>Number(G.remaining_quantity1)>0).length),h(H)}catch(M){console.error(" Error loading inventory:",M),we({title:"",description:"",variant:"destructive"}),h([])}finally{g(!1)}})()},[s]),k.useEffect(()=>{(async()=>{var U;if(s)try{y(!0),console.log("Loading employees from API for branch:",s);const q=await na.getAll(s);console.log("Employees API response:",q);let C=[];(U=q.data)!=null&&U.success&&Array.isArray(q.data.data)?C=q.data.data:(Array.isArray(q.data)||q.data&&Array.isArray(q.data))&&(C=q.data),console.log("Processed employees data:",C),v(C)}catch(q){console.error("Error loading employees:",q),we({title:"",description:"",variant:"destructive"}),v([])}finally{y(!1)}})()},[s]),k.useEffect(()=>{console.log(" Checkers useEffect triggered with selectedBranch:",s);const j=async()=>{var U;if(console.log(" loadCheckers called with selectedBranch:",s),!s){console.log(" No selectedBranch, skipping loadCheckers");return}try{_(!0),console.log(" Loading checkers from API for branch:",s);const q=await Xo.getAll(s);console.log(" Checkers API response:",q);let C=[];(U=q.data)!=null&&U.success&&Array.isArray(q.data.data)?(C=q.data.data,console.log(" Using response.data.data format")):Array.isArray(q.data)?(C=q.data,console.log(" Using response.data array format")):q.data&&Array.isArray(q.data)?(C=q.data,console.log(" Using response.data array format (fallback)")):console.log(" Unknown response format:",q),console.log(" Processed checkers data:",C),console.log(" Sample checker item:",C[0]),N(C)}catch(q){console.error(" Error loading checkers:",q),console.error(" Error details:",{message:q.message,stack:q.stack,response:q.response}),we({title:"",description:"",variant:"destructive"}),N([])}finally{_(!1),console.log(" loadCheckers completed")}};console.log(" Setting up loadCheckers useEffect for selectedBranch:",s),j()},[s]),k.useEffect(()=>{(async()=>{var U;if(s)try{V(!0),console.log("Loading collectors from API for branch:",s);const q=await na.getAll(s);console.log("Collectors API response:",q);let C=[];(U=q.data)!=null&&U.success&&Array.isArray(q.data.data)?C=q.data.data:(Array.isArray(q.data)||q.data&&Array.isArray(q.data))&&(C=q.data);const R=C.filter(F=>F.position==="collector"||F.position==="");console.log("Processed collectors data:",R),A(R)}catch(q){console.error("Error loading collectors:",q),we({title:"",description:"",variant:"destructive"}),A([])}finally{V(!1)}})()},[s]);const[P,T]=k.useState({contractNumber:"",customerId:"",customerDetails:{title:"",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},guarantorId:"",guarantorDetails:{title:"",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},productId:"",productDetails:{name:"",description:"",price:"",category:"",model:"",serialNumber:""},plan:{downPayment:"",monthlyPayment:"",months:"",collectionDate:""},salespersonId:"",inspectorId:"",collectorId:"",contractDate:new Date().toISOString().split("T")[0]});k.useEffect(()=>{if(P.customerId){const j=l.find(U=>U.id===P.customerId);j&&(console.log("Auto-filling customer details:",j),T(U=>({...U,customerDetails:{...U.customerDetails,title:j.title||"",name:j.name||"",surname:j.surname||"",nickname:j.nickname||"",age:j.age||"",idCard:j.id_card||j.idCard||"",address:j.address||"",moo:j.moo||"",road:j.road||"",subdistrict:j.subdistrict||"",district:j.district||"",province:j.province||"",phone1:j.phone1||j.phone||"",phone2:j.phone2||"",phone3:j.phone3||"",email:j.email||""}})),we({title:"",description:` ${j.name||j.full_name} `}))}},[P.customerId,l]),k.useEffect(()=>{if(P.guarantorId){console.log(" Guarantor useEffect triggered with guarantorId:",P.guarantorId);const j=l.find(U=>U.id===P.guarantorId);console.log(" Found guarantor:",j),j&&(console.log("Auto-filling guarantor details:",j),T(U=>{console.log(" Previous contractForm state:",U);const q={...U,guarantorDetails:{...U.guarantorDetails,title:j.title||"",name:j.name||"",surname:j.surname||"",nickname:j.nickname||"",age:j.age||"",idCard:j.id_card||j.idCard||"",address:j.address||"",moo:j.moo||"",road:j.road||"",subdistrict:j.subdistrict||"",district:j.district||"",province:j.province||"",phone1:j.phone1||j.phone||"",phone2:j.phone2||"",phone3:j.phone3||"",email:j.email||""}};return console.log(" New contractForm state:",q),q}),we({title:"",description:` ${j.name||j.full_name} `}))}},[P.guarantorId,l]),k.useEffect(()=>{if(P.productId){const j=f.find(U=>U.id===P.productId);j&&(console.log("Auto-filling inventory details:",j),T(U=>({...U,productDetails:{...U.productDetails,name:j.product_name||"",description:j.remarks||"",price:"",category:j.product_code||"",model:j.product_code||"",serialNumber:j.sequence||""}})),we({title:"",description:` ${j.product_name} `}))}},[P.productId,f]);const z=(j,U,q)=>{T(C=>({...C,[j]:{...C[j],[U]:q}}))},L=(j,U)=>{console.log(" handleSelectChange called:",{field:j,value:U}),console.log(" Previous contractForm state:",P),T(q=>{const C={...q,[j]:U};return console.log(" New contractForm state after handleSelectChange:",C),C})},ee=j=>{if(j.preventDefault(),console.log(" ContractForm handleSubmit - contractForm:",P),console.log(" Product ID in form:",P.productId),console.log(" Product ID type:",typeof P.productId),console.log(" Product ID in form:",P.productId),console.log(" Product ID type:",typeof P.productId),!P.customerId||!P.productId||!P.salespersonId||!P.inspectorId||!P.collectorId){lt.fire({icon:"error",title:"",text:", , ,  ",confirmButtonText:"",confirmButtonColor:"#7c3aed"});return}if(!P.plan.monthlyPayment||!P.plan.months){lt.fire({icon:"error",title:"",text:"",confirmButtonText:"",confirmButtonColor:"#7c3aed"});return}const U=parseFloat(P.plan.downPayment)||0,q=parseFloat(P.plan.monthlyPayment)||0,C=parseInt(P.plan.months)||0,R=q*C,F=U+R;if(F<=0){lt.fire({icon:"error",title:"",text:"",confirmButtonText:"",confirmButtonColor:"#7c3aed"});return}const E=f.find(Q=>Q.id===P.productId);console.log(" Selected inventory:",E),console.log(" All inventory:",f),console.log(" :",(E==null?void 0:E.cost_price)||0);const M=l.find(Q=>Q.id===P.customerId),H=b.find(Q=>Q.id===P.collectorId),G=q,re=F-U,he=new Date(P.contractDate),oe=new Date(he);oe.setMonth(oe.getMonth()+C);const ce={contractNumber:P.contractNumber||void 0,contractDate:P.contractDate,customerId:P.customerId,productId:P.productId,productName:(E==null?void 0:E.product_name)||"",totalAmount:F,installmentAmount:G,remainingAmount:re,installmentPeriod:C,startDate:he.toISOString().split("T")[0],endDate:oe.toISOString().split("T")[0],branchId:s,salespersonId:P.salespersonId,inspectorId:P.inspectorId,line:(H==null?void 0:H.code)||(H==null?void 0:H.name)||"",customerTitle:P.customerDetails.title,customerAge:parseInt(P.customerDetails.age)||null,customerMoo:P.customerDetails.moo,customerRoad:P.customerDetails.road,customerSubdistrict:P.customerDetails.subdistrict,customerDistrict:P.customerDetails.district,customerProvince:P.customerDetails.province,customerPhone1:P.customerDetails.phone1,customerPhone2:P.customerDetails.phone2,customerPhone3:P.customerDetails.phone3,customerEmail:P.customerDetails.email,customerIdCard:P.customerDetails.idCard,customerName:P.customerDetails.name,customerSurname:P.customerDetails.surname,customerNickname:P.customerDetails.nickname,customerAddress:P.customerDetails.address,guarantorId:P.guarantorId,guarantorTitle:P.guarantorDetails.title,guarantorName:P.guarantorDetails.name,guarantorSurname:P.guarantorDetails.surname,guarantorNickname:P.guarantorDetails.nickname,guarantorAge:parseInt(P.guarantorDetails.age)||null,guarantorIdCard:P.guarantorDetails.idCard,guarantorAddress:P.guarantorDetails.address,guarantorMoo:P.guarantorDetails.moo,guarantorRoad:P.guarantorDetails.road,guarantorSubdistrict:P.guarantorDetails.subdistrict,guarantorDistrict:P.guarantorDetails.district,guarantorProvince:P.guarantorDetails.province,guarantorPhone1:P.guarantorDetails.phone1,guarantorPhone2:P.guarantorDetails.phone2,guarantorPhone3:P.guarantorDetails.phone3,guarantorEmail:P.guarantorDetails.email,productDescription:P.productDetails.description,productCategory:P.productDetails.category,productModel:P.productDetails.model,productSerialNumber:P.productDetails.serialNumber,productName:P.productDetails.name||(E==null?void 0:E.product_name)||"",costPrice:(E==null?void 0:E.cost_price)||0,downPayment:U,monthlyPayment:q,months:C,collectionDate:P.plan.collectionDate,status:"active"};console.log(" ContractForm handleSubmit - prepared contractData:",ce),lt.fire({title:"",html:`
        <div class="text-left">
          <p><strong>:</strong> ${(M==null?void 0:M.name)||""}</p>
          <p><strong>:</strong> ${(E==null?void 0:E.product_name)||""}</p>
          <p><strong>:</strong> ${F.toLocaleString()} </p>
          <p><strong>:</strong> ${U.toLocaleString()} </p>
          <p><strong>:</strong> ${q.toLocaleString()} </p>
          <p><strong>:</strong> ${C} </p>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"",cancelButtonText:"",confirmButtonColor:"#7c3aed",cancelButtonColor:"#6b7280",reverseButtons:!0}).then(Q=>{Q.isConfirmed&&(lt.fire({title:"...",text:"",allowOutsideClick:!1,didOpen:()=>{lt.showLoading()}}),n(ce))})};return i.jsxs($e.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[i.jsx(mr,{className:"w-6 h-6 text-blue-600"}),""]}),i.jsxs("form",{onSubmit:ee,className:"space-y-6",children:[i.jsxs(Rd,{title:"",icon:br,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(Eo,{label:"",value:P.customerId,onChange:j=>L("customerId",j.target.value),options:l,placeholder:u?"...":"----",required:!0}),i.jsx(Eo,{label:"",value:P.guarantorId,onChange:j=>L("guarantorId",j.target.value),options:l,placeholder:u?"...":"----"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"flex-1",children:i.jsx(it,{label:" ()",value:P.contractNumber,onChange:j=>L("contractNumber",j.target.value),placeholder:" "})}),i.jsx("div",{className:"flex items-end",children:i.jsx(ae,{type:"button",onClick:()=>{const j=new Date,U=j.getFullYear().toString().slice(-2),q=(j.getMonth()+1).toString().padStart(2,"0"),C=j.getDate().toString().padStart(2,"0"),R=Math.floor(Math.random()*1e3).toString().padStart(3,"0"),F=`CT${U}${q}${C}${R}`;L("contractNumber",F)},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm",children:""})})]}),i.jsx(it,{label:"",type:"date",value:P.contractDate,onChange:j=>L("contractDate",j.target.value)})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(ub,{label:"",value:P.customerDetails.title,onChange:j=>z("customerDetails","title",j),options:["","",""]}),i.jsx(it,{label:"-",value:P.customerDetails.name,onChange:j=>z("customerDetails","name",j.target.value),placeholder:"-",required:!0}),i.jsx(it,{label:"",value:P.customerDetails.nickname,onChange:j=>z("customerDetails","nickname",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.customerDetails.age,onChange:j=>z("customerDetails","age",j.target.value),placeholder:"",type:"number"}),i.jsx(it,{label:"",value:P.customerDetails.idCard,onChange:j=>z("customerDetails","idCard",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.customerDetails.address,onChange:j=>z("customerDetails","address",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.customerDetails.moo,onChange:j=>z("customerDetails","moo",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.customerDetails.road,onChange:j=>z("customerDetails","road",j.target.value),placeholder:""}),i.jsx(it,{label:"/",value:P.customerDetails.subdistrict,onChange:j=>z("customerDetails","subdistrict",j.target.value),placeholder:"/"}),i.jsx(it,{label:"/",value:P.customerDetails.district,onChange:j=>z("customerDetails","district",j.target.value),placeholder:"/"}),i.jsx(it,{label:"",value:P.customerDetails.province,onChange:j=>z("customerDetails","province",j.target.value),placeholder:""}),i.jsx(it,{label:" 1",value:P.customerDetails.phone1,onChange:j=>z("customerDetails","phone1",j.target.value),placeholder:"",required:!0}),i.jsx(it,{label:" 2",value:P.customerDetails.phone2,onChange:j=>z("customerDetails","phone2",j.target.value),placeholder:""}),i.jsx(it,{label:" 3",value:P.customerDetails.phone3,onChange:j=>z("customerDetails","phone3",j.target.value),placeholder:""})]})]}),i.jsx(Rd,{title:"",icon:Nn,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(ub,{label:"",value:P.guarantorDetails.title,onChange:j=>z("guarantorDetails","title",j),options:["","",""]}),i.jsx(it,{label:"-",value:P.guarantorDetails.name,onChange:j=>z("guarantorDetails","name",j.target.value),placeholder:"-"}),i.jsx(it,{label:"",value:P.guarantorDetails.nickname,onChange:j=>z("guarantorDetails","nickname",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.guarantorDetails.age,onChange:j=>z("guarantorDetails","age",j.target.value),placeholder:"",type:"number"}),i.jsx(it,{label:"",value:P.guarantorDetails.idCard,onChange:j=>z("guarantorDetails","idCard",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.guarantorDetails.address,onChange:j=>z("guarantorDetails","address",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.guarantorDetails.moo,onChange:j=>z("guarantorDetails","moo",j.target.value),placeholder:""}),i.jsx(it,{label:"",value:P.guarantorDetails.road,onChange:j=>z("guarantorDetails","road",j.target.value),placeholder:""}),i.jsx(it,{label:"/",value:P.guarantorDetails.subdistrict,onChange:j=>z("guarantorDetails","subdistrict",j.target.value),placeholder:"/"}),i.jsx(it,{label:"/",value:P.guarantorDetails.district,onChange:j=>z("guarantorDetails","district",j.target.value),placeholder:"/"}),i.jsx(it,{label:"",value:P.guarantorDetails.province,onChange:j=>z("guarantorDetails","province",j.target.value),placeholder:""}),i.jsx(it,{label:" 1",value:P.guarantorDetails.phone1,onChange:j=>z("guarantorDetails","phone1",j.target.value),placeholder:""}),i.jsx(it,{label:" 2",value:P.guarantorDetails.phone2,onChange:j=>z("guarantorDetails","phone2",j.target.value),placeholder:""}),i.jsx(it,{label:" 3",value:P.guarantorDetails.phone3,onChange:j=>z("guarantorDetails","phone3",j.target.value),placeholder:""})]})}),i.jsx(Rd,{title:"",icon:er,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[console.log(" ContractForm: Rendering product SearchableSelectField with:",{allInventoryCount:(f==null?void 0:f.length)||0,allInventory:f,filteredInventory:f.filter(j=>j.status==="active"&&Number(j.remaining_quantity1)>0),activeWithQtyCount:f.filter(j=>j.status==="active"&&Number(j.remaining_quantity1)>0).length,optionsToSend:f.map(j=>({...j,displayName:j.product_name||j.name||"",searchText:`${j.product_name||""} ${j.product_code||""}`.trim()})),inventoryStatuses:f==null?void 0:f.map(j=>({id:j.id,status:j.status,qty:j.remaining_quantity1,name:j.product_name||j.name})),activeInventory:f==null?void 0:f.filter(j=>j.status==="active"),inventoryWithQty:f==null?void 0:f.filter(j=>Number(j.remaining_quantity1)>0),inventoryWithData:f==null?void 0:f.filter(j=>j.product_name||j.name),inventoryWithoutData:f==null?void 0:f.filter(j=>!j.product_name&&!j.name),activeInventoryWithData:f==null?void 0:f.filter(j=>j.status==="active"&&(j.product_name||j.name)),inventoryWithDataAndQty:f==null?void 0:f.filter(j=>Number(j.remaining_quantity1)>0&&(j.product_name||j.name))}),i.jsx(Eo,{label:"",value:P.productId,onChange:j=>L("productId",j.target.value),options:f.filter(j=>j.status==="active"&&Number(j.remaining_quantity1)>0).sort((j,U)=>j.receive_date&&U.receive_date?new Date(j.receive_date)-new Date(U.receive_date):j.product_name&&U.product_name?j.product_name.localeCompare(U.product_name,"th"):0).map(j=>({...j,displayName:`${j.product_name||""}${j.shop_name?` | : ${j.shop_name}`:""}${j.receive_date?` | : ${new Date(j.receive_date).toLocaleDateString("th-TH")}`:""}${j.remaining_quantity1?` | : ${j.remaining_quantity1} `:""}`,searchText:`${j.product_name||""} ${j.product_code||""} ${j.shop_name||""}`.trim()})),placeholder:m?"...":"----",required:!0}),i.jsx(it,{label:"",value:(()=>{const j=parseFloat(P.plan.downPayment)||0,U=parseFloat(P.plan.monthlyPayment)||0,q=parseInt(P.plan.months)||0,C=U*q,R=j+C;return R>0?R.toString():""})(),onChange:j=>z("productDetails","price",j.target.value),placeholder:"",type:"number",required:!0,disabled:!0}),i.jsx(it,{label:"",value:P.productDetails.model,onChange:j=>z("productDetails","model",j.target.value),placeholder:""}),i.jsx(it,{label:"S/N",value:P.productDetails.serialNumber,onChange:j=>z("productDetails","serialNumber",j.target.value),placeholder:"Serial Number"}),i.jsx(it,{label:"",value:P.plan.downPayment,onChange:j=>z("plan","downPayment",j.target.value),placeholder:"",type:"number"}),i.jsx(it,{label:"/",value:P.plan.monthlyPayment,onChange:j=>z("plan","monthlyPayment",j.target.value),placeholder:"",type:"number",required:!0}),i.jsx(it,{label:"",value:P.plan.months,onChange:j=>z("plan","months",j.target.value),placeholder:"",type:"number",required:!0}),i.jsx(it,{label:"",value:P.plan.collectionDate,onChange:j=>z("plan","collectionDate",j.target.value),placeholder:"--  31-12-2564"})]})}),i.jsx(Rd,{title:"",icon:Ws,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(Eo,{label:"",value:P.salespersonId,onChange:j=>L("salespersonId",j.target.value),options:p,placeholder:w?"...":"----",required:!0}),i.jsx(Eo,{label:"",value:P.inspectorId,onChange:j=>L("inspectorId",j.target.value),options:x,placeholder:S?"...":"----",required:!0}),i.jsx(Eo,{label:" ()",value:P.collectorId,onChange:j=>L("collectorId",j.target.value),options:b,placeholder:D?"...":"----"})]})}),i.jsx("div",{className:"flex justify-end gap-3 pt-4",children:i.jsx(ae,{type:"submit",disabled:o,className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"..."]}):i.jsxs(i.Fragment,{children:[i.jsx(z4,{className:"w-4 h-4 mr-2"}),""]})})})]})]})},Ld=({title:e,icon:t,children:r})=>{const n=t;return i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(n,{className:"w-5 h-5 text-purple-600"}),e]}),r]})},ot=({label:e,value:t,onChange:r,placeholder:n,type:s="text",required:a=!1})=>i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsx("input",{type:s,value:t,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:n,required:a})]}),To=({label:e,value:t,onChange:r,options:n,placeholder:s,required:a=!1})=>{const[o,l]=k.useState(""),[c,u]=k.useState(!1),[d,f]=k.useState(n);k.useEffect(()=>{const m=n.filter(g=>(g.searchText||`${g.name||""} ${g.full_name||""} ${g.fullName||""} ${g.code||""} ${g.nickname||""} ${g.phone||""} ${g.surname||""} ${g.product_name||""}`.toLowerCase()).includes(o.toLowerCase()));f(m)},[o,n]);const h=n.find(m=>m.id===t);return i.jsxs("div",{className:"relative",children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:[e,a&&" *"]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:c?o:(h==null?void 0:h.displayName)||(h==null?void 0:h.name)||(h==null?void 0:h.full_name)||(h==null?void 0:h.fullName)||(h==null?void 0:h.nickname)||(h==null?void 0:h.product_name)||(h==null?void 0:h.code)||"",onChange:m=>{c&&l(m.target.value)},onFocus:()=>u(!0),onBlur:()=>setTimeout(()=>u(!1),200),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:s}),i.jsx(an,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]}),c&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:d.map(m=>i.jsxs("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",onClick:()=>{r({target:{value:m.id}}),u(!1),l("")},children:[m.displayName||m.name||m.full_name||m.fullName||m.nickname||m.product_name||m.code,m.phone&&i.jsxs("span",{className:"text-gray-500 ml-2",children:["(",m.phone,")"]})]},m.id))})]})},db=({label:e,value:t,onChange:r,options:n})=>i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:e}),i.jsx("div",{className:"flex gap-4",children:n.map(s=>i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:s,checked:t===s,onChange:a=>r(a.target.value),className:"mr-2"}),i.jsx("span",{className:"text-sm",children:s})]},s))})]}),$Y=({contractId:e,selectedBranch:t,onBack:r,onSuccess:n})=>{console.log(" ContractEditForm rendered with props:",{contractId:e,selectedBranch:t});const[s,a]=k.useState([]),[o,l]=k.useState(!1),[c,u]=k.useState([]),[d,f]=k.useState(!1),[h,m]=k.useState([]),[g,p]=k.useState(!1),[v,w]=k.useState([]),[y,x]=k.useState(!1),[N,S]=k.useState([]),[_,b]=k.useState(!1),[A,D]=k.useState(!0),[V,P]=k.useState(!1),[T,z]=k.useState([]),[L,ee]=k.useState({contractNumber:"",contractDate:"",customerId:"",customerDetails:{title:"",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},guarantorId:"",guarantorDetails:{title:"",name:"",surname:"",nickname:"",age:"",idCard:"",address:"",moo:"",road:"",subdistrict:"",district:"",province:"",phone1:"",phone2:"",phone3:"",email:""},productId:"",productDetails:{name:"",description:"",price:"",category:"",model:"",serialNumber:""},plan:{downPayment:"",monthlyPayment:"",months:"",collectionDate:""},salespersonId:"",inspectorId:"",collectorId:"",line:"",totalAmount:0,installmentPeriod:12,startDate:"",endDate:""});k.useEffect(()=>{console.log(" contractForm state changed:",L),console.log(" contractForm.contractNumber:",L.contractNumber),console.log(" contractForm.contractDate:",L.contractDate),console.log(" contractForm.productId:",L.productId),console.log(" contractForm.customerDetails.name:",L.customerDetails.name),console.log(" contractForm.productDetails.name:",L.productDetails.name),console.log(" contractForm.totalAmount:",L.totalAmount)},[L]),k.useEffect(()=>{if(console.log(" Auto-fill effect triggered - productId:",L.productId,"allInventory length:",c.length),console.log(" contractForm.productId type:",typeof L.productId),console.log(" contractForm.productId value:",L.productId),L.productId&&c.length>0){const C=c.find(R=>R.id===parseInt(L.productId));console.log(" Looking for productId:",L.productId,"in inventory"),console.log(" Parsed productId:",parseInt(L.productId)),console.log(" Found inventory item:",C),C?(console.log(" Auto-filling product details for:",C),ee(R=>({...R,productDetails:{...R.productDetails,name:C.product_name||"",price:C.cost_price?C.cost_price.toString():""}}))):(console.log(" No inventory item found for productId:",L.productId),console.log(" Available inventory IDs:",c.map(R=>R.id)),console.log(" Available inventory items:",c.map(R=>({id:R.id,product_name:R.product_name}))))}else console.log(" Cannot auto-fill: productId:",L.productId,"allInventory length:",c.length)},[L.productId,c]),k.useEffect(()=>{(async()=>{var R,F,E,M,H,G,re,he,oe,ce,Q,J,O,ve,ye,xe,ke,ue,Ne,De,Ee,Ie,te,de,Fe,Oe,Ue,et,Ve,qe,Ke,pt,xr,St,_n,vi,ko,qu,$l;if(e)try{D(!0),console.log(" Loading contract with ID:",e);const Sn=await ra.getById(e);console.log(" API Response:",Sn),console.log(" API Response status:",Sn.status),console.log(" API Response headers:",Sn.headers);let Z;if((R=Sn.data)!=null&&R.success?Z=Sn.data.data:Sn.data?Z=Sn.data:Z=Sn,console.log(" Contract data:",Z),console.log(" Contract data keys:",Object.keys(Z||{})),console.log(" Contract contractNumber:",Z==null?void 0:Z.contractNumber),console.log(" Contract customerName:",Z==null?void 0:Z.customerName),console.log(" Contract customerFullName:",Z==null?void 0:Z.customerFullName),console.log(" Contract productName:",Z==null?void 0:Z.productName),console.log(" Contract inventoryProductName:",Z==null?void 0:Z.inventoryProductName),console.log(" Contract productId:",Z==null?void 0:Z.productId),console.log(" Contract product_id:",Z==null?void 0:Z.product_id),console.log(" Contract line:",Z==null?void 0:Z.line),console.log(" Contract collectorId:",Z==null?void 0:Z.collectorId),console.log(" Contract totalAmount:",Z==null?void 0:Z.totalAmount),console.log(" Contract customerDetails:",Z==null?void 0:Z.customerDetails),console.log(" Contract customerIdCard:",Z==null?void 0:Z.customerIdCard),console.log(" Contract customerNickname:",Z==null?void 0:Z.customerNickname),console.log(" Contract guarantorIdCard:",Z==null?void 0:Z.guarantorIdCard),console.log(" Contract guarantorNickname:",Z==null?void 0:Z.guarantorNickname),console.log(" Contract guarantorId:",Z==null?void 0:Z.guarantorId),console.log(" Contract guarantorDetails:",Z==null?void 0:Z.guarantorDetails),console.log(" Contract guarantorTitle:",Z==null?void 0:Z.guarantorTitle),console.log(" Contract guarantorName:",Z==null?void 0:Z.guarantorName),console.log(" Contract guarantorSurname:",Z==null?void 0:Z.guarantorSurname),console.log(" Contract guarantorAge:",Z==null?void 0:Z.guarantorAge),console.log(" Contract guarantorAddress:",Z==null?void 0:Z.guarantorAddress),console.log(" Contract guarantorPhone1:",Z==null?void 0:Z.guarantorPhone1),console.log(" Contract productDetails:",Z==null?void 0:Z.productDetails),console.log(" Contract plan:",Z==null?void 0:Z.plan),console.log(" Contract collectorId (raw):",Z==null?void 0:Z.collectorId),console.log(" Contract line (raw):",Z==null?void 0:Z.line),console.log(" Contract collector_id (alternative):",Z==null?void 0:Z.collector_id),console.log(" Contract collectorId type:",typeof(Z==null?void 0:Z.collectorId)),console.log(" Contract line type:",typeof(Z==null?void 0:Z.line)),console.log(" Contract collectorId truthy:",!!(Z!=null&&Z.collectorId)),console.log(" Contract line truthy:",!!(Z!=null&&Z.line)),Z){const Ir={contractNumber:Z.contractNumber||"",contractDate:Z.contractDate?Z.contractDate.split("T")[0]:Z.startDate?Z.startDate.split("T")[0]:"",customerId:Z.customerId||"",customerDetails:{title:((F=Z.customerDetails)==null?void 0:F.title)||Z.customerTitle||"",name:Z.customerName||"",surname:((E=Z.customerDetails)==null?void 0:E.surname)||Z.customerSurname||"",nickname:((M=Z.customerDetails)==null?void 0:M.nickname)||Z.customerNickname||"",age:((H=Z.customerDetails)==null?void 0:H.age)||Z.customerAge||"",idCard:((G=Z.customerDetails)==null?void 0:G.idCard)||Z.customerIdCard||"",address:Z.customerAddress||"",moo:((re=Z.customerDetails)==null?void 0:re.moo)||Z.customerMoo||"",road:((he=Z.customerDetails)==null?void 0:he.road)||Z.customerRoad||"",subdistrict:((oe=Z.customerDetails)==null?void 0:oe.subdistrict)||Z.customerSubdistrict||"",district:((ce=Z.customerDetails)==null?void 0:ce.district)||Z.customerDistrict||"",province:((Q=Z.customerDetails)==null?void 0:Q.province)||Z.customerProvince||"",phone1:((J=Z.customerDetails)==null?void 0:J.phone1)||Z.customerPhone1||Z.customerPhone||"",phone2:((O=Z.customerDetails)==null?void 0:O.phone2)||Z.customerPhone2||"",phone3:((ve=Z.customerDetails)==null?void 0:ve.phone3)||Z.customerPhone3||"",email:((ye=Z.customerDetails)==null?void 0:ye.email)||Z.customerEmail||""},guarantorId:Z.guarantorId||"",guarantorDetails:{title:((xe=Z.guarantorDetails)==null?void 0:xe.title)||Z.guarantorTitle||"",name:((ke=Z.guarantorDetails)==null?void 0:ke.name)||Z.guarantorName||"",surname:((ue=Z.guarantorDetails)==null?void 0:ue.surname)||Z.guarantorSurname||"",nickname:((Ne=Z.guarantorDetails)==null?void 0:Ne.nickname)||Z.guarantorNickname||"",age:((De=Z.guarantorDetails)==null?void 0:De.age)||Z.guarantorAge||"",idCard:((Ee=Z.guarantorDetails)==null?void 0:Ee.idCard)||Z.guarantorIdCard||"",address:((Ie=Z.guarantorDetails)==null?void 0:Ie.address)||Z.guarantorAddress||"",moo:((te=Z.guarantorDetails)==null?void 0:te.moo)||Z.guarantorMoo||"",road:((de=Z.guarantorDetails)==null?void 0:de.road)||Z.guarantorRoad||"",subdistrict:((Fe=Z.guarantorDetails)==null?void 0:Fe.subdistrict)||Z.guarantorSubdistrict||"",district:((Oe=Z.guarantorDetails)==null?void 0:Oe.district)||Z.guarantorDistrict||"",province:((Ue=Z.guarantorDetails)==null?void 0:Ue.province)||Z.guarantorProvince||"",phone1:((et=Z.guarantorDetails)==null?void 0:et.phone1)||Z.guarantorPhone1||"",phone2:((Ve=Z.guarantorDetails)==null?void 0:Ve.phone2)||Z.guarantorPhone2||"",phone3:((qe=Z.guarantorDetails)==null?void 0:qe.phone3)||Z.guarantorPhone3||"",email:((Ke=Z.guarantorDetails)==null?void 0:Ke.email)||Z.guarantorEmail||""},productId:Z.productId||Z.product_id||"",productDetails:{name:Z.productName||Z.inventoryProductName||"",description:((pt=Z.productDetails)==null?void 0:pt.description)||Z.productDescription||"",price:Z.productPrice||Z.totalAmount||"",category:((xr=Z.productDetails)==null?void 0:xr.category)||Z.productCategory||"",model:((St=Z.productDetails)==null?void 0:St.model)||Z.productModel||"",serialNumber:((_n=Z.productDetails)==null?void 0:_n.serialNumber)||Z.productSerialNumber||""},plan:{downPayment:((vi=Z.plan)==null?void 0:vi.downPayment)||Z.downPayment||"",monthlyPayment:((ko=Z.plan)==null?void 0:ko.monthlyPayment)||Z.monthlyPayment||Z.installmentAmount||"",months:((qu=Z.plan)==null?void 0:qu.months)||Z.months||Z.installmentPeriod||"",collectionDate:(($l=Z.plan)==null?void 0:$l.collectionDate)||Z.collectionDate||""},salespersonId:Z.salespersonId||"",inspectorId:Z.inspectorId||"",collectorId:Z.collectorId||"",line:Z.line||"",totalAmount:Z.totalAmount||0,installmentPeriod:Z.installmentPeriod||Z.months||12,startDate:Z.startDate||"",endDate:Z.endDate||""};console.log(" Collector and line mapping debug:"),console.log("  - Original contract.collectorId:",Z.collectorId),console.log("  - Original contract.line:",Z.line),console.log("  - Original contract.collector_id:",Z.collector_id),console.log("  - Mapped formData.collectorId:",Ir.collectorId),console.log("  - Mapped formData.line:",Ir.line),console.log("  - Will try to map collectorId from line if needed"),console.log(" Mapped form data:",Ir),console.log(" Mapped customerDetails:",Ir.customerDetails),console.log(" Mapped productDetails:",Ir.productDetails),console.log(" Mapped plan:",Ir.plan),console.log(" Contract productId:",Z.productId),console.log(" Contract product_id:",Z.product_id),console.log(" Form productId:",Ir.productId),console.log(" Contract line:",Z.line),console.log(" Form line:",Ir.line),console.log(" Contract contractDate:",Z.contractDate),console.log(" Form contractDate:",Ir.contractDate),console.log(" Setting contractForm with:",Ir),console.log(" Final formData.productId:",Ir.productId),console.log(" Final formData.collectorId:",Ir.collectorId),console.log(" Final formData.line:",Ir.line),ee(Ir),console.log(" setContractForm called")}}catch(Sn){console.error("Error loading contract:",Sn),we({title:"",description:"",variant:"destructive"})}finally{D(!1)}})()},[e]),k.useEffect(()=>{console.log(" contractForm state changed:",L),console.log(" contractForm.contractNumber:",L.contractNumber),console.log(" contractForm.contractDate:",L.contractDate),console.log(" contractForm.productId:",L.productId),console.log(" contractForm.customerDetails.name:",L.customerDetails.name),console.log(" contractForm.productDetails.name:",L.productDetails.name),console.log(" contractForm.totalAmount:",L.totalAmount)},[L]),k.useEffect(()=>{(async()=>{var R;if(t)try{l(!0),console.log(" Loading customers for branch:",t);const F=await Li.getAll(t);console.log(" Customers response:",F);let E=[];(R=F.data)!=null&&R.success&&Array.isArray(F.data.data)?E=F.data.data:Array.isArray(F.data)&&(E=F.data),console.log(" Processed customers data:",E),a(E)}catch(F){console.error("Error loading customers:",F),console.warn(" Customers loading failed, continuing without customers data"),a([])}finally{l(!1)}})()},[t]),k.useEffect(()=>{(async()=>{var R;if(t)try{f(!0),console.log(" Loading inventory for branch:",t);const F=await ms.getAll({branchId:t});console.log(" Inventory response:",F),console.log(" Inventory response status:",F.status),console.log(" Inventory response data:",F.data);let E=[];(R=F.data)!=null&&R.success&&Array.isArray(F.data.data)?E=F.data.data:Array.isArray(F.data)&&(E=F.data),console.log(" Processed inventory data:",E),console.log(" All inventory items:",E.length),console.log(" Active inventory items:",E.filter(M=>M.status==="active"&&Number(M.remaining_quantity1)>0).length),console.log(" Sample inventory items:",E.slice(0,3).map(M=>({id:M.id,product_name:M.product_name,status:M.status}))),console.log(" All inventory IDs:",E.map(M=>M.id)),console.log(" Current contractForm.productId:",L.productId),console.log(" Will try to find product with ID:",L.productId),u(E)}catch(F){console.error("Error loading inventory:",F),console.warn(" Inventory loading failed, continuing without inventory data"),u([])}finally{f(!1)}})()},[t]),k.useEffect(()=>{(async()=>{var R;if(t)try{p(!0),console.log(" Loading employees for branch:",t);const F=await na.getAll(t);console.log(" Employees response:",F),console.log(" Employees response status:",F.status),console.log(" Employees response data:",F.data);let E=[];(R=F.data)!=null&&R.success&&Array.isArray(F.data.data)?E=F.data.data:Array.isArray(F.data)&&(E=F.data),console.log(" Processed employees data:",E),m(E)}catch(F){console.error("Error loading employees:",F),console.warn(" Employees loading failed, continuing without employees data"),m([])}finally{p(!1)}})()},[t]),k.useEffect(()=>{(async()=>{var R;if(t)try{x(!0),console.log(" Loading checkers for branch:",t);const F=await Xo.getAll(t);console.log(" Checkers response:",F),console.log(" Checkers response status:",F.status),console.log(" Checkers response data:",F.data);let E=[];(R=F.data)!=null&&R.success&&Array.isArray(F.data.data)?E=F.data.data:Array.isArray(F.data)&&(E=F.data),console.log(" Processed checkers data:",E),w(E)}catch(F){console.error("Error loading checkers:",F),console.warn(" Checkers loading failed, continuing without checkers data"),w([])}finally{x(!1)}})()},[t]),k.useEffect(()=>{(async()=>{var R,F,E,M,H,G,re;if(t)try{b(!0),console.log(" Loading collectors for branch:",t);const he=await na.getAll(t);console.log(" Collectors response:",he),console.log(" Collectors response status:",he.status),console.log(" Collectors response data:",he.data),console.log(" Employees response.data.success:",(R=he.data)==null?void 0:R.success),console.log(" Employees response.data.data:",(F=he.data)==null?void 0:F.data),console.log(" Employees response.data.data length:",(M=(E=he.data)==null?void 0:E.data)==null?void 0:M.length),console.log(" Employees response.data.data type:",typeof((H=he.data)==null?void 0:H.data)),console.log(" Employees response.data.data isArray:",Array.isArray((G=he.data)==null?void 0:G.data));let oe=[];(re=he.data)!=null&&re.success&&Array.isArray(he.data.data)?(oe=he.data.data,console.log(" Using response.data.data format")):Array.isArray(he.data)?(oe=he.data,console.log(" Using response.data array format")):console.log(" Unknown response format:",he),console.log(" Processed employees data:",oe),console.log(" Processed employees data length:",oe.length),oe.length>0&&(console.log(" Sample employee:",oe[0]),console.log(" Sample employee keys:",Object.keys(oe[0])));const ce=oe.filter(Q=>Q.position==="collector"||Q.position==="");console.log(" Processed collectors data:",ce),console.log(" Sample collectors:",ce.slice(0,3).map(Q=>({id:Q.id,name:Q.name,position:Q.position,code:Q.code}))),console.log(" All collector IDs:",ce.map(Q=>Q.id)),console.log(" Current contractForm.line:",L.line),console.log(" Current contractForm.collectorId:",L.collectorId),console.log(" Will try to find collector with line:",L.line),console.log(" Collectors data structure sample:",ce[0]?Object.keys(ce[0]):"No collectors"),console.log(" Collectors with code field:",ce.filter(Q=>Q.code).map(Q=>({id:Q.id,name:Q.name,code:Q.code}))),console.log(" Collectors without code field:",ce.filter(Q=>!Q.code).map(Q=>({id:Q.id,name:Q.name,code:Q.code}))),S(ce)}catch(he){console.error("Error loading collectors:",he),console.warn(" Collectors loading failed, continuing without collectors data"),S([])}finally{b(!1)}})()},[t]),k.useEffect(()=>{(async()=>{var R;if(t)try{D(!0),console.log(" Loading contracts for branch:",t);const F=await ra.getAll(t);console.log(" Contracts response:",F),console.log(" Contracts response status:",F.status),console.log(" Contracts response data:",F.data);let E=[];(R=F.data)!=null&&R.success&&Array.isArray(F.data.data)?E=F.data.data:Array.isArray(F.data)&&(E=F.data),console.log(" Processed contracts data:",E),console.log(" Contracts with product_id:",E.filter(M=>M.product_id)),z(E)}catch(F){console.error("Error loading contracts:",F),console.warn(" Contracts loading failed, continuing without contracts data"),z([])}finally{D(!1)}})()},[t]),k.useEffect(()=>{if(console.log(" Collector mapping effect triggered - line:",L.line,"collectorId:",L.collectorId,"allCollectors length:",N.length),console.log(" contractForm.line type:",typeof L.line),console.log(" contractForm.line value:",L.line),console.log(" contractForm.collectorId type:",typeof L.collectorId),console.log(" contractForm.collectorId value:",L.collectorId),console.log(" allCollectors sample:",N.slice(0,3).map(C=>({id:C.id,name:C.name,code:C.code,full_name:C.full_name}))),N.length>0&&L.line&&!L.collectorId){const C=N.find(R=>R.code===L.line||R.name===L.line||R.full_name===L.line);console.log(" Looking for collector with line:",L.line),console.log(" Found collector:",C),C?(console.log(" Mapping collectorId from line:",L.line,"to collectorId:",C.id),ee(R=>({...R,collectorId:C.id}))):(console.log(" No collector found for line:",L.line),console.log(" Available collector codes:",N.map(R=>R.code)),console.log(" Available collector names:",N.map(R=>R.name)),console.log(" Available collector full_names:",N.map(R=>R.full_name)))}else console.log(" Cannot map collector: allCollectors length:",N.length,"line:",L.line,"collectorId:",L.collectorId),L.collectorId&&console.log(" collectorId already exists, no need to map from line"),L.line||console.log(" No line value to map from"),N.length===0&&console.log(" No collectors data available")},[N,L.line,L.collectorId]);const j=(C,R,F)=>{ee(E=>({...E,[C]:{...E[C],[R]:F}}))},U=(C,R)=>{ee(F=>({...F,[C]:R}))},q=async C=>{var M,H;C.preventDefault(),console.log(" ContractEditForm handleSubmit - contractForm:",L);const R=c.find(G=>G.id===L.productId),F=N.find(G=>G.id===L.collectorId),E={...L,productName:(R==null?void 0:R.name)||L.productDetails.name,line:(F==null?void 0:F.code)||(F==null?void 0:F.name)||L.line||"",totalAmount:parseFloat(L.productDetails.price)||L.totalAmount,installmentPeriod:parseInt(L.plan.months)||L.installmentPeriod,startDate:L.contractDate,endDate:(()=>{const G=new Date(L.contractDate),re=parseInt(L.plan.months)||L.installmentPeriod;return G.setMonth(G.getMonth()+re),G.toISOString().split("T")[0]})(),plan:{...L.plan,monthlyPayment:parseFloat(L.plan.monthlyPayment)||0}};console.log(" ContractEditForm handleSubmit - prepared contractData:",E);try{P(!0);const G=await ra.update(e,E);if((M=G.data)!=null&&M.success)we({title:"",description:""}),n&&n(G.data.data);else throw new Error(((H=G.data)==null?void 0:H.message)||"")}catch(G){console.error("Error updating contract:",G),we({title:"",description:G.message||"",variant:"destructive"})}finally{P(!1)}};return A?i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-8 h-8 border-4 border-orange-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"..."}),i.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Contract ID: ",e]})]})})}):(console.log(" ContractEditForm state:",{allCustomersCount:(s==null?void 0:s.length)||0,allInventoryCount:(c==null?void 0:c.length)||0,allEmployeesCount:(h==null?void 0:h.length)||0,allCheckersCount:(v==null?void 0:v.length)||0,allCollectorsCount:(N==null?void 0:N.length)||0,loadingCustomers:o,loadingInventory:d,loadingEmployees:g,loadingCheckers:y,loadingCollectors:_,allCollectorsSample:N==null?void 0:N.slice(0,3),allCollectorsStatuses:N==null?void 0:N.map(C=>({id:C.id,name:C.name,position:C.position,code:C.code})),contractFormCollectorId:L==null?void 0:L.collectorId,contractFormLine:L==null?void 0:L.line,contractFormSalespersonId:L==null?void 0:L.salespersonId,contractFormInspectorId:L==null?void 0:L.inspectorId}),i.jsxs($e.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(mr,{className:"w-6 h-6 text-blue-600"}),""]}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[": ",L.contractNumber]})]}),i.jsxs(ae,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[i.jsx(ai,{className:"w-4 h-4"}),""]})]}),i.jsxs("form",{onSubmit:q,className:"space-y-6",children:[i.jsxs(Ld,{title:"",icon:br,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(To,{label:"",value:L.customerId,onChange:C=>U("customerId",C.target.value),options:s,placeholder:o?"...":"----"}),i.jsx(To,{label:"",value:L.guarantorId,onChange:C=>U("guarantorId",C.target.value),options:s,placeholder:o?"...":"----"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(ot,{label:"",value:L.contractNumber,onChange:C=>U("contractNumber",C.target.value),placeholder:""}),i.jsx(ot,{label:"",type:"date",value:L.contractDate,onChange:C=>U("contractDate",C.target.value)})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(db,{label:"",value:L.customerDetails.title,onChange:C=>j("customerDetails","title",C),options:["","",""]}),i.jsx(ot,{label:"-",value:`${L.customerDetails.name} ${L.customerDetails.surname}`.trim(),onChange:C=>{const F=C.target.value.split(" "),E=F[0]||"",M=F.slice(1).join(" ")||"";j("customerDetails","name",E),j("customerDetails","surname",M)},placeholder:"-"}),i.jsx(ot,{label:"",value:L.customerDetails.nickname,onChange:C=>j("customerDetails","nickname",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.customerDetails.age,onChange:C=>j("customerDetails","age",C.target.value),placeholder:"",type:"number"}),i.jsx(ot,{label:"",value:L.customerDetails.idCard,onChange:C=>j("customerDetails","idCard",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.customerDetails.address,onChange:C=>j("customerDetails","address",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.customerDetails.moo,onChange:C=>j("customerDetails","moo",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.customerDetails.road,onChange:C=>j("customerDetails","road",C.target.value),placeholder:""}),i.jsx(ot,{label:"/",value:L.customerDetails.subdistrict,onChange:C=>j("customerDetails","subdistrict",C.target.value),placeholder:"/"}),i.jsx(ot,{label:"/",value:L.customerDetails.district,onChange:C=>j("customerDetails","district",C.target.value),placeholder:"/"}),i.jsx(ot,{label:"",value:L.customerDetails.province,onChange:C=>j("customerDetails","province",C.target.value),placeholder:""}),i.jsx(ot,{label:" 1",value:L.customerDetails.phone1,onChange:C=>j("customerDetails","phone1",C.target.value),placeholder:""}),i.jsx(ot,{label:" 2",value:L.customerDetails.phone2,onChange:C=>j("customerDetails","phone2",C.target.value),placeholder:""}),i.jsx(ot,{label:" 3",value:L.customerDetails.phone3,onChange:C=>j("customerDetails","phone3",C.target.value),placeholder:""})]})]}),i.jsx(Ld,{title:"",icon:Nn,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[i.jsx(db,{label:"",value:L.guarantorDetails.title,onChange:C=>j("guarantorDetails","title",C),options:["","",""]}),i.jsx(ot,{label:"-",value:`${L.guarantorDetails.name} ${L.guarantorDetails.surname}`.trim(),onChange:C=>{const F=C.target.value.split(" "),E=F[0]||"",M=F.slice(1).join(" ")||"";j("guarantorDetails","name",E),j("guarantorDetails","surname",M)},placeholder:"-"}),i.jsx(ot,{label:"",value:L.guarantorDetails.nickname,onChange:C=>j("guarantorDetails","nickname",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.guarantorDetails.age,onChange:C=>j("guarantorDetails","age",C.target.value),placeholder:"",type:"number"}),i.jsx(ot,{label:"",value:L.guarantorDetails.idCard,onChange:C=>j("guarantorDetails","idCard",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.guarantorDetails.address,onChange:C=>j("guarantorDetails","address",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.guarantorDetails.moo,onChange:C=>j("guarantorDetails","moo",C.target.value),placeholder:""}),i.jsx(ot,{label:"",value:L.guarantorDetails.road,onChange:C=>j("guarantorDetails","road",C.target.value),placeholder:""}),i.jsx(ot,{label:"/",value:L.guarantorDetails.subdistrict,onChange:C=>j("guarantorDetails","subdistrict",C.target.value),placeholder:"/"}),i.jsx(ot,{label:"/",value:L.guarantorDetails.district,onChange:C=>j("guarantorDetails","district",C.target.value),placeholder:"/"}),i.jsx(ot,{label:"",value:L.guarantorDetails.province,onChange:C=>j("guarantorDetails","province",C.target.value),placeholder:""}),i.jsx(ot,{label:" 1",value:L.guarantorDetails.phone1,onChange:C=>j("guarantorDetails","phone1",C.target.value),placeholder:""}),i.jsx(ot,{label:" 2",value:L.guarantorDetails.phone2,onChange:C=>j("guarantorDetails","phone2",C.target.value),placeholder:""}),i.jsx(ot,{label:" 3",value:L.guarantorDetails.phone3,onChange:C=>j("guarantorDetails","phone3",C.target.value),placeholder:""})]})}),i.jsxs(Ld,{title:"",icon:er,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:" *"}),i.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-sm text-gray-700 min-h-[80px] flex items-start",children:(()=>{const C=c.find(R=>String(R.id)===String(L.productId));return console.log(" Product display debug:"),console.log("  - contractForm.productId:",L.productId),console.log("  - allInventory length:",c.length),console.log("  - selectedProduct:",C),console.log("  - contractForm.productDetails:",L.productDetails),C?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(er,{className:"w-4 h-4 text-purple-600"}),i.jsx("span",{className:"font-medium",children:C.product_name||C.name||""}),C.product_code&&i.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded",children:C.product_code})]}),i.jsxs("div",{className:"text-xs text-gray-600 space-y-1 ml-6",children:[C.product_model&&i.jsxs("div",{children:[": ",C.product_model]}),C.product_serial_number&&i.jsxs("div",{children:["S/N: ",C.product_serial_number]}),C.cost_price&&i.jsxs("div",{children:[": ",parseFloat(C.cost_price).toLocaleString()]})]})]}):L.productDetails.name?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(er,{className:"w-4 h-4 text-purple-600"}),i.jsx("span",{className:"font-medium",children:L.productDetails.name})]}),i.jsxs("div",{className:"text-xs text-gray-600 space-y-1 ml-6",children:[L.productDetails.model&&i.jsxs("div",{children:[": ",L.productDetails.model]}),L.productDetails.serialNumber&&i.jsxs("div",{children:["S/N: ",L.productDetails.serialNumber]}),L.productDetails.price&&i.jsxs("div",{children:[": ",parseFloat(L.productDetails.price).toLocaleString()]})]})]}):i.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[i.jsx(er,{className:"w-4 h-4"}),i.jsx("span",{children:""})]})})()})]}),(()=>{const C=c.filter(E=>E.status==="active"&&Number(E.remaining_quantity1)>0),R=c.find(E=>String(E.id)===String(L.productId));console.log(" Product selection debug:"),console.log("  - contractForm.productId:",L.productId),console.log("  - selectedProduct:",R),console.log("  - activeInventory count:",C.length),console.log("  - allInventory count:",c.length);const F=R&&!C.some(E=>String(E.id)===String(R.id))?[R,...C]:C;return console.log(" Product options:",F.map(E=>({id:E.id,product_name:E.product_name,status:E.status}))),i.jsx(To,{label:"",value:L.productId,onChange:E=>U("productId",E.target.value),options:F.map(E=>({...E,displayName:E.product_name||E.name||"",searchText:`${E.product_name||""} ${E.product_code||""}`.trim()})),placeholder:d?"...":"----"})})()]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(ot,{label:"",value:L.productDetails.price,onChange:C=>j("productDetails","price",C.target.value),placeholder:"",type:"number"}),i.jsx(ot,{label:"",value:L.productDetails.model,onChange:C=>j("productDetails","model",C.target.value),placeholder:""}),i.jsx(ot,{label:"S/N",value:L.productDetails.serialNumber,onChange:C=>j("productDetails","serialNumber",C.target.value),placeholder:"Serial Number"}),i.jsx(ot,{label:"",value:L.plan.downPayment,onChange:C=>j("plan","downPayment",C.target.value),placeholder:"",type:"number"}),i.jsx(ot,{label:"/",value:L.plan.monthlyPayment,onChange:C=>j("plan","monthlyPayment",C.target.value),placeholder:"",type:"number"}),i.jsx(ot,{label:"",value:L.plan.months,onChange:C=>j("plan","months",C.target.value),placeholder:"",type:"number"}),i.jsx(ot,{label:"",type:"date",value:L.plan.collectionDate?L.plan.collectionDate.split("T")[0]:"",onChange:C=>j("plan","collectionDate",C.target.value),placeholder:"--  31-12-2564"})]})]}),i.jsx(Ld,{title:"",icon:Ws,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(To,{label:"",value:L.salespersonId,onChange:C=>U("salespersonId",C.target.value),options:h,placeholder:g?"...":"----"}),i.jsx(To,{label:"",value:L.inspectorId,onChange:C=>U("inspectorId",C.target.value),options:v,placeholder:y?"...":"----"}),(()=>{const C=N.find(E=>String(E.id)===String(L.collectorId)||E.code===L.line||E.name===L.line||E.full_name===L.line);let R=null;L.line&&!C&&(R={id:`line_${L.line}`,name:L.line,full_name:L.line,code:L.line,position:"collector",isVirtual:!0}),console.log(" Collector selection debug:"),console.log("  - contractForm.collectorId:",L.collectorId),console.log("  - contractForm.line:",L.line),console.log("  - selectedCollector:",C),console.log("  - virtualCollector:",R),console.log("  - allCollectors count:",N.length),console.log("  - allCollectors sample:",N.slice(0,3).map(E=>({id:E.id,name:E.name,position:E.position,code:E.code})));let F=N;return C&&!N.some(E=>String(E.id)===String(C.id))?F=[C,...N]:R&&(F=[R,...N]),console.log(" Collector options:",F.map(E=>({id:E.id,name:E.name,position:E.position,code:E.code,isVirtual:E.isVirtual}))),console.log(" Final collectorOptions count:",F.length),console.log(" Final collectorOptions with selectedCollector:",C?"YES":"NO"),console.log(" Final collectorOptions with virtualCollector:",R?"YES":"NO"),i.jsx(To,{label:"",value:L.collectorId||(R?R.id:""),onChange:E=>{const M=E.target.value,H=String(M||"");if(H.startsWith("line_"))U("line",H.replace("line_","")),U("collectorId","");else{const G=N.find(re=>String(re.id)===H);G&&(U("collectorId",G.id),U("line",G.code||G.name||""))}},options:F,placeholder:_?"...":"----"})})()]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx(ae,{type:"button",variant:"outline",onClick:r,className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:""}),i.jsx(ae,{type:"submit",disabled:V,className:"bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:V?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"..."]}):i.jsxs(i.Fragment,{children:[i.jsx(z4,{className:"w-4 h-4 mr-2"}),""]})})]})]})]}))},UY=({contracts:e,onPrint:t,onView:r,onEdit:n,onDelete:s,sortField:a,sortDirection:o,onSort:l})=>{const c=h=>{switch(h){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},u=h=>{switch(h){case"active":return i.jsx($0,{className:"w-3 h-3"});case"completed":return i.jsx(ts,{className:"w-3 h-3"});case"cancelled":return i.jsx(Zi,{className:"w-3 h-3"});default:return i.jsx($0,{className:"w-3 h-3"})}},d=h=>{switch(h){case"active":return"";case"completed":return"";case"cancelled":return"";default:return""}},f=h=>a!==h?i.jsx(Zt,{className:"w-4 h-4 text-gray-400"}):o==="asc"?i.jsx(Zt,{className:"w-4 h-4 text-blue-600"}):i.jsx(Wt,{className:"w-4 h-4 text-blue-600"});return e.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Bg,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-500",children:""})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>l&&l("contractNumber"),children:i.jsxs("div",{className:"flex items-center gap-2",children:["",f("contractNumber")]})}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>l&&l("contractDate"),children:i.jsxs("div",{className:"flex items-center gap-2",children:["",f("contractDate")]})}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 cursor-pointer hover:bg-gray-50 select-none",onClick:()=>l&&l("customerName"),children:i.jsxs("div",{className:"flex items-center gap-2",children:["",f("customerName")]})}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:""}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"/"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700 w-48",children:""}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:""}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:""})]})}),i.jsx("tbody",{children:e.map((h,m)=>{var g,p;return i.jsxs($e.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:m*.05},className:"border-b border-gray-100 hover:bg-gray-50",children:[i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"font-medium text-blue-600",children:h.contractNumber})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"text-sm text-gray-600",children:new Date(h.contractDate).toLocaleDateString("th-TH")})}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("div",{className:"font-medium text-gray-900",children:h.customerName}),i.jsx("div",{className:"text-xs text-gray-500",children:h.customerPhone})]}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("div",{className:"text-gray-900",children:h.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["",(g=h.productPrice)==null?void 0:g.toLocaleString()]})]}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsxs("div",{className:"font-medium text-green-600",children:["",(p=h.monthlyPayment)==null?void 0:p.toLocaleString()]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[h.months," "]})]}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"text-gray-900",children:[i.jsx("div",{className:"font-medium text-blue-600",children:h.employeeName||h.salespersonFullName||""}),i.jsxs("div",{className:"text-xs text-purple-600",children:[": ",h.inspectorName||h.inspectorFullName||""]}),i.jsxs("div",{className:"text-xs text-green-600",children:[": ",h.line||""]})]})}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${c(h.status)}`,children:[u(h.status),i.jsx("span",{className:"ml-1",children:d(h.status)})]})}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"flex gap-1",children:[i.jsxs(ae,{size:"sm",onClick:()=>t(h),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-2 py-1",children:[i.jsx(Qi,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",variant:"outline",onClick:()=>r(h),className:"text-gray-600 border-gray-200 hover:bg-gray-50 text-xs px-2 py-1",children:[i.jsx(au,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",variant:"outline",onClick:()=>n(h),className:"text-orange-600 border-orange-200 hover:bg-orange-50 text-xs px-2 py-1",children:[i.jsx(Cs,{className:"w-3 h-3 mr-1"}),""]}),i.jsxs(ae,{size:"sm",variant:"outline",onClick:()=>s(h),className:"text-red-600 border-red-200 hover:bg-red-50 text-xs px-2 py-1",children:[i.jsx(ka,{className:"w-3 h-3 mr-1"}),""]})]})})]},h.id)})})]})})},VY=({contract:e,onClose:t,onEdit:r,onPrint:n})=>{var o,l,c,u,d,f,h,m,g,p,v,w,y,x,N;if(!e)return null;const s=S=>S?new Date(S).toLocaleDateString("th-TH"):"-",a=S=>S?`${parseFloat(S).toLocaleString()}`:"0";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs($e.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[" ",e.contractNumber]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{size:"sm",onClick:()=>r(e),className:"bg-orange-600 hover:bg-orange-700 text-white",children:""}),i.jsx(ae,{size:"sm",onClick:()=>n(e),className:"bg-blue-600 hover:bg-blue-700 text-white",children:""}),i.jsx(ae,{variant:"outline",size:"sm",onClick:t,className:"text-gray-500 hover:text-gray-700",children:i.jsx(X4,{className:"w-4 h-4"})})]})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[i.jsx(mr,{className:"w-5 h-5"}),""]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:e.contractNumber})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:s(e.contractDate)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${e.status==="active"?"bg-green-100 text-green-800":e.status==="completed"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:e.status==="active"?"":e.status==="completed"?"":""})]})]})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-3 flex items-center gap-2",children:[i.jsx(br,{className:"w-5 h-5"}),""]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:((o=e.customerDetails)==null?void 0:o.name)||e.customerName})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:((l=e.customerDetails)==null?void 0:l.phone1)||e.customerPhone})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium text-right",children:((c=e.customerDetails)==null?void 0:c.address)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"/:"}),i.jsx("span",{className:"font-medium",children:((u=e.customerDetails)==null?void 0:u.subdistrict)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"/:"}),i.jsx("span",{className:"font-medium",children:((d=e.customerDetails)==null?void 0:d.district)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:((f=e.customerDetails)==null?void 0:f.province)||"-"})]})]})]}),((h=e.guarantorDetails)==null?void 0:h.name)&&i.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-purple-800 mb-3 flex items-center gap-2",children:[i.jsx(Nn,{className:"w-5 h-5"}),""]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:e.guarantorDetails.name})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:e.guarantorDetails.phone1||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium text-right",children:e.guarantorDetails.address||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"/:"}),i.jsx("span",{className:"font-medium",children:e.guarantorDetails.subdistrict||"-"})]})]})]}),i.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-orange-800 mb-3 flex items-center gap-2",children:[i.jsx(er,{className:"w-5 h-5"}),""]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:((m=e.productDetails)==null?void 0:m.name)||e.productName})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:a(((g=e.productDetails)==null?void 0:g.price)||e.totalAmount)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:((p=e.productDetails)==null?void 0:p.model)||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"S/N:"}),i.jsx("span",{className:"font-medium",children:((v=e.productDetails)==null?void 0:v.serialNumber)||"-"})]})]})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:[i.jsx(ii,{className:"w-5 h-5"}),""]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:a(((w=e.planDetails)==null?void 0:w.downPayment)||e.downPayment)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:a(((y=e.planDetails)==null?void 0:y.monthlyPayment)||e.monthlyPayment)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsxs("span",{className:"font-medium",children:[((x=e.planDetails)==null?void 0:x.months)||e.months||e.installmentPeriod," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:s(e.startDate)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:s(e.endDate)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:((N=e.planDetails)==null?void 0:N.collectionDate)||"-"})]})]})]}),i.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-indigo-800 mb-3 flex items-center gap-2",children:[i.jsx(Ws,{className:"w-5 h-5"}),""]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:e.salespersonName||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:e.inspectorName||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-medium",children:e.line||"-"})]})]})]})]})]})})},zY=(e,t=[])=>{const r=window.open("","_blank"),n=o=>o?new Date(o).toLocaleDateString("th-TH"):"",s=o=>Array.from({length:15}).map((l,c)=>{const u=o+c,d=t[u];return`
      <tr>
        <td>${u+1}</td>
        <td>${d?n(d.dueDate||d.payment_date):""}</td>
        <td>${d&&(d.receiptNumber||d.receipt_number)||""}</td>
        <td>${d?Number(d.amount||0).toLocaleString():""}</td>
        <td>${d&&d.remaining!=null?Number(d.remaining).toLocaleString():""}</td>
      </tr>
    `}).join(""),a=`
  <!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title> ${(e==null?void 0:e.contractNumber)||""}</title>
      <style>
        @page { size: 80mm auto; margin: 5mm; }
        body { font-family: 'Sarabun', system-ui, sans-serif; color: #111; display:flex; justify-content:center; }
        .sheet { width: 80mm; margin: 0 auto; }
        .header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 4px; }
        .brand { font-weight: 800; font-size: 14px; }
        .addr { font-size: 10px; color: #333; }
        .small { font-size: 10px; color: #444; }
        .row { display: flex; gap: 4px; margin: 2px 0; align-items: baseline; }
        .label { width: 22mm; font-weight: 600; font-size: 11px; }
        .value { flex: 1; font-size: 11px; border-bottom: 1px solid #999; padding-bottom: 2px; }
        .box { border: 1px solid #666; padding: 4px; margin-top: 6px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-top: 6px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #999; font-size: 10px; padding: 3px; text-align: center; }
        th { background: #f6f6f6; }
      </style>
    </head>
    <body onload="window.print(); setTimeout(() => window.close(), 300);">
      <div class="sheet">
        <div class="header">
          <div>
            <div class="brand"> </div>
            <div class="addr">116  3 . . . 77000</div>
            <div class="addr">. 092-2856965</div>
          </div>
          <div class="small">: ${(e==null?void 0:e.contractNumber)||"-"}</div>
        </div>

        <div class="box">
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.customerName)||""}  ${(e==null?void 0:e.customerPhone)||""}</div></div>
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.customerAddress)||""}</div></div>
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.guarantorName)||""}  ${(e==null?void 0:e.guarantorPhone)||""}</div></div>
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.guarantorAddress)||""}</div></div>
        </div>

        <div class="box">
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.productName)||""}</div></div>
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.productModel)||""}</div></div>
          <div class="row"><div class="label">S/N</div><div class="value">${(e==null?void 0:e.productSerialNumber)||""}</div></div>
          <div class="row"><div class="label"></div><div class="value">${Number((e==null?void 0:e.totalAmount)||(e==null?void 0:e.productPrice)||0).toLocaleString()}</div></div>
          <div class="row"><div class="label"></div><div class="value">${Number((e==null?void 0:e.downPayment)||0).toLocaleString()}</div></div>
          <div class="row"><div class="label">/</div><div class="value">${Number((e==null?void 0:e.monthlyPayment)||(e==null?void 0:e.installmentAmount)||0).toLocaleString()}</div></div>
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.months)||(e==null?void 0:e.installmentPeriod)||""} </div></div>
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.collectionDate)||""}</div></div>
          <div class="row"><div class="label"></div><div class="value">${n((e==null?void 0:e.contractDate)||(e==null?void 0:e.startDate))}</div></div>
          <div class="row"><div class="label"></div><div class="value">${(e==null?void 0:e.salespersonName)||(e==null?void 0:e.employeeName)||""}</div></div>
        </div>

        <div class="box">
          <div class="grid">
            <div>
              <table>
                <thead>
                  <tr>
                    <th></th>
                    <th>//</th>
                    <th></th>
                    <th></th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>${s(0)}</tbody>
              </table>
            </div>
            <div>
              <table>
                <thead>
                  <tr>
                    <th></th>
                    <th>//</th>
                    <th></th>
                    <th></th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>${s(15)}</tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </body>
  </html>`;r.document.write(a),r.document.close(),r.focus()},WY=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState([]),[o,l]=k.useState([]),[c,u]=k.useState([]),[d,f]=k.useState(!0),[h,m]=k.useState(!1),[g,p]=k.useState(!1),[v,w]=k.useState(""),[y,x]=k.useState("all"),[N,S]=k.useState("contractNumber"),[_,b]=k.useState("asc"),[A,D]=k.useState(null),[V,P]=k.useState(!1),[T,z]=k.useState(!1),[L,ee]=k.useState(null);k.useEffect(()=>{e?j():(n([]),a([]),l([]),u([]))},[e]);const j=async()=>{var Q,J,O,ve;try{if(f(!0),console.log("Loading data for branch:",e),!e){console.log("No selectedBranch, using empty arrays"),n([]),a([]),setProducts([]),u([]);return}const[ye,xe,ke,ue]=await Promise.all([ra.getAll(e),Li.getAll(e),ms.getAll({branchId:e}),na.getAll(e)]);console.log("API responses:",{contractsRes:ye,customersRes:xe,inventoryRes:ke,employeesRes:ue});let Ne=(Q=ye.data)!=null&&Q.success?ye.data.data:ye.data||[];const De=(J=xe.data)!=null&&J.success?xe.data.data:xe.data||[],Ee=(O=ke.data)!=null&&O.success?ke.data.data:ke.data||[],Ie=(ve=ue.data)!=null&&ve.success?ue.data.data:ue.data||[];console.log(" Raw API responses:",{contracts:ye.data,customers:xe.data,inventory:ke.data,employees:ue.data});const te=Ne.length;Ne=Ne.filter((de,Fe,Oe)=>Fe===Oe.findIndex(Ue=>Ue.id===de.id)),te!==Ne.length&&(console.log(" Removed duplicate contracts:",te-Ne.length),console.log(" Original contracts:",te),console.log(" Unique contracts:",Ne.length)),console.log(" Processed data:",{contracts:Ne.length,customers:De.length,inventory:Ee.length,employees:Ie.length}),console.log(" First contract sample:",Ne[0]),n(Ne),a(De),l(Ee),u(Ie),console.log(" State updated - contracts:",Ne.length,"customers:",De.length)}catch(ye){console.error("Error loading data:",ye),we({title:"",description:"",variant:"destructive"}),n([]),a([]),setProducts([]),u([])}finally{f(!1)}},U=async Q=>{var J;try{m(!0);const O={...Q,branchId:e,status:"active"},ve=await ra.create(O),ye=ve.data;n(xe=>[ye,...xe]),p(!1),lt.close(),lt.fire({icon:"success",title:"!",html:`
          <div class="text-left">
            <p><strong>:</strong> ${ye.contractNumber||""}</p>
            <p><strong>:</strong> ${ye.customerName||""}</p>
            <p><strong>:</strong> ${ye.productName||""}</p>
            <p><strong>:</strong> ${((J=ye.totalAmount)==null?void 0:J.toLocaleString())||"0"} </p>
            <p><strong>:</strong> ${new Date(ye.contractDate).toLocaleDateString("th-TH")}</p>
          </div>
        `,confirmButtonText:"",confirmButtonColor:"#7c3aed"}),ve.warning&&lt.fire({icon:"warning",title:"",text:ve.warning,confirmButtonText:"",confirmButtonColor:"#7c3aed"})}catch(O){console.error("Error creating contract:",O),lt.close(),lt.fire({icon:"error",title:"",text:" ",confirmButtonText:"",confirmButtonColor:"#7c3aed"})}finally{m(!1)}},q=async Q=>{var J;try{if(!Q.contractNumber){we({title:"",description:" ",variant:"destructive"});return}let O=[];try{const ve=await ra.getById(Q.id);O=(((J=ve.data)==null?void 0:J.data)||ve.data||{}).payments||[]}catch(ve){console.warn(" Unable to load payments, continue without.",ve==null?void 0:ve.message)}zY(Q,O),we({title:"",description:` ${Q.contractNumber}`})}catch(O){console.error("Error printing contract:",O),we({title:"",description:"",variant:"destructive"})}},C=Q=>{D(Q),P(!0)},R=Q=>{ee(Q.id),z(!0)},F=async Q=>{var O,ve;if((await lt.fire({title:"",html:`
        <div class="text-left">
          <p class="mb-2"> <strong>${Q.contractNumber}</strong> ?</p>
          <div class="bg-gray-100 p-3 rounded-lg text-sm">
            <p><strong>:</strong> ${Q.customerName||""}</p>
            <p><strong>:</strong> ${Q.productName||""}</p>
            <p><strong>:</strong> ${new Date(Q.contractDate).toLocaleDateString("th-TH")}</p>
          </div>
          <p class="text-red-600 text-sm mt-2"> </p>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0,customClass:{popup:"rounded-lg",confirmButton:"rounded-md",cancelButton:"rounded-md"}})).isConfirmed)try{lt.fire({title:"...",text:"",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{lt.showLoading()}});const ye=await ra.delete(Q.id);if((O=ye.data)!=null&&O.success)n(xe=>xe.filter(ke=>ke.id!==Q.id)),lt.fire({icon:"success",title:"",text:` ${Q.contractNumber} `,confirmButtonColor:"#059669",confirmButtonText:""});else throw new Error(((ve=ye.data)==null?void 0:ve.message)||"")}catch(ye){console.error("Error deleting contract:",ye),lt.fire({icon:"error",title:"",text:ye.message||"",confirmButtonColor:"#dc2626",confirmButtonText:""})}},E=Q=>{var J;n(O=>O.map(ve=>ve.id===Q.id?Q:ve)),z(!1),ee(null),lt.fire({icon:"success",title:"!",html:`
        <div class="text-left">
          <p><strong>:</strong> ${Q.contractNumber||""}</p>
          <p><strong>:</strong> ${Q.customerName||""}</p>
          <p><strong>:</strong> ${Q.productName||""}</p>
          <p><strong>:</strong> ${((J=Q.totalAmount)==null?void 0:J.toLocaleString())||"0"} </p>
        </div>
      `,confirmButtonText:"",confirmButtonColor:"#7c3aed"})},M=()=>{z(!1),ee(null)},H=Q=>{N===Q?b(_==="asc"?"desc":"asc"):(S(Q),b("asc"))},G=Q=>[...Q].sort((J,O)=>{let ve=J[N],ye=O[N];if(ve==null&&(ve=""),ye==null&&(ye=""),typeof ve=="string"&&(ve=ve.toLowerCase()),typeof ye=="string"&&(ye=ye.toLowerCase()),N==="contractNumber"){const xe=ve.match(/^([A-Z]+)(\d+)$/),ke=ye.match(/^([A-Z]+)(\d+)$/);if(xe&&ke){const ue=xe[1],Ne=ke[1],De=parseInt(xe[2]),Ee=parseInt(ke[2]);return ue===Ne?_==="asc"?De-Ee:Ee-De:ue.localeCompare(Ne)}}if(N==="contractDate"){const xe=new Date(ve),ke=new Date(ye);return _==="asc"?xe-ke:ke-xe}return typeof ve=="number"&&typeof ye=="number"?_==="asc"?ve-ye:ye-ve:ve<ye?_==="asc"?-1:1:ve>ye?_==="asc"?1:-1:0}),re=r.filter((Q,J,O)=>J===O.findIndex(ve=>ve.id===Q.id));console.log(" Filtering contracts - total:",r.length,"unique:",re.length);const he=re.filter(Q=>{var ve,ye,xe,ke;const J=((ve=Q.contractNumber)==null?void 0:ve.toLowerCase().includes(v.toLowerCase()))||((ye=Q.customerName)==null?void 0:ye.toLowerCase().includes(v.toLowerCase()))||((xe=Q.productName)==null?void 0:xe.toLowerCase().includes(v.toLowerCase()))||((ke=Q.salespersonName)==null?void 0:ke.toLowerCase().includes(v.toLowerCase())),O=y==="all"||Q.status===y;return J&&O});console.log(" Filtered contracts:",he.length);const oe=G(he),ce=[{value:"all",label:""},{value:"active",label:""},{value:"completed",label:""},{value:"cancelled",label:""}];return d?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:"..."})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Pt,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"..."})]})})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600",children:[" - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Bg,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",he.length," "]}),r.length!==re.length&&i.jsxs("span",{className:"text-orange-600",children:["( ",r.length," )"]}),i.jsxs("span",{className:"text-blue-600",children:["| : ",N==="contractNumber"?"":N==="contractDate"?"":N==="customerName"?"":N==="totalAmount"?"":"","(",_==="asc"?"":"",")"]})]}),i.jsxs(ae,{onClick:()=>{console.log(" ContractsPage: Toggle showForm from",g,"to",!g),p(!g)},className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:", , , ...",value:v,onChange:Q=>w(Q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("select",{value:y,onChange:Q=>x(Q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:ce.map(Q=>i.jsx("option",{value:Q.value,children:Q.label},Q.value))}),i.jsxs("select",{value:`${N}-${_}`,onChange:Q=>{const[J,O]=Q.target.value.split("-");S(J),b(O)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"contractNumber-asc",children:":   "}),i.jsx("option",{value:"contractNumber-desc",children:":   "}),i.jsx("option",{value:"contractDate-asc",children:":   "}),i.jsx("option",{value:"contractDate-desc",children:":   "}),i.jsx("option",{value:"customerName-asc",children:": -"}),i.jsx("option",{value:"customerName-desc",children:": -"}),i.jsx("option",{value:"totalAmount-asc",children:":   "}),i.jsx("option",{value:"totalAmount-desc",children:":   "})]})]})]}),g&&i.jsxs(i.Fragment,{children:[console.log(" ContractsPage: Rendering ContractForm with props:",{customersCount:(s==null?void 0:s.length)||0,inventoryCount:(o==null?void 0:o.length)||0,employeesCount:(c==null?void 0:c.length)||0,selectedBranch:e,currentBranch:t,showForm:g}),i.jsx(BY,{customers:s,inventory:o,employees:c,onSubmit:U,selectedBranch:e,currentBranch:t,submitting:h})]}),T&&L&&i.jsx($Y,{contractId:L,selectedBranch:e,onBack:M,onSuccess:E}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})}),i.jsx("div",{className:"p-6",children:i.jsx(UY,{contracts:oe,onPrint:q,onView:C,onEdit:R,onDelete:F,sortField:N,sortDirection:_,onSort:H})})]}),V&&A&&i.jsx(VY,{contract:A,onClose:()=>P(!1),onEdit:R,onPrint:q})]})},HY=({selectedBranch:e,currentBranch:t})=>{const[r,n]=k.useState([]),[s,a]=k.useState(!0),[o,l]=k.useState(!1),[c,u]=k.useState(""),[d,f]=k.useState("all"),[h,m]=k.useState({returnNumber:"",returnDate:new Date().toISOString().split("T")[0],customerName:"",productName:"",quantity:1,reason:"",condition:"good",refundAmount:0,status:"pending",notes:"",processedBy:""});k.useEffect(()=>{g()},[e]);const g=async()=>{try{a(!0),n([])}catch(S){console.error("Error loading returns:",S),we({title:"",description:"",variant:"destructive"})}finally{a(!1)}},p=()=>{const S="R",_=new Date,b=_.getFullYear().toString().slice(-2),A=(_.getMonth()+1).toString().padStart(2,"0"),D=_.getDate().toString().padStart(2,"0"),V=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`${S}${b}${A}${D}${V}`},v=async S=>{if(S.preventDefault(),!h.customerName||!h.productName||!h.reason){we({title:"",description:"  ",variant:"destructive"});return}try{const _={...h,id:Date.now().toString(),returnNumber:p(),branchId:e,branchName:t==null?void 0:t.name,createdAt:new Date().toISOString(),processedBy:""};n(b=>[_,...b]),m({returnNumber:"",returnDate:new Date().toISOString().split("T")[0],customerName:"",productName:"",quantity:1,reason:"",condition:"good",refundAmount:0,status:"pending",notes:"",processedBy:""}),l(!1),we({title:"! ",description:` ${_.returnNumber} `})}catch(_){console.error("Error creating return:",_),we({title:"",description:"",variant:"destructive"})}},w=async(S,_)=>{try{n(A=>A.map(D=>D.id===S?{...D,status:_,updatedAt:new Date().toISOString()}:D)),we({title:"",description:`: ${{pending:"",approved:"",rejected:"",completed:""}[_]}`})}catch(b){console.error("Error updating return status:",b),we({title:"",description:"",variant:"destructive"})}},y=S=>{switch(S){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"approved":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},x=S=>{switch(S){case"pending":return"";case"approved":return"";case"rejected":return"";case"completed":return"";default:return""}},N=r.filter(S=>{var A,D,V;const _=((A=S.customerName)==null?void 0:A.toLowerCase().includes(c.toLowerCase()))||((D=S.productName)==null?void 0:D.toLowerCase().includes(c.toLowerCase()))||((V=S.returnNumber)==null?void 0:V.toLowerCase().includes(c.toLowerCase())),b=d==="all"||S.status===d;return _&&b});return s?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:"..."})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Pt,{className:"w-8 h-8 animate-spin text-gray-400"}),i.jsx("span",{className:"ml-2 text-gray-500",children:"..."})]})})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600",children:[" - ",t==null?void 0:t.name]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Bp,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",N.length," "]})]}),i.jsxs(ae,{onClick:()=>l(!o),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]})]}),o&&i.jsxs($e.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),i.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"text",value:h.customerName,onChange:S=>m(_=>({..._,customerName:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("input",{type:"text",value:h.productName,onChange:S=>m(_=>({..._,productName:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"number",value:h.quantity,onChange:S=>m(_=>({..._,quantity:parseInt(S.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"number",value:h.refundAmount,onChange:S=>m(_=>({..._,refundAmount:parseFloat(S.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("select",{value:h.condition,onChange:S=>m(_=>({..._,condition:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"good",children:""}),i.jsx("option",{value:"fair",children:""}),i.jsx("option",{value:"poor",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"date",value:h.returnDate,onChange:S=>m(_=>({..._,returnDate:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),i.jsx("textarea",{value:h.reason,onChange:S=>m(_=>({..._,reason:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"",rows:"3",required:!0})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("textarea",{value:h.notes,onChange:S=>m(_=>({..._,notes:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"",rows:"2"})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3",children:[i.jsx(ae,{type:"button",variant:"outline",onClick:()=>l(!1),children:""}),i.jsxs(ae,{type:"submit",className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:", , ...",value:c,onChange:S=>u(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{value:d,onChange:S=>f(S.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"pending",children:""}),i.jsx("option",{value:"approved",children:""}),i.jsx("option",{value:"rejected",children:""}),i.jsx("option",{value:"completed",children:""})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})}),i.jsx("div",{className:"p-6",children:N.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Bp,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-500 mb-4",children:""}),i.jsxs(ae,{onClick:()=>l(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]}):i.jsx("div",{className:"grid gap-4",children:N.map((S,_)=>i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:_*.1},className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:S.customerName}),i.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:S.returnNumber})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(er,{className:"w-4 h-4"}),S.productName]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ya,{className:"w-4 h-4"}),new Date(S.returnDate).toLocaleDateString("th-TH")]}),S.refundAmount>0&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(mr,{className:"w-4 h-4"}),"",S.refundAmount.toLocaleString()]})]}),S.reason&&i.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("strong",{children:":"})," ",S.reason]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium border ${y(S.status)}`,children:x(S.status)}),S.status==="pending"&&i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(ae,{size:"sm",onClick:()=>w(S.id,"approved"),className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(ts,{className:"w-4 h-4 mr-1"}),""]}),i.jsxs(ae,{size:"sm",onClick:()=>w(S.id,"rejected"),className:"bg-red-600 hover:bg-red-700 text-white",children:[i.jsx(Uf,{className:"w-4 h-4 mr-1"}),""]})]})]})]})},S.id))})})]})]})},GY=({products:e,installmentPlans:t,customers:r,employees:n})=>{const s=o=>{we({title:" ! ! ",description:`${o}`})},a=[{title:"",description:"",icon:mr,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"",description:"",icon:mr,color:"text-green-600",bgColor:"bg-green-100"},{title:"",description:"",icon:mr,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"",description:"",icon:mr,color:"text-orange-600",bgColor:"bg-orange-100"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:""})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(ae,{variant:"outline",className:"flex items-center gap-2",children:[i.jsx(iu,{className:"w-4 h-4"}),""]}),i.jsxs(ae,{variant:"outline",className:"flex items-center gap-2",children:[i.jsx(ya,{className:"w-4 h-4"}),""]})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.map((o,l)=>{const c=o.icon;return i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:`p-3 rounded-lg ${o.bgColor}`,children:i.jsx(c,{className:`w-6 h-6 ${o.color}`})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:o.title}),i.jsx("p",{className:"text-gray-600 mb-4",children:o.description}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(ae,{size:"sm",onClick:()=>s(o.title),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[i.jsx(zs,{className:"w-4 h-4 mr-2"})," PDF"]}),i.jsxs(ae,{size:"sm",variant:"outline",onClick:()=>s(o.title),children:[i.jsx(zs,{className:"w-4 h-4 mr-2"})," Excel"]})]})]})]})},o.title)})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:e.length}),i.jsx("div",{className:"text-sm text-gray-600",children:""})]}),i.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:r.length}),i.jsx("div",{className:"text-sm text-gray-600",children:""})]}),i.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:t.length}),i.jsx("div",{className:"text-sm text-gray-600",children:""})]})]})]})]})},XY=({products:e=[],installmentPlans:t=[],customers:r=[],employees:n=[],selectedBranch:s,currentBranch:a})=>{const o=t.filter(w=>w.branchId===s),l=r.filter(w=>w.branchId===s),c=n.filter(w=>w.branchId===s),u=e.filter(w=>w.branchId===s),d=o.reduce((w,y)=>{var N;const x=((N=y.payments)==null?void 0:N.filter(S=>S.status==="paid"))||[];return w+x.reduce((S,_)=>S+(_.amount||0),0)},0),f=o.reduce((w,y)=>{var N;const x=((N=y.payments)==null?void 0:N.filter(S=>S.status==="pending"))||[];return w+x.reduce((S,_)=>S+(_.amount||0),0)},0),h=[{title:"",value:`${d.toLocaleString()}`,icon:ii,color:"text-green-600",bgColor:"bg-green-100"},{title:"",value:`${f.toLocaleString()}`,icon:Tl,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"",value:l.length,icon:gn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"",value:u.length,icon:er,color:"text-purple-600",bgColor:"bg-purple-100"}],m=o.reduce((w,y)=>{var x;return w+(((x=y.payments)==null?void 0:x.filter(N=>N.status==="paid").length)||0)},0),g=o.reduce((w,y)=>{var x;return w+(((x=y.payments)==null?void 0:x.filter(N=>N.status==="pending").length)||0)},0),p=c.filter(w=>w.isCheckedIn).length,v=c.filter(w=>!w.isCheckedIn).length;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsxs("p",{className:"text-gray-600",children:[" - ",(a==null?void 0:a.name)||""]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(Qh,{className:"w-4 h-4"}),i.jsxs("span",{children:[": ",new Date().toLocaleDateString("th-TH")]})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map((w,y)=>{const x=w.icon;return i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsx("div",{className:`p-3 rounded-lg ${w.bgColor}`,children:i.jsx(x,{className:`w-6 h-6 ${w.color}`})})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:w.title}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.value})]})]},w.title)})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:""}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsxs("span",{className:"font-medium",children:[o.length," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsxs("span",{className:"font-medium text-green-600",children:[m," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsxs("span",{className:"font-medium text-red-600",children:[g," "]})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:""}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsxs("span",{className:"font-medium",children:[c.length," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsxs("span",{className:"font-medium text-green-600",children:[p," "]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsxs("span",{className:"font-medium text-gray-600",children:[v," "]})]})]})]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Qh,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-500",children:" ! ! "})]})}),o.length===0&&l.length===0&&i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[i.jsx(Qh,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:""}),i.jsx("p",{className:"text-gray-500",children:""})]})]})},KY=({selectedBranch:e})=>{const[t,r]=k.useState([]),[n,s]=k.useState(!0),[a,o]=k.useState(!1),[l,c]=k.useState(!1),[u,d]=k.useState(null),[f,h]=k.useState({name:"",address:"",phone:"",manager:""});k.useEffect(()=>{m()},[]);const m=async()=>{try{s(!0);const x=await Ti.getAll();r(x.data||[])}catch(x){console.error("Error loading branches:",x),we({title:"",description:"",variant:"destructive"})}finally{s(!1)}},g=async x=>{if(x.preventDefault(),!f.name||!f.address){we({title:"",description:"",variant:"destructive"});return}try{o(!0),u?(await Ti.update(u.id,f),we({title:"! ",description:` ${f.name} `}),d(null)):(await Ti.create(f),we({title:"! ",description:` ${f.name} `})),h({name:"",address:"",phone:"",manager:""}),c(!1),m()}catch(N){console.error("Error saving branch:",N),we({title:"",description:"",variant:"destructive"})}finally{o(!1)}},p=x=>{h({name:x.name,address:x.address,phone:x.phone||"",manager:x.manager||""}),d(x),c(!0)},v=async x=>{if(t.length<=1){we({title:"",description:" 1 ",variant:"destructive"});return}if(x===e){we({title:"",description:"",variant:"destructive"});return}try{await Ti.delete(x),we({title:"",description:""}),m()}catch(N){console.error("Error deleting branch:",N),we({title:"",description:"",variant:"destructive"})}},w=async x=>{try{const S={isActive:!t.find(_=>_.id===x).isActive};await Ti.update(x,S),we({title:"",description:""}),m()}catch(N){console.error("Error updating branch status:",N),we({title:"",description:"",variant:"destructive"})}},y=()=>{h({name:"",address:"",phone:"",manager:""}),d(null),c(!1)};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600 mt-1",children:" "})]}),i.jsxs(ae,{onClick:()=>c(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n?Array.from({length:6}).map((x,N)=>i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 animate-pulse",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-4"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]},N)):t.length===0?i.jsx("div",{className:"col-span-full",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[i.jsx(Vs,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),i.jsx("p",{className:"text-gray-500 mb-6",children:""}),i.jsxs(ae,{onClick:()=>c(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[i.jsx(Sr,{className:"w-4 h-4 mr-2"}),""]})]})}):t.map((x,N)=>i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:i.jsx(Vs,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:x.name}),i.jsxs("div",{className:"flex items-center gap-2",children:[x.isActive?i.jsx(ts,{className:"w-4 h-4 text-green-500"}):i.jsx(Uf,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{className:`text-sm ${x.isActive?"text-green-600":"text-red-600"}`,children:x.isActive?"":""})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{size:"sm",variant:"ghost",onClick:()=>w(x.id),className:"text-gray-500 hover:text-gray-700",children:x.isActive?"":""}),i.jsx(ae,{size:"sm",variant:"ghost",onClick:()=>p(x),className:"text-blue-600 hover:text-blue-700",children:i.jsx(Cs,{className:"w-4 h-4"})}),i.jsx(ae,{size:"sm",variant:"ghost",onClick:()=>v(x.id),className:"text-red-600 hover:text-red-700",disabled:x.id===e,children:i.jsx(ka,{className:"w-4 h-4"})})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx(gl,{className:"w-4 h-4"}),i.jsx("span",{className:"truncate",children:x.address})]}),x.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx(rs,{className:"w-4 h-4"}),i.jsx("span",{children:x.phone})]}),x.manager&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx(br,{className:"w-4 h-4"}),i.jsx("span",{children:x.manager})]})]}),x.id===e&&i.jsx("div",{className:"mt-4 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:i.jsx("span",{className:"text-sm text-blue-700 font-medium",children:""})})]},x.id))}),(l||u)&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:u?"":""}),i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),i.jsx("input",{type:"text",value:f.name,onChange:x=>h(N=>({...N,name:x.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),i.jsx("textarea",{value:f.address,onChange:x=>h(N=>({...N,address:x.target.value})),required:!0,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"tel",value:f.phone,onChange:x=>h(N=>({...N,phone:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:f.manager,onChange:x=>h(N=>({...N,manager:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]})]}),i.jsxs("div",{className:"flex gap-2 mt-6",children:[i.jsx(ae,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700",disabled:a,children:a?i.jsxs(i.Fragment,{children:[i.jsx(Pt,{className:"w-4 h-4 mr-2 animate-spin"}),"..."]}):u?"":""}),i.jsx(ae,{type:"button",variant:"outline",onClick:y,disabled:a,children:""})]})]})]})})]})},YY=()=>{const[e,t]=k.useState(!1);k.useEffect(()=>{const a=localStorage.getItem("simple_404_mode");t(a==="true")},[]);const r=()=>{const a=!e;t(a),localStorage.setItem("simple_404_mode",a.toString()),we({title:a?"  404 ":"  404 ",description:a?" 404":"",variant:"default"}),a&&setTimeout(()=>{window.location.reload()},2e3)},n=a=>{we({title:" ! ! ",description:`: ${a}`})},s=[{title:"",icon:eo,settings:[{name:"",value:"",type:"text"},{name:"",value:"Asia/Bangkok",type:"select"},{name:"",value:"THB ()",type:"select"}]},{title:"",icon:Mg,settings:[{name:"",value:!0,type:"toggle"},{name:"",value:!0,type:"toggle"},{name:"",value:!1,type:"toggle"}]},{title:"",icon:Nn,settings:[{name:"",value:!1,type:"toggle"},{name:"",value:!0,type:"toggle"},{name:" ()",value:"30",type:"number"}]},{title:"",icon:_w,settings:[{name:"",value:!0,type:"toggle"},{name:" ()",value:"24",type:"number"},{name:" ()",value:"30",type:"number"}]}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),i.jsx("p",{className:"text-gray-600",children:""})]})}),i.jsx("div",{className:"grid gap-6",children:s.map((a,o)=>{const l=a.icon;return i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-3",children:[i.jsx(l,{className:"w-5 h-5"}),a.title]})}),i.jsx("div",{className:"p-6 space-y-4",children:a.settings.map((c,u)=>i.jsxs("div",{className:"flex items-center justify-between py-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:c.name}),c.type!=="toggle"&&i.jsxs("div",{className:"text-sm text-gray-500",children:[": ",c.value]})]}),i.jsx("div",{children:c.type==="toggle"?i.jsx(ae,{variant:c.value?"default":"outline",size:"sm",onClick:()=>n(c.name),className:c.value?"bg-green-600 hover:bg-green-700":"",children:c.value?"":""}):i.jsx(ae,{variant:"outline",size:"sm",onClick:()=>n(c.name),children:""})})]},c.name))})]},a.title)})}),i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-3",children:[i.jsx(Qd,{className:"w-5 h-5"})," 404"]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between py-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:"/ 404"}),i.jsx("div",{className:"text-sm text-gray-500",children:"  404 Not Found (Admin )"})]}),i.jsxs(ae,{variant:e?"default":"outline",onClick:r,className:`${e?"bg-red-500 hover:bg-red-600 text-white":"border-red-300 text-red-600 hover:bg-red-50"}`,children:[i.jsx(Qd,{className:"w-4 h-4 mr-2"}),e?" 404":" 404"]})]}),e&&i.jsxs($e.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[i.jsx(Qd,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:" 404 "})]}),i.jsx("p",{className:"text-sm text-red-600 mt-1",children:" 404 Not Found  Admin "})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs(ae,{variant:"outline",onClick:()=>n(""),className:"h-auto p-4 flex flex-col items-center gap-2",children:[i.jsx(_w,{className:"w-6 h-6"}),i.jsx("span",{children:""})]}),i.jsxs(ae,{variant:"outline",onClick:()=>n(""),className:"h-auto p-4 flex flex-col items-center gap-2",children:[i.jsx(eo,{className:"w-6 h-6"}),i.jsx("span",{children:""})]}),i.jsxs(ae,{variant:"outline",onClick:()=>n(""),className:"h-auto p-4 flex flex-col items-center gap-2",children:[i.jsx(Nn,{className:"w-6 h-6"}),i.jsx("span",{children:""})]})]})]})]})},qY=({activeTab:e,selectedBranch:t,currentBranch:r,customerData:n,onBack:s,onViewPaymentSchedule:a,currentUser:o})=>{const l=()=>{switch(e){case"dashboard":return i.jsx(Ew,{selectedBranch:t,currentBranch:r});case"products":return i.jsx(w7,{selectedBranch:t,currentBranch:r});case"customers":return i.jsx(b7,{selectedBranch:t,currentBranch:r});case"employees":return i.jsx(N7,{selectedBranch:t,currentBranch:r});case"salespeople":return i.jsx(k7,{selectedBranch:t,currentBranch:r});case"checkers":return i.jsx(S7,{selectedBranch:t,currentBranch:r,onViewPaymentSchedule:a});case"all-checker-customers":return i.jsx(j7,{selectedBranch:t,currentBranch:r,onViewPaymentSchedule:a});case"checker-installment-report":return i.jsx(gj,{selectedBranch:t,currentBranch:r,onBack:s});case"sales-index":return i.jsx(C7,{selectedBranch:t,currentBranch:r});case"payment-schedule":return i.jsx(E7,{selectedBranch:t,currentBranch:r,customerData:n,onBack:s,onViewPaymentSchedule:a});case"contracts":return i.jsx(WY,{selectedBranch:t,currentBranch:r});case"payments":return i.jsx(A7,{selectedBranch:t,currentBranch:r});case"returns":return i.jsx(HY,{selectedBranch:t,currentBranch:r});case"reports":return i.jsx(GY,{selectedBranch:t,currentBranch:r});case"analytics":return i.jsx(XY,{selectedBranch:t,currentBranch:r});case"branches":return i.jsx(KY,{selectedBranch:t});case"import-data":return i.jsx(RY,{onBack:()=>window.history.back()});case"admin-users":return i.jsx(MY,{selectedBranch:t,currentBranch:r});case"settings":return i.jsx(YY,{});default:return i.jsx(Ew,{selectedBranch:t,currentBranch:r})}};return i.jsx("div",{className:"flex-1 overflow-auto",children:i.jsx("div",{className:"p-6",children:l()})})},ar=({branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:s,onLogout:a})=>{const o=Na(),l=ag(),[c,u]=k.useState(!1),[d,f]=k.useState(null),h=e.find(y=>y.id===r)||e[0],g=(y=>y.replace("/","")||"dashboard")(o.pathname),p=y=>{l(`/${y}`)},v=()=>{l("/checkers"),f(null)},w=y=>{f(y),l("/payment-schedule")};return i.jsxs("div",{className:"flex h-screen bg-gray-50",children:[i.jsx(KI,{activeTab:g,setActiveTab:p,collapsed:c,setCollapsed:u,currentBranch:h}),i.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${c?"ml-16":"ml-64"}`,children:[i.jsx(YI,{sidebarCollapsed:c,setSidebarCollapsed:u,branches:e,selectedBranch:r,setSelectedBranch:n,currentBranch:h,currentUser:s,onLogout:a}),i.jsx(qY,{activeTab:g,selectedBranch:r,currentBranch:h,customerData:d,onBack:v,onViewPaymentSchedule:w,currentUser:s})]})]})};class JY{constructor(){this.currentUser=null,this.token=localStorage.getItem("auth_token"),this.token&&(_e.defaults.headers.common.Authorization=`Bearer ${this.token}`)}async login(t,r){var n,s;try{const a=await _e.post("/auth/login",{username:t,password:r}),{token:o,user:l}=a.data;return this.token=o,this.currentUser=l,localStorage.setItem("auth_token",o),localStorage.setItem("current_user",JSON.stringify(l)),_e.defaults.headers.common.Authorization=`Bearer ${o}`,{success:!0,user:l}}catch(a){throw console.error("Login error:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("")}}async logout(){try{await _e.post("/auth/logout")}catch(t){console.error("Logout error:",t)}finally{this.token=null,this.currentUser=null,localStorage.removeItem("auth_token"),localStorage.removeItem("current_user"),delete _e.defaults.headers.common.Authorization}}isAuthenticated(){return!!this.token}getCurrentUser(){if(!this.currentUser){const t=localStorage.getItem("current_user");t&&(this.currentUser=JSON.parse(t))}return this.currentUser}async refreshToken(){try{const t=await _e.post("/auth/refresh"),{token:r}=t.data;return this.token=r,localStorage.setItem("auth_token",r),_e.defaults.headers.common.Authorization=`Bearer ${r}`,r}catch(t){throw console.error("Token refresh error:",t),this.logout(),new Error("Session expired. Please login again.")}}hasPermission(t){var n;const r=this.getCurrentUser();return r?r.role==="super_admin"?!0:((n=r.permissions)==null?void 0:n.includes(t))||!1:!1}hasRole(t){const r=this.getCurrentUser();return r?Array.isArray(t)?t.includes(r.role):r.role===t:!1}isAdmin(){return this.hasRole(["super_admin","admin"])}isSuperAdmin(){return this.hasRole("super_admin")}canAccessBranch(t){const r=this.getCurrentUser();return r?this.hasRole(["super_admin","admin"])||!r.branch_id?!0:r.branch_id===t:!1}getAccessibleBranches(t){const r=this.getCurrentUser();return r?this.hasRole(["super_admin","admin"])?t:r.branch_id?t.filter(n=>n.id===r.branch_id):t:[]}async validateToken(){if(!this.token)return!1;try{return(await _e.get("/auth/validate")).data.valid}catch(t){return console.error("Token validation error:",t),!1}}async changePassword(t,r){var n,s;try{return(await _e.post("/auth/change-password",{current_password:t,new_password:r})).data}catch(a){throw console.error("Change password error:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("")}}async requestPasswordReset(t){var r,n;try{return(await _e.post("/auth/forgot-password",{email:t})).data}catch(s){throw console.error("Password reset request error:",s),(n=(r=s.response)==null?void 0:r.data)!=null&&n.message?new Error(s.response.data.message):new Error("")}}async resetPassword(t,r){var n,s;try{return(await _e.post("/auth/reset-password",{token:t,new_password:r})).data}catch(a){throw console.error("Password reset error:",a),(s=(n=a.response)==null?void 0:n.data)!=null&&s.message?new Error(a.response.data.message):new Error("")}}}const mc=new JY,ZY=({onLoginSuccess:e})=>{const[t,r]=k.useState({username:"",password:""}),[n,s]=k.useState(!1),[a,o]=k.useState(!1),[l,c]=k.useState({}),[u,d]=k.useState(0);k.useEffect(()=>{const p=setInterval(()=>{d(v=>(v+1)%3)},4e3);return()=>clearInterval(p)},[]);const f=[{icon:i.jsx(Vs,{className:"w-10 h-10"}),title:"",description:" ",color:"from-emerald-400 to-green-500"},{icon:i.jsx(gn,{className:"w-10 h-10"}),title:"",description:"",color:"from-teal-400 to-cyan-500"},{icon:i.jsx(Tl,{className:"w-10 h-10"}),title:"",description:"",color:"from-green-400 to-emerald-500"}],h=p=>{const{name:v,value:w}=p.target;r(y=>({...y,[v]:w})),l[v]&&c(y=>({...y,[v]:""}))},m=()=>{const p={};return t.username.trim()||(p.username=""),t.password||(p.password=""),c(p),Object.keys(p).length===0},g=async p=>{if(p.preventDefault(),!!m()){o(!0);try{const v=await mc.login(t.username,t.password);we({title:"",description:` ${v.user.full_name||v.user.username}`,variant:"default"}),e&&e(v.user)}catch(v){we({title:"",description:v.message,variant:"destructive"})}finally{o(!1)}}};return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-green-100 to-teal-50 flex relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("div",{className:"absolute top-20 left-20 w-96 h-96 bg-gradient-to-r from-emerald-300/30 to-green-400/30 rounded-full blur-3xl animate-pulse"}),i.jsx("div",{className:"absolute bottom-20 right-20 w-80 h-80 bg-gradient-to-r from-teal-300/30 to-cyan-400/30 rounded-full blur-3xl animate-pulse delay-1000"}),i.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-to-r from-green-300/30 to-emerald-400/30 rounded-full blur-3xl animate-pulse delay-500"}),i.jsx("div",{className:"absolute top-32 left-32 animate-bounce",children:i.jsx(LI,{className:"w-6 h-6 text-emerald-500"})}),i.jsx("div",{className:"absolute top-64 right-32 animate-bounce delay-1000",children:i.jsx(OI,{className:"w-4 h-4 text-green-500"})}),i.jsx("div",{className:"absolute bottom-32 left-1/3 animate-bounce delay-500",children:i.jsx($I,{className:"w-5 h-5 text-teal-500"})})]}),i.jsx("div",{className:"hidden lg:flex lg:w-1/2 relative z-10",children:i.jsxs("div",{className:"flex flex-col justify-center items-center text-white p-12 w-full",children:[i.jsxs($e.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1},className:"text-center mb-16",children:[i.jsxs($e.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{delay:.3,type:"spring",stiffness:200},className:"w-24 h-24 bg-gradient-to-r from-emerald-400 via-green-500 to-teal-500 rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-2xl relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/50 via-green-500/50 to-teal-500/50 animate-pulse"}),i.jsx(xl,{className:"w-12 h-12 text-white relative z-10"})]}),i.jsx("h1",{className:"text-5xl font-bold mb-6 bg-gradient-to-r from-emerald-600 via-green-600 to-teal-600 bg-clip-text text-transparent",children:""}),i.jsx("p",{className:"text-xl text-emerald-700 font-medium",children:"Admin Panel - Professional Management System"})]}),i.jsxs("div",{className:"w-full max-w-lg",children:[i.jsx(Ec,{mode:"wait",children:i.jsxs($e.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-100,scale:.8},transition:{duration:.6,type:"spring"},className:"text-center",children:[i.jsx("div",{className:`w-20 h-20 bg-gradient-to-r ${f[u].color} rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl transform hover:scale-110 transition-transform duration-300`,children:f[u].icon}),i.jsx("h3",{className:"text-2xl font-bold mb-3 text-emerald-800",children:f[u].title}),i.jsx("p",{className:"text-emerald-700 text-lg",children:f[u].description})]},u)}),i.jsx("div",{className:"flex justify-center gap-3 mt-8",children:f.map((p,v)=>i.jsx("button",{onClick:()=>d(v),className:`w-3 h-3 rounded-full transition-all duration-300 ${v===u?"bg-white w-8 scale-125":"bg-white/40 hover:bg-white/60"}`},v))})]}),i.jsxs($e.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1,delay:.5},className:"mt-16 grid grid-cols-3 gap-12 text-center",children:[i.jsxs("div",{className:"group",children:[i.jsx("div",{className:"text-3xl font-bold text-emerald-600 group-hover:text-emerald-700 transition-colors",children:"50+"}),i.jsx("div",{className:"text-sm text-emerald-700 group-hover:text-emerald-800 transition-colors",children:""})]}),i.jsxs("div",{className:"group",children:[i.jsx("div",{className:"text-3xl font-bold text-green-600 group-hover:text-green-700 transition-colors",children:"10K+"}),i.jsx("div",{className:"text-sm text-green-700 group-hover:text-green-800 transition-colors",children:""})]}),i.jsxs("div",{className:"group",children:[i.jsx("div",{className:"text-3xl font-bold text-teal-600 group-hover:text-teal-700 transition-colors",children:"99.9%"}),i.jsx("div",{className:"text-sm text-teal-700 group-hover:text-teal-800 transition-colors",children:""})]})]})]})}),i.jsx("div",{className:"flex-1 flex items-center justify-center p-8 relative z-10",children:i.jsxs($e.div,{initial:{opacity:0,x:50,scale:.9},animate:{opacity:1,x:0,scale:1},transition:{duration:1,delay:.3},className:"w-full max-w-md",children:[i.jsxs(yr,{className:"shadow-2xl border-0 bg-white/90 backdrop-blur-xl rounded-3xl overflow-hidden border border-emerald-200",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-50/50 to-green-50/30"}),i.jsxs(Zn,{className:"text-center pb-8 relative z-10",children:[i.jsxs($e.div,{initial:{scale:0,rotate:180},animate:{scale:1,rotate:0},transition:{delay:.6,type:"spring",stiffness:200},className:"w-20 h-20 bg-gradient-to-r from-emerald-400 via-green-500 to-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/50 via-green-500/50 to-teal-500/50 animate-pulse"}),i.jsx(Nn,{className:"w-10 h-10 text-white relative z-10"})]}),i.jsx(Qn,{className:"text-3xl font-bold text-emerald-800 mb-2",children:""}),i.jsx(Os,{className:"text-emerald-600 text-lg",children:""})]}),i.jsx(wr,{className:"relative z-10",children:i.jsxs("form",{onSubmit:g,className:"space-y-8",children:[i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:[i.jsx("label",{className:"block text-sm font-semibold text-emerald-800 mb-3",children:""}),i.jsxs("div",{className:"relative group",children:[i.jsx(br,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-emerald-500 h-5 w-5 group-focus-within:text-emerald-600 transition-colors"}),i.jsx("input",{type:"text",name:"username",value:t.username,onChange:h,className:`w-full pl-12 pr-4 py-4 border-2 rounded-2xl focus:ring-4 focus:ring-emerald-500/30 focus:border-emerald-400 transition-all duration-300 bg-white/80 backdrop-blur-sm text-emerald-900 placeholder-emerald-500 ${l.username?"border-red-400 bg-red-50":"border-emerald-300/50 hover:border-emerald-400"}`,placeholder:"",disabled:a})]}),i.jsx(Ec,{children:l.username&&i.jsxs($e.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-red-300 text-sm mt-2 flex items-center gap-2",children:[i.jsx(Zi,{className:"h-4 w-4"}),l.username]})})]}),i.jsxs($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:[i.jsx("label",{className:"block text-sm font-semibold text-emerald-800 mb-3",children:""}),i.jsxs("div",{className:"relative group",children:[i.jsx(Mp,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-emerald-500 h-5 w-5 group-focus-within:text-emerald-600 transition-colors"}),i.jsx("input",{type:n?"text":"password",name:"password",value:t.password,onChange:h,className:`w-full pl-12 pr-14 py-4 border-2 rounded-2xl focus:ring-4 focus:ring-emerald-500/30 focus:border-emerald-400 transition-all duration-300 bg-white/80 backdrop-blur-sm text-emerald-900 placeholder-emerald-500 ${l.password?"border-red-400 bg-red-50":"border-emerald-300/50 hover:border-emerald-400"}`,placeholder:"",disabled:a}),i.jsx("button",{type:"button",onClick:()=>s(!n),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-emerald-500 hover:text-emerald-600 transition-colors",disabled:a,children:n?i.jsx(Op,{className:"h-5 w-5"}):i.jsx(au,{className:"h-5 w-5"})})]}),i.jsx(Ec,{children:l.password&&i.jsxs($e.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-red-300 text-sm mt-2 flex items-center gap-2",children:[i.jsx(Zi,{className:"h-4 w-4"}),l.password]})})]}),i.jsx($e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},children:i.jsx(ae,{type:"submit",disabled:a,className:"w-full py-4 text-lg font-semibold bg-gradient-to-r from-emerald-400 via-green-500 to-teal-500 hover:from-emerald-500 hover:via-green-600 hover:to-teal-600 shadow-2xl hover:shadow-emerald-500/25 transition-all duration-300 transform hover:scale-105 rounded-2xl",children:a?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Pt,{className:"h-5 w-5 animate-spin"}),"..."]}):i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(AI,{className:"h-5 w-5"}),""]})})})]})})]}),i.jsx($e.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},className:"text-center mt-8",children:i.jsxs("div",{className:"flex items-center justify-center gap-3 text-sm text-emerald-600",children:[i.jsx(Nn,{className:"h-5 w-5"}),i.jsx("span",{className:"font-medium",children:""})]})})]})})]})};function QY(){const[e,t]=k.useState([]),[r,n]=k.useState(null),[s,a]=k.useState(!0),[o,l]=k.useState(!1),[c,u]=k.useState(null),[d,f]=k.useState(!1);k.useEffect(()=>{h(),m()},[]),k.useEffect(()=>{const w=setInterval(()=>{m()},3e4);return()=>clearInterval(w)},[]),k.useEffect(()=>{o&&g()},[o]);const h=async()=>{try{if(a(!0),mc.isAuthenticated()){const w=mc.getCurrentUser();u(w),l(!0)}}catch(w){console.error("Auth check error:",w),mc.logout()}finally{a(!1)}},m=()=>{try{const w=localStorage.getItem("simple_404_mode")==="true";f(w)}catch(w){console.error("Error checking 404 mode:",w)}},g=async()=>{try{a(!0);const y=(await Ti.getAll()).data||[];t(y),!r&&y.length>0&&n(y[0].id),console.log(" Branches loaded successfully:",y)}catch(w){console.error(" Error loading branches:",w),we({title:"",description:"",variant:"destructive"})}finally{a(!1)}},p=w=>{console.log(" Login success, user:",w),u(w),l(!0),console.log(" State updated - isAuthenticated:",!0,"currentUser:",w)},v=()=>{mc.logout(),u(null),l(!1),t([]),n(null)};return console.log(" Auth check - isAuthenticated:",o,"currentUser:",c,"role:",c==null?void 0:c.role),!o||!c||c.role!=="admin"&&c.role!=="super_admin"?(console.log(" Showing login page"),i.jsxs(i.Fragment,{children:[i.jsx(ZY,{onLoginSuccess:p}),i.jsx(Cw,{})]})):s?i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"..."})]})}):(console.log(" Showing dashboard - isAuthenticated:",o,"currentUser:",c),i.jsx(P5,{children:i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[i.jsxs(l5,{children:[i.jsx(zt,{path:"/",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/dashboard",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/branches",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/products",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/customers",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/installments",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/contracts",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/checkers",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/collectors",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/reports",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/payments",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/returns",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/employees",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/salespeople",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/all-checker-customers",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/sales-index",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/import-data",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/admin-users",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/settings",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"/payment-schedule",element:i.jsx(ar,{branches:e,setBranches:t,selectedBranch:r,setSelectedBranch:n,currentUser:c,onLogout:v})}),i.jsx(zt,{path:"*",element:i.jsx(i5,{to:"/",replace:!0})})]}),i.jsx(Cw,{})]})}))}km.createRoot(document.getElementById("root")).render(i.jsx(wt.StrictMode,{children:i.jsx(QY,{})}));
