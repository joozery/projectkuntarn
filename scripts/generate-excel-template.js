import XLSX from 'xlsx';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå template Excel
function generateExcelTemplate() {
  const wb = XLSX.utils.book_new();

  // Sheet 1: ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Instructions)
  const instructionsData = [
    ['‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡πà‡∏≠‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤'],
    [''],
    ['1. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö Sheet ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î'],
    ['2. ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå template'],
    ['3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ * ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô'],
    ['4. ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: YYYY-MM-DD (‡πÄ‡∏ä‡πà‡∏ô 2024-01-15)'],
    ['5. ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç: ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≠‡∏°‡∏°‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô 25000.50)'],
    [''],
    ['‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß:'],
    ['- ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Sheet Installments ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô'],
    ['- ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Sheet Payments ‡∏ó‡∏∏‡∏Å‡∏á‡∏ß‡∏î (‡∏ó‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∞)'],
    ['- ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Sheet Collections ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß'],
    [''],
    ['‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:'],
    ['- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞: paid, pending, overdue, cancelled'],
    ['- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏±‡∏ç‡∏ç‡∏≤: active, completed, cancelled, overdue'],
    [''],
    ['‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:'],
    ['- ‡∏£‡∏´‡∏±‡∏™‡∏ï‡πà‡∏≤‡∏á‡πÜ (customer_code, contract_number) ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô'],
    ['- ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô'],
    ['- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô import']
  ];
  const instructionsWS = XLSX.utils.aoa_to_sheet(instructionsData);
  XLSX.utils.book_append_sheet(wb, instructionsWS, '‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥');

  // Sheet 2: Branches (‡∏™‡∏≤‡∏Ç‡∏≤)
  const branchesData = [
    ['branch_code*', 'branch_name*', 'address', 'phone', 'manager'],
    ['BR001', '‡∏™‡∏≤‡∏Ç‡∏≤‡∏´‡∏•‡∏±‡∏Å', '123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10110', '02-123-4567', '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ'],
    ['BR002', '‡∏™‡∏≤‡∏Ç‡∏≤‡∏£‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏´‡∏á', '456 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏´‡∏á ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10240', '02-234-5678', '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏£‡∏±‡∏Å‡∏î‡∏µ'],
    ['BR003', '‡∏™‡∏≤‡∏Ç‡∏≤‡∏•‡∏≤‡∏î‡∏û‡∏£‡πâ‡∏≤‡∏ß', '789 ‡∏ñ‡∏ô‡∏ô‡∏•‡∏≤‡∏î‡∏û‡∏£‡πâ‡∏≤‡∏ß ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10310', '02-345-6789', '‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á']
  ];
  const branchesWS = XLSX.utils.aoa_to_sheet(branchesData);
  XLSX.utils.book_append_sheet(wb, branchesWS, 'Branches');

  // Sheet 3: Checkers (‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Å‡∏≠‡∏£‡πå)
  const checkersData = [
    ['checker_code*', 'name*', 'surname', 'phone', 'email', 'branch_code*'],
    ['CHK001', '‡∏≠‡∏ô‡∏∏‡∏ä‡∏¥‡∏ï', '', '081-111-1111', 'anuchit@example.com', 'BR001'],
    ['CHK002', '‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå', '‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏ó‡∏≠‡∏á', '081-222-2222', 'udomsak@example.com', 'BR001'],
    ['CHK003', '‡πÄ‡∏™‡∏Å‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå', '‡πÇ‡∏ï‡∏ó‡∏≠‡∏á', '081-333-3333', 'seksak@example.com', 'BR002'],
    ['CHK004', '‡∏™‡∏°‡∏ä‡∏≤‡∏¢', '‡πÉ‡∏à‡∏î‡∏µ', '081-444-4444', 'somchai@example.com', 'BR002'],
    ['CHK005', '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á', '‡∏£‡∏±‡∏Å‡∏î‡∏µ', '081-555-5555', 'somying@example.com', 'BR003']
  ];
  const checkersWS = XLSX.utils.aoa_to_sheet(checkersData);
  XLSX.utils.book_append_sheet(wb, checkersWS, 'Checkers');

  // Sheet 4: Customers (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)
  const customersData = [
    ['customer_code*', 'name*', 'surname', 'id_card*', 'nickname', 'phone', 'email', 'address', 'guarantor_name', 'guarantor_id_card', 'guarantor_phone', 'guarantor_address', 'branch_code*', 'checker_code*'],
    ['CUST001', '‡∏™‡∏°‡∏ä‡∏≤‡∏¢', '‡πÉ‡∏à‡∏î‡∏µ', '1234567890123', '‡∏™‡∏°‡∏ä‡∏≤‡∏¢', '082-111-1111', 'customer1@example.com', '123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø', '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏£‡∏±‡∏Å‡∏î‡∏µ', '9876543210987', '082-222-2222', '456 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏´‡∏á ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø', 'BR001', 'CHK001'],
    ['CUST002', '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á', '‡∏£‡∏±‡∏Å‡∏î‡∏µ', '9876543210987', '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á', '082-222-2222', 'customer2@example.com', '456 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏´‡∏á ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø', '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ', '1234567890123', '082-111-1111', '123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø', 'BR001', 'CHK001'],
    ['CUST003', '‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò', '‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á', '1122334455667', '‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò', '082-333-3333', 'customer3@example.com', '789 ‡∏ñ‡∏ô‡∏ô‡∏•‡∏≤‡∏î‡∏û‡∏£‡πâ‡∏≤‡∏ß ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø', '', '', '', '', 'BR002', 'CHK003']
  ];
  const customersWS = XLSX.utils.aoa_to_sheet(customersData);
  XLSX.utils.book_append_sheet(wb, customersWS, 'Customers');

  // Sheet 5: Products (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)
  const productsData = [
    ['product_code*', 'product_name*', 'description', 'price*', 'branch_code*'],
    ['PROD001', '‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ Samsung Galaxy S21', '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å Samsung', '25000.00', 'BR001'],
    ['PROD002', '‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Ñ Dell Inspiron 15', '‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '35000.00', 'BR001'],
    ['PROD003', '‡∏ó‡∏µ‡∏ß‡∏µ LG 55 ‡∏ô‡∏¥‡πâ‡∏ß', '‡∏ó‡∏µ‡∏ß‡∏µ Smart TV ‡∏Ç‡∏ô‡∏≤‡∏î 55 ‡∏ô‡∏¥‡πâ‡∏ß', '45000.00', 'BR002'],
    ['PROD004', '‡∏ï‡∏π‡πâ‡πÄ‡∏¢‡πá‡∏ô Samsung 2 ‡∏õ‡∏£‡∏∞‡∏ï‡∏π', '‡∏ï‡∏π‡πâ‡πÄ‡∏¢‡πá‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà 2 ‡∏õ‡∏£‡∏∞‡∏ï‡∏π', '28000.00', 'BR002'],
    ['PROD005', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ã‡∏±‡∏Å‡∏ú‡πâ‡∏≤ Panasonic', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ã‡∏±‡∏Å‡∏ú‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥', '18000.00', 'BR003']
  ];
  const productsWS = XLSX.utils.aoa_to_sheet(productsData);
  XLSX.utils.book_append_sheet(wb, productsWS, 'Products');

  // Sheet 6: Installments (‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ú‡πà‡∏≠‡∏ô)
  const installmentsData = [
    ['contract_number*', 'customer_code*', 'product_code', 'product_name*', 'total_amount*', 'installment_amount*', 'installment_period*', 'start_date*', 'end_date*', 'status*', 'branch_code*', 'salesperson_name'],
    ['CT2401001', 'CUST001', 'PROD001', '‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ Samsung Galaxy S21', '25000.00', '2500.00', '10', '2024-01-01', '2024-10-01', 'active', 'BR001', '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢'],
    ['CT2401002', 'CUST002', 'PROD002', '‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Ñ Dell Inspiron 15', '35000.00', '3500.00', '10', '2024-01-15', '2024-10-15', 'active', 'BR001', '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á'],
    ['CT2401003', 'CUST003', 'PROD003', '‡∏ó‡∏µ‡∏ß‡∏µ LG 55 ‡∏ô‡∏¥‡πâ‡∏ß', '45000.00', '4500.00', '10', '2024-02-01', '2024-11-01', 'active', 'BR002', '‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò']
  ];
  const installmentsWS = XLSX.utils.aoa_to_sheet(installmentsData);
  XLSX.utils.book_append_sheet(wb, installmentsWS, 'Installments');

  // Sheet 7: Payments (‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô)
  const paymentsData = [
    ['contract_number*', 'payment_sequence*', 'amount*', 'due_date*', 'payment_date', 'status*', 'notes'],
    ['CT2401001', '1', '2500.00', '2024-01-01', '2024-01-01', 'paid', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1'],
    ['CT2401001', '2', '2500.00', '2024-02-01', '2024-02-01', 'paid', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 2'],
    ['CT2401001', '3', '2500.00', '2024-03-01', '', 'pending', ''],
    ['CT2401001', '4', '2500.00', '2024-04-01', '', 'pending', ''],
    ['CT2401001', '5', '2500.00', '2024-05-01', '', 'pending', ''],
    ['CT2401001', '6', '2500.00', '2024-06-01', '', 'pending', ''],
    ['CT2401001', '7', '2500.00', '2024-07-01', '', 'pending', ''],
    ['CT2401001', '8', '2500.00', '2024-08-01', '', 'pending', ''],
    ['CT2401001', '9', '2500.00', '2024-09-01', '', 'pending', ''],
    ['CT2401001', '10', '2500.00', '2024-10-01', '', 'pending', ''],
    ['CT2401002', '1', '3500.00', '2024-01-15', '2024-01-15', 'paid', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1'],
    ['CT2401002', '2', '3500.00', '2024-02-15', '', 'pending', ''],
    ['CT2401002', '3', '3500.00', '2024-03-15', '', 'pending', ''],
    ['CT2401003', '1', '4500.00', '2024-02-01', '2024-02-01', 'paid', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1'],
    ['CT2401003', '2', '4500.00', '2024-03-01', '', 'pending', '']
  ];
  const paymentsWS = XLSX.utils.aoa_to_sheet(paymentsData);
  XLSX.utils.book_append_sheet(wb, paymentsWS, 'Payments');

  // Sheet 8: Collections (‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô)
  const collectionsData = [
    ['contract_number*', 'payment_sequence*', 'checker_code*', 'amount_collected*', 'collection_date*', 'notes'],
    ['CT2401001', '1', 'CHK001', '2500.00', '2024-01-01', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1'],
    ['CT2401001', '2', 'CHK001', '2500.00', '2024-02-01', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 2'],
    ['CT2401002', '1', 'CHK001', '3500.00', '2024-01-15', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1'],
    ['CT2401003', '1', 'CHK003', '4500.00', '2024-02-01', '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 1']
  ];
  const collectionsWS = XLSX.utils.aoa_to_sheet(collectionsData);
  XLSX.utils.book_append_sheet(wb, collectionsWS, 'Collections');

  // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå
  const outputPath = path.join(__dirname, '..', 'public', 'templates', 'import_template.xlsx');
  XLSX.writeFile(wb, outputPath);
  
  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå template Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', outputPath);
  console.log('üìã ‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 8 sheets:');
  console.log('   1. ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ - ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
  console.log('   2. Branches - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤');
  console.log('   3. Checkers - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Å‡∏≠‡∏£‡πå');
  console.log('   4. Customers - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤');
  console.log('   5. Products - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤');
  console.log('   6. Installments - ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ú‡πà‡∏≠‡∏ô');
  console.log('   7. Payments - ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô');
  console.log('   8. Collections - ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô');
}

// ‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå
generateExcelTemplate();

export { generateExcelTemplate };